"use strict";var Ure=Object.create;var ME=Object.defineProperty;var Y9=Object.getOwnPropertyDescriptor;var Wre=Object.getOwnPropertyNames;var Vre=Object.getPrototypeOf,jre=Object.prototype.hasOwnProperty;var he=(r,e)=>()=>(r&&(e=r(r=0)),e);var re=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Kv=(r,e)=>{for(var t in e)ME(r,t,{get:e[t],enumerable:!0})},$9=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Wre(e))!jre.call(r,i)&&i!==t&&ME(r,i,{get:()=>e[i],enumerable:!(n=Y9(e,i))||n.enumerable});return r};var se=(r,e,t)=>(t=r!=null?Ure(Vre(r)):{},$9(e||!r||!r.__esModule?ME(t,"default",{value:r,enumerable:!0}):t,r)),nL=r=>$9(ME({},"__esModule",{value:!0}),r),U=(r,e,t,n)=>{for(var i=n>1?void 0:n?Y9(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&ME(e,t,i),i},x=(r,e)=>(t,n)=>e(t,n,r);var process,p=he(()=>{"use strict";process={platform:"web",cwd:()=>"",env:{NODE_ENV:"production"}}});var Q9=re(()=>{p();var z9;(function(r){(function(e){var t=typeof this=="object"?this:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=i(r);typeof t.Reflect=="undefined"?t.Reflect=r:n=i(t.Reflect,n),e(n);function i(o,s){return function(a,l){typeof o[a]!="function"&&Object.defineProperty(o,a,{configurable:!0,writable:!0,value:l}),s&&s(a,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",i=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",o=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",a={__proto__:[]}instanceof Array,l=!s&&!a,u={create:s?function(){return we(Object.create(null))}:a?function(){return we({__proto__:null})}:function(){return we({})},has:l?function(G,X){return t.call(G,X)}:function(G,X){return X in G},get:l?function(G,X){return t.call(G,X)?G[X]:void 0}:function(G,X){return G[X]}},c=Object.getPrototypeOf(Function),d=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",f=!d&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:me(),m=!d&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Fe(),g=!d&&typeof WeakMap=="function"?WeakMap:Q(),b=new g;function y(G,X,ue,_e){if($(ue)){if(!$e(G))throw new TypeError;if(!Bt(X))throw new TypeError;return h(G,X)}else{if(!$e(G))throw new TypeError;if(!ye(X))throw new TypeError;if(!ye(_e)&&!$(_e)&&!de(_e))throw new TypeError;return de(_e)&&(_e=void 0),ue=Le(ue),v(G,X,ue,_e)}}e("decorate",y);function P(G,X){function ue(_e,xe){if(!ye(_e))throw new TypeError;if(!$(xe)&&!R(xe))throw new TypeError;ie(G,X,_e,xe)}return ue}e("metadata",P);function A(G,X,ue,_e){if(!ye(ue))throw new TypeError;return $(_e)||(_e=Le(_e)),ie(G,X,ue,_e)}e("defineMetadata",A);function D(G,X,ue){if(!ye(X))throw new TypeError;return $(ue)||(ue=Le(ue)),k(G,X,ue)}e("hasMetadata",D);function T(G,X,ue){if(!ye(X))throw new TypeError;return $(ue)||(ue=Le(ue)),H(G,X,ue)}e("hasOwnMetadata",T);function K(G,X,ue){if(!ye(X))throw new TypeError;return $(ue)||(ue=Le(ue)),Y(G,X,ue)}e("getMetadata",K);function L(G,X,ue){if(!ye(X))throw new TypeError;return $(ue)||(ue=Le(ue)),Z(G,X,ue)}e("getOwnMetadata",L);function B(G,X){if(!ye(G))throw new TypeError;return $(X)||(X=Le(X)),ce(G,X)}e("getMetadataKeys",B);function N(G,X){if(!ye(G))throw new TypeError;return $(X)||(X=Le(X)),be(G,X)}e("getOwnMetadataKeys",N);function O(G,X,ue){if(!ye(X))throw new TypeError;$(ue)||(ue=Le(ue));var _e=C(X,ue,!1);if($(_e)||!_e.delete(G))return!1;if(_e.size>0)return!0;var xe=b.get(X);return xe.delete(ue),xe.size>0||b.delete(X),!0}e("deleteMetadata",O);function h(G,X){for(var ue=G.length-1;ue>=0;--ue){var _e=G[ue],xe=_e(X);if(!$(xe)&&!de(xe)){if(!Bt(xe))throw new TypeError;X=xe}}return X}function v(G,X,ue,_e){for(var xe=G.length-1;xe>=0;--xe){var ee=G[xe],oe=ee(X,ue,_e);if(!$(oe)&&!de(oe)){if(!ye(oe))throw new TypeError;_e=oe}}return _e}function C(G,X,ue){var _e=b.get(G);if($(_e)){if(!ue)return;_e=new f,b.set(G,_e)}var xe=_e.get(X);if($(xe)){if(!ue)return;xe=new f,_e.set(X,xe)}return xe}function k(G,X,ue){var _e=H(G,X,ue);if(_e)return!0;var xe=j(X);return de(xe)?!1:k(G,xe,ue)}function H(G,X,ue){var _e=C(X,ue,!1);return $(_e)?!1:Ie(_e.has(G))}function Y(G,X,ue){var _e=H(G,X,ue);if(_e)return Z(G,X,ue);var xe=j(X);if(!de(xe))return Y(G,xe,ue)}function Z(G,X,ue){var _e=C(X,ue,!1);if(!$(_e))return _e.get(G)}function ie(G,X,ue,_e){var xe=C(ue,_e,!0);xe.set(G,X)}function ce(G,X){var ue=be(G,X),_e=j(G);if(_e===null)return ue;var xe=ce(_e,X);if(xe.length<=0)return ue;if(ue.length<=0)return xe;for(var ee=new m,oe=[],ae=0,Se=ue;ae<Se.length;ae++){var Pe=Se[ae],Ne=ee.has(Pe);Ne||(ee.add(Pe),oe.push(Pe))}for(var vt=0,Gt=xe;vt<Gt.length;vt++){var Pe=Gt[vt],Ne=ee.has(Pe);Ne||(ee.add(Pe),oe.push(Pe))}return oe}function be(G,X){var ue=[],_e=C(G,X,!1);if($(_e))return ue;for(var xe=_e.keys(),ee=S(xe),oe=0;;){var ae=_(ee);if(!ae)return ue.length=oe,ue;var Se=I(ae);try{ue[oe]=Se}catch(Pe){try{F(ee)}finally{throw Pe}}oe++}}function q(G){if(G===null)return 1;switch(typeof G){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return G===null?1:6;default:return 6}}function $(G){return G===void 0}function de(G){return G===null}function pe(G){return typeof G=="symbol"}function ye(G){return typeof G=="object"?G!==null:typeof G=="function"}function z(G,X){switch(q(G)){case 0:return G;case 1:return G;case 2:return G;case 3:return G;case 4:return G;case 5:return G}var ue=X===3?"string":X===5?"number":"default",_e=M(G,i);if(_e!==void 0){var xe=_e.call(G,ue);if(ye(xe))throw new TypeError;return xe}return fe(G,ue==="default"?"number":ue)}function fe(G,X){if(X==="string"){var ue=G.toString;if(Ge(ue)){var _e=ue.call(G);if(!ye(_e))return _e}var xe=G.valueOf;if(Ge(xe)){var _e=xe.call(G);if(!ye(_e))return _e}}else{var xe=G.valueOf;if(Ge(xe)){var _e=xe.call(G);if(!ye(_e))return _e}var ee=G.toString;if(Ge(ee)){var _e=ee.call(G);if(!ye(_e))return _e}}throw new TypeError}function Ie(G){return!!G}function Te(G){return""+G}function Le(G){var X=z(G,3);return pe(X)?X:Te(X)}function $e(G){return Array.isArray?Array.isArray(G):G instanceof Object?G instanceof Array:Object.prototype.toString.call(G)==="[object Array]"}function Ge(G){return typeof G=="function"}function Bt(G){return typeof G=="function"}function R(G){switch(q(G)){case 3:return!0;case 4:return!0;default:return!1}}function M(G,X){var ue=G[X];if(ue!=null){if(!Ge(ue))throw new TypeError;return ue}}function S(G){var X=M(G,o);if(!Ge(X))throw new TypeError;var ue=X.call(G);if(!ye(ue))throw new TypeError;return ue}function I(G){return G.value}function _(G){var X=G.next();return X.done?!1:X}function F(G){var X=G.return;X&&X.call(G)}function j(G){var X=Object.getPrototypeOf(G);if(typeof G!="function"||G===c||X!==c)return X;var ue=G.prototype,_e=ue&&Object.getPrototypeOf(ue);if(_e==null||_e===Object.prototype)return X;var xe=_e.constructor;return typeof xe!="function"||xe===G?X:xe}function me(){var G={},X=[],ue=function(){function oe(ae,Se,Pe){this._index=0,this._keys=ae,this._values=Se,this._selector=Pe}return oe.prototype["@@iterator"]=function(){return this},oe.prototype[o]=function(){return this},oe.prototype.next=function(){var ae=this._index;if(ae>=0&&ae<this._keys.length){var Se=this._selector(this._keys[ae],this._values[ae]);return ae+1>=this._keys.length?(this._index=-1,this._keys=X,this._values=X):this._index++,{value:Se,done:!1}}return{value:void 0,done:!0}},oe.prototype.throw=function(ae){throw this._index>=0&&(this._index=-1,this._keys=X,this._values=X),ae},oe.prototype.return=function(ae){return this._index>=0&&(this._index=-1,this._keys=X,this._values=X),{value:ae,done:!0}},oe}();return function(){function oe(){this._keys=[],this._values=[],this._cacheKey=G,this._cacheIndex=-2}return Object.defineProperty(oe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),oe.prototype.has=function(ae){return this._find(ae,!1)>=0},oe.prototype.get=function(ae){var Se=this._find(ae,!1);return Se>=0?this._values[Se]:void 0},oe.prototype.set=function(ae,Se){var Pe=this._find(ae,!0);return this._values[Pe]=Se,this},oe.prototype.delete=function(ae){var Se=this._find(ae,!1);if(Se>=0){for(var Pe=this._keys.length,Ne=Se+1;Ne<Pe;Ne++)this._keys[Ne-1]=this._keys[Ne],this._values[Ne-1]=this._values[Ne];return this._keys.length--,this._values.length--,ae===this._cacheKey&&(this._cacheKey=G,this._cacheIndex=-2),!0}return!1},oe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=G,this._cacheIndex=-2},oe.prototype.keys=function(){return new ue(this._keys,this._values,_e)},oe.prototype.values=function(){return new ue(this._keys,this._values,xe)},oe.prototype.entries=function(){return new ue(this._keys,this._values,ee)},oe.prototype["@@iterator"]=function(){return this.entries()},oe.prototype[o]=function(){return this.entries()},oe.prototype._find=function(ae,Se){return this._cacheKey!==ae&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=ae)),this._cacheIndex<0&&Se&&(this._cacheIndex=this._keys.length,this._keys.push(ae),this._values.push(void 0)),this._cacheIndex},oe}();function _e(oe,ae){return oe}function xe(oe,ae){return ae}function ee(oe,ae){return[oe,ae]}}function Fe(){return function(){function G(){this._map=new f}return Object.defineProperty(G.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),G.prototype.has=function(X){return this._map.has(X)},G.prototype.add=function(X){return this._map.set(X,X),this},G.prototype.delete=function(X){return this._map.delete(X)},G.prototype.clear=function(){this._map.clear()},G.prototype.keys=function(){return this._map.keys()},G.prototype.values=function(){return this._map.values()},G.prototype.entries=function(){return this._map.entries()},G.prototype["@@iterator"]=function(){return this.keys()},G.prototype[o]=function(){return this.keys()},G}()}function Q(){var G=16,X=u.create(),ue=_e();return function(){function Se(){this._key=_e()}return Se.prototype.has=function(Pe){var Ne=xe(Pe,!1);return Ne!==void 0?u.has(Ne,this._key):!1},Se.prototype.get=function(Pe){var Ne=xe(Pe,!1);return Ne!==void 0?u.get(Ne,this._key):void 0},Se.prototype.set=function(Pe,Ne){var vt=xe(Pe,!0);return vt[this._key]=Ne,this},Se.prototype.delete=function(Pe){var Ne=xe(Pe,!1);return Ne!==void 0?delete Ne[this._key]:!1},Se.prototype.clear=function(){this._key=_e()},Se}();function _e(){var Se;do Se="@@WeakMap@@"+ae();while(u.has(X,Se));return X[Se]=!0,Se}function xe(Se,Pe){if(!t.call(Se,ue)){if(!Pe)return;Object.defineProperty(Se,ue,{value:u.create()})}return Se[ue]}function ee(Se,Pe){for(var Ne=0;Ne<Pe;++Ne)Se[Ne]=Math.random()*255|0;return Se}function oe(Se){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(Se)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(Se)):ee(new Uint8Array(Se),Se):ee(new Array(Se),Se)}function ae(){var Se=oe(G);Se[6]=Se[6]&79|64,Se[8]=Se[8]&191|128;for(var Pe="",Ne=0;Ne<G;++Ne){var vt=Se[Ne];(Ne===4||Ne===6||Ne===8)&&(Pe+="-"),vt<16&&(Pe+="0"),Pe+=vt.toString(16).toLowerCase()}return Pe}}function we(G){return G.__=void 0,delete G.__,G}})})(z9||(z9={}))});var X9={};Kv(X9,{isPreRelesVersionOfJupyterExtension:()=>Bre});var Bre,Z9=he(()=>{"use strict";p();Bre=!1});var Mn=re(er=>{"use strict";p();Object.defineProperty(er,"__esModule",{value:!0});er.NON_CUSTOM_TAG_KEYS=er.PRE_DESTROY=er.POST_CONSTRUCT=er.DESIGN_PARAM_TYPES=er.PARAM_TYPES=er.TAGGED_PROP=er.TAGGED=er.MULTI_INJECT_TAG=er.INJECT_TAG=er.OPTIONAL_TAG=er.UNMANAGED_TAG=er.NAME_TAG=er.NAMED_TAG=void 0;er.NAMED_TAG="named";er.NAME_TAG="name";er.UNMANAGED_TAG="unmanaged";er.OPTIONAL_TAG="optional";er.INJECT_TAG="inject";er.MULTI_INJECT_TAG="multi_inject";er.TAGGED="inversify:tagged";er.TAGGED_PROP="inversify:tagged_props";er.PARAM_TYPES="inversify:paramtypes";er.DESIGN_PARAM_TYPES="design:paramtypes";er.POST_CONSTRUCT="post_construct";er.PRE_DESTROY="pre_destroy";function hne(){return[er.INJECT_TAG,er.MULTI_INJECT_TAG,er.NAME_TAG,er.UNMANAGED_TAG,er.NAMED_TAG,er.OPTIONAL_TAG]}er.NON_CUSTOM_TAG_KEYS=hne()});var Ua=re(wp=>{"use strict";p();Object.defineProperty(wp,"__esModule",{value:!0});wp.TargetTypeEnum=wp.BindingTypeEnum=wp.BindingScopeEnum=void 0;var gne={Request:"Request",Singleton:"Singleton",Transient:"Transient"};wp.BindingScopeEnum=gne;var vne={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};wp.BindingTypeEnum=vne;var yne={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};wp.TargetTypeEnum=yne});var xp=re(ND=>{"use strict";p();Object.defineProperty(ND,"__esModule",{value:!0});ND.id=void 0;var bne=0;function Sne(){return bne++}ND.id=Sne});var GB=re(RD=>{"use strict";p();Object.defineProperty(RD,"__esModule",{value:!0});RD.Binding=void 0;var JB=Ua(),Ine=xp(),_ne=function(){function r(e,t){this.id=(0,Ine.id)(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=JB.BindingTypeEnum.Invalid,this.constraint=function(n){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return r.prototype.clone=function(){var e=new r(this.serviceIdentifier,this.scope);return e.activated=e.scope===JB.BindingScopeEnum.Singleton?this.activated:!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e},r}();RD.Binding=_ne});var Wi=re(je=>{"use strict";p();Object.defineProperty(je,"__esModule",{value:!0});je.STACK_OVERFLOW=je.CIRCULAR_DEPENDENCY_IN_FACTORY=je.ON_DEACTIVATION_ERROR=je.PRE_DESTROY_ERROR=je.POST_CONSTRUCT_ERROR=je.ASYNC_UNBIND_REQUIRED=je.MULTIPLE_POST_CONSTRUCT_METHODS=je.MULTIPLE_PRE_DESTROY_METHODS=je.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=je.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=je.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=je.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=je.ARGUMENTS_LENGTH_MISMATCH=je.INVALID_DECORATOR_OPERATION=je.INVALID_TO_SELF_VALUE=je.LAZY_IN_SYNC=je.INVALID_FUNCTION_BINDING=je.INVALID_MIDDLEWARE_RETURN=je.NO_MORE_SNAPSHOTS_AVAILABLE=je.INVALID_BINDING_TYPE=je.NOT_IMPLEMENTED=je.CIRCULAR_DEPENDENCY=je.UNDEFINED_INJECT_ANNOTATION=je.MISSING_INJECT_ANNOTATION=je.MISSING_INJECTABLE_ANNOTATION=je.NOT_REGISTERED=je.CANNOT_UNBIND=je.AMBIGUOUS_MATCH=je.KEY_NOT_FOUND=je.NULL_ARGUMENT=je.DUPLICATED_METADATA=je.DUPLICATED_INJECTABLE_DECORATOR=void 0;je.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.";je.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:";je.NULL_ARGUMENT="NULL argument";je.KEY_NOT_FOUND="Key Not Found";je.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:";je.CANNOT_UNBIND="Could not unbind serviceIdentifier:";je.NOT_REGISTERED="No matching bindings found for serviceIdentifier:";je.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:";je.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var Ene=function(r){return"@inject called with undefined this could mean that the class "+r+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};je.UNDEFINED_INJECT_ANNOTATION=Ene;je.CIRCULAR_DEPENDENCY="Circular dependency found:";je.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.";je.INVALID_BINDING_TYPE="Invalid binding type:";je.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.";je.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!";je.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!";var Cne=function(r){return"You are attempting to construct '"+r+`' in a synchronous way
 but it has asynchronous dependencies.`};je.LAZY_IN_SYNC=Cne;je.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier";je.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var wne=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return"The number of constructor arguments in the derived class "+(r[0]+" must be >= than the number of constructor arguments of its base class.")};je.ARGUMENTS_LENGTH_MISMATCH=wne;je.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.";je.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').";je.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean";je.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean";je.MULTIPLE_PRE_DESTROY_METHODS="Cannot apply @preDestroy decorator multiple times in the same class";je.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";je.ASYNC_UNBIND_REQUIRED="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)";var xne=function(r,e){return"@postConstruct error in class "+r+": "+e};je.POST_CONSTRUCT_ERROR=xne;var Pne=function(r,e){return"@preDestroy error in class "+r+": "+e};je.PRE_DESTROY_ERROR=Pne;var Dne=function(r,e){return"onDeactivation() error in class "+r+": "+e};je.ON_DEACTIVATION_ERROR=Dne;var Tne=function(r,e){return"It looks like there is a circular dependency in one of the '"+r+"' bindings. Please investigate bindings with"+("service identifier '"+e+"'.")};je.CIRCULAR_DEPENDENCY_IN_FACTORY=Tne;je.STACK_OVERFLOW="Maximum call stack size exceeded"});var EL=re(sc=>{"use strict";p();var kne=sc&&sc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Nne=sc&&sc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Rne=sc&&sc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&kne(e,r,t);return Nne(e,r),e};Object.defineProperty(sc,"__esModule",{value:!0});sc.MetadataReader=void 0;var _L=Rne(Mn()),Ane=function(){function r(){}return r.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(_L.PARAM_TYPES,e),n=Reflect.getMetadata(_L.TAGGED,e);return{compilerGeneratedMetadata:t,userGeneratedMetadata:n||{}}},r.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(_L.TAGGED_PROP,e)||[];return t},r}();sc.MetadataReader=Ane});var YB=re(AD=>{"use strict";p();Object.defineProperty(AD,"__esModule",{value:!0});AD.BindingCount=void 0;var Mne={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};AD.BindingCount=Mne});var CL=re(Zs=>{"use strict";p();var One=Zs&&Zs.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Lne=Zs&&Zs.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Kne=Zs&&Zs.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&One(e,r,t);return Lne(e,r),e};Object.defineProperty(Zs,"__esModule",{value:!0});Zs.tryAndThrowErrorIfStackOverflow=Zs.isStackOverflowExeption=void 0;var Fne=Kne(Wi());function $B(r){return r instanceof RangeError||r.message===Fne.STACK_OVERFLOW}Zs.isStackOverflowExeption=$B;var Une=function(r,e){try{return r()}catch(t){throw $B(t)&&(t=e()),t}};Zs.tryAndThrowErrorIfStackOverflow=Une});var Zv=re(On=>{"use strict";p();var Wne=On&&On.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Vne=On&&On.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),jne=On&&On.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Wne(e,r,t);return Vne(e,r),e};Object.defineProperty(On,"__esModule",{value:!0});On.getSymbolDescription=On.circularDependencyToException=On.listMetadataForTarget=On.listRegisteredBindingsForServiceIdentifier=On.getServiceIdentifierAsString=On.getFunctionName=void 0;var Bne=jne(Wi());function zB(r){if(typeof r=="function"){var e=r;return e.name}else{if(typeof r=="symbol")return r.toString();var e=r;return e}}On.getServiceIdentifierAsString=zB;function Hne(r,e,t){var n="",i=t(r,e);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(function(o){var s="Object";o.implementationType!==null&&(s=ZB(o.implementationType)),n=n+`
 `+s,o.constraint.metaData&&(n=n+" - "+o.constraint.metaData)})),n}On.listRegisteredBindingsForServiceIdentifier=Hne;function QB(r,e){return r.parentRequest===null?!1:r.parentRequest.serviceIdentifier===e?!0:QB(r.parentRequest,e)}function qne(r){function e(n,i){i===void 0&&(i=[]);var o=zB(n.serviceIdentifier);return i.push(o),n.parentRequest!==null?e(n.parentRequest,i):i}var t=e(r);return t.reverse().join(" --> ")}function XB(r){r.childRequests.forEach(function(e){if(QB(e,e.serviceIdentifier)){var t=qne(e);throw new Error(Bne.CIRCULAR_DEPENDENCY+" "+t)}else XB(e)})}On.circularDependencyToException=XB;function Jne(r,e){if(e.isTagged()||e.isNamed()){var t="",n=e.getNamedTag(),i=e.getCustomTags();return n!==null&&(t+=n.toString()+`
`),i!==null&&i.forEach(function(o){t+=o.toString()+`
`})," "+r+`
 `+r+" - "+t}else return" "+r}On.listMetadataForTarget=Jne;function ZB(r){if(r.name)return r.name;var e=r.toString(),t=e.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: "+e}On.getFunctionName=ZB;function Gne(r){return r.toString().slice(7,-1)}On.getSymbolDescription=Gne});var eH=re(MD=>{"use strict";p();Object.defineProperty(MD,"__esModule",{value:!0});MD.Context=void 0;var Yne=xp(),$ne=function(){function r(e){this.id=(0,Yne.id)(),this.container=e}return r.prototype.addPlan=function(e){this.plan=e},r.prototype.setCurrentRequest=function(e){this.currentRequest=e},r}();MD.Context=$ne});var Wa=re(ac=>{"use strict";p();var zne=ac&&ac.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Qne=ac&&ac.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Xne=ac&&ac.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&zne(e,r,t);return Qne(e,r),e};Object.defineProperty(ac,"__esModule",{value:!0});ac.Metadata=void 0;var Zne=Xne(Mn()),eie=function(){function r(e,t){this.key=e,this.value=t}return r.prototype.toString=function(){return this.key===Zne.NAMED_TAG?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},r}();ac.Metadata=eie});var tH=re(OD=>{"use strict";p();Object.defineProperty(OD,"__esModule",{value:!0});OD.Plan=void 0;var tie=function(){function r(e,t){this.parentContext=e,this.rootRequest=t}return r}();OD.Plan=tie});var wL=re(LD=>{"use strict";p();Object.defineProperty(LD,"__esModule",{value:!0});LD.LazyServiceIdentifer=void 0;var rie=function(){function r(e){this._cb=e}return r.prototype.unwrap=function(){return this._cb()},r}();LD.LazyServiceIdentifer=rie});var rH=re(KD=>{"use strict";p();Object.defineProperty(KD,"__esModule",{value:!0});KD.QueryableString=void 0;var nie=function(){function r(e){this.str=e}return r.prototype.startsWith=function(e){return this.str.indexOf(e)===0},r.prototype.endsWith=function(e){var t="",n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},r.prototype.contains=function(e){return this.str.indexOf(e)!==-1},r.prototype.equals=function(e){return this.str===e},r.prototype.value=function(){return this.str},r}();KD.QueryableString=nie});var xL=re(lc=>{"use strict";p();var iie=lc&&lc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),oie=lc&&lc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),sie=lc&&lc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&iie(e,r,t);return oie(e,r),e};Object.defineProperty(lc,"__esModule",{value:!0});lc.Target=void 0;var Ou=sie(Mn()),aie=xp(),lie=Zv(),nH=Wa(),cie=rH(),uie=function(){function r(e,t,n,i){this.id=(0,aie.id)(),this.type=e,this.serviceIdentifier=n;var o=typeof t=="symbol"?(0,lie.getSymbolDescription)(t):t;this.name=new cie.QueryableString(o||""),this.identifier=t,this.metadata=new Array;var s=null;typeof i=="string"?s=new nH.Metadata(Ou.NAMED_TAG,i):i instanceof nH.Metadata&&(s=i),s!==null&&this.metadata.push(s)}return r.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){var i=n[t];if(i.key===e)return!0}return!1},r.prototype.isArray=function(){return this.hasTag(Ou.MULTI_INJECT_TAG)},r.prototype.matchesArray=function(e){return this.matchesTag(Ou.MULTI_INJECT_TAG)(e)},r.prototype.isNamed=function(){return this.hasTag(Ou.NAMED_TAG)},r.prototype.isTagged=function(){return this.metadata.some(function(e){return Ou.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})})},r.prototype.isOptional=function(){return this.matchesTag(Ou.OPTIONAL_TAG)(!0)},r.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===Ou.NAMED_TAG})[0]:null},r.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return Ou.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})}):null},r.prototype.matchesNamedTag=function(e){return this.matchesTag(Ou.NAMED_TAG)(e)},r.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,o=t.metadata;i<o.length;i++){var s=o[i];if(s.key===e&&s.value===n)return!0}return!1}},r}();lc.Target=uie});var dH=re(Vi=>{"use strict";p();var die=Vi&&Vi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),pie=Vi&&Vi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),iH=Vi&&Vi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&die(e,r,t);return pie(e,r),e},FD=Vi&&Vi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(Vi,"__esModule",{value:!0});Vi.getFunctionName=Vi.getBaseClassDependencyCount=Vi.getDependencies=void 0;var fie=wL(),PL=iH(Wi()),oH=Ua(),zE=iH(Mn()),DL=Zv();Object.defineProperty(Vi,"getFunctionName",{enumerable:!0,get:function(){return DL.getFunctionName}});var sH=xL();function mie(r,e){var t=(0,DL.getFunctionName)(e);return aH(r,t,e,!1)}Vi.getDependencies=mie;function aH(r,e,t,n){var i=r.getConstructorMetadata(t),o=i.compilerGeneratedMetadata;if(o===void 0){var s=PL.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(s)}var a=i.userGeneratedMetadata,l=Object.keys(a),u=t.length===0&&l.length>0,c=l.length>t.length,d=u||c?l.length:t.length,f=gie(n,e,o,a,d),m=lH(r,t,e),g=FD(FD([],f,!0),m,!0);return g}function hie(r,e,t,n,i){var o=i[r.toString()]||[],s=uH(o),a=s.unmanaged!==!0,l=n[r],u=s.inject||s.multiInject;if(l=u||l,l instanceof fie.LazyServiceIdentifer&&(l=l.unwrap()),a){var c=l===Object,d=l===Function,f=l===void 0,m=c||d||f;if(!e&&m){var g=PL.MISSING_INJECT_ANNOTATION+" argument "+r+" in class "+t+".";throw new Error(g)}var b=new sH.Target(oH.TargetTypeEnum.ConstructorArgument,s.targetName,l);return b.metadata=o,b}return null}function gie(r,e,t,n,i){for(var o=[],s=0;s<i;s++){var a=s,l=hie(a,r,e,t,n);l!==null&&o.push(l)}return o}function vie(r,e,t,n){var i=r||e;if(i===void 0){var o=PL.MISSING_INJECTABLE_ANNOTATION+" for property "+String(t)+" in class "+n+".";throw new Error(o)}return i}function lH(r,e,t){for(var n=r.getPropertiesMetadata(e),i=[],o=Object.getOwnPropertySymbols(n),s=Object.keys(n),a=s.concat(o),l=0,u=a;l<u.length;l++){var c=u[l],d=n[c],f=uH(d),m=f.targetName||c,g=vie(f.inject,f.multiInject,c,t),b=new sH.Target(oH.TargetTypeEnum.ClassProperty,m,g);b.metadata=d,i.push(b)}var y=Object.getPrototypeOf(e.prototype).constructor;if(y!==Object){var P=lH(r,y,t);i=FD(FD([],i,!0),P,!0)}return i}function cH(r,e){var t=Object.getPrototypeOf(e.prototype).constructor;if(t!==Object){var n=(0,DL.getFunctionName)(t),i=aH(r,n,t,!0),o=i.map(function(l){return l.metadata.filter(function(u){return u.key===zE.UNMANAGED_TAG})}),s=[].concat.apply([],o).length,a=i.length-s;return a>0?a:cH(r,t)}else return 0}Vi.getBaseClassDependencyCount=cH;function uH(r){var e={};return r.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[zE.INJECT_TAG],multiInject:e[zE.MULTI_INJECT_TAG],targetName:e[zE.NAME_TAG],unmanaged:e[zE.UNMANAGED_TAG]}}});var pH=re(UD=>{"use strict";p();Object.defineProperty(UD,"__esModule",{value:!0});UD.Request=void 0;var yie=xp(),bie=function(){function r(e,t,n,i,o){this.id=(0,yie.id)(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null}return r.prototype.addChildRequest=function(e,t,n){var i=new r(e,this.parentContext,this,t,n);return this.childRequests.push(i),i},r}();UD.Request=bie});var AL=re(Fo=>{"use strict";p();var Sie=Fo&&Fo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Iie=Fo&&Fo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),hH=Fo&&Fo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Sie(e,r,t);return Iie(e,r),e};Object.defineProperty(Fo,"__esModule",{value:!0});Fo.getBindingDictionary=Fo.createMockRequest=Fo.plan=void 0;var WD=YB(),kL=hH(Wi()),gH=Ua(),fH=hH(Mn()),_ie=CL(),ey=Zv(),vH=eH(),NL=Wa(),Eie=tH(),TL=dH(),RL=pH(),yH=xL();function bH(r){return r._bindingDictionary}Fo.getBindingDictionary=bH;function Cie(r,e,t,n,i,o){var s=r?fH.MULTI_INJECT_TAG:fH.INJECT_TAG,a=new NL.Metadata(s,t),l=new yH.Target(e,n,t,a);if(i!==void 0){var u=new NL.Metadata(i,o);l.metadata.push(u)}return l}function mH(r,e,t,n,i){var o=QE(t.container,i.serviceIdentifier),s=[];return o.length===WD.BindingCount.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&r.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(i.serviceIdentifier).toSelf(),o=QE(t.container,i.serviceIdentifier)),e?s=o:s=o.filter(function(a){var l=new RL.Request(a.serviceIdentifier,t,n,a,i);return a.constraint(l)}),wie(i.serviceIdentifier,s,i,t.container),s}function wie(r,e,t,n){switch(e.length){case WD.BindingCount.NoBindingsAvailable:if(t.isOptional())return e;var i=(0,ey.getServiceIdentifierAsString)(r),o=kL.NOT_REGISTERED;throw o+=(0,ey.listMetadataForTarget)(i,t),o+=(0,ey.listRegisteredBindingsForServiceIdentifier)(n,i,QE),new Error(o);case WD.BindingCount.OnlyOneBindingAvailable:return e;case WD.BindingCount.MultipleBindingsAvailable:default:if(t.isArray())return e;var i=(0,ey.getServiceIdentifierAsString)(r),o=kL.AMBIGUOUS_MATCH+" "+i;throw o+=(0,ey.listRegisteredBindingsForServiceIdentifier)(n,i,QE),new Error(o)}}function SH(r,e,t,n,i,o){var s,a;if(i===null){s=mH(r,e,n,null,o),a=new RL.Request(t,n,null,s,o);var l=new Eie.Plan(n,a);n.addPlan(l)}else s=mH(r,e,n,i,o),a=i.addChildRequest(o.serviceIdentifier,s,o);s.forEach(function(u){var c=null;if(o.isArray())c=a.addChildRequest(u.serviceIdentifier,u,o);else{if(u.cache)return;c=a}if(u.type===gH.BindingTypeEnum.Instance&&u.implementationType!==null){var d=(0,TL.getDependencies)(r,u.implementationType);if(!n.container.options.skipBaseClassChecks){var f=(0,TL.getBaseClassDependencyCount)(r,u.implementationType);if(d.length<f){var m=kL.ARGUMENTS_LENGTH_MISMATCH((0,TL.getFunctionName)(u.implementationType));throw new Error(m)}}d.forEach(function(g){SH(r,!1,g.serviceIdentifier,n,c,g)})}})}function QE(r,e){var t=[],n=bH(r);return n.hasKey(e)?t=n.get(e):r.parent!==null&&(t=QE(r.parent,e)),t}function xie(r,e,t,n,i,o,s,a){a===void 0&&(a=!1);var l=new vH.Context(e),u=Cie(t,n,i,"",o,s);try{return SH(r,a,i,l,null,u),l}catch(c){throw(0,_ie.isStackOverflowExeption)(c)&&(0,ey.circularDependencyToException)(l.plan.rootRequest),c}}Fo.plan=xie;function Pie(r,e,t,n){var i=new yH.Target(gH.TargetTypeEnum.Variable,"",e,new NL.Metadata(t,n)),o=new vH.Context(r),s=new RL.Request(e,o,null,[],i);return s}Fo.createMockRequest=Pie});var XE=re(ty=>{"use strict";p();Object.defineProperty(ty,"__esModule",{value:!0});ty.isPromiseOrContainsPromise=ty.isPromise=void 0;function ML(r){var e=typeof r=="object"&&r!==null||typeof r=="function";return e&&typeof r.then=="function"}ty.isPromise=ML;function Die(r){return ML(r)?!0:Array.isArray(r)&&r.some(ML)}ty.isPromiseOrContainsPromise=Die});var IH=re(cc=>{"use strict";p();var Tie=cc&&cc.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},kie=cc&&cc.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(cc,"__esModule",{value:!0});cc.saveToScope=cc.tryGetFromScope=void 0;var VD=ge(),Nie=XE(),Rie=function(r,e){return e.scope===VD.BindingScopeEnum.Singleton&&e.activated?e.cache:e.scope===VD.BindingScopeEnum.Request&&r.has(e.id)?r.get(e.id):null};cc.tryGetFromScope=Rie;var Aie=function(r,e,t){e.scope===VD.BindingScopeEnum.Singleton&&Oie(e,t),e.scope===VD.BindingScopeEnum.Request&&Mie(r,e,t)};cc.saveToScope=Aie;var Mie=function(r,e,t){r.has(e.id)||r.set(e.id,t)},Oie=function(r,e){r.cache=e,r.activated=!0,(0,Nie.isPromise)(e)&&Lie(r,e)},Lie=function(r,e){return Tie(void 0,void 0,void 0,function(){var t,n;return kie(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return t=i.sent(),r.cache=t,[3,3];case 2:throw n=i.sent(),r.cache=null,r.activated=!1,n;case 3:return[2]}})})}});var _H=re(ZE=>{"use strict";p();Object.defineProperty(ZE,"__esModule",{value:!0});ZE.FactoryType=void 0;var Kie;(function(r){r.DynamicValue="toDynamicValue",r.Factory="toFactory",r.Provider="toProvider"})(Kie=ZE.FactoryType||(ZE.FactoryType={}))});var LL=re(Uo=>{"use strict";p();var Fie=Uo&&Uo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Uie=Uo&&Uo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Wie=Uo&&Uo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Fie(e,r,t);return Uie(e,r),e};Object.defineProperty(Uo,"__esModule",{value:!0});Uo.getFactoryDetails=Uo.ensureFullyBound=Uo.multiBindToService=void 0;var Vie=ge(),jie=Wie(Wi()),uc=Ua(),OL=_H(),Bie=function(r){return function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach(function(i){return r.bind(i).toService(e)})}}};Uo.multiBindToService=Bie;var Hie=function(r){var e=null;switch(r.type){case uc.BindingTypeEnum.ConstantValue:case uc.BindingTypeEnum.Function:e=r.cache;break;case uc.BindingTypeEnum.Constructor:case uc.BindingTypeEnum.Instance:e=r.implementationType;break;case uc.BindingTypeEnum.DynamicValue:e=r.dynamicValue;break;case uc.BindingTypeEnum.Provider:e=r.provider;break;case uc.BindingTypeEnum.Factory:e=r.factory;break}if(e===null){var t=(0,Vie.getServiceIdentifierAsString)(r.serviceIdentifier);throw new Error(jie.INVALID_BINDING_TYPE+" "+t)}};Uo.ensureFullyBound=Hie;var qie=function(r){switch(r.type){case uc.BindingTypeEnum.Factory:return{factory:r.factory,factoryType:OL.FactoryType.Factory};case uc.BindingTypeEnum.Provider:return{factory:r.provider,factoryType:OL.FactoryType.Provider};case uc.BindingTypeEnum.DynamicValue:return{factory:r.dynamicValue,factoryType:OL.FactoryType.DynamicValue};default:throw new Error("Unexpected factory type "+r.type)}};Uo.getFactoryDetails=qie});var DH=re(hi=>{"use strict";p();var ry=hi&&hi.__assign||function(){return ry=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},ry.apply(this,arguments)},Jie=hi&&hi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Gie=hi&&hi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Yie=hi&&hi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Jie(e,r,t);return Gie(e,r),e},wH=hi&&hi.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},xH=hi&&hi.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},$ie=hi&&hi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(hi,"__esModule",{value:!0});hi.resolveInstance=void 0;var KL=Wi(),UL=Ua(),FL=Yie(Mn()),WL=XE();function zie(r,e){return r.reduce(function(t,n){var i=e(n),o=n.target.type;return o===UL.TargetTypeEnum.ConstructorArgument?t.constructorInjections.push(i):(t.propertyRequests.push(n),t.propertyInjections.push(i)),t.isAsync||(t.isAsync=(0,WL.isPromiseOrContainsPromise)(i)),t},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}function Qie(r,e,t){var n;if(e.length>0){var i=zie(e,t),o=ry(ry({},i),{constr:r});i.isAsync?n=Xie(o):n=PH(o)}else n=new r;return n}function PH(r){var e,t=new((e=r.constr).bind.apply(e,$ie([void 0],r.constructorInjections,!1)));return r.propertyRequests.forEach(function(n,i){var o=n.target.identifier,s=r.propertyInjections[i];t[o]=s}),t}function Xie(r){return wH(this,void 0,void 0,function(){var e,t;return xH(this,function(n){switch(n.label){case 0:return[4,EH(r.constructorInjections)];case 1:return e=n.sent(),[4,EH(r.propertyInjections)];case 2:return t=n.sent(),[2,PH(ry(ry({},r),{constructorInjections:e,propertyInjections:t}))]}})})}function EH(r){return wH(this,void 0,void 0,function(){var e,t,n,i;return xH(this,function(o){for(e=[],t=0,n=r;t<n.length;t++)i=n[t],Array.isArray(i)?e.push(Promise.all(i)):e.push(i);return[2,Promise.all(e)]})})}function CH(r,e){var t=Zie(r,e);return(0,WL.isPromise)(t)?t.then(function(){return e}):e}function Zie(r,e){var t,n;if(Reflect.hasMetadata(FL.POST_CONSTRUCT,r)){var i=Reflect.getMetadata(FL.POST_CONSTRUCT,r);try{return(n=(t=e)[i.value])===null||n===void 0?void 0:n.call(t)}catch(o){throw new Error((0,KL.POST_CONSTRUCT_ERROR)(r.name,o.message))}}}function eoe(r,e){r.scope!==UL.BindingScopeEnum.Singleton&&toe(r,e)}function toe(r,e){var t="Class cannot be instantiated in "+(r.scope===UL.BindingScopeEnum.Request?"request":"transient")+" scope.";if(typeof r.onDeactivation=="function")throw new Error((0,KL.ON_DEACTIVATION_ERROR)(e.name,t));if(Reflect.hasMetadata(FL.PRE_DESTROY,e))throw new Error((0,KL.PRE_DESTROY_ERROR)(e.name,t))}function roe(r,e,t,n){eoe(r,e);var i=Qie(e,t,n);return(0,WL.isPromise)(i)?i.then(function(o){return CH(e,o)}):CH(e,i)}hi.resolveInstance=roe});var AH=re(Wo=>{"use strict";p();var noe=Wo&&Wo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ioe=Wo&&Wo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),ooe=Wo&&Wo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&noe(e,r,t);return ioe(e,r),e},soe=Wo&&Wo.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},aoe=Wo&&Wo.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(Wo,"__esModule",{value:!0});Wo.resolve=void 0;var loe=ooe(Wi()),jD=Ua(),coe=AL(),TH=IH(),VL=XE(),NH=LL(),uoe=CL(),doe=DH(),jL=function(r){return function(e){e.parentContext.setCurrentRequest(e);var t=e.bindings,n=e.childRequests,i=e.target&&e.target.isArray(),o=!e.parentRequest||!e.parentRequest.target||!e.target||!e.parentRequest.target.matchesArray(e.target.serviceIdentifier);if(i&&o)return n.map(function(a){var l=jL(r);return l(a)});if(e.target.isOptional()&&t.length===0)return;var s=t[0];return hoe(r,e,s)}},poe=function(r,e){var t=(0,NH.getFactoryDetails)(r);return(0,uoe.tryAndThrowErrorIfStackOverflow)(function(){return t.factory.bind(r)(e)},function(){return new Error(loe.CIRCULAR_DEPENDENCY_IN_FACTORY(t.factoryType,e.currentRequest.serviceIdentifier.toString()))})},foe=function(r,e,t){var n,i=e.childRequests;switch((0,NH.ensureFullyBound)(t),t.type){case jD.BindingTypeEnum.ConstantValue:case jD.BindingTypeEnum.Function:n=t.cache;break;case jD.BindingTypeEnum.Constructor:n=t.implementationType;break;case jD.BindingTypeEnum.Instance:n=(0,doe.resolveInstance)(t,t.implementationType,i,jL(r));break;default:n=poe(t,e.parentContext)}return n},moe=function(r,e,t){var n=(0,TH.tryGetFromScope)(r,e);return n!==null||(n=t(),(0,TH.saveToScope)(r,e,n)),n},hoe=function(r,e,t){return moe(r,t,function(){var n=foe(r,e,t);return(0,VL.isPromise)(n)?n=n.then(function(i){return kH(e,t,i)}):n=kH(e,t,n),n})};function kH(r,e,t){var n=goe(r.parentContext,e,t),i=boe(r.parentContext.container),o,s=i.next();do{o=s.value;var a=r.parentContext,l=r.serviceIdentifier,u=yoe(o,l);(0,VL.isPromise)(n)?n=RH(u,a,n):n=voe(u,a,n),s=i.next()}while(s.done!==!0&&!(0,coe.getBindingDictionary)(o).hasKey(r.serviceIdentifier));return n}var goe=function(r,e,t){var n;return typeof e.onActivation=="function"?n=e.onActivation(r,t):n=t,n},voe=function(r,e,t){for(var n=r.next();!n.done;){if(t=n.value(e,t),(0,VL.isPromise)(t))return RH(r,e,t);n=r.next()}return t},RH=function(r,e,t){return soe(void 0,void 0,void 0,function(){var n,i;return aoe(this,function(o){switch(o.label){case 0:return[4,t];case 1:n=o.sent(),i=r.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(e,n)];case 3:return n=o.sent(),i=r.next(),[3,2];case 4:return[2,n]}})})},yoe=function(r,e){var t=r._activations;return t.hasKey(e)?t.get(e).values():[].values()},boe=function(r){for(var e=[r],t=r.parent;t!==null;)e.push(t),t=t.parent;var n=function(){var o=e.pop();return o!==void 0?{done:!1,value:o}:{done:!0,value:void 0}},i={next:n};return i};function Soe(r){var e=jL(r.plan.rootRequest.requestScope);return e(r.plan.rootRequest)}Wo.resolve=Soe});var BL=re(ji=>{"use strict";p();var Ioe=ji&&ji.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),_oe=ji&&ji.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Eoe=ji&&ji.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ioe(e,r,t);return _oe(e,r),e};Object.defineProperty(ji,"__esModule",{value:!0});ji.typeConstraint=ji.namedConstraint=ji.taggedConstraint=ji.traverseAncerstors=void 0;var Coe=Eoe(Mn()),woe=Wa(),MH=function(r,e){var t=r.parentRequest;return t!==null?e(t)?!0:MH(t,e):!1};ji.traverseAncerstors=MH;var OH=function(r){return function(e){var t=function(n){return n!==null&&n.target!==null&&n.target.matchesTag(r)(e)};return t.metaData=new woe.Metadata(r,e),t}};ji.taggedConstraint=OH;var xoe=OH(Coe.NAMED_TAG);ji.namedConstraint=xoe;var Poe=function(r){return function(e){var t=null;if(e!==null)if(t=e.bindings[0],typeof r=="string"){var n=t.serviceIdentifier;return n===r}else{var i=e.bindings[0].implementationType;return r===i}return!1}};ji.typeConstraint=Poe});var HD=re(BD=>{"use strict";p();Object.defineProperty(BD,"__esModule",{value:!0});BD.BindingWhenSyntax=void 0;var mo=qD(),$n=BL(),Doe=function(){function r(e){this._binding=e}return r.prototype.when=function(e){return this._binding.constraint=e,new mo.BindingOnSyntax(this._binding)},r.prototype.whenTargetNamed=function(e){return this._binding.constraint=(0,$n.namedConstraint)(e),new mo.BindingOnSyntax(this._binding)},r.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){if(e===null)return!1;var t=e.target!==null&&!e.target.isNamed()&&!e.target.isTagged();return t},new mo.BindingOnSyntax(this._binding)},r.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=(0,$n.taggedConstraint)(e)(t),new mo.BindingOnSyntax(this._binding)},r.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return t!==null&&(0,$n.typeConstraint)(e)(t.parentRequest)},new mo.BindingOnSyntax(this._binding)},r.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,$n.namedConstraint)(e)(t.parentRequest)},new mo.BindingOnSyntax(this._binding)},r.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,$n.taggedConstraint)(e)(t)(n.parentRequest)},new mo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&(0,$n.traverseAncerstors)(t,(0,$n.typeConstraint)(e))},new mo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,$n.traverseAncerstors)(t,(0,$n.typeConstraint)(e))},new mo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,$n.traverseAncerstors)(t,(0,$n.namedConstraint)(e))},new mo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,$n.traverseAncerstors)(t,(0,$n.namedConstraint)(e))},new mo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,$n.traverseAncerstors)(n,(0,$n.taggedConstraint)(e)(t))},new mo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&!(0,$n.traverseAncerstors)(n,(0,$n.taggedConstraint)(e)(t))},new mo.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&(0,$n.traverseAncerstors)(t,e)},new mo.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,$n.traverseAncerstors)(t,e)},new mo.BindingOnSyntax(this._binding)},r}();BD.BindingWhenSyntax=Doe});var qD=re(JD=>{"use strict";p();Object.defineProperty(JD,"__esModule",{value:!0});JD.BindingOnSyntax=void 0;var LH=HD(),Toe=function(){function r(e){this._binding=e}return r.prototype.onActivation=function(e){return this._binding.onActivation=e,new LH.BindingWhenSyntax(this._binding)},r.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new LH.BindingWhenSyntax(this._binding)},r}();JD.BindingOnSyntax=Toe});var HL=re(GD=>{"use strict";p();Object.defineProperty(GD,"__esModule",{value:!0});GD.BindingWhenOnSyntax=void 0;var koe=qD(),Noe=HD(),Roe=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Noe.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new koe.BindingOnSyntax(this._binding)}return r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();GD.BindingWhenOnSyntax=Roe});var KH=re(YD=>{"use strict";p();Object.defineProperty(YD,"__esModule",{value:!0});YD.BindingInSyntax=void 0;var qL=Ua(),JL=HL(),Aoe=function(){function r(e){this._binding=e}return r.prototype.inRequestScope=function(){return this._binding.scope=qL.BindingScopeEnum.Request,new JL.BindingWhenOnSyntax(this._binding)},r.prototype.inSingletonScope=function(){return this._binding.scope=qL.BindingScopeEnum.Singleton,new JL.BindingWhenOnSyntax(this._binding)},r.prototype.inTransientScope=function(){return this._binding.scope=qL.BindingScopeEnum.Transient,new JL.BindingWhenOnSyntax(this._binding)},r}();YD.BindingInSyntax=Aoe});var FH=re($D=>{"use strict";p();Object.defineProperty($D,"__esModule",{value:!0});$D.BindingInWhenOnSyntax=void 0;var Moe=KH(),Ooe=qD(),Loe=HD(),Koe=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Loe.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Ooe.BindingOnSyntax(this._binding),this._bindingInSyntax=new Moe.BindingInSyntax(e)}return r.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},r.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},r.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();$D.BindingInWhenOnSyntax=Koe});var VH=re(dc=>{"use strict";p();var Foe=dc&&dc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Uoe=dc&&dc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Woe=dc&&dc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Foe(e,r,t);return Uoe(e,r),e};Object.defineProperty(dc,"__esModule",{value:!0});dc.BindingToSyntax=void 0;var UH=Woe(Wi()),ho=Ua(),WH=FH(),ny=HL(),Voe=function(){function r(e){this._binding=e}return r.prototype.to=function(e){return this._binding.type=ho.BindingTypeEnum.Instance,this._binding.implementationType=e,new WH.BindingInWhenOnSyntax(this._binding)},r.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+UH.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},r.prototype.toConstantValue=function(e){return this._binding.type=ho.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=ho.BindingScopeEnum.Singleton,new ny.BindingWhenOnSyntax(this._binding)},r.prototype.toDynamicValue=function(e){return this._binding.type=ho.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new WH.BindingInWhenOnSyntax(this._binding)},r.prototype.toConstructor=function(e){return this._binding.type=ho.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=ho.BindingScopeEnum.Singleton,new ny.BindingWhenOnSyntax(this._binding)},r.prototype.toFactory=function(e){return this._binding.type=ho.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=ho.BindingScopeEnum.Singleton,new ny.BindingWhenOnSyntax(this._binding)},r.prototype.toFunction=function(e){if(typeof e!="function")throw new Error(UH.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=ho.BindingTypeEnum.Function,this._binding.scope=ho.BindingScopeEnum.Singleton,t},r.prototype.toAutoFactory=function(e){return this._binding.type=ho.BindingTypeEnum.Factory,this._binding.factory=function(t){var n=function(){return t.container.get(e)};return n},this._binding.scope=ho.BindingScopeEnum.Singleton,new ny.BindingWhenOnSyntax(this._binding)},r.prototype.toAutoNamedFactory=function(e){return this._binding.type=ho.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new ny.BindingWhenOnSyntax(this._binding)},r.prototype.toProvider=function(e){return this._binding.type=ho.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=ho.BindingScopeEnum.Singleton,new ny.BindingWhenOnSyntax(this._binding)},r.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},r}();dc.BindingToSyntax=Voe});var jH=re(zD=>{"use strict";p();Object.defineProperty(zD,"__esModule",{value:!0});zD.ContainerSnapshot=void 0;var joe=function(){function r(){}return r.of=function(e,t,n,i,o){var s=new r;return s.bindings=e,s.middleware=t,s.deactivations=i,s.activations=n,s.moduleActivationStore=o,s},r}();zD.ContainerSnapshot=joe});var BH=re(QD=>{"use strict";p();Object.defineProperty(QD,"__esModule",{value:!0});QD.isClonable=void 0;function Boe(r){return typeof r=="object"&&r!==null&&"clone"in r&&typeof r.clone=="function"}QD.isClonable=Boe});var GL=re(pc=>{"use strict";p();var Hoe=pc&&pc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),qoe=pc&&pc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Joe=pc&&pc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Hoe(e,r,t);return qoe(e,r),e};Object.defineProperty(pc,"__esModule",{value:!0});pc.Lookup=void 0;var Km=Joe(Wi()),Goe=BH(),Yoe=function(){function r(){this._map=new Map}return r.prototype.getMap=function(){return this._map},r.prototype.add=function(e,t){if(e==null)throw new Error(Km.NULL_ARGUMENT);if(t==null)throw new Error(Km.NULL_ARGUMENT);var n=this._map.get(e);n!==void 0?n.push(t):this._map.set(e,[t])},r.prototype.get=function(e){if(e==null)throw new Error(Km.NULL_ARGUMENT);var t=this._map.get(e);if(t!==void 0)return t;throw new Error(Km.KEY_NOT_FOUND)},r.prototype.remove=function(e){if(e==null)throw new Error(Km.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(Km.KEY_NOT_FOUND)},r.prototype.removeIntersection=function(e){var t=this;this.traverse(function(n,i){var o=e.hasKey(n)?e.get(n):void 0;if(o!==void 0){var s=i.filter(function(a){return!o.some(function(l){return a===l})});t._setValue(n,s)}})},r.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach(function(i,o){for(var s=[],a=0,l=i;a<l.length;a++){var u=l[a],c=e(u);c?n.push(u):s.push(u)}t._setValue(o,s)}),n},r.prototype.hasKey=function(e){if(e==null)throw new Error(Km.NULL_ARGUMENT);return this._map.has(e)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){t.forEach(function(i){return e.add(n,(0,Goe.isClonable)(i)?i.clone():i)})}),e},r.prototype.traverse=function(e){this._map.forEach(function(t,n){e(n,t)})},r.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},r}();pc.Lookup=Yoe});var qH=re(XD=>{"use strict";p();Object.defineProperty(XD,"__esModule",{value:!0});XD.ModuleActivationStore=void 0;var HH=GL(),$oe=function(){function r(){this._map=new Map}return r.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},r.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},r.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){e._map.set(n,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})}),e},r.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},r.prototype._getEmptyHandlersStore=function(){var e={onActivations:new HH.Lookup,onDeactivations:new HH.Lookup};return e},r}();XD.ModuleActivationStore=$oe});var YL=re(gi=>{"use strict";p();var eT=gi&&gi.__assign||function(){return eT=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},eT.apply(this,arguments)},zoe=gi&&gi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Qoe=gi&&gi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),JH=gi&&gi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&zoe(e,r,t);return Qoe(e,r),e},ea=gi&&gi.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(d){s(d)}}function l(c){try{u(n.throw(c))}catch(d){s(d)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((n=n.apply(r,e||[])).next())})},ta=gi&&gi.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(c){u=[6,c],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Xoe=gi&&gi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(gi,"__esModule",{value:!0});gi.Container=void 0;var Zoe=GB(),Va=JH(Wi()),iy=Ua(),Fm=JH(Mn()),ese=EL(),ZD=AL(),tse=AH(),rse=VH(),Um=XE(),nse=xp(),ise=Zv(),ose=jH(),eC=GL(),sse=qH(),ase=function(){function r(e){var t=e||{};if(typeof t!="object")throw new Error(""+Va.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(t.defaultScope===void 0)t.defaultScope=iy.BindingScopeEnum.Transient;else if(t.defaultScope!==iy.BindingScopeEnum.Singleton&&t.defaultScope!==iy.BindingScopeEnum.Transient&&t.defaultScope!==iy.BindingScopeEnum.Request)throw new Error(""+Va.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error(""+Va.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error(""+Va.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=(0,nse.id)(),this._bindingDictionary=new eC.Lookup,this._snapshots=[],this._middleware=null,this._activations=new eC.Lookup,this._deactivations=new eC.Lookup,this.parent=null,this._metadataReader=new ese.MetadataReader,this._moduleActivationStore=new sse.ModuleActivationStore}return r.merge=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new r,s=Xoe([e,t],n,!0).map(function(u){return(0,ZD.getBindingDictionary)(u)}),a=(0,ZD.getBindingDictionary)(o);function l(u,c){u.traverse(function(d,f){f.forEach(function(m){c.add(m.serviceIdentifier,m.clone())})})}return s.forEach(function(u){l(u,a)}),o},r.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,o=e;i<o.length;i++){var s=o[i],a=n(s.id);s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},r.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ea(this,void 0,void 0,function(){var n,i,o,s,a;return ta(this,function(l){switch(l.label){case 0:n=this._getContainerModuleHelpersFactory(),i=0,o=e,l.label=1;case 1:return i<o.length?(s=o[i],a=n(s.id),[4,s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)]):[3,4];case 2:l.sent(),l.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},r.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach(function(i){var o=e._removeModuleBindings(i.id);e._deactivateSingletons(o),e._removeModuleHandlers(i.id)})},r.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ea(this,void 0,void 0,function(){var n,i,o,s;return ta(this,function(a){switch(a.label){case 0:n=0,i=e,a.label=1;case 1:return n<i.length?(o=i[n],s=this._removeModuleBindings(o.id),[4,this._deactivateSingletonsAsync(s)]):[3,4];case 2:a.sent(),this._removeModuleHandlers(o.id),a.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.bind=function(e){var t=this.options.defaultScope||iy.BindingScopeEnum.Transient,n=new Zoe.Binding(e,t);return this._bindingDictionary.add(e,n),new rse.BindingToSyntax(n)},r.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},r.prototype.rebindAsync=function(e){return ea(this,void 0,void 0,function(){return ta(this,function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}})})},r.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},r.prototype.unbindAsync=function(e){return ea(this,void 0,void 0,function(){var t;return ta(this,function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}})})},r.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse(function(t,n){e._deactivateSingletons(n)}),this._bindingDictionary=new eC.Lookup},r.prototype.unbindAllAsync=function(){return ea(this,void 0,void 0,function(){var e,t=this;return ta(this,function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse(function(i,o){e.push(t._deactivateSingletonsAsync(o))}),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new eC.Lookup,[2]}})})},r.prototype.onActivation=function(e,t){this._activations.add(e,t)},r.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},r.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},r.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},r.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,Fm.NAMED_TAG,t)},r.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),s=(0,ZD.createMockRequest)(this,e,t,n);i=o.some(function(a){return a.constraint(s)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},r.prototype.snapshot=function(){this._snapshots.push(ose.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},r.prototype.restore=function(){var e=this._snapshots.pop();if(e===void 0)throw new Error(Va.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},r.prototype.createChild=function(e){var t=new r(e||this.options);return t.parent=this,t},r.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(i,o){return o(i)},n)},r.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},r.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},r.prototype.getAsync=function(e){return ea(this,void 0,void 0,function(){var t;return ta(this,function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]})})},r.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},r.prototype.getTaggedAsync=function(e,t,n){return ea(this,void 0,void 0,function(){var i;return ta(this,function(o){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]})})},r.prototype.getNamed=function(e,t){return this.getTagged(e,Fm.NAMED_TAG,t)},r.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,Fm.NAMED_TAG,t)},r.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},r.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},r.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},r.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},r.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,Fm.NAMED_TAG,t)},r.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,Fm.NAMED_TAG,t)},r.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},r.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(Fm.PRE_DESTROY,e)){var n=Reflect.getMetadata(Fm.PRE_DESTROY,e);return t[n.value]()}},r.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},r.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition(function(t){return t.moduleId===e})},r.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var o=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if((0,Um.isPromise)(o))return this._handleDeactivationError(o.then(function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)}),i)}var s=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if((0,Um.isPromise)(s))return this._handleDeactivationError(s,i)}catch(a){throw new Error(Va.ON_DEACTIVATION_ERROR(i.name,a.message))}},r.prototype._handleDeactivationError=function(e,t){return ea(this,void 0,void 0,function(){var n;return ta(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:throw n=i.sent(),new Error(Va.ON_DEACTIVATION_ERROR(t.name,n.message));case 3:return[2]}})})},r.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var o=i.value(e);if((0,Um.isPromise)(o))return o.then(function(){return n._deactivateContainerAsync(e,t)});i=t.next()}},r.prototype._deactivateContainerAsync=function(e,t){return ea(this,void 0,void 0,function(){var n;return ta(this,function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return[2]}})})},r.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(c,d){c._binding.moduleId=d},n=function(c){return function(d){var f=e.bind(d);return t(f,c),f}},i=function(){return function(c){return e.unbind(c)}},o=function(){return function(c){return e.unbindAsync(c)}},s=function(){return function(c){return e.isBound(c)}},a=function(c){return function(d){var f=e.rebind(d);return t(f,c),f}},l=function(c){return function(d,f){e._moduleActivationStore.addActivation(c,d,f),e.onActivation(d,f)}},u=function(c){return function(d,f){e._moduleActivationStore.addDeactivation(c,d,f),e.onDeactivation(d,f)}};return function(c){return{bindFunction:n(c),isboundFunction:s(),onActivationFunction:l(c),onDeactivationFunction:u(c),rebindFunction:a(c),unbindFunction:i(),unbindAsyncFunction:o()}}},r.prototype._getAll=function(e){return Promise.all(this._get(e))},r.prototype._get=function(e){var t=eT(eT({},e),{contextInterceptor:function(i){return i},targetType:iy.TargetTypeEnum.Variable});if(this._middleware){var n=this._middleware(t);if(n==null)throw new Error(Va.INVALID_MIDDLEWARE_RETURN);return n}return this._planAndResolve()(t)},r.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if((0,Um.isPromiseOrContainsPromise)(t))throw new Error(Va.LAZY_IN_SYNC(e.serviceIdentifier));return t},r.prototype._getAllArgs=function(e){var t={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e};return t},r.prototype._getNotAllArgs=function(e,t,n,i){var o={avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i};return o},r.prototype._planAndResolve=function(){var e=this;return function(t){var n=(0,ZD.plan)(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);n=t.contextInterceptor(n);var i=(0,tse.resolve)(n);return i}},r.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return(0,Um.isPromise)(e.cache)?e.cache.then(function(n){return t._deactivate(e,n)}):this._deactivate(e,e.cache)},r.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t],o=this._deactivateIfSingleton(i);if((0,Um.isPromise)(o))throw new Error(Va.ASYNC_UNBIND_REQUIRED)}},r.prototype._deactivateSingletonsAsync=function(e){return ea(this,void 0,void 0,function(){var t=this;return ta(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(i){return t._deactivateIfSingleton(i)}))];case 1:return n.sent(),[2]}})})},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return ea(this,void 0,void 0,function(){return ta(this,function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return[2]}})})},r.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(Va.CANNOT_UNBIND+" "+(0,ise.getServiceIdentifierAsString)(e))}},r.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if(typeof e.onDeactivation=="function"){var o=e.onDeactivation(t);if((0,Um.isPromise)(o))return o.then(function(){return i._preDestroy(n,t)})}return this._preDestroy(n,t)},r.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return ea(this,void 0,void 0,function(){return ta(this,function(i){switch(i.label){case 0:return typeof e.onDeactivation!="function"?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}})})},r}();gi.Container=ase});var YH=re(oy=>{"use strict";p();Object.defineProperty(oy,"__esModule",{value:!0});oy.AsyncContainerModule=oy.ContainerModule=void 0;var GH=xp(),lse=function(){function r(e){this.id=(0,GH.id)(),this.registry=e}return r}();oy.ContainerModule=lse;var cse=function(){function r(e){this.id=(0,GH.id)(),this.registry=e}return r}();oy.AsyncContainerModule=cse});var $H=re(tT=>{"use strict";p();Object.defineProperty(tT,"__esModule",{value:!0});tT.getFirstArrayDuplicate=void 0;function use(r){for(var e=new Set,t=0,n=r;t<n.length;t++){var i=n[t];if(e.has(i))return i;e.add(i)}}tT.getFirstArrayDuplicate=use});var Lu=re(Bi=>{"use strict";p();var dse=Bi&&Bi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),pse=Bi&&Bi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),QH=Bi&&Bi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&dse(e,r,t);return pse(e,r),e};Object.defineProperty(Bi,"__esModule",{value:!0});Bi.createTaggedDecorator=Bi.tagProperty=Bi.tagParameter=Bi.decorate=void 0;var rT=QH(Wi()),XH=QH(Mn()),fse=$H();function mse(r){return r.prototype!==void 0}function hse(r){if(r!==void 0)throw new Error(rT.INVALID_DECORATOR_OPERATION)}function ZH(r,e,t,n){hse(e),t7(XH.TAGGED,r,t.toString(),n)}Bi.tagParameter=ZH;function e7(r,e,t){if(mse(r))throw new Error(rT.INVALID_DECORATOR_OPERATION);t7(XH.TAGGED_PROP,r.constructor,e,t)}Bi.tagProperty=e7;function gse(r){var e=[];if(Array.isArray(r)){e=r;var t=(0,fse.getFirstArrayDuplicate)(e.map(function(n){return n.key}));if(t!==void 0)throw new Error(rT.DUPLICATED_METADATA+" "+t.toString())}else e=[r];return e}function t7(r,e,t,n){var i=gse(n),o={};Reflect.hasOwnMetadata(r,e)&&(o=Reflect.getMetadata(r,e));var s=o[t];if(s===void 0)s=[];else for(var a=function(d){if(i.some(function(f){return f.key===d.key}))throw new Error(rT.DUPLICATED_METADATA+" "+d.key.toString())},l=0,u=s;l<u.length;l++){var c=u[l];a(c)}s.push.apply(s,i),o[t]=s,Reflect.defineMetadata(r,o,e)}function vse(r){return function(e,t,n){typeof n=="number"?ZH(e,t,n,r):e7(e,t,r)}}Bi.createTaggedDecorator=vse;function zH(r,e){Reflect.decorate(r,e)}function yse(r,e){return function(t,n){e(t,n,r)}}function bse(r,e,t){typeof t=="number"?zH([yse(t,r)],e):typeof t=="string"?Reflect.decorate([r],e,t):zH([r],e)}Bi.decorate=bse});var n7=re(fc=>{"use strict";p();var Sse=fc&&fc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ise=fc&&fc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),r7=fc&&fc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Sse(e,r,t);return Ise(e,r),e};Object.defineProperty(fc,"__esModule",{value:!0});fc.injectable=void 0;var _se=r7(Wi()),$L=r7(Mn());function Ese(){return function(r){if(Reflect.hasOwnMetadata($L.PARAM_TYPES,r))throw new Error(_se.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata($L.DESIGN_PARAM_TYPES,r)||[];return Reflect.defineMetadata($L.PARAM_TYPES,e,r),r}}fc.injectable=Ese});var i7=re(nT=>{"use strict";p();Object.defineProperty(nT,"__esModule",{value:!0});nT.tagged=void 0;var Cse=Wa(),wse=Lu();function xse(r,e){return(0,wse.createTaggedDecorator)(new Cse.Metadata(r,e))}nT.tagged=xse});var o7=re(mc=>{"use strict";p();var Pse=mc&&mc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Dse=mc&&mc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Tse=mc&&mc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Pse(e,r,t);return Dse(e,r),e};Object.defineProperty(mc,"__esModule",{value:!0});mc.named=void 0;var kse=Tse(Mn()),Nse=Wa(),Rse=Lu();function Ase(r){return(0,Rse.createTaggedDecorator)(new Nse.Metadata(kse.NAMED_TAG,r))}mc.named=Ase});var zL=re(iT=>{"use strict";p();Object.defineProperty(iT,"__esModule",{value:!0});iT.injectBase=void 0;var Mse=Wi(),Ose=Wa(),Lse=Lu();function Kse(r){return function(e){return function(t,n,i){if(e===void 0){var o=typeof t=="function"?t.name:t.constructor.name;throw new Error((0,Mse.UNDEFINED_INJECT_ANNOTATION)(o))}return(0,Lse.createTaggedDecorator)(new Ose.Metadata(r,e))(t,n,i)}}}iT.injectBase=Kse});var s7=re(hc=>{"use strict";p();var Fse=hc&&hc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Use=hc&&hc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Wse=hc&&hc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Fse(e,r,t);return Use(e,r),e};Object.defineProperty(hc,"__esModule",{value:!0});hc.inject=void 0;var Vse=Wse(Mn()),jse=zL(),Bse=(0,jse.injectBase)(Vse.INJECT_TAG);hc.inject=Bse});var a7=re(gc=>{"use strict";p();var Hse=gc&&gc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),qse=gc&&gc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Jse=gc&&gc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Hse(e,r,t);return qse(e,r),e};Object.defineProperty(gc,"__esModule",{value:!0});gc.optional=void 0;var Gse=Jse(Mn()),Yse=Wa(),$se=Lu();function zse(){return(0,$se.createTaggedDecorator)(new Yse.Metadata(Gse.OPTIONAL_TAG,!0))}gc.optional=zse});var l7=re(vc=>{"use strict";p();var Qse=vc&&vc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Xse=vc&&vc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Zse=vc&&vc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Qse(e,r,t);return Xse(e,r),e};Object.defineProperty(vc,"__esModule",{value:!0});vc.unmanaged=void 0;var eae=Zse(Mn()),tae=Wa(),rae=Lu();function nae(){return function(r,e,t){var n=new tae.Metadata(eae.UNMANAGED_TAG,!0);(0,rae.tagParameter)(r,e,t,n)}}vc.unmanaged=nae});var c7=re(yc=>{"use strict";p();var iae=yc&&yc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),oae=yc&&yc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),sae=yc&&yc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&iae(e,r,t);return oae(e,r),e};Object.defineProperty(yc,"__esModule",{value:!0});yc.multiInject=void 0;var aae=sae(Mn()),lae=zL(),cae=(0,lae.injectBase)(aae.MULTI_INJECT_TAG);yc.multiInject=cae});var u7=re(bc=>{"use strict";p();var uae=bc&&bc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),dae=bc&&bc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),pae=bc&&bc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&uae(e,r,t);return dae(e,r),e};Object.defineProperty(bc,"__esModule",{value:!0});bc.targetName=void 0;var fae=pae(Mn()),mae=Wa(),hae=Lu();function gae(r){return function(e,t,n){var i=new mae.Metadata(fae.NAME_TAG,r);(0,hae.tagParameter)(e,t,n,i)}}bc.targetName=gae});var QL=re(oT=>{"use strict";p();Object.defineProperty(oT,"__esModule",{value:!0});oT.propertyEventDecorator=void 0;var vae=Wa();function yae(r,e){return function(){return function(t,n){var i=new vae.Metadata(r,n);if(Reflect.hasOwnMetadata(r,t.constructor))throw new Error(e);Reflect.defineMetadata(r,i,t.constructor)}}}oT.propertyEventDecorator=yae});var p7=re(Sc=>{"use strict";p();var bae=Sc&&Sc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Sae=Sc&&Sc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),d7=Sc&&Sc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&bae(e,r,t);return Sae(e,r),e};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.postConstruct=void 0;var Iae=d7(Wi()),_ae=d7(Mn()),Eae=QL(),Cae=(0,Eae.propertyEventDecorator)(_ae.POST_CONSTRUCT,Iae.MULTIPLE_POST_CONSTRUCT_METHODS);Sc.postConstruct=Cae});var m7=re(Ic=>{"use strict";p();var wae=Ic&&Ic.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),xae=Ic&&Ic.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),f7=Ic&&Ic.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&wae(e,r,t);return xae(e,r),e};Object.defineProperty(Ic,"__esModule",{value:!0});Ic.preDestroy=void 0;var Pae=f7(Wi()),Dae=f7(Mn()),Tae=QL(),kae=(0,Tae.propertyEventDecorator)(Dae.PRE_DESTROY,Pae.MULTIPLE_PRE_DESTROY_METHODS);Ic.preDestroy=kae});var h7=re(sT=>{"use strict";p();Object.defineProperty(sT,"__esModule",{value:!0});sT.interfaces=void 0;var XL;XL||(XL={});sT.interfaces=XL});var ge=re(Be=>{"use strict";p();var Nae=Be&&Be.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Rae=Be&&Be.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Aae=Be&&Be.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Nae(e,r,t);return Rae(e,r),e};Object.defineProperty(Be,"__esModule",{value:!0});Be.multiBindToService=Be.getServiceIdentifierAsString=Be.typeConstraint=Be.namedConstraint=Be.taggedConstraint=Be.traverseAncerstors=Be.decorate=Be.interfaces=Be.id=Be.MetadataReader=Be.preDestroy=Be.postConstruct=Be.targetName=Be.multiInject=Be.unmanaged=Be.optional=Be.LazyServiceIdentifer=Be.inject=Be.named=Be.tagged=Be.injectable=Be.createTaggedDecorator=Be.ContainerModule=Be.AsyncContainerModule=Be.TargetTypeEnum=Be.BindingTypeEnum=Be.BindingScopeEnum=Be.Container=Be.METADATA_KEY=void 0;var Mae=Aae(Mn());Be.METADATA_KEY=Mae;var Oae=YL();Object.defineProperty(Be,"Container",{enumerable:!0,get:function(){return Oae.Container}});var ZL=Ua();Object.defineProperty(Be,"BindingScopeEnum",{enumerable:!0,get:function(){return ZL.BindingScopeEnum}});Object.defineProperty(Be,"BindingTypeEnum",{enumerable:!0,get:function(){return ZL.BindingTypeEnum}});Object.defineProperty(Be,"TargetTypeEnum",{enumerable:!0,get:function(){return ZL.TargetTypeEnum}});var g7=YH();Object.defineProperty(Be,"AsyncContainerModule",{enumerable:!0,get:function(){return g7.AsyncContainerModule}});Object.defineProperty(Be,"ContainerModule",{enumerable:!0,get:function(){return g7.ContainerModule}});var Lae=Lu();Object.defineProperty(Be,"createTaggedDecorator",{enumerable:!0,get:function(){return Lae.createTaggedDecorator}});var Kae=n7();Object.defineProperty(Be,"injectable",{enumerable:!0,get:function(){return Kae.injectable}});var Fae=i7();Object.defineProperty(Be,"tagged",{enumerable:!0,get:function(){return Fae.tagged}});var Uae=o7();Object.defineProperty(Be,"named",{enumerable:!0,get:function(){return Uae.named}});var Wae=s7();Object.defineProperty(Be,"inject",{enumerable:!0,get:function(){return Wae.inject}});var Vae=wL();Object.defineProperty(Be,"LazyServiceIdentifer",{enumerable:!0,get:function(){return Vae.LazyServiceIdentifer}});var jae=a7();Object.defineProperty(Be,"optional",{enumerable:!0,get:function(){return jae.optional}});var Bae=l7();Object.defineProperty(Be,"unmanaged",{enumerable:!0,get:function(){return Bae.unmanaged}});var Hae=c7();Object.defineProperty(Be,"multiInject",{enumerable:!0,get:function(){return Hae.multiInject}});var qae=u7();Object.defineProperty(Be,"targetName",{enumerable:!0,get:function(){return qae.targetName}});var Jae=p7();Object.defineProperty(Be,"postConstruct",{enumerable:!0,get:function(){return Jae.postConstruct}});var Gae=m7();Object.defineProperty(Be,"preDestroy",{enumerable:!0,get:function(){return Gae.preDestroy}});var Yae=EL();Object.defineProperty(Be,"MetadataReader",{enumerable:!0,get:function(){return Yae.MetadataReader}});var $ae=xp();Object.defineProperty(Be,"id",{enumerable:!0,get:function(){return $ae.id}});var zae=h7();Object.defineProperty(Be,"interfaces",{enumerable:!0,get:function(){return zae.interfaces}});var Qae=Lu();Object.defineProperty(Be,"decorate",{enumerable:!0,get:function(){return Qae.decorate}});var aT=BL();Object.defineProperty(Be,"traverseAncerstors",{enumerable:!0,get:function(){return aT.traverseAncerstors}});Object.defineProperty(Be,"taggedConstraint",{enumerable:!0,get:function(){return aT.taggedConstraint}});Object.defineProperty(Be,"namedConstraint",{enumerable:!0,get:function(){return aT.namedConstraint}});Object.defineProperty(Be,"typeConstraint",{enumerable:!0,get:function(){return aT.typeConstraint}});var Xae=Zv();Object.defineProperty(Be,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return Xae.getServiceIdentifierAsString}});var Zae=LL();Object.defineProperty(Be,"multiBindToService",{enumerable:!0,get:function(){return Zae.multiBindToService}})});var b7=re(Pp=>{"use strict";p();Object.defineProperty(Pp,"__esModule",{value:!0});Pp.PythonExtension=Pp.PVSC_EXTENSION_ID=void 0;var tle=require("vscode");Pp.PVSC_EXTENSION_ID="ms-python.python";var rle;(function(r){async function e(){let t=tle.extensions.getExtension(Pp.PVSC_EXTENSION_ID);if(t===void 0)throw new Error("Python extension is not installed or is disabled");return t.isActive||await t.activate(),t.exports}r.api=e})(rle=Pp.PythonExtension||(Pp.PythonExtension={}))});var rK=re((hNe,T7)=>{p();function sle(r){var e=/(%?)(%([jds]))/g,t=Array.prototype.slice.call(arguments,1);return t.length&&(r=r.replace(e,function(n,i,o,s){var a=t.shift();switch(s){case"s":a=""+a;break;case"d":a=Number(a);break;case"j":a=JSON.stringify(a);break}return i?(t.unshift(a),n):a})),t.length&&(r+=" "+t.join(" ")),r=r.replace(/%{2,2}/g,"%"),""+r}T7.exports=sle});var X7=re((qNe,sK)=>{"use strict";p();var hy=typeof Reflect=="object"?Reflect:null,j7=hy&&typeof hy.apply=="function"?hy.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},vT;hy&&typeof hy.ownKeys=="function"?vT=hy.ownKeys:Object.getOwnPropertySymbols?vT=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:vT=function(e){return Object.getOwnPropertyNames(e)};function ble(r){console&&console.warn&&console.warn(r)}var H7=Number.isNaN||function(e){return e!==e};function wr(){wr.init.call(this)}sK.exports=wr;sK.exports.once=Ele;wr.EventEmitter=wr;wr.prototype._events=void 0;wr.prototype._eventsCount=0;wr.prototype._maxListeners=void 0;var B7=10;function yT(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(wr,"defaultMaxListeners",{enumerable:!0,get:function(){return B7},set:function(r){if(typeof r!="number"||r<0||H7(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");B7=r}});wr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};wr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||H7(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function q7(r){return r._maxListeners===void 0?wr.defaultMaxListeners:r._maxListeners}wr.prototype.getMaxListeners=function(){return q7(this)};wr.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")j7(l,this,t);else for(var u=l.length,c=z7(l,u),n=0;n<u;++n)j7(c[n],this,t);return!0};function J7(r,e,t,n){var i,o,s;if(yT(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),s=o[e]),s===void 0)s=o[e]=t,++r._eventsCount;else if(typeof s=="function"?s=o[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),i=q7(r),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=s.length,ble(a)}return r}wr.prototype.addListener=function(e,t){return J7(this,e,t,!1)};wr.prototype.on=wr.prototype.addListener;wr.prototype.prependListener=function(e,t){return J7(this,e,t,!0)};function Sle(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function G7(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=Sle.bind(n);return i.listener=t,n.wrapFn=i,i}wr.prototype.once=function(e,t){return yT(t),this.on(e,G7(this,e,t)),this};wr.prototype.prependOnceListener=function(e,t){return yT(t),this.prependListener(e,G7(this,e,t)),this};wr.prototype.removeListener=function(e,t){var n,i,o,s,a;if(yT(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():Ile(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};wr.prototype.off=wr.prototype.removeListener;wr.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Y7(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?_le(i):z7(i,i.length)}wr.prototype.listeners=function(e){return Y7(this,e,!0)};wr.prototype.rawListeners=function(e){return Y7(this,e,!1)};wr.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):$7.call(r,e)};wr.prototype.listenerCount=$7;function $7(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}wr.prototype.eventNames=function(){return this._eventsCount>0?vT(this._events):[]};function z7(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Ile(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function _le(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Ele(r,e){return new Promise(function(t,n){function i(s){r.removeListener(e,o),n(s)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}Q7(r,e,o,{once:!0}),e!=="error"&&Cle(r,i,{once:!0})})}function Cle(r,e,t){typeof r.on=="function"&&Q7(r,"error",e,t)}function Q7(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var t8=re((vy,e8)=>{"use strict";p();var wle=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof Vu!="undefined")return Vu;throw new Error("unable to locate global object")},Vu=wle();e8.exports=vy=Vu.fetch;Vu.fetch&&(vy.default=Vu.fetch.bind(Vu));vy.Headers=Vu.Headers;vy.Request=Vu.Request;vy.Response=Vu.Response});var r8=re(oC=>{p();oC.get=function(r){var e=Error.stackTraceLimit;Error.stackTraceLimit=1/0;var t={},n=Error.prepareStackTrace;Error.prepareStackTrace=function(o,s){return s},Error.captureStackTrace(t,r||oC.get);var i=t.stack;return Error.prepareStackTrace=n,Error.stackTraceLimit=e,i};oC.parse=function(r){if(!r.stack)return[];var e=this,t=r.stack.split(`
`).slice(1);return t.map(function(n){if(n.match(/^\s*[-]{4,}$/))return e._createParsedCallSite({fileName:n,lineNumber:null,functionName:null,typeName:null,methodName:null,columnNumber:null,native:null});var i=n.match(/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);if(i){var o=null,s=null,a=null,l=null,u=null,c=i[5]==="native";if(i[1]){a=i[1];var d=a.lastIndexOf(".");if(a[d-1]=="."&&d--,d>0){o=a.substr(0,d),s=a.substr(d+1);var f=o.indexOf(".Module");f>0&&(a=a.substr(f+1),o=o.substr(0,f))}l=null}s&&(l=o,u=s),s==="<anonymous>"&&(u=null,a=null);var m={fileName:i[2]||null,lineNumber:parseInt(i[3],10)||null,functionName:a,typeName:l,methodName:u,columnNumber:parseInt(i[4],10)||null,native:c};return e._createParsedCallSite(m)}}).filter(function(n){return!!n})};function iC(r){for(var e in r)this[e]=r[e]}var xle=["this","typeName","functionName","methodName","fileName","lineNumber","columnNumber","function","evalOrigin"],Ple=["topLevel","eval","native","constructor"];xle.forEach(function(r){iC.prototype[r]=null,iC.prototype["get"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});Ple.forEach(function(r){iC.prototype[r]=!1,iC.prototype["is"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});oC._createParsedCallSite=function(r){return new iC(r)}});var Qr,dt,Yt,Mt,aC,Ir,ra,Ha,ST,yo,nr,IT=he(()=>{p();Qr="function",dt="object",Yt="undefined",Mt="prototype",aC="hasOwnProperty",Ir=Object,ra=Ir[Mt],Ha=Ir.assign,ST=Ir.create,yo=Ir.defineProperty,nr=ra[aC]});function Kn(r){r===void 0&&(r=!0);var e=r===!1?null:u8;return e||(typeof globalThis!==Yt&&(e=globalThis),!e&&typeof self!==Yt&&(e=self),!e&&typeof window!==Yt&&(e=window),!e&&typeof this!==Yt&&(e=this),u8=e),e}function na(r){throw new TypeError(r)}function bo(r){var e=ST;if(e)return e(r);if(r==null)return{};var t=typeof r;t!==dt&&t!==Qr&&na("Object prototype may only be an Object:"+r);function n(){}return n[Mt]=r,new n}var u8,dK=he(()=>{p();IT();u8=null});function vn(r,e){typeof e!==Qr&&e!==null&&na("Class extends value "+String(e)+" is not a constructor or null"),pK(r,e);function t(){this.constructor=r}r[Mt]=e===null?bo(e):(t[Mt]=e[Mt],new t)}function jm(r,e){for(var t=0,n=e.length,i=r.length;t<n;t++,i++)r[i]=e[t];return r}var q1e,J1e,Lle,So,pK,d8=he(()=>{p();IT();dK();q1e=(Kn()||{}).Symbol,J1e=(Kn()||{}).Reflect,Lle=function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)ra[aC].call(e,i)&&(r[i]=e[i])}return r},So=Ha||Lle,pK=function(r,e){return pK=Ir.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n[aC](i)&&(t[i]=n[i])},pK(r,e)}});var p8=he(()=>{p()});var ir=he(()=>{p();IT();dK();d8();p8()});var fK,f8=he(()=>{"use strict";p();fK=100});var qa,Di,lC,Ja,Ot,_s,_c,_T,jo,rt,Bm,Kr,ET,Hm,qm,mK,cC,Jm,Sy,uC,ju,Es,Iy,Mp,Ga,_y,Gm,Cs,ia,Op,Bu,CT,Lp,Ya,Ey,Kp,dC,Fp,wT,Cy,$a,hK,gK,xT,Fn,Bo,pC,Ym,fC,$m,za,PT,zm,wy,Up,mC,Cn=he(()=>{p();qa="initialize",Di="name",lC="getNotifyMgr",Ja="identifier",Ot="push",_s="isInitialized",_c="config",_T="instrumentationKey",jo="logger",rt="length",Bm="time",Kr="processNext",ET="getProcessTelContext",Hm="addNotificationListener",qm="removeNotificationListener",mK="stopPollingInternalLogs",cC="onComplete",Jm="getPlugin",Sy="flush",uC="_extensions",ju="splice",Es="teardown",Iy="messageId",Mp="message",Ga="isAsync",_y="_doTeardown",Gm="update",Cs="getNext",ia="diagLog",Op="setNextPlugin",Bu="createNew",CT="cookieCfg",Lp="indexOf",Ya="substring",Ey="userAgent",Kp="split",dC="setEnabled",Fp="substr",wT="nodeType",Cy="apply",$a="replace",hK="enableDebugExceptions",gK="logInternalMessage",xT="toLowerCase",Fn="call",Bo="type",pC="handler",Ym="listeners",fC="isChildEvt",$m="getCtx",za="setCtx",PT="complete",zm="traceId",wy="spanId",Up="traceFlags",mC="version"});var pt,vK,sn,yK,hC,xy,m8,Ho,oa,Py,Wp,Dy,Vp,DT,gC,Qm,vi=he(()=>{p();pt="",vK="channels",sn="core",yK="createPerfMgr",hC="disabled",xy="extensionConfig",m8="extensions",Ho="processTelemetry",oa="priority",Py="eventsSent",Wp="eventsDiscarded",Dy="eventsSendRequest",Vp="perfEvent",DT="errorToConsole",gC="warnToConsole",Qm="getPerfMgr"});function $le(r){if(r){if(kT)return kT(r);var e=r[Kle]||r[Mt]||r[TT];if(e)return e}return null}function Ty(r,e){return typeof r===e}function cr(r){return r===void 0||typeof r===Yt}function Et(r){return r===null||cr(r)}function CK(r){return!Et(r)}function Hu(r,e){return!!(r&&nr[Fn](r,e))}function Ti(r){return!!(r&&typeof r===dt)}function Ht(r){return!!(r&&typeof r===Qr)}function Xm(r){var e=r;return e&&an(e)&&(e=e[$a](Jle,function(t,n){return n.toUpperCase()}),e=e[$a](Gle,"_"),e=e[$a](Yle,function(t,n){return"_"+n})),e}function Fr(r,e){if(r)for(var t in r)nr[Fn](r,t)&&e[Fn](r,t,r[t])}function Zm(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=Wle?r[E8](e):zle(r,e)),t}function zle(r,e){var t=!1,n=e?e[rt]:0,i=r?r[rt]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function ky(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=Vle?r[C8](e):Qle(r,e)),t}function Qle(r,e){var t=!1,n=e?e[rt]:0;if(r&&n&&r[rt]>=n&&!(t=r===e)){for(var i=0;i<n;i++)if(r[i]!==e[i])return!1;t=!0}return t}function wn(r,e){return r&&e?r[Lp](e)!==-1:!1}function Ny(r){return!!(r&&EK[Fn](r)==="[object Date]")}function Xle(r){return!!(r&&EK[Fn](r)==="[object Array]")}function eh(r){return!!(r&&EK[Fn](r)==="[object Error]")}function an(r){return typeof r=="string"}function qo(r){return typeof r=="number"}function qu(r){return typeof r=="boolean"}function S8(r){var e=!1;if(r&&typeof r=="object"){var t=kT?kT(r):$le(r);t?(t[TT]&&nr[Fn](t,TT)&&(t=t[TT]),e=typeof t===Qr&&x8[Fn](t)===qle):e=!0}return e}function sa(r){if(r)return Ble?r[_8]():Zle(r)}function Zle(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[rt]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function We(r,e,t){var n=r[rt];try{for(var i=0;i<n&&!(i in r&&e[Fn](t||r,r[i],i,r)===-1);i++);}catch(o){}}function zn(r,e,t){if(r){if(r[h8])return r[h8](e,t);var n=r[rt],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function th(r,e,t){var n;if(r){if(r[g8])return r[g8](e,t);var i=r[rt],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[Fn](o,r[s],r))}catch(a){}}return n}function rh(r,e,t){var n;if(r){if(r[v8])return r[v8](e,t);var i=r[rt],o=0;if(arguments[rt]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function Ur(r){return r&&(r=Ule&&r[SK]?r[SK]():r[$a]?r[$a](/^\s+|(?=\s)\s+$/g,pt):r),r}function Io(r){var e=typeof r;if(e!==Qr&&(e!==dt||r===null)&&na("objKeys called on non-object"),!I8&&b8)return b8(r);var t=[];for(var n in r)r&&nr[Fn](r,n)&&t[Ot](n);if(I8)for(var i=bK[rt],o=0;o<i;o++)r&&nr[Fn](r,bK[o])&&t[Ot](bK[o]);return t}function ws(r,e,t,n){if(y8)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),y8(r,e,i),!0}catch(o){}return!1}function P8(r){return r}function wK(r){return IK&&Fr(r,function(e,t){(yt(t)||Ti(t))&&IK(t)}),Jo(r)}function Qn(){var r=Date;return r.now?r.now():new r().getTime()}function nh(r){return eh(r)?r[Di]:pt}function Go(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function jp(r,e,t){var n;return r?(n=r[e],!n&&Et(n)&&(n=cr(t)?{}:t,r[e]=n)):n=cr(t)?{}:t,n}function aa(r,e){return Et(r)?e:r}function PK(r){return!r}function Ry(r){return!!r}function Xn(r){throw new Error(r)}function D8(r,e){var t=null,n=null;return Ht(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][Cy](n,i)}}function DK(r,e,t){if(r&&e&&Ti(r)&&Ti(e)){var n=function(o){if(an(o)){var s=e[o];Ht(s)?(!t||t(o,!0,e,r))&&(r[o]=D8(e,o)):(!t||t(o,!1,e,r))&&(Hu(r,o)&&delete r[o],ws(r,o,function(){return e[o]},function(a){e[o]=a})||(r[o]=s))}};for(var i in e)n(i)}return r}function Bp(r,e,t,n,i){r&&e&&t&&(i!==!1||cr(r[e]))&&(r[e]=D8(t,n))}function ih(r,e,t,n){return r&&e&&Ti(r)&&yt(t)&&We(t,function(i){an(i)&&Bp(r,i,e,i,n)}),r}function Ju(r){return r&&Ha&&(r=Ir(Ha({},r))),r}function Ay(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[rt],u=!1,c=1;for(l>0&&qu(a)&&(u=a,a=s[c]||{},c++),Ti(a)||(a={});c<l;c++){var d=s[c],f=yt(d),m=Ti(d);for(var g in d){var b=f&&g in d||m&&nr[Fn](d,g);if(b){var y=d[g],P=void 0;if(u&&y&&((P=yt(y))||S8(y))){var A=a[g];P?yt(A)||(A=[]):S8(A)||(A={}),y=Ay(u,A,y)}y!==void 0&&(a[g]=y)}}}return a}var _8,E8,C8,h8,g8,v8,SK,w8,Kle,TT,y8,IK,Fle,b8,_K,Ule,Wle,Vle,jle,Ble,Hle,EK,x8,qle,Jle,Gle,Yle,kT,yt,I8,bK,Jo,xK,xn=he(()=>{p();ir();Cn();vi();_8="toISOString",E8="endsWith",C8="startsWith",h8="indexOf",g8="map",v8="reduce",SK="trim",w8="toString",Kle="__proto__",TT="constructor",y8=yo,IK=Ir.freeze,Fle=Ir.seal,b8=Ir.keys,_K=String[Mt],Ule=_K[SK],Wle=_K[E8],Vle=_K[C8],jle=Date[Mt],Ble=jle[_8],Hle=Array.isArray,EK=ra[w8],x8=nr[w8],qle=x8[Fn](Ir),Jle=/-([a-z])/g,Gle=/([^\w\d_$])/g,Yle=/^(\d+[\w\d_$])/,kT=Object.getPrototypeOf;yt=Hle||Xle;I8=!{toString:null}.propertyIsEnumerable("toString"),bK=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];Jo=IK||P8,xK=Fle||P8});function _o(r){var e={};return Fr(r,function(t,n){e[t]=n,e[n]=t}),wK(e)}var NT=he(()=>{p();xn()});var Qa,T8=he(()=>{p();NT();Qa=_o({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5})});function tce(){var r;return typeof globalThis!==AT&&(r=globalThis),!r&&typeof self!==AT&&(r=self),!r&&typeof window!==AT&&(r=window),!r&&typeof this!==AT&&(r=this),r||{}}function Yu(r,e){return r&&VT[Gu].hasOwnProperty.call(r,e)}function L8(r){return r&&(r===VT[Gu]||r===Array[Gu])}function OK(r){return L8(r)||r===Function[Gu]}function oh(r){var e;if(r){if(yC)return yC(r);var t=r[O8]||r[Gu]||(r[LT]?r[LT][Gu]:null);e=r[MT]||t,Yu(r,MT)||(delete r[TK],e=r[MT]=r[TK]||r[MT],r[TK]=t)}return e}function UT(r,e){var t=[];if(R8)t=R8(r);else for(var n in r)typeof n=="string"&&Yu(r,n)&&t.push(n);if(t&&t.length>0)for(var i=0;i<t.length;i++)e(t[i])}function LK(r,e,t){return e!==LT&&typeof r[e]===KT&&(t||Yu(r,e))}function WT(r){throw new TypeError("DynamicProto: "+r)}function rce(r){var e={};return UT(r,function(t){!e[t]&&LK(r,t,!1)&&(e[t]=r[t])}),e}function KK(r,e){for(var t=r.length-1;t>=0;t--)if(r[t]===e)return!0;return!1}function nce(r,e,t,n){function i(l,u,c){var d=u[c];if(d[NK]&&n){var f=l[FT]||{};f[vC]!==!1&&(d=(f[u[My]]||{})[c]||d)}return function(){return d.apply(l,arguments)}}var o={};UT(t,function(l){o[l]=i(e,t,l)});for(var s=oh(r),a=[];s&&!OK(s)&&!KK(a,s);)UT(s,function(l){!o[l]&&LK(s,l,!yC)&&(o[l]=i(e,s,l))}),a.push(s),s=oh(s);return o}function ice(r,e,t,n){var i=null;if(r&&Yu(t,My)){var o=r[FT]||{};if(i=(o[t[My]]||{})[e],i||WT("Missing ["+e+"] "+KT),!i[RK]&&o[vC]!==!1){for(var s=!Yu(r,e),a=oh(r),l=[];s&&a&&!OK(a)&&!KK(l,a);){var u=a[e];if(u){s=u===n;break}l.push(a),a=oh(a)}try{s&&(r[e]=i),i[RK]=1}catch(c){o[vC]=!1}}}return i}function oce(r,e,t){var n=e[r];return n===t&&(n=oh(e)[r]),typeof n!==KT&&WT("["+r+"] is not a "+KT),n}function sce(r,e,t,n,i){function o(l,u){var c=function(){var d=ice(this,u,l,c)||oce(u,l,c);return d.apply(this,arguments)};return c[NK]=1,c}if(!L8(r)){var s=t[FT]=t[FT]||{},a=s[e]=s[e]||{};s[vC]!==!1&&(s[vC]=!!i),UT(t,function(l){LK(t,l,!1)&&t[l]!==n[l]&&(a[l]=t[l],delete t[l],(!Yu(r,l)||r[l]&&!r[l][NK])&&(r[l]=o(r,l)))})}}function ace(r,e){if(yC){for(var t=[],n=oh(e);n&&!OK(n)&&!KK(t,n);){if(n===r)return!0;t.push(n),n=oh(n)}return!1}return!0}function kK(r,e){return Yu(r,Gu)?r.name||e||k8:((r||{})[LT]||{}).name||e||k8}function He(r,e,t,n){Yu(r,Gu)||WT("theClass is an invalid class definition.");var i=r[Gu];ace(i,e)||WT("["+kK(r)+"] not in hierarchy of ["+kK(e)+"]");var o=null;Yu(i,My)?o=i[My]:(o=ece+kK(r,"_")+"$"+MK.n,MK.n++,i[My]=o);var s=He[M8],a=!!s[OT];a&&n&&n[OT]!==void 0&&(a=!!n[OT]);var l=rce(e),u=nce(i,e,l,a);t(e,u);var c=!!yC&&!!s[AK];c&&n&&(c=!!n[AK]),sce(i,o,e,l,c!==!1)}var RT,AT,LT,Gu,KT,FT,NK,My,ece,RK,vC,M8,k8,O8,MT,N8,TK,OT,AK,VT,yC,R8,A8,MK,ur=he(()=>{p();AT="undefined",LT="constructor",Gu="prototype",KT="function",FT="_dynInstFuncs",NK="_isDynProxy",My="_dynClass",ece="_dynCls$",RK="_dynInstChk",vC=RK,M8="_dfOpts",k8="_unknown_",O8="__proto__",MT="_dyn"+O8,N8="__dynProto$Gbl",TK="_dynInstProto",OT="useBaseInst",AK="setInstFuncs",VT=Object,yC=VT.getPrototypeOf,R8=VT.getOwnPropertyNames;A8=tce(),MK=A8[N8]||(A8[N8]={o:(RT={},RT[AK]=!0,RT[OT]=!0,RT),n:1e3});He[M8]=MK.o});function V8(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Mt];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!cr(i[e])}catch(o){}}return t}function BK(r){W8=r}function ln(r){var e=Kn();return e&&e[r]?e[r]:r===K8&&bC()?window:null}function bC(){return!!(typeof window===dt&&window)}function Ec(){return bC()?window:ln(K8)}function jT(){return!!(typeof document===dt&&document)}function Yo(){return jT()?document:ln(lce)}function SC(){return!!(typeof navigator===dt&&navigator)}function xs(){return SC()?navigator:ln(uce)}function BT(){return!!(typeof history===dt&&history)}function HK(){return BT()?history:ln(dce)}function sh(r){if(r&&W8){var e=ln("__mockLocation");if(e)return e}return typeof location===dt&&location?location:ln(pce)}function IC(){return typeof console!==Yt?console:ln(fce)}function Ly(){return ln(mce)}function ah(){return!!(typeof JSON===dt&&JSON||ln(F8)!==null)}function Ky(){return ah()?JSON||ln(F8):null}function _C(){return ln(hce)}function EC(){return ln(gce)}function $u(){var r=xs();return r&&r.product?r.product===vce:!1}function Xa(){var r=xs();if(r&&(r[Ey]!==UK||FK===null)){UK=r[Ey];var e=(UK||pt)[xT]();FK=wn(e,VK)||wn(e,jK)}return FK}function qK(r){if(r===void 0&&(r=null),!r){var e=xs()||{};r=e?(e[Ey]||pt)[xT]():pt}var t=(r||pt)[xT]();if(wn(t,VK)){var n=Yo()||{};return Math.max(parseInt(t[Kp](VK)[1]),n[cce]||0)}else if(wn(t,jK)){var i=parseInt(t[Kp](jK)[1]);if(i)return i+4}return null}function Xr(r){var e=Object[Mt].toString[Fn](r),t=pt;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Di]+"'":ah()&&(t=Ky().stringify(r)),e+t}function Hp(){return WK===null&&(WK=SC()&&!!xs().sendBeacon),WK}function Fy(r){var e=!1;try{e=!!ln("fetch");var t=ln("Request");e&&r&&t&&(e=V8(t,"keepalive"))}catch(n){}return e}function lh(){return Oy===null&&(Oy=typeof XDomainRequest!==Yt,Oy&&Uy()&&(Oy=Oy&&!V8(ln(U8),"withCredentials"))),Oy}function Uy(){var r=!1;try{var e=ln(U8);r=!!e}catch(t){}return r}function j8(r,e){if(r)for(var t=0;t<r[rt];t++){var n=r[t];if(n[Di]&&n[Di]===e)return n}return{}}function JK(r){var e=Yo();return e&&r?j8(e.querySelectorAll("meta"),r).content:null}function GK(r){var e,t=Ly();if(t){var n=t.getEntriesByType("navigation")||[];e=j8((n[rt]>0?n[0]:{}).serverTiming,r).description}return e}var K8,lce,cce,uce,dce,pce,fce,mce,F8,hce,gce,vce,VK,jK,U8,FK,UK,W8,Oy,WK,la=he(()=>{"use strict";p();ir();Cn();xn();vi();K8="window",lce="document",cce="documentMode",uce="navigator",dce="history",pce="location",fce="console",mce="performance",F8="JSON",hce="crypto",gce="msCrypto",vce="ReactNative",VK="msie",jK="trident/",U8="XMLHttpRequest",FK=null,UK=null,W8=!1,Oy=null,WK=null});function yce(r,e){return function(){var t=arguments,n=$K(e);if(n){var i=n.listener;i&&i[r]&&i[r][Cy](i,t)}}}function bce(){var r=ln("Microsoft");return r&&(qT=r.ApplicationInsights),qT}function $K(r){var e=qT;return!e&&r.disableDbgExt!==!0&&(e=qT||bce()),e?e.ChromeDbgExt:null}function B8(r){if(!HT){HT={};for(var e=0;e<YK[rt];e++)HT[YK[e]]=yce(YK[e],r)}return HT}var YK,qT,HT,zK=he(()=>{p();Cn();la();YK=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],qT=null});function H8(r){return r?'"'+r[$a](/\"/g,pt)+'"':pt}function q8(r,e){var t=IC();if(t){var n="log";t[r]&&(n=r),Ht(t[n])&&t[n](e)}}function CC(r,e){return(r||{})[jo]||new Za(e)}function QK(r){return r||new Za}function Gr(r,e,t,n,i,o){o===void 0&&(o=!1),QK(r).throwInternal(e,t,n,i,o)}function el(r,e){QK(r)[gC](e)}function XK(r,e,t){QK(r)[gK](e,t)}var Sce,Ice,_ce,ch,Za,qp=he(()=>{"use strict";p();ur();Cn();zK();la();xn();vi();Sce="AI (Internal): ",Ice="AI: ",_ce="AITR_";ch=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Iy]=e,o[Mp]=(n?Ice:Sce)+e;var s=pt;ah()&&(s=Ky().stringify(i));var a=(t?" message:"+H8(t):pt)+(i?" props:"+H8(s):pt);o[Mp]+=a}return r.dataType="MessageData",r}();Za=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[hK]=function(){return a},l.throwInternal=function(m,g,b,y,P){P===void 0&&(P=!1);var A=new ch(g,b,P,y);if(a)throw Xr(A);var D=m===1?DT:gC;if(cr(A[Mp]))f("throw"+(m===1?"Critical":"Warning"),A);else{if(P){var T=+A[Iy];!n[T]&&i>=m&&(l[D](A[Mp]),n[T]=!0)}else i>=m&&l[D](A[Mp]);u(m,A)}},l[gC]=function(m){q8("warn",m),f("warning",m)},l[DT]=function(m){q8("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[gK]=u;function u(m,g){if(!d()){var b=!0,y=_ce+g[Iy];if(n[y]?b=!1:n[y]=!0,b&&(m<=o&&(l.queue[Ot](g),t++,f(m===1?"error":"warn",g)),t===s)){var P="Internal events throttle limit per PageView reached for this app.",A=new ch(23,P,!1);l.queue[Ot](A),m===1?l[DT](P):l[gC](P)}}}function c(m){i=aa(m.loggingLevelConsole,0),o=aa(m.loggingLevelTelemetry,1),s=aa(m.maxMessageLimit,25),a=aa(m[hK],!1)}function d(){return t>=s}function f(m,g){var b=$K(e||{});b&&b[ia]&&b[ia](m,g)}})}return r.__ieDyn=1,r}()});function yn(r,e,t,n,i){if(r){var o=r;if(o[Qm]&&(o=o[Qm]()),o){var s=void 0,a=o[$m](ZK);try{if(s=o.create(e(),n,i),s){if(a&&s[za]&&(s[za](uh[eF],a),a[$m]&&a[za])){var l=a[$m](uh[wC]);l||(l=[],a[za](uh[wC],l)),l[Ot](s)}return o[za](ZK,s),t(s)}}catch(u){s&&s[za]&&s[za]("exception",u)}finally{s&&o.fire(s),o[za](ZK,a)}}}return t()}function tF(){return Ece}var Wy,eF,wC,Ece,uh,xC,ZK,PC=he(()=>{p();ur();Cn();xn();vi();Wy="ctx",eF="ParentContextKey",wC="ChildrenContextKey",Ece=null,uh=function(){function r(e,t,n){var i=this,o=!1;if(i.start=Qn(),i[Di]=e,i[Ga]=n,i[fC]=function(){return!1},Ht(t)){var s;o=ws(i,"payload",function(){return!s&&Ht(t)&&(s=t(),t=null),s})}i[$m]=function(a){return a?a===r[eF]||a===r[wC]?i[a]:(i[Wy]||{})[a]:null},i[za]=function(a,l){if(a)if(a===r[eF])i[a]||(i[fC]=function(){return!0}),i[a]=l;else if(a===r[wC])i[a]=l;else{var u=i[Wy]=i[Wy]||{};u[a]=l}},i[PT]=function(){var a=0,l=i[$m](r[wC]);if(yt(l))for(var u=0;u<l[rt];u++){var c=l[u];c&&(a+=c[Bm])}i[Bm]=Qn()-i.start,i.exTime=i[Bm]-a,i[PT]=function(){},!o&&Ht(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),xC=function(){function r(e){this.ctx={},He(r,this,function(t){t.create=function(n,i,o){return new uh(n,i,o)},t.fire=function(n){n&&(n[PT](),e&&Ht(e[Vp])&&e[Vp](n))},t[za]=function(n,i){if(n){var o=t[Wy]=t[Wy]||{};o[n]=i}},t[$m]=function(n){return(t[Wy]||{})[n]}})}return r.__ieDyn=1,r}(),ZK="CoreUtils.doPerf"});function Y8(r){r<0&&(r>>>=0),DC=123456789+r&Jp,TC=987654321-r&Jp,G8=!0}function $8(){try{var r=Qn()&2147483647;Y8((Math.random()*J8^r)+r)}catch(e){}}function Vy(r){return r>0?Math.floor(tl()/Jp*(r+1))>>>0:0}function tl(r){var e=0,t=_C()||EC();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&Jp),e===0&&Xa()&&(G8||$8(),e=kC()&Jp),e===0&&(e=Math.floor(J8*Math.random()|0)),r||(e>>>=0),e}function JT(r){r?Y8(r):$8()}function kC(r){TC=36969*(TC&65535)+(TC>>16)&Jp,DC=18e3*(DC&65535)+(DC>>16)&Jp;var e=(TC<<16)+(DC&65535)>>>0&Jp|0;return r||(e>>>=0),e}function Gp(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=tl()>>>0,n=0,i=pt;i[rt]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(tl()<<2&4294967295|t&3)>>>0,n=0);return i}var J8,Jp,G8,DC,TC,GT=he(()=>{p();Cn();la();xn();vi();J8=4294967296,Jp=4294967295,G8=!1,DC=123456789,TC=987654321});function xce(r,e,t){if(z8)try{return z8(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function X8(r){return r[wT]===1||r[wT]===9||!+r[wT]}function Pce(r,e){var t=e[r.id];if(!t){t={};try{X8(e)&&(xce(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function rl(r,e){return e===void 0&&(e=!1),Xm(r+wce+++(e?"."+Q8:pt)+Cce)}function YT(r){var e={id:rl("_aiData-"+(r||pt)+"."+Q8),accept:function(t){return X8(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[Xm(n)]:(o&&(s=Pce(e,t),s[Xm(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var z8,Q8,Cce,wce,NC=he(()=>{p();ir();Cn();xn();vi();GT();z8=yo,Q8="2.8.10",Cce="."+Gp(6),wce=0});function Dce(r,e){var t=zu[Yp]||QT[Yp];return t||(t=zu[Yp]=zu(r,e),QT[Yp]=t),t}function zT(r){return r?r.isEnabled():!0}function Tce(r){var e=r[CT]=r[CT]||{};if(Go(e,"domain",r.cookieDomain,CK,Et),Go(e,"path",r.cookiePath||"/",null,Et),Et(e[iF])){var t=void 0;cr(r[t6])||(t=!r[t6]),cr(r[r6])||(t=!r[r6]),e[iF]=t}return e}function l6(r,e){return e&&r&&yt(r.ignoreCookies)?r.ignoreCookies[Lp](e)!==-1:!1}function kce(r,e){return e&&r&&yt(r.blockedCookies)&&r.blockedCookies[Lp](e)!==-1?!0:l6(r,e)}function $p(r,e){var t;if(r)t=r.getCookieMgr();else if(e){var n=e[CT];n[Yp]?t=n[Yp]:t=zu(e)}return t||(t=Dce(e,(r||{})[jo])),t}function zu(r,e){var t,n=Tce(r||QT),i=n.path||"/",o=n.domain,s=n[iF]!==!1,a=(t={isEnabled:function(){var l=s&&nl(e),u=QT[Yp];return l&&u&&a!==u&&(l=zT(u)),l}},t[dC]=function(l){s=l!==!1},t.set=function(l,u,c,d,f){var m=!1;if(zT(a)&&!kce(n,l)){var g={},b=Ur(u||pt),y=b[Lp](";");if(y!==-1&&(b=Ur(u[Ya](0,y)),g=c6(u[Ya](y+1))),Go(g,"domain",d||o,Ry,cr),!Et(c)){var P=Xa();if(cr(g[rF])){var A=Qn(),D=A+c*1e3;if(D>0){var T=new Date;T.setTime(D),Go(g,rF,o6(T,P?Z8:e6)||o6(T,P?Z8:e6)||pt,Ry)}}P||Go(g,"max-age",pt+c,null,cr)}var K=sh();K&&K.protocol==="https:"&&(Go(g,"secure",null,null,cr),nF===null&&(nF=!jy((xs()||{})[Ey])),nF&&Go(g,"SameSite","None",null,cr)),Go(g,"path",f||i,null,cr);var L=n.setCookie||a6;L(l,s6(b,g)),m=!0}return m},t.get=function(l){var u=pt;return zT(a)&&!l6(n,l)&&(u=(n.getCookie||Nce)(l)),u},t.del=function(l,u){var c=!1;return zT(a)&&(c=a.purge(l,u)),c},t.purge=function(l,u){var c,d=!1;if(nl(e)){var f=(c={},c.path=u||"/",c[rF]="Thu, 01 Jan 1970 00:00:01 GMT",c);Xa()||(f["max-age"]="0");var m=n.delCookie||a6;m(l,s6(pt,f)),d=!0}return d},t);return a[Yp]=a,a}function nl(r){if($T===null){$T=!1;try{var e=RC||{};$T=e[oF]!==void 0}catch(t){Gr(r,2,68,"Cannot access document.cookie - "+nh(t),{exception:Xr(t)})}}return $T}function c6(r){var e={};if(r&&r[rt]){var t=Ur(r)[Kp](";");We(t,function(n){if(n=Ur(n||pt),n){var i=n[Lp]("=");i===-1?e[n]=null:e[Ur(n[Ya](0,i))]=Ur(n[Ya](i+1))}})}return e}function o6(r,e){return Ht(r[e])?r[e]():null}function s6(r,e){var t=r||pt;return Fr(e,function(n,i){t+="; "+n+(Et(i)?pt:"="+i)}),t}function Nce(r){var e=pt;if(RC){var t=RC[oF]||pt;n6!==t&&(i6=c6(t),n6=t),e=Ur(i6[r]||pt)}return e}function a6(r,e){RC&&(RC[oF]=r+"="+e)}function jy(r){return an(r)?!!(wn(r,"CPU iPhone OS 12")||wn(r,"iPad; CPU OS 12")||wn(r,"Macintosh; Intel Mac OS X 10_14")&&wn(r,"Version/")&&wn(r,"Safari")||wn(r,"Macintosh; Intel Mac OS X 10_14")&&Zm(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||wn(r,"Chrome/5")||wn(r,"Chrome/6")||wn(r,"UnrealEngine")&&!wn(r,"Chrome")||wn(r,"UCBrowser/12")||wn(r,"UCBrowser/11")):!1}var Z8,e6,oF,rF,iF,t6,r6,Yp,$T,nF,n6,RC,i6,QT,sF=he(()=>{p();Cn();qp();la();xn();vi();Z8="toGMTString",e6="toUTCString",oF="cookie",rF="expires",iF="enabled",t6="isCookieUseDisabled",r6="disableCookiesUsage",Yp="_ckMgr",$T=null,nF=null,n6=null,RC=Yo(),i6={},QT={}});function m6(r){return r&&r[$a]?r[$a](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,pt):r}function ek(r,e){var t;if(e){var n=pt;yt(e)?(n=pt,We(e,function(o){o=m6(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=m6(e),n&&(n[0]!=="."&&(n="."+n),r=(r||pt)+n)}var i=Oce.exec(r||pt)||[];return t={},t[Bo]=i[1],t.ns=(i[2]||pt).replace(Rce,".").replace(Ace,pt)[Kp](".").sort().join("."),t}function aF(r,e,t){var n=[],i=MC.get(r,XT,{},!1),o=ek(e,t);return Fr(i,function(s,a){We(a,function(l){var u;(!o[Bo]||o[Bo]===l.evtName[Bo])&&(!o.ns||o.ns===o.ns)&&n[Ot]((u={},u[Di]=l.evtName[Bo]+(l.evtName.ns?"."+l.evtName.ns:pt),u.handler=l[pC],u))})}),n}function _6(r,e,t){t===void 0&&(t=!0);var n=MC.get(r,XT,{},t),i=n[e];return i||(i=n[e]=[]),i}function E6(r,e,t,n){r&&e&&e[Bo]&&(r[f6]?r[f6](e[Bo],t,n):r[p6]&&r[p6](g6+e[Bo],t))}function Lce(r,e,t,n){var i=!1;return r&&e&&e[Bo]&&t&&(r[d6]?(r[d6](e[Bo],t,n),i=!0):r[u6]&&(r[u6](g6+e[Bo],t),i=!0)),i}function h6(r,e,t,n){for(var i=e[rt];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(E6(r,o.evtName,o[pC],o.capture),e[ju](i,1))}}function Kce(r,e,t){if(e[Bo])h6(r,_6(r,e[Bo]),e,t);else{var n=MC.get(r,XT,{});Fr(n,function(i,o){h6(r,o,e,t)}),Io(n)[rt]===0&&MC.kill(r,XT)}}function Qu(r,e){var t;return e?(yt(e)?t=[r].concat(e):t=[r,e],t=ek("xx",t).ns[Kp](".")):t=r,t}function dh(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=ek(e,n);if(s=Lce(r,a,t,i),s&&MC.accept(r)){var l=(o={guid:Mce++,evtName:a},o[pC]=t,o.capture=i,o);_6(r,a.type)[Ot](l)}}catch(u){}return s}function ph(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=ek(e,n),s=!1;Kce(r,o,function(a){return o.ns&&!t||a[pC]===t?(s=!0,!0):!1}),s||E6(r,o,t,i)}catch(a){}}function Hy(r,e,t,n){return n===void 0&&(n=!1),dh(r,e,t,null,n)}function qy(r,e,t,n){n===void 0&&(n=!1),ph(r,e,t,null,n)}function Qp(r,e,t){var n=!1,i=Ec();i&&(n=dh(i,r,e,t),n=dh(i.body,r,e,t)||n);var o=Yo();return o&&(n=dh(o,r,e,t)||n),n}function tk(r,e,t){var n=Ec();n&&(ph(n,r,e,t),ph(n.body,r,e,t));var i=Yo();i&&ph(i,r,e,t)}function By(r,e,t,n){var i=!1;return e&&r&&r[rt]>0&&We(r,function(o){o&&(!t||zn(t,o)===-1)&&(i=Qp(o,e,n)||i)}),i}function rk(r,e,t,n){var i=!1;return e&&r&&yt(r)&&(i=By(r,e,t,n),!i&&t&&t[rt]>0&&(i=By(r,e,null,n))),i}function zp(r,e,t){r&&yt(r)&&We(r,function(n){n&&tk(n,e,t)})}function fh(r,e,t){return rk([b6,y6,ZT],r,e,t)}function OC(r,e){zp([b6,y6,ZT],r,e)}function Jy(r,e,t){function n(s){var a=Yo();r&&a&&a.visibilityState==="hidden"&&r(s)}var i=Qu(S6,t),o=By([ZT],r,e,i);return(!e||zn(e,AC)===-1)&&(o=By([AC],n,e,i)||o),!o&&e&&(o=Jy(r,null,t)),o}function LC(r,e){var t=Qu(S6,e);zp([ZT],r,t),zp([AC],null,t)}function Gy(r,e,t){function n(s){var a=Yo();r&&a&&a.visibilityState==="visible"&&r(s)}var i=Qu(I6,t),o=By([v6],r,e,i);return o=By([AC],n,e,i)||o,!o&&e&&(o=Gy(r,null,t)),o}function KC(r,e){var t=Qu(I6,e);zp([v6],r,t),zp([AC],null,t)}var g6,u6,d6,p6,f6,XT,AC,ZT,v6,y6,b6,S6,I6,Rce,Ace,Mce,MC,Oce,lF=he(()=>{p();Cn();NC();la();xn();vi();g6="on",u6="attachEvent",d6="addEventListener",p6="detachEvent",f6="removeEventListener",XT="events",AC="visibilitychange",ZT="pagehide",v6="pageshow",y6="unload",b6="beforeunload",S6=rl("aiEvtPageHide"),I6=rl("aiEvtPageShow"),Rce=/\.[\.]+/g,Ace=/[\.]+$/,Mce=1,MC=YT("events"),Oce=/^([^.]*)(?:\.(.+)|)/});function Yy(){var r=Xu();return r[Ya](0,8)+"-"+r[Ya](8,12)+"-"+r[Ya](12,16)+"-"+r[Ya](16,20)+"-"+r[Ya](20)}function $y(){var r=Ly();return r&&r.now?r.now():Qn()}function Xu(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=pt,t,n=0;n<4;n++)t=tl(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(tl()&3)|0];return e[Fp](0,8)+e[Fp](9,4)+"4"+e[Fp](13,3)+i+e[Fp](16,3)+e[Fp](19,12)}var cF,uF=he(()=>{"use strict";p();Cn();la();lF();xn();vi();GT();cF={Attach:Hy,AttachEvent:Hy,Detach:qy,DetachEvent:qy}});function Zu(r,e,t){return r&&r[rt]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function w6(r,e,t){return Zu(r,e)?r:t}function x6(r){(isNaN(r)||r<0||r>255)&&(r=1);for(var e=r.toString(16);e[rt]<2;)e="0"+e;return e}function fF(r,e,t,n){var i;return i={},i[mC]=Zu(n,2,pF)?n:dF,i[zm]=zy(r)?r:Xu(),i.spanId=Qy(e)?e:Xu()[Fp](0,16),i.traceFlags=t>=0&&t<=255?t:1,i}function FC(r){var e;if(!r||(yt(r)&&(r=r[0]||""),!r||!an(r)||r[rt]>8192))return null;var t=Fce.exec(Ur(r));return!t||t[1]===pF||t[2]===nk||t[3]===ik?null:(e={},e[mC]=t[1],e[zm]=t[2],e[wy]=t[3],e[Up]=parseInt(t[4],16),e)}function zy(r){return Zu(r,32,nk)}function Qy(r){return Zu(r,16,ik)}function ok(r){return!(!r||!Zu(r[mC],2,pF)||!Zu(r[zm],32,nk)||!Zu(r[wy],16,ik)||!Zu(x6(r[Up]),2))}function mF(r){return ok(r)?(r[Up]&C6)===C6:!1}function hF(r){if(r){var e=x6(r[Up]);Zu(e,2)||(e="01");var t=r[mC]||dF;return t!=="00"&&t!=="ff"&&(t=dF),"".concat(t,"-").concat(w6(r.traceId,32,nk),"-").concat(w6(r.spanId,16,ik),"-").concat(e)}return""}function gF(){var r="traceparent",e=FC(JK(r));return e||(e=FC(GK(r))),e}var Fce,dF,pF,nk,ik,C6,vF=he(()=>{p();Cn();uF();la();xn();Fce=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]*)?$/,dF="00",pF="ff",nk="00000000000000000000000000000000",ik="0000000000000000",C6=1});function ed(r){return Uce.get(r,"state",{},!0)}function sk(r,e){for(var t=[],n=null,i=r[Cs](),o;i;){var s=i[Jm]();if(s){n&&Ht(n[Op])&&Ht(s[Ho])&&n[Op](s);var a=!1;Ht(s[_s])?a=s[_s]():(o=ed(s),a=o[_s]),a||t[Ot](s),n=s,i=i[Cs]()}}We(t,function(l){var u=r[sn]();l[qa](r.getCfg(),u,e,r[Cs]()),o=ed(l),!l[sn]&&!o[sn]&&(o[sn]=u),o[_s]=!0,delete o[Es]})}function ak(r){return r.sort(function(e,t){var n=0;if(t){var i=Ht(t[Ho]);Ht(e[Ho])?n=i?e[oa]-t[oa]:1:i&&(n=-1)}else n=e?1:-1;return n})}function P6(r){var e={};return{getName:function(){return e[Di]},setName:function(t){r&&r.setName(t),e[Di]=t},getTraceId:function(){return e[zm]},setTraceId:function(t){r&&r.setTraceId(t),zy(t)&&(e[zm]=t)},getSpanId:function(){return e[wy]},setSpanId:function(t){r&&r.setSpanId(t),Qy(t)&&(e[wy]=t)},getTraceFlags:function(){return e[Up]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[Up]=t}}}var Uce,lk=he(()=>{"use strict";p();Cn();NC();xn();vi();vF();Uce=YT("plugin")});function Vce(r,e,t){for(;r;){if(r[Jm]()===t)return r;r=r[Cs]()}return Cc([t],e[_c]||{},e)}function yF(r,e,t,n){var i=null,o=[];n!==null&&(i=n?Vce(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return CC(t,e)},getCfg:function(){return e},getExtCfg:u,getConfig:c,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:d,onComplete:a}};function a(f,m){for(var g=[],b=2;b<arguments.length;b++)g[b-2]=arguments[b];f&&o[Ot]({func:f,self:cr(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[Cs]():null,!f){var m=o;m&&m[rt]>0&&(We(m,function(g){try{g.func[Fn](g.self,g.args)}catch(b){Gr(t[jo],2,73,"Unexpected Exception during onComplete - "+Xr(b))}}),o=[])}return f}function u(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var b;if(e){var y=e[xy];y&&f&&(b=y[f])}if(!b)b=m;else if(Ti(m)&&g!==0){var P=Ay(!0,m,b);e&&g===2&&Fr(m,function(A){if(Et(P[A])){var D=e[A];Et(D)||(P[A]=D)}}),b=P}return b}function c(f,m,g){g===void 0&&(g=!1);var b,y=u(f,null);return y&&!Et(y[m])?b=y[m]:e&&!Et(e[m])&&(b=e[m]),Et(b)?g:b}function d(f){for(var m;m=s._next();){var g=m[Jm]();g&&f(g)}}return s}function $o(r,e,t,n){var i=yF(r,e,t,n),o=i.ctx;function s(l){var u=i._next();return u&&u[Ho](l,o),!u}function a(l,u){return l===void 0&&(l=null),yt(l)&&(l=Cc(l,e,t,u)),$o(l||o[Cs](),e,t,u)}return o[Kr]=s,o[Bu]=a,o}function Xy(r,e,t){var n=e[_c]||{},i=yF(r,n,e,t),o=i.ctx;function s(l){var u=i._next();return u&&u.unload(o,l),!u}function a(l,u){return l===void 0&&(l=null),yt(l)&&(l=Cc(l,n,e,u)),Xy(l||o[Cs](),e,u)}return o[Kr]=s,o[Bu]=a,o}function UC(r,e,t){var n=e[_c]||{},i=yF(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(u){Ht(u[Gm])&&u[Gm](o,l)})}function a(l,u){return l===void 0&&(l=null),yt(l)&&(l=Cc(l,n,e,u)),UC(l||o[Cs](),e,u)}return o[Kr]=s,o[Bu]=a,o}function Cc(r,e,t,n){var i=null,o=!n;if(yt(r)&&r[rt]>0){var s=null;We(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&Ht(a[Ho])){var l=jce(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Cc([n],e,t):i}function jce(r,e,t){var n=null,i=Ht(r[Ho]),o=Ht(r[Op]),s;r?s=r[Ja]+"-"+r[oa]+"-"+k6++:s="Unknown-0-"+k6++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:c,unload:d,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&Ht(r[T6])&&(m=r[T6]()),m||(m=$o(a,e,t)),m}function u(m,g,b,y,P){var A=!1,D=r?r[Ja]:Wce,T=m[D6];return T||(T=m[D6]={}),m.setNext(n),r&&yn(m[sn](),function(){return D+":"+b},function(){T[s]=!0;try{var K=n?n._id:pt;K&&(T[K]=!1),A=g(m)}catch(B){var L=n?T[n._id]:!0;L&&(A=!0),(!n||!L)&&Gr(m[ia](),1,73,"Plugin ["+D+"] failed during "+b+" - "+Xr(B)+", run flags: "+Xr(T))}},y,P),A}function c(m,g){g=g||l();function b(y){if(!r||!i)return!1;var P=ed(r);return P[Es]||P[hC]?!1:(o&&r[Op](n),r[Ho](m,y),!0)}u(g,b,"processTelemetry",function(){return{item:m}},!m.sync)||g[Kr](m)}function d(m,g){function b(){var y=!1;if(r){var P=ed(r),A=r[sn]||P[sn];r&&(!A||A===m.core())&&!P[Es]&&(P[sn]=null,P[Es]=!0,P[_s]=!1,r[Es]&&r[Es](m,g)===!0&&(y=!0))}return y}u(m,b,"unload",function(){},g[Ga])||m[Kr](g)}function f(m,g){function b(){var y=!1;if(r){var P=ed(r),A=r[sn]||P[sn];r&&(!A||A===m.core())&&!P[Es]&&r[Gm]&&r[Gm](m,g)===!0&&(y=!0)}return y}u(m,b,"update",function(){},!1)||m[Kr](g)}return Jo(a)}var Wce,D6,T6,k6,bF,WC=he(()=>{"use strict";p();Cn();qp();la();xn();vi();PC();lk();Wce="TelemetryPluginChain",D6="_hasRun",T6="_getTelCtx",k6=0;bF=function(){function r(e,t,n,i){var o=this,s=$o(e,t,n,i);ih(o,s,Io(s))}return r}()});function N6(r,e,t){e&&yt(e)&&e[rt]>0&&(e=e.sort(function(n,i){return n[oa]-i[oa]}),We(e,function(n){n[oa]<VC&&Xn(Bce+n[Ja])}),r[Ot]({queue:Jo(e),chain:Cc(e,t[_c],t)}))}function R6(r,e){function t(){return $o(null,e[_c],e,null)}function n(u,c,d,f){var m=u?u[rt]+1:1;function g(){m--,m===0&&(f&&f(),f=null)}m>0&&We(u,function(b){if(b&&b.queue[rt]>0){var y=b.chain,P=c[Bu](y);P[cC](g),d(P)}else m--}),g()}function i(u,c){var d=c||{reason:0};return n(r,u,function(f){f[Kr](d)},function(){u[Kr](d)}),!0}function o(u,c){var d=c||{reason:0,isAsync:!1};return n(r,u,function(f){f[Kr](d)},function(){u[Kr](d),a=!1}),!0}function s(u){var c=null;return r&&r[rt]>0&&We(r,function(d){if(d&&d.queue[rt]>0&&(We(d.queue,function(f){if(f[Ja]===u)return c=f,-1}),c))return-1}),c}var a=!1,l={identifier:"ChannelControllerPlugin",priority:VC,initialize:function(u,c,d,f){a=!0,We(r,function(m){m&&m.queue[rt]>0&&sk($o(m.chain,u,c),d)})},isInitialized:function(){return a},processTelemetry:function(u,c){n(r,c||t(),function(d){d[Kr](u)},function(){c[Kr](u)})},update:i,pause:function(){n(r,t(),function(u){u.iterate(function(c){c.pause&&c.pause()})},null)},resume:function(){n(r,t(),function(u){u.iterate(function(c){c.resume&&c.resume()})},null)},teardown:o,getChannel:s,flush:function(u,c,d,f){var m=1,g=!1,b=null;f=f||5e3;function y(){m--,g&&m===0&&(b&&(clearTimeout(b),b=null),c&&c(g),c=null)}return n(r,t(),function(P){P.iterate(function(A){if(A[Sy]){m++;var D=!1;A[Sy](u,function(){D=!0,y()},d)||D||(u&&b==null?b=setTimeout(function(){b=null,y()},f):y())}})},function(){g=!0,y()}),!0},_setQueue:function(u){r=u}};return l}function A6(r,e,t){var n=[];if(r&&We(r,function(o){return N6(n,o,t)}),e){var i=[];We(e,function(o){o[oa]>VC&&i[Ot](o)}),N6(n,i,t)}return n}var VC,Bce,M6=he(()=>{p();Cn();xn();vi();WC();lk();VC=500,Bce="Channel has invalid priority - "});function mh(){var r=[];function e(n){n&&r[Ot](n)}function t(n,i){We(r,function(o){try{o(n,i)}catch(s){Gr(n[ia](),2,73,"Unexpected error calling unload handler - "+Xr(s))}}),r=[]}return{add:e,run:t}}var ck=he(()=>{p();Cn();qp();la();xn()});var Xp,hh,SF=he(()=>{"use strict";p();ur();Cn();xn();vi();WC();ck();Xp="getPlugin",hh=function(){function r(){var e=this,t,n,i,o,s;u(),He(r,e,function(c){c[qa]=function(d,f,m,g){l(d,f,g),t=!0},c[Es]=function(d,f){var m,g=c[sn];if(!g||d&&g!==d[sn]())return;var b,y=!1,P=d||Xy(null,g,i&&i[Xp]?i[Xp]():i),A=f||(m={reason:0},m[Ga]=!1,m);function D(){if(!y){y=!0,o.run(P,f);var T=s;s=[],We(T,function(K){K.rm()}),b===!0&&P[Kr](A),u()}}return!c[_y]||c[_y](P,A,D)!==!0?D():b=!0,b},c[Gm]=function(d,f){var m=c[sn];if(!m||d&&m!==d[sn]())return;var g,b=!1,y=d||UC(null,m,i&&i[Xp]?i[Xp]():i),P=f||{reason:0};function A(){b||(b=!0,l(y.getCfg(),y.core(),y[Cs]()))}return!c._doUpdate||c._doUpdate(y,P,A)!==!0?A():g=!0,g},c._addHook=function(d){d&&(yt(d)?s=s.concat(d):s[Ot](d))},Bp(c,"_addUnloadCb",function(){return o},"add")}),e[ia]=function(c){return a(c)[ia]()},e[_s]=function(){return t},e.setInitialized=function(c){t=c},e[Op]=function(c){i=c},e[Kr]=function(c,d){d?d[Kr](c):i&&Ht(i[Ho])&&i[Ho](c,null)},e._getTelCtx=a;function a(c){c===void 0&&(c=null);var d=c;if(!d){var f=n||$o(null,{},e[sn]);i&&i[Xp]?d=f[Bu](null,i[Xp]):d=f[Bu](null,i)}return d}function l(c,d,f){c&&Go(c,xy,[],null,Et),!f&&d&&(f=d[ET]()[Cs]());var m=i;i&&i[Xp]&&(m=i[Xp]()),e[sn]=d,n=$o(f,c,d,m)}function u(){t=!1,e[sn]=null,n=null,i=null,s=[],o=mh()}}return r.__ieDyn=1,r}()});var O6,L6=he(()=>{p();ir();ur();Cn();SF();qp();la();xn();vi();O6=function(r){vn(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),He(e,t,function(s,a){s.addTelemetryInitializer=function(l){var u={id:n++,fn:l};i[Ot](u);var c={remove:function(){We(i,function(d,f){if(d.id===u.id)return i[ju](f,1),-1})}};return c},s[Ho]=function(l,u){for(var c=!1,d=i[rt],f=0;f<d;++f){var m=i[f];if(m)try{if(m.fn[Cy](null,[l])===!1){c=!0;break}}catch(g){Gr(u[ia](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+nh(g),{exception:Xr(g)},!0)}}c||s[Kr](l,u)},s[_y]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(hh)});function Jce(r,e){return new xC(e)}function Gce(r,e,t){var n,i=[],o={};return We(t,function(s){(Et(s)||Et(s[qa]))&&Xn(W6);var a=s[oa],l=s[Ja];s&&a&&(Et(o[a])?o[a]=l:el(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[Ot](s)}),n={all:t},n[sn]=i,n}function U6(r,e){var t=!1;return We(e,function(n){if(n===r)return t=!0,-1}),t}function Yce(){var r;return bo((r={},r[Hm]=function(e){},r[qm]=function(e){},r[Py]=function(e){},r[Wp]=function(e,t){},r[Dy]=function(e,t){},r))}var W6,K6,F6,Hce,qce,gh,IF=he(()=>{"use strict";p();ir();ur();ir();Cn();M6();sF();NC();zK();qp();xn();vi();PC();WC();lk();L6();ck();W6="Plugins must provide initialize method",K6="_notificationManager",F6="SDK is still unloading...",Hce="SDK is not initialized",qce={loggingLevelConsole:1};gh=function(){function r(){var e,t,n,i,o,s,a,l,u,c,d,f,m,g,b,y,P,A,D,T,K=0;He(r,this,function(L){B(),L[_s]=function(){return t},L[qa]=function(q,$,de,pe){g&&Xn(F6),L[_s]()&&Xn("Core should not be initialized more than once"),e=q||{},L[_c]=e,Et(q[_T])&&Xn("Please provide instrumentation key"),i=pe,L[K6]=pe,Y(),Z(),ie(),de&&(L[jo]=de);var ye=jp(e,m8,[]);u=[],u[Ot].apply(u,jm(jm([],$,!1),ye,!1)),f=jp(e,vK,[]),O(null),(!m||m[rt]===0)&&Xn("No "+vK+" available"),t=!0,L.releaseQueue()},L.getTransmissionControls=function(){var q=[];return m&&We(m,function($){q[Ot]($.queue)}),Jo(q)},L.track=function(q){q.iKey=q.iKey||e[_T],q[Bm]=q[Bm]||sa(new Date),q.ver=q.ver||"4.0",!g&&L[_s]()?N()[Kr](q):n[Ot](q)},L[ET]=N,L[lC]=function(){return i||(i=Yce(),L[K6]=i),i},L[Hm]=function(q){i&&i[Hm](q)},L[qm]=function(q){i&&i[qm](q)},L.getCookieMgr=function(){return a||(a=zu(e,L[jo])),a},L.setCookieMgr=function(q){a=q},L[Qm]=function(){if(!o&&!s&&aa(e.enablePerfMgr)){var q=aa(e[yK]);Ht(q)&&(s=q(L,L[lC]()))}return o||s||tF()},L.setPerfMgr=function(q){o=q},L.eventCnt=function(){return n[rt]},L.releaseQueue=function(){if(t&&n[rt]>0){var q=n;n=[],We(q,function($){N()[Kr]($)})}},L.pollInternalLogs=function(q){y=q||null;var $=aa(e.diagnosticLogInterval);return(!$||!($>0))&&($=1e4),K&&clearInterval(K),K=setInterval(function(){k()},$),K},L[mK]=function(){K&&(clearInterval(K),K=0,k())},ih(L,function(){return b},["addTelemetryInitializer"]),L.unload=function(q,$,de){var pe;q===void 0&&(q=!0),t||Xn(Hce),g&&Xn(F6);var ye=(pe={reason:50},pe[Ga]=q,pe.flushComplete=!1,pe),z=Xy(v(),L);z[cC](function(){B(),$&&$(ye)},L);function fe(Ie){ye.flushComplete=Ie,g=!0,A.run(z,ye),L[mK](),z[Kr](ye)}H(q,fe,6,de)||fe(!1)},L[Jm]=h,L.addPlugin=function(q,$,de,pe){if(!q){pe&&pe(!1),be(W6);return}var ye=h(q[Ja]);if(ye&&!$){pe&&pe(!1),be("Plugin ["+q[Ja]+"] is already loaded!");return}var z={reason:16};function fe(Le){u[Ot](q),z.added=[q],O(z),pe&&pe(!0)}if(ye){var Ie=[ye.plugin],Te={reason:2,isAsync:!!de};C(Ie,Te,function(Le){Le?(z.removed=Ie,z.reason|=32,fe(!0)):pe&&pe(!1)})}else fe(!1)},L.evtNamespace=function(){return P},L[Sy]=H,L.getTraceCtx=function(q){return T||(T=P6()),T},L.setTraceCtx=function(q){T=q||null},Bp(L,"addUnloadCb",function(){return A},"add");function B(){t=!1,e=Ay(!0,{},qce),L[_c]=e,L[jo]=new Za(e),L[uC]=[],b=new O6,n=[],i=null,o=null,s=null,a=null,l=null,c=null,u=[],d=null,f=null,m=null,g=!1,y=null,P=rl("AIBaseCore",!0),A=mh(),T=null}function N(){return $o(v(),e,L)}function O(q){var $=Gce(L[jo],VC,u);c=$[sn],l=null;var de=$.all;if(m=Jo(A6(f,de,L)),d){var pe=zn(de,d);pe!==-1&&de[ju](pe,1),pe=zn(c,d),pe!==-1&&c[ju](pe,1),d._setQueue(m)}else d=R6(m,L);de[Ot](d),c[Ot](d),L[uC]=ak(de),d[qa](e,L,de),sk(N(),de),L[uC]=Jo(ak(c||[])).slice(),q&&ce(q)}function h(q){var $,de=null,pe=null;return We(L[uC],function(ye){if(ye[Ja]===q&&ye!==d&&ye!==b)return pe=ye,-1}),!pe&&d&&(pe=d.getChannel(q)),pe&&(de=($={plugin:pe},$[dC]=function(ye){ed(pe)[hC]=!ye},$.isEnabled=function(){var ye=ed(pe);return!ye[Es]&&!ye[hC]},$.remove=function(ye,z){var fe;ye===void 0&&(ye=!0);var Ie=[pe],Te=(fe={reason:1},fe[Ga]=ye,fe);C(Ie,Te,function(Le){Le&&O({reason:32,removed:Ie}),z&&z(Le)})},$)),de}function v(){if(!l){var q=(c||[]).slice();zn(q,b)===-1&&q[Ot](b),l=Cc(ak(q),e,L)}return l}function C(q,$,de){if(q&&q[rt]>0){var pe=Cc(q,e,L),ye=Xy(pe,L);ye[cC](function(){var z=!1,fe=[];We(u,function(Te,Le){U6(Te,q)?z=!0:fe[Ot](Te)}),u=fe;var Ie=[];f&&(We(f,function(Te,Le){var $e=[];We(Te,function(Ge){U6(Ge,q)?z=!0:$e[Ot](Ge)}),Ie[Ot]($e)}),f=Ie),de&&de(z)}),ye[Kr]($)}else de(!1)}function k(){var q=L[jo]?L[jo].queue:[];q&&(We(q,function($){var de,pe=(de={},de[Di]=y||"InternalMessageId: "+$[Iy],de.iKey=aa(e[_T]),de.time=sa(new Date),de.baseType=ch.dataType,de.baseData={message:$[Mp]},de);L.track(pe)}),q[rt]=0)}function H(q,$,de,pe){return d?d[Sy](q,$,de||6,pe):($&&$(!1),!0)}function Y(){var q=aa(e.disableDbgExt);q===!0&&D&&(i[qm](D),D=null),i&&!D&&q!==!0&&(D=B8(e),i[Hm](D))}function Z(){var q=aa(e.enablePerfMgr);!q&&s&&(s=null),q&&jp(e,yK,Jce)}function ie(){var q=jp(e,xy,{});q.NotificationManager=i}function ce(q){var $=UC(v(),L);(!L._updateHook||L._updateHook($,q)!==!0)&&$[Kr](q)}function be(q){var $=L[jo];$?Gr($,2,73,q):Xn(q)}})}return r.__ieDyn=1,r}()});function uk(r,e,t,n){We(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var jC,_F=he(()=>{p();ur();Cn();xn();vi();jC=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;He(r,this,function(n){n[Hm]=function(i){n.listeners[Ot](i)},n[qm]=function(i){for(var o=zn(n[Ym],i);o>-1;)n.listeners[ju](o,1),o=zn(n[Ym],i)},n[Py]=function(i){uk(n[Ym],Py,!0,function(o){o[Py](i)})},n[Wp]=function(i,o){uk(n[Ym],Wp,!0,function(s){s[Wp](i,o)})},n[Dy]=function(i,o){uk(n[Ym],Dy,o,function(s){s[Dy](i,o)})},n[Vp]=function(i){i&&(t||!i[fC]())&&uk(n[Ym],Vp,!1,function(o){i[Ga]?setTimeout(function(){return o[Vp](i)},0):o[Vp](i)})}})}return r.__ieDyn=1,r}()});var BC,V6=he(()=>{p();ir();ur();Cn();IF();qp();xn();vi();_F();PC();BC=function(r){vn(e,r);function e(){var t=r.call(this)||this;return He(e,t,function(n,i){n[qa]=function(a,l,u,c){i[qa](a,l,u||new Za(a),c||new jC(a))},n.track=function(a){yn(n[Qm](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),Xn("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){Et(a[Di])&&(s(a),Xn("telemetry name required"))}function s(a){var l=n[lC]();l&&l[Wp]([a],2)}}),t}return e.__ieDyn=1,e}(gh)});var Ae,xr,vh,il,j6,B6,dk,EF,HC,pk,Zy,ol,Zp,td,qC,H6,CF,JC,q6=he(()=>{p();NT();xr="Failed",vh=xr+"MonitorAjax",il="Track",j6="Start",B6="Stop",dk="Event",EF="AuthContext",HC="Exception",pk="Local",Zy="Session",ol="Storage",Zp="Browser",td="Cannot",qC="Buffer",H6="InstrumentationKey",CF=_o({CRITICAL:1,WARNING:2}),JC=_o((Ae={},Ae[Zp+"DoesNotSupport"+pk+ol]=0,Ae[Zp+td+"Read"+pk+ol]=1,Ae[Zp+td+"Read"+Zy+ol]=2,Ae[Zp+td+"Write"+pk+ol]=3,Ae[Zp+td+"Write"+Zy+ol]=4,Ae[Zp+xr+"RemovalFrom"+pk+ol]=5,Ae[Zp+xr+"RemovalFrom"+Zy+ol]=6,Ae[td+"SendEmptyTelemetry"]=7,Ae.ClientPerformanceMathError=8,Ae["ErrorParsingAI"+Zy+"Cookie"]=9,Ae.ErrorPVCalc=10,Ae[HC+"WhileLoggingError"]=11,Ae[xr+"AddingTelemetryTo"+qC]=12,Ae[vh+"Abort"]=13,Ae[vh+"Dur"]=14,Ae[vh+"Open"]=15,Ae[vh+"RSC"]=16,Ae[vh+"Send"]=17,Ae[vh+"GetCorrelationHeader"]=18,Ae[xr+"ToAddHandlerForOnBeforeUnload"]=19,Ae[xr+"ToSendQueuedTelemetry"]=20,Ae[xr+"ToReportDataLoss"]=21,Ae["Flush"+xr]=22,Ae.MessageLimitPerPVExceeded=23,Ae.MissingRequiredFieldSpecification=24,Ae.NavigationTimingNotSupported=25,Ae.OnError=26,Ae[Zy+"RenewalDateIsZero"]=27,Ae.SenderNotInitialized=28,Ae[j6+il+dk+xr]=29,Ae[B6+il+dk+xr]=30,Ae[j6+il+xr]=31,Ae[B6+il+xr]=32,Ae.TelemetrySampledAndNotSent=33,Ae[il+dk+xr]=34,Ae[il+HC+xr]=35,Ae[il+"Metric"+xr]=36,Ae[il+"PV"+xr]=37,Ae[il+"PV"+xr+"Calc"]=38,Ae[il+"Trace"+xr]=39,Ae["Transmission"+xr]=40,Ae[xr+"ToSet"+ol+qC]=41,Ae[xr+"ToRestore"+ol+qC]=42,Ae.InvalidBackendResponse=43,Ae[xr+"ToFixDepricatedValues"]=44,Ae.InvalidDurationValue=45,Ae.TelemetryEnvelopeInvalid=46,Ae.CreateEnvelopeError=47,Ae[td+"SerializeObject"]=48,Ae[td+"SerializeObjectNonSerializable"]=49,Ae.CircularReferenceDetected=50,Ae["Clear"+EF+xr]=51,Ae[HC+"Truncated"]=52,Ae.IllegalCharsInName=53,Ae.ItemNotInArray=54,Ae.MaxAjaxPerPVExceeded=55,Ae.MessageTruncated=56,Ae.NameTooLong=57,Ae.SampleRateOutOfRange=58,Ae["Set"+EF+xr]=59,Ae["Set"+EF+xr+"AccountName"]=60,Ae.StringValueTooLong=61,Ae.StartCalledMoreThanOnce=62,Ae.StopCalledWithoutStart=63,Ae["TelemetryInitializer"+xr]=64,Ae.TrackArgumentsNotSpecified=65,Ae.UrlTooLong=66,Ae[Zy+ol+qC+"Full"]=67,Ae[td+"AccessCookie"]=68,Ae.IdTooLong=69,Ae.InvalidEvent=70,Ae[vh+"SetRequestHeader"]=71,Ae["Send"+Zp+"InfoOnUserInit"]=72,Ae["Plugin"+HC]=73,Ae["Notification"+HC]=74,Ae.SnippetScriptLoadFailure=99,Ae["Invalid"+H6]=100,Ae[td+"ParseAiBlobValue"]=101,Ae.InvalidContentBlob=102,Ae[il+"PageAction"+dk+xr]=103,Ae[xr+"AddingCustomDefinedRequestContext"]=104,Ae["InMemory"+ol+qC+"Full"]=105,Ae[H6+"Deprecation"]=106,Ae))});var rd=he(()=>{p();f8();T8();V6();IF();SF();GT();uF();xn();NT();lF();la();ir();_F();PC();qp();WC();q6();sF();NC();ck();vF()});var J6,G6,Y6,$6,z6,Q6,X6=he(()=>{p();ir();rd();J6=_o({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32}),G6=_o({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),Y6=_o({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),$6=_o({Normal:1,Critical:2}),z6=_o({NONE:0,ERROR:1,WARNING:2,INFORMATION:3}),Q6=Jo(So(So({},JC),_o({AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520})))});var sl,fk,$ce,pLe,wF,mk,GC=he(()=>{p();sl="",fk="https://browser.events.data.microsoft.com/OneCollector/1.0/",$ce="pluginVersionString",pLe=$ce+"Arr",wF="version",mk="properties"});function Un(r){return!(r===sl||Et(r))}function $C(r){if(r){var e=r.indexOf("-");if(e>-1)return r.substring(0,e)}return sl}function DF(){return xF===null&&(xF=!cr(Uint8Array)&&!eue()&&!$u()),xF}function zC(r){return!!(r&&qo(r)&&r>=1&&r<=4)}function QC(r,e,t){if(!e&&!Un(e)||typeof r!="string")return null;var n=typeof e;if(n==="string"||n==="number"||n==="boolean"||yt(e))e={value:e};else if(n==="object"&&!nr.call(e,"value"))e={value:t?JSON.stringify(e):e};else if(Et(e.value)||e.value===sl||!an(e.value)&&!qo(e.value)&&!qu(e.value)&&!yt(e.value))return null;if(yt(e.value)&&!gk(e.value))return null;if(!Et(e.kind)){if(yt(e.value)||!eb(e.kind))return null;e.value=e.value.toString()}return e}function XC(r,e,t){var n=-1;if(!cr(r))if(e>0&&(e===32?n=8192:e<=13&&(n=e<<5)),Zce(t))n===-1&&(n=0),n|=t;else{var i=Xce[al(r)]||-1;n!==-1&&i!==-1?n|=i:i===6&&(n=i)}return n}function TF(){$p(null).setEnabled(!1)}function kF(r,e,t){nl(null)&&$p(null).set(r,e,t*86400,null,"/")}function NF(r){nl(null)&&$p(null).del(r)}function RF(r){return nl(null)?AF($p(null),r):sl}function AF(r,e,t){t===void 0&&(t=!0);var n;return r&&(n=r.get(e),t&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||sl}function MF(r){r===void 0&&(r="D");var e=Yy();return r==="B"?e="{"+e+"}":r==="P"?e="("+e+")":r==="N"&&(e=e.replace(/-/g,sl)),e}function ef(r,e,t,n,i){var o={},s=!1,a=0,l=arguments.length,u=Object[Mt],c=arguments;for(u.toString.call(c[0])==="[object Boolean]"&&(s=c[0],a++);a<l;a++){var r=c[a];Fr(r,function(f,m){s&&m&&Ti(m)?yt(m)?(o[f]=o[f]||[],We(m,function(g,b){g&&Ti(g)?o[f][b]=ef(!0,o[f][b],g):o[f][b]=g})):o[f]=ef(!0,o[f],m):o[f]=m})}return o}function eb(r){return r===0||r>0&&r<=13||r===32}function Zce(r){return r>=0&&r<=9}function eue(){var r=xs();if(!cr(r)&&r.userAgent){var e=r.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}function gk(r){return r.length>0}function yh(r,e){var t=r;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[e]=Eo()}function al(r){var e=0;if(r!=null){var t=typeof r;t==="string"?e=1:t==="number"?e=2:t==="boolean"?e=3:t===dt&&(e=4,yt(r)?(e=4096,r.length>0&&(e|=al(r[0]))):nr.call(r,"value")&&(e=8192|al(r.value)))}return e}function vk(){return!!ln("chrome")}function yk(r,e,t,n,i,o){n===void 0&&(n=!1),i===void 0&&(i=!1);function s(l,u,c){try{l[u]=c}catch(d){}}var a=new XMLHttpRequest;return n&&s(a,zce,n),t&&s(a,Z6,t),a.open(r,e,!i),t&&s(a,Z6,t),!i&&o&&s(a,Qce,o),a}var nd,hk,id,zce,Z6,Qce,Xce,xF,YC,PF,Eo,e5,t5,ZC=he(()=>{p();rd();ir();GC();hk="3.2.9",id="1DS-Web-JS-"+hk,zce="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Z6="withCredentials",Qce="timeout",Xce=(nd={},nd[0]=0,nd[2]=6,nd[1]=1,nd[3]=7,nd[4098]=6,nd[4097]=1,nd[4099]=7,nd),xF=null,YC=!!Yo(),PF=!!Ec();Eo=$y;e5={Version:hk,FullVersionString:id,strUndefined:Yt,strObject:dt,Undefined:Yt,arrForEach:We,arrIndexOf:zn,arrMap:th,arrReduce:rh,objKeys:Io,toISOString:sa,isReactNative:$u,isString:an,isNumber:qo,isBoolean:qu,isFunction:Ht,isArray:yt,isObject:Ti,strTrim:Ur,isDocumentObjectAvailable:YC,isWindowObjectAvailable:PF,isValueAssigned:Un,getTenantId:$C,isBeaconsSupported:Hp,isUint8ArrayAvailable:DF,isLatency:zC,sanitizeProperty:QC,getISOString:sa,useXDomainRequest:lh,getCommonSchemaMetaData:XC,cookieAvailable:nl,disallowsSameSiteNone:jy,setCookie:kF,deleteCookie:NF,getCookie:RF,createGuid:MF,extend:ef,getTime:Eo,isValueKind:eb,isArrayValid:gk,objDefineAccessors:ws,addPageUnloadEventListener:fh,setProcessTelemetryTimings:yh,addEventHandler:Qp,getFieldValueType:al,strEndsWith:Zm,objForEachKey:Fr},t5={_canUseCookies:void 0,isTypeof:Ty,isUndefined:cr,isNullOrUndefined:Et,hasOwnProperty:Hu,isFunction:Ht,isObject:Ti,isDate:Ny,isArray:yt,isError:eh,isString:an,isNumber:qo,isBoolean:qu,toISOString:sa,arrForEach:We,arrIndexOf:zn,arrMap:th,arrReduce:rh,strTrim:Ur,objCreate:bo,objKeys:Io,objDefineAccessors:ws,addEventHandler:Qp,dateNow:Qn,isIE:Xa,disableCookies:TF,newGuid:Yy,perfNow:$y,newId:Gp,randomValue:Vy,random32:tl,mwcRandomSeed:JT,mwcRandom32:kC,generateW3CId:Xu}});var tue,r5,n5=he(()=>{p();ir();ur();rd();GC();ZC();tue=function(r){vn(e,r);function e(){var t=r.call(this)||this;return t.pluginVersionStringArr=[],He(e,t,function(n,i){(!n.logger||!n.logger.queue)&&(n.logger=new Za({loggingLevelConsole:1})),n.initialize=function(o,s,a,l){yn(n,function(){return"AppInsightsCore.initialize"},function(){var u=n.pluginVersionStringArr;if(o){o.endpointUrl||(o.endpointUrl=fk);var c=o.propertyStorageOverride;c&&(!c.getProperty||!c.setProperty)&&Xn("Invalid property storage override passed."),o.channels&&We(o.channels,function(m){m&&We(m,function(g){if(g.identifier&&g.version){var b=g.identifier+"="+g.version;u.push(b)}})})}n.getWParam=function(){return typeof document!="undefined"||o.enableWParam?0:-1},s&&We(s,function(m){if(m&&m.identifier&&m.version){var g=m.identifier+"="+m.version;u.push(g)}}),n.pluginVersionString=u.join(";"),n.pluginVersionStringArr=u;try{i.initialize(o,s,a,l),n.pollInternalLogs("InternalLog")}catch(m){var d=n.logger,f=Xr(m);f.indexOf("channels")!==-1&&(f+=`
 - Channels must be provided through config.channels only!`),Gr(d,1,514,"SDK Initialization Failed - no telemetry will be sent: "+f)}},function(){return{config:o,extensions:s,logger:a,notificationManager:l}})},n.track=function(o){yn(n,function(){return"AppInsightsCore.track"},function(){var s=o;if(s){s.timings=s.timings||{},s.timings.trackStart=Eo(),zC(s.latency)||(s.latency=1);var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=id;var l=s.baseData=s.baseData||{};l[mk]=l[mk]||{};var u=l[mk];u[wF]=u[wF]||n.pluginVersionString||sl}i.track(s)},function(){return{item:o}},!o.sync)}}),t}return e.__ieDyn=1,e}(BC),r5=tue});var rue,i5,o5=he(()=>{p();ir();ur();rd();GC();ZC();rue=function(r){vn(e,r);function e(){var t=r.call(this)||this;return He(e,t,function(n,i){n.initialize=function(o,s,a,l){o&&!o.endpointUrl&&(o.endpointUrl=fk),n.getWParam=function(){return YC||o.enableWParam?0:-1};try{i.initialize(o,s,a,l)}catch(u){Gr(n.logger,1,514,"Initialization Failed: "+Xr(u)+`
 - Note: Channels must be provided through config.channels only`)}},n.track=function(o){var s=o;if(s){var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=id}i.track(s)}}),t}return e.__ieDyn=1,e}(gh),i5=rue});function nue(r,e,t){return function(n){r[e]=n,t()}}var bh,iue,tf,OF=he(()=>{p();ur();rd();bh=Ht;iue=function(){function r(e){var t=0,n=null,i=[];He(r,this,function(u){u.then=function(c,d){return new r(function(f,m){o(c,d,f,m)})},u.catch=function(c){return u.then(null,c)}});function o(u,c,d,f){i.push(function(){var m;try{t===1?m=bh(u)?u(n):n:m=bh(c)?c(n):n,m instanceof r?m.then(d,f):t===2&&!bh(c)?f(m):d(m)}catch(g){f(g);return}}),t!==0&&s()}function s(){if(i.length>0){var u=i.slice();i=[],setTimeout(function(){for(var c=0,d=u.length;c<d;++c)try{u[c]()}catch(f){}},0)}}function a(u){t===0&&(n=u,t=1,s())}function l(u){t===0&&(n=u,t=2,s())}(function(){if(!bh(e))throw new TypeError("ESPromise: resolvedFunc argument is not a Function");try{e(a,l)}catch(c){l(c)}})()}return r.resolve=function(e){return e instanceof r?e:e&&bh(e.then)?new r(function(t,n){try{e.then(t,n)}catch(i){n(i)}}):new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.all=function(e){if(!(!e||!e.length))return new r(function(t,n){try{for(var i=[],o=0,s=0;s<e.length;s++){var a=e[s];a&&bh(a.then)?(o++,a.then(nue(i,s,function(){--o===0&&t(i)}),n)):i[s]=a}o===0&&setTimeout(function(){t(i)},0)}catch(l){n(l)}})},r.race=function(e){return new r(function(t,n){if(!(!e||!e.length))try{for(var i=function(s){var a=e[s];a&&bh(a.then)?a.then(t,n):setTimeout(function(){t(a)},0)},o=0;o<e.length;o++)i(o)}catch(s){n(s)}})},r}(),tf=iue});function tb(){return new Date().getTime()}var oue,s5,ew,Sh,LF,sue,a5,l5=he(()=>{p();ur();OF();rd();oue=6e5,s5=0,ew=[],Sh=[],LF=[];sue=function(){function r(e,t){var n=0,i=(e||"<unnamed>")+"."+s5;s5++,He(r,this,function(a){var l=null,u=0;a.scheduleEvent=function(d,f,m){var g=i+"."+u;u++,f&&(g+="-("+f+")");var b=g+"{"+n+"}";n++;var y={evt:null,tm:tb(),id:b,isRunning:!1,isAborted:!1};return l?y.evt=B(y,l):y.evt=L(y),l=y,l.evt._schId=b,y.evt;function P(N){for(var O=tb(),h=O-oue,v=N.length,C=0;C<v;){var k=N[C];if(k&&k.tm<h){var H=null;k.abort?(H="Aborting ["+k.id+"] due to Excessive runtime ("+(O-k.tm)+" ms)",k.abort(H)):H="Removing ["+k.id+"] due to Excessive runtime ("+(O-k.tm)+" ms)",s(H),N.splice(C,1),v--}else C++}}function A(N,O){var h=!1,v=c(ew,N);if(v||(v=c(LF,N),h=!0),v){v.to&&(clearTimeout(v.to),v.to=null);var C=tb()-v.tm;O?h?s("Timed out event ["+N+"] finally complete -- "+C+" ms"):o("Promise ["+N+"] Complete -- "+C+" ms"):(LF.push(v),s("Event ["+N+"] Timed out and removed -- "+C+" ms"))}else o("Failed to remove ["+N+"] from running queue");l&&l.id===N&&(l=null),P(ew),P(Sh),P(LF)}function D(N,O){return function(h){return A(N,!0),O&&O(h),h}}function T(N,O,h,v){O.then(function(C){return C instanceof tf?(o("Event ["+N+"] returned a promise -- waiting"),T(N,C,h,v),C):D(N,h)(C)},D(N,v))}function K(N,O){var h=N.id;return new tf(function(v,C){o("Event ["+h+"] Starting -- waited for "+(N.wTm||"--")+" ms"),N.isRunning=!0,N.abort=function(H){N.abort=null,N.isAborted=!0,A(h,!1),C(new Error(H))};var k=O(h);k instanceof tf?(m&&(N.to=setTimeout(function(){A(h,!1),C(new Error("Timed out after ["+m+"] ms"))},m)),T(h,k,function(H){o("Event ["+h+"] Resolving after "+(tb()-N.tm)+" ms"),v(H)},C)):(o("Promise ["+h+"] Auto completed as the start action did not return a promise"),v())})}function L(N){var O=tb();return N.wTm=O-N.tm,N.tm=O,N.isAborted?tf.reject(new Error("["+g+"] was aborted")):(ew.push(N),K(N,d))}function B(N,O){var h=new tf(function(v,C){var k=tb()-O.tm,H=O.id;o("["+g+"] is waiting for ["+H+":"+k+" ms] to complete before starting -- ["+Sh.length+"] waiting and ["+ew.length+"] running"),N.abort=function(Y){N.abort=null,c(Sh,g),N.isAborted=!0,C(new Error(Y))},O.evt.then(function(Y){c(Sh,g),L(N).then(v,C)},function(Y){c(Sh,g),L(N).then(v,C)})});return Sh.push(N),h}};function c(d,f){for(var m=0;m<d.length;m++)if(d[m].id===f)return d.splice(m,1)[0];return null}});function o(a){var l=Kn();l&&l.QUnit&&console&&console.log("ESPromiseScheduler["+i+"] "+a)}function s(a){el(t,"ESPromiseScheduler["+i+"] "+a)}}return r.incomplete=function(){return ew},r.waitingToStart=function(){return Sh},r}(),a5=sue});var c5,u5=he(()=>{p();rd();GC();ZC();c5=function(){function r(e){var t=this,n={},i=[],o=[];e&&o.push(e);function s(c,d){var f,m=n[c];if(m&&(f=m[d]),!f&&f!==null){if(an(c)&&an(d))if(o.length>0){for(var g=0;g<o.length;g++)if(o[g].handleField(c,d)){f={canHandle:!0,fieldHandler:o[g]};break}}else i.length===0&&(f={canHandle:!0});if(!f&&f!==null){f=null;for(var g=0;g<i.length;g++)if(i[g].handleField(c,d)){f={canHandle:!0,handler:i[g],fieldHandler:null};break}}m||(m=n[c]={}),m[d]=f}return f}t.addSanitizer=function(c){c&&(i.push(c),n={})},t.addFieldSanitizer=function(c){c&&(o.push(c),n={})},t.handleField=function(c,d){var f=s(c,d);return f?f.canHandle:!1},t.value=function(c,d,f,m){var g=s(c,d);if(g&&g.canHandle){if(!g||!g.canHandle)return null;if(g.handler)return g.handler.value(c,d,f,m);if(!an(d)||Et(f)||f===sl)return null;var b=null,y=al(f);if((y&8192)===8192){var P=y&-8193;if(b=f,!Un(b.value)||P!==1&&P!==2&&P!==3&&(P&4096)!==4096)return null}else y===1||y===2||y===3||(y&4096)===4096?b=l(c,d,f):y===4&&(b=l(c,d,m?JSON.stringify(f):f));if(b)return a(g,c,d,y,b,m)}return null},t.property=function(c,d,f,m){var g=s(c,d);if(!g||!g.canHandle||!an(d)||Et(f)||!Un(f.value))return null;var b=al(f.value);return b===0?null:a(g,c,d,b,f,m)};function a(c,d,f,m,g,b){if(c.handler)return c.handler.property(d,f,g,b);if(!Et(g.kind)){if((m&4096)===4096||!eb(g.kind))return null;g.value=g.value.toString()}return u(c.fieldHandler,d,f,m,g)}function l(c,d,f){return Un(f)?{value:f}:null}function u(c,d,f,m,g){if(g&&c){var b=c.getSanitizer(d,f,m,g.kind,g.propertyType);if(b)if(m===4){var y={},P=g.value;Fr(P,function(D,T){var K=d+"."+f;if(Un(T)){var L=l(K,D,T);L=u(c,K,D,al(T),L),L&&(y[D]=L.value)}}),g.value=y}else{var A={path:d,name:f,type:m,prop:g,sanitizer:t};g=b.call(t,A)}}return g}}return r.getFieldType=al,r}()});var d5={};Kv(d5,{AppInsightsCore:()=>r5,BaseCore:()=>i5,BaseTelemetryPlugin:()=>hh,CoreUtils:()=>t5,DiagnosticLogger:()=>Za,ESPromise:()=>tf,ESPromiseScheduler:()=>a5,EventHelper:()=>cF,EventLatency:()=>G6,EventPersistence:()=>$6,EventPropertyType:()=>Y6,EventsDiscardedReason:()=>Qa,FullVersionString:()=>id,InternalAppInsightsCore:()=>BC,InternalBaseCore:()=>gh,LoggingSeverity:()=>CF,MinChannelPriorty:()=>fK,NotificationManager:()=>jC,PerfEvent:()=>uh,PerfManager:()=>xC,ProcessTelemetryContext:()=>bF,TraceLevel:()=>z6,Undefined:()=>Yt,Utils:()=>e5,ValueKind:()=>J6,ValueSanitizer:()=>c5,Version:()=>hk,_ExtendedInternalMessageId:()=>Q6,_InternalLogMessage:()=>ch,_InternalMessageId:()=>JC,__getRegisteredEvents:()=>aF,_logInternalMessage:()=>XK,_throwInternal:()=>Gr,_warnToConsole:()=>el,addEventHandler:()=>Qp,addEventListeners:()=>rk,addPageHideEventListener:()=>Jy,addPageShowEventListener:()=>Gy,addPageUnloadEventListener:()=>fh,areCookiesSupported:()=>nl,arrForEach:()=>We,arrIndexOf:()=>zn,arrMap:()=>th,arrReduce:()=>rh,attachEvent:()=>Hy,cookieAvailable:()=>nl,createCookieMgr:()=>zu,createEnumStyle:()=>_o,createGuid:()=>MF,createProcessTelemetryContext:()=>$o,createTraceParent:()=>fF,createUniqueNamespace:()=>rl,createUnloadHandlerContainer:()=>mh,dateNow:()=>Qn,deleteCookie:()=>NF,detachEvent:()=>qy,disableCookies:()=>TF,disallowsSameSiteNone:()=>jy,doPerf:()=>yn,dumpObj:()=>Xr,eventOff:()=>ph,eventOn:()=>dh,extend:()=>ef,findW3cTraceParent:()=>gF,formatTraceParent:()=>hF,generateW3CId:()=>Xu,getCommonSchemaMetaData:()=>XC,getConsole:()=>IC,getCookie:()=>RF,getCookieValue:()=>AF,getCrypto:()=>_C,getDocument:()=>Yo,getExceptionName:()=>nh,getFieldValueType:()=>al,getGlobal:()=>Kn,getGlobalInst:()=>ln,getHistory:()=>HK,getIEVersion:()=>qK,getISOString:()=>sa,getJSON:()=>Ky,getLocation:()=>sh,getMsCrypto:()=>EC,getNavigator:()=>xs,getPerformance:()=>Ly,getSetValue:()=>jp,getTenantId:()=>$C,getTime:()=>Eo,getWindow:()=>Ec,hasDocument:()=>jT,hasHistory:()=>BT,hasJSON:()=>ah,hasNavigator:()=>SC,hasOwnProperty:()=>Hu,hasWindow:()=>bC,isArray:()=>yt,isArrayValid:()=>gk,isBeaconsSupported:()=>Hp,isBoolean:()=>qu,isChromium:()=>vk,isDate:()=>Ny,isDocumentObjectAvailable:()=>YC,isError:()=>eh,isFetchSupported:()=>Fy,isFunction:()=>Ht,isIE:()=>Xa,isLatency:()=>zC,isNotTruthy:()=>PK,isNullOrUndefined:()=>Et,isNumber:()=>qo,isObject:()=>Ti,isReactNative:()=>$u,isSampledFlag:()=>mF,isString:()=>an,isTruthy:()=>Ry,isTypeof:()=>Ty,isUint8ArrayAvailable:()=>DF,isUndefined:()=>cr,isValidSpanId:()=>Qy,isValidTraceId:()=>zy,isValidTraceParent:()=>ok,isValueAssigned:()=>Un,isValueKind:()=>eb,isWindowObjectAvailable:()=>PF,isXhrSupported:()=>Uy,mergeEvtNamespace:()=>Qu,newGuid:()=>Yy,newId:()=>Gp,normalizeJsName:()=>Xm,objCreate:()=>bo,objDefineAccessors:()=>ws,objForEachKey:()=>Fr,objFreeze:()=>Jo,objKeys:()=>Io,objSeal:()=>xK,openXhr:()=>yk,optimizeObject:()=>Ju,parseTraceParent:()=>FC,perfNow:()=>$y,proxyAssign:()=>DK,proxyFunctionAs:()=>Bp,proxyFunctions:()=>ih,random32:()=>tl,randomValue:()=>Vy,removeEventHandler:()=>tk,removeEventListeners:()=>zp,removePageHideEventListener:()=>LC,removePageShowEventListener:()=>KC,removePageUnloadEventListener:()=>OC,safeGetCookieMgr:()=>$p,safeGetLogger:()=>CC,sanitizeProperty:()=>QC,setCookie:()=>kF,setEnableEnvMocks:()=>BK,setProcessTelemetryTimings:()=>yh,setValue:()=>Go,strContains:()=>wn,strEndsWith:()=>Zm,strFunction:()=>Qr,strObject:()=>dt,strPrototype:()=>Mt,strStartsWith:()=>ky,strTrim:()=>Ur,strUndefined:()=>Yt,throwError:()=>Xn,toISOString:()=>sa,useXDomainRequest:()=>lh});var Ih=he(()=>{p();X6();n5();o5();OF();l5();u5();rd();ZC()});var _h,bk,Sk,KF=he(()=>{p();_h="REAL_TIME",bk="NEAR_REAL_TIME",Sk="BEST_EFFORT"});var ll,Ik,p5,_k,f5,FF,m5,h5,g5,UF,WF,Ek,v5,VF,y5,jF,Ck,BF,wk,xk,Pk,tw,HF,b5,rb,qF,Dk,rw=he(()=>{p();ll="",Ik="POST",p5="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",_k="drop",f5="send",FF="requeue",m5="rspFail",h5="oth",g5="no-cache, no-store",UF="application/x-json-stream",WF="cache-control",Ek="content-type",v5="kill-tokens",VF="kill-duration",y5="kill-duration-seconds",jF="time-delta-millis",Ck="client-version",BF="client-id",wk="time-delta-to-apply-millis",xk="upload-time",Pk="apikey",tw="AuthMsaDeviceTicket",HF="AuthXToken",b5="NoResponseBody",rb="msfpc",qF="trace",Dk="user"});function I5(r){var e=(r.ext||{}).intweb;return e&&Un(e[rb])?e[rb]:null}function S5(r){for(var e=null,t=0;e===null&&t<r.length;t++)e=I5(r[t]);return e}var nb,JF=he(()=>{p();Ih();rw();nb=function(){function r(e,t){var n=t?[].concat(t):[],i=this,o=S5(n);i.iKey=function(){return e},i.Msfpc=function(){return o||ll},i.count=function(){return n.length},i.events=function(){return n},i.addEvent=function(s){return s?(n.push(s),o||(o=I5(s)),!0):!1},i.split=function(s,a){var l;if(s<n.length){var u=n.length-s;Et(a)||(u=a<u?a:u),l=n.splice(s,u),o=S5(n)}return new r(e,l)}}return r.create=function(e,t){return new r(e,t)},r}()});var aue,_5,E5=he(()=>{p();ur();aue=function(){function r(){var e=!0,t=!0,n=!0,i="use-collector-delta",o=!1;He(r,this,function(s){s.allowRequestSending=function(){return e},s.firstRequestSent=function(){n&&(n=!1,o||(e=!1))},s.shouldAddClockSkewHeaders=function(){return t},s.getClockSkewHeaderValue=function(){return i},s.setClockSkew=function(a){o||(a?(i=a,t=!0,o=!0):t=!1,e=!0)}})}return r.__ieDyn=1,r}(),_5=aue});var lue,cue,C5,w5=he(()=>{p();ur();Ih();lue=1e3,cue=function(){function r(){var e={};function t(n){var i=[];return n&&We(n,function(o){i.push(Ur(o))}),i}He(r,this,function(n){n.setKillSwitchTenants=function(i,o){if(i&&o)try{var s=t(i.split(","));if(o==="this-request-only")return s;for(var a=parseInt(o,10)*lue,l=0;l<s.length;++l)e[s[l]]=Qn()+a}catch(u){return[]}return[]},n.isTenantKilled=function(i){var o=e,s=Ur(i);return o[s]!==void 0&&o[s]>Qn()?!0:(delete o[s],!1)}})}return r.__ieDyn=1,r}(),C5=cue});function P5(r){return!(r>=300&&r<500&&r!=408&&r!=429||r==501||r==505)}function Tk(r){var e=0,t=x5*uue,n=x5*due,i=Math.floor(Math.random()*(n-t))+t;return e=Math.pow(2,r)*i,Math.min(e,pue)}var uue,due,x5,pue,GF=he(()=>{p();uue=.8,due=1.2,x5=3e3,pue=6e5});function T5(r,e,t,n){if(n&&r){var i=XC(n.value,n.kind,n.propertyType);if(i>-1){var o=r[D5];o||(o=r[D5]={f:{}});var s=o[kk];if(s||(s=o[kk]={}),e)for(var a=0;a<e.length;a++){var l=e[a];s[l]||(s[l]={f:{}});var u=s[l][kk];u||(u=s[l][kk]={}),s=u}s=s[t]={},yt(n.value)?s.a={t:i}:s.t=i}}}var fue,mue,k5,N5,hue,D5,kk,gue,R5,A5=he(()=>{p();ur();Ih();JF();rw();fue=20,mue=3984588,k5=65e3,N5=2e6,hue=Math.min(N5,k5),D5="metadata",kk="f",gue=/\./,R5=function(){function r(e,t,n,i){var o="data",s="baseData",a="ext",l=!!i,u=!0,c=t,d={};He(r,this,function(f){f.createPayload=function(b,y,P,A,D,T){return{apiKeys:[],payloadBlob:ll,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:b,isTeardown:y,isSync:P,isBeacon:A,sendType:T,sendReason:D}},f.appendPayload=function(b,y,P){var A=b&&y&&!b.overflow;return A&&yn(e,function(){return"Serializer:appendPayload"},function(){for(var D=y.events(),T=b.payloadBlob,K=b.numEvents,L=!1,B=[],N=[],O=b.isBeacon,h=O?k5:mue,v=O?hue:N5,C=0,k=0;C<D.length;){var H=D[C];if(H){if(K>=P){b.overflow=y.split(C);break}var Y=f.getEventBlob(H);if(Y&&Y.length<=v){var Z=Y.length,ie=T.length;if(ie+Z>h){b.overflow=y.split(C);break}T&&(T+=`
`),T+=Y,k++,k>fue&&(T.substr(0,1),k=0),L=!0,K++}else Y?B.push(H):N.push(H),D.splice(C,1),C--}C++}if(B&&B.length>0&&b.sizeExceed.push(nb.create(y.iKey(),B)),N&&N.length>0&&b.failedEvts.push(nb.create(y.iKey(),N)),L){b.batches.push(y),b.payloadBlob=T,b.numEvents=K;var ce=y.iKey();zn(b.apiKeys,ce)===-1&&b.apiKeys.push(ce)}},function(){return{payload:b,theBatch:{iKey:y.iKey(),evts:y.events()},max:P}}),A},f.getEventBlob=function(b){try{return yn(e,function(){return"Serializer.getEventBlob"},function(){var y={};y.name=b.name,y.time=b.time,y.ver=b.ver,y.iKey="o:"+$C(b.iKey);var P={},A=b[a];A&&(y[a]=P,Fr(A,function(K,L){var B=P[K]={};g(L,B,"ext."+K,!0,null,null,!0)}));var D=y[o]={};D.baseType=b.baseType;var T=D[s]={};return g(b.baseData,T,s,!1,[s],function(K,L,B){T5(P,K,L,B)},u),g(b.data,D,o,!1,[],function(K,L,B){T5(P,K,L,B)},u),JSON.stringify(y)},function(){return{item:b}})}catch(y){return null}};function m(b,y){var P=d[b];return P===void 0&&(b.length>=7&&(P=ky(b,"ext.metadata")||ky(b,"ext.web")),d[b]=P),P}function g(b,y,P,A,D,T,K){Fr(b,function(L,B){var N=null;if(B||Un(B)){var O=P,h=L,v=D,C=y;if(l&&!A&&gue.test(L)){var k=L.split("."),H=k.length;if(H>1){v&&(v=v.slice());for(var Y=0;Y<H-1;Y++){var Z=k[Y];C=C[Z]=C[Z]||{},O+="."+Z,v&&v.push(Z)}h=k[H-1]}}var ie=A&&m(O,h);if(!ie&&c&&c.handleField(O,h)?N=c.value(O,h,B,n):N=QC(h,B,n),N){var ce=N.value;if(C[h]=ce,T&&T(v,h,N),K&&typeof ce=="object"&&!yt(ce)){var be=v;be&&(be=be.slice(),be.push(h)),g(B,ce,O+"."+h,A,be,T,K)}}}})}})}return r.__ieDyn=1,r}()});function Ch(r,e,t){$F[r]=e,t!==!1&&(zF[e]=r)}function O5(r){try{return r.responseText}catch(e){}return ll}function L5(r,e){var t=!1;if(r&&e){var n=Io(r);if(n&&n.length>0)for(var i=e.toLowerCase(),o=0;o<n.length;o++){var s=n[o];if(s&&Hu(e,s)&&s.toLowerCase()===i){t=!0;break}}}return t}function ib(r,e,t,n){e&&t&&t.length>0&&(n&&$F[e]?(r.hdrs[$F[e]]=t,r.useHdrs=!0):r.url+="&"+e+"="+t)}function K5(r,e){return e&&(qo(e)?r=[e].concat(r):yt(e)&&(r=e.concat(r))),r}var Eh,YF,M5,vue,$F,zF,F5,U5=he(()=>{p();ur();E5();w5();Ih();rw();GF();A5();YF="sendAttempt",M5="&"+b5+"=true",vue=(Eh={},Eh[1]=FF,Eh[100]=FF,Eh[200]="sent",Eh[8004]=_k,Eh[8003]=_k,Eh),$F={},zF={};Ch(tw,tw,!1);Ch(Ck,Ck);Ch(BF,"Client-Id");Ch(Pk,Pk);Ch(wk,wk);Ch(xk,xk);Ch(HF,HF);F5=function(){function r(e,t,n,i,o){this._responseHandlers=[];var s="?cors=true&"+Ek.toLowerCase()+"="+UF,a=new C5,l=!1,u=new _5,c=!1,d=0,f,m,g,b,y=!0,P=[],A={},D=[],T=null,K=!1,L,B=!1,N=!1,O,h,v,C,k;He(r,this,function(H){var Y=!0;H.initialize=function(Q,we,G,X,ue){var _e;ue||(ue={}),s=Q+s,N=cr(ue.avoidOptions)?!0:!ue.avoidOptions,b=we,L=we.getCookieMgr(),K=!b.config.disableEventTimings;var xe=!!b.config.enableCompoundKey;f=G,m=f.diagLog();var ee=ue.valueSanitizer,oe=ue.stringifyObjects;cr(ue.enableCompoundKey)||(xe=!!ue.enableCompoundKey),O=ue.xhrTimeout,h=!!ue.disableXhrSync,v=!!ue.disableFetchKeepAlive,k=ue.addNoResponse!==!1,c=!$u(),T=new R5(b,ee,oe,xe),Et(ue.useSendBeacon)||(c=!!ue.useSendBeacon);var ae=X,Se=ue.alwaysUseXhrOverride?X:null,Pe=ue.alwaysUseXhrOverride?X:null,Ne=[3,2];if(!X){y=!1;var vt=sh();vt&&vt.protocol&&vt.protocol.toLowerCase()==="file:"&&(Y=!1);var Gt=[];$u()?(Gt=[2,1],Ne=[2,1,3]):Gt=[1,2,3],Gt=K5(Gt,ue.transports),X=Z(Gt,!1),X||el(m,"No available transport to send events"),ae=Z(Gt,!0)}Se||(Ne=K5(Ne,ue.unloadTransports),Se=Z(Ne,!0)),C=!y&&(c&&Hp()||!v&&Fy(!0)),g=(_e={},_e[0]=X,_e[1]=ae||Z([1,2,3],!0),_e[2]=Se||ae||Z([1],!0),_e[3]=Pe||Z([2,3],!0)||ae||Z([1],!0),_e)};function Z(Q,we){for(var G=0,X=null,ue=0;X==null&&ue<Q.length;)G=Q[ue],G===1?lh()?X=ie:Uy()&&(X=be):G===2&&Fy(we)&&(!we||we&&!v)?X=ce:c&&G===3&&Hp()&&(X=$),ue++;return X?{_transport:G,_isSync:we,sendPOST:X}:null}H._getDbgPlgTargets=function(){return[g[0],a,T,g]};function ie(Q,we,G){var X=new XDomainRequest;X.open(Ik,Q.urlString),Q.timeout&&(X.timeout=Q.timeout),X.onload=function(){var ue=O5(X);q(we,200,{},ue),j(ue)},X.onerror=function(){q(we,400,{})},X.ontimeout=function(){q(we,500,{})},X.onprogress=function(){},G?X.send(Q.data):o.set(function(){X.send(Q.data)},0)}function ce(Q,we,G){var X,ue=Q.urlString,_e=!1,xe=!1,ee=(X={body:Q.data,method:Ik},X[p5]=!0,X);G&&(ee.keepalive=!0,Q._sendReason===2&&(_e=!0,k&&(ue+=M5))),Y&&(ee.credentials="include"),Q.headers&&Io(Q.headers).length>0&&(ee.headers=Q.headers),fetch(ue,ee).then(function(oe){var ae={},Se=ll,Pe=oe.headers;Pe&&Pe.forEach(function(Ne,vt){ae[vt]=Ne}),oe.body&&oe.text().then(function(Ne){Se=Ne}),xe||(xe=!0,q(we,oe.status,ae,Se),j(Se))}).catch(function(oe){xe||(xe=!0,q(we,0,{}))}),_e&&!xe&&(xe=!0,q(we,200,{})),!xe&&Q.timeout>0&&o.set(function(){xe||(xe=!0,q(we,500,{}))},Q.timeout)}function be(Q,we,G){var X=Q.urlString;function ue(oe,ae,Se){if(!oe[Se]&&ae&&ae.getResponseHeader){var Pe=ae.getResponseHeader(Se);Pe&&(oe[Se]=Ur(Pe))}return oe}function _e(oe){var ae={};return oe.getAllResponseHeaders?ae=_(oe.getAllResponseHeaders()):(ae=ue(ae,oe,jF),ae=ue(ae,oe,VF),ae=ue(ae,oe,y5)),ae}function xe(oe,ae){q(we,oe.status,_e(oe),ae)}G&&Q.disableXhrSync&&(G=!1);var ee=yk(Ik,X,Y,!0,G,Q.timeout);Fr(Q.headers,function(oe,ae){ee.setRequestHeader(oe,ae)}),ee.onload=function(){var oe=O5(ee);xe(ee,oe),j(oe)},ee.onerror=function(){xe(ee)},ee.ontimeout=function(){xe(ee)},ee.send(Q.data)}function q(Q,we,G,X){try{Q(we,G,X)}catch(ue){Gr(m,2,518,Xr(ue))}}function $(Q,we,G){var X=Q,ue=200,_e=X._thePayload,xe=Q.urlString+(k?M5:ll);try{var ee=xs();if(!ee.sendBeacon(xe,Q.data))if(_e){var oe=[];We(_e.batches,function(ae){if(oe&&ae&&ae.count()>0){for(var Se=ae.events(),Pe=0;Pe<Se.length;Pe++)if(!ee.sendBeacon(xe,T.getEventBlob(Se[Pe]))){oe.push(ae.split(Pe));break}}else oe.push(ae.split(0))}),me(oe,8003,_e.sendType,!0)}else ue=0}catch(ae){el(m,"Failed to send telemetry using sendBeacon API. Ex:"+Xr(ae)),ue=0}finally{q(we,ue,{},ll)}}function de(Q){return Q===2||Q===3}function pe(Q){return B&&de(Q)&&(Q=2),Q}H.addQueryStringParameter=function(Q,we){for(var G=0;G<P.length;G++)if(P[G].name===Q){P[G].value=we;return}P.push({name:Q,value:we})},H.addHeader=function(Q,we){A[Q]=we},H.canSendRequest=function(){return ye()&&u.allowRequestSending()},H.sendQueuedRequests=function(Q,we){cr(Q)&&(Q=0),B&&(Q=pe(Q),we=2),fe(D,Q,0)&&Te(z(),0,!1,Q,we||0)},H.isCompletelyIdle=function(){return!l&&d===0&&D.length===0},H.setUnloading=function(Q){B=Q},H.addBatch=function(Q){if(Q&&Q.count()>0){if(a.isTenantKilled(Q.iKey()))return!1;D.push(Q)}return!0},H.teardown=function(){D.length>0&&Te(z(),0,!0,2,2)},H.pause=function(){l=!0},H.resume=function(){l=!1,H.sendQueuedRequests(0,4)},H.sendSynchronousBatch=function(Q,we,G){Q&&Q.count()>0&&(Et(we)&&(we=1),B&&(we=pe(we),G=2),Te([Q],0,!1,we,G||0))};function ye(){return!l&&d<t}function z(){var Q=D;return D=[],Q}function fe(Q,we,G){var X=!1;return Q&&Q.length>0&&!l&&g[we]&&T&&(X=we!==0||ye()&&(G>0||u.allowRequestSending())),X}function Ie(Q){var we={};return Q&&We(Q,function(G,X){we[X]={iKey:G.iKey(),evts:G.events()}}),we}function Te(Q,we,G,X,ue){if(!(!Q||Q.length===0)){if(l){me(Q,1,X);return}X=pe(X);try{var _e=Q,xe=X!==0;yn(b,function(){return"HttpManager:_sendBatches"},function(ee){ee&&(Q=Q.slice(0));for(var oe=[],ae=null,Se=Eo(),Pe=g[X]||(xe?g[1]:g[0]),Ne=Pe&&Pe._transport,vt=C&&(B||de(X)||Ne===3||Pe._isSync&&Ne===2);fe(Q,X,we);){var Gt=Q.shift();Gt&&Gt.count()>0&&(a.isTenantKilled(Gt.iKey())?oe.push(Gt):(ae=ae||T.createPayload(we,G,xe,vt,ue,X),T.appendPayload(ae,Gt,e)?ae.overflow!==null&&(Q=[ae.overflow].concat(Q),ae.overflow=null,Ge(ae,Se,Eo(),ue),Se=Eo(),ae=null):(Ge(ae,Se,Eo(),ue),Se=Eo(),Q=[Gt].concat(Q),ae=null)))}ae&&Ge(ae,Se,Eo(),ue),Q.length>0&&(D=Q.concat(D)),me(oe,8004,X)},function(){return{batches:Ie(_e),retryCount:we,isTeardown:G,isSynchronous:xe,sendReason:ue,useSendBeacon:de(X),sendType:X}},!xe)}catch(ee){Gr(m,2,48,"Unexpected Exception sending batch: "+Xr(ee))}}}function Le(Q,we){var G={url:s,hdrs:{},useHdrs:!1};we?(G.hdrs=ef(G.hdrs,A),G.useHdrs=Io(G.hdrs).length>0):Fr(A,function(ee,oe){zF[ee]?ib(G,zF[ee],oe,!1):(G.hdrs[ee]=oe,G.useHdrs=!0)}),ib(G,BF,"NO_AUTH",we),ib(G,Ck,id,we);var X=ll;We(Q.apiKeys,function(ee){X.length>0&&(X+=","),X+=ee}),ib(G,Pk,X,we),ib(G,xk,Qn().toString(),we);var ue=F(Q);if(Un(ue)&&(G.url+="&ext.intweb.msfpc="+ue),u.shouldAddClockSkewHeaders()&&ib(G,wk,u.getClockSkewHeaderValue(),we),b.getWParam){var _e=b.getWParam();_e>=0&&(G.url+="&w="+_e)}for(var xe=0;xe<P.length;xe++)G.url+="&"+P[xe].name+"="+P[xe].value;return G}function $e(Q,we,G){Q[we]=Q[we]||{},Q[we][f.identifier]=G}function Ge(Q,we,G,X){if(Q&&Q.payloadBlob&&Q.payloadBlob.length>0){var ue=!!H.sendHook,_e=g[Q.sendType];!de(Q.sendType)&&Q.isBeacon&&Q.sendReason===2&&(_e=g[2]||g[3]||_e);var xe=N;(Q.isBeacon||_e._transport===3)&&(xe=!1);var ee=Le(Q,xe);xe=xe||ee.useHdrs;var oe=Eo();yn(b,function(){return"HttpManager:_doPayloadSend"},function(){for(var ae=0;ae<Q.batches.length;ae++)for(var Se=Q.batches[ae],Pe=Se.events(),Ne=0;Ne<Pe.length;Ne++){var vt=Pe[Ne];if(K){var Gt=vt.timings=vt.timings||{};$e(Gt,"sendEventStart",oe),$e(Gt,"serializationStart",we),$e(Gt,"serializationCompleted",G)}vt[YF]>0?vt[YF]++:vt[YF]=1}me(Q.batches,1e3+(X||0),Q.sendType,!0);var Or={data:Q.payloadBlob,urlString:ee.url,headers:ee.hdrs,_thePayload:Q,_sendReason:X,timeout:O,disableXhrSync:h,disableFetchKeepAlive:v};xe&&(L5(Or.headers,WF)||(Or.headers[WF]=g5),L5(Or.headers,Ek)||(Or.headers[Ek]=UF));var Mm=null;_e&&(Mm=function(Lv){u.firstRequestSent();var Om=function(AE,rL){R(AE,rL,Q,X)},Ys=Q.isTeardown||Q.isSync;try{_e.sendPOST(Lv,Om,Ys),H.sendListener&&H.sendListener(Or,Lv,Ys,Q.isBeacon)}catch(AE){el(m,"Unexpected exception sending payload. Ex:"+Xr(AE)),q(Om,0,{})}}),yn(b,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(Mm)if(Q.sendType===0&&d++,ue&&!Q.isBeacon&&_e._transport!==3){var Lv={data:Or.data,urlString:Or.urlString,headers:ef({},Or.headers),timeout:Or.timeout,disableXhrSync:Or.disableXhrSync,disableFetchKeepAlive:Or.disableFetchKeepAlive},Om=!1;yn(b,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{H.sendHook(Lv,function(Ys){Om=!0,!y&&!Ys._thePayload&&(Ys._thePayload=Ys._thePayload||Or._thePayload,Ys._sendReason=Ys._sendReason||Or._sendReason),Mm(Ys)},Q.isSync||Q.isTeardown)}catch(Ys){Om||Mm(Or)}})}else Mm(Or)})},function(){return{thePayload:Q,serializationStart:we,serializationCompleted:G,sendReason:X}},Q.isSync)}Q.sizeExceed&&Q.sizeExceed.length>0&&me(Q.sizeExceed,8003,Q.sendType),Q.failedEvts&&Q.failedEvts.length>0&&me(Q.failedEvts,8002,Q.sendType)}function Bt(Q,we){K&&We(Q,function(G){var X=G.timings=G.timings||{};$e(X,"sendEventCompleted",we)})}function R(Q,we,G,X){var ue=9e3,_e=null,xe=!1,ee=!1;try{var oe=!0;if(typeof Q!==Yt){if(we){u.setClockSkew(we[jF]);var ae=we[VF]||we["kill-duration-seconds"];We(a.setKillSwitchTenants(we[v5],ae),function(Pe){We(G.batches,function(Ne){if(Ne.iKey()===Pe){_e=_e||[];var vt=Ne.split(0);G.numEvents-=vt.count(),_e.push(vt)}})})}if(Q==200||Q==204){ue=200;return}(!P5(Q)||G.numEvents<=0)&&(oe=!1),ue=9e3+Q%1e3}if(oe){ue=100;var Se=G.retryCnt;G.sendType===0&&(Se<n?(xe=!0,I(function(){G.sendType===0&&d--,Te(G.batches,Se+1,G.isTeardown,B?2:G.sendType,5)},B,Tk(Se))):(ee=!0,B&&(ue=8001)))}}finally{xe||(u.setClockSkew(),M(G,ue,X,ee)),me(_e,8004,G.sendType)}}function M(Q,we,G,X){try{X&&f._backOffTransmission(),we===200&&(!X&&!Q.isSync&&f._clearBackOff(),S(Q.batches)),me(Q.batches,we,Q.sendType,!0)}finally{Q.sendType===0&&(d--,G!==5&&H.sendQueuedRequests(Q.sendType,G))}}function S(Q){if(K){var we=Eo();We(Q,function(G){G&&G.count()>0&&Bt(G.events(),we)})}}function I(Q,we,G){we?Q():o.set(Q,G)}function _(Q){var we={};if(an(Q)){var G=Ur(Q).split(/[\r\n]+/);We(G,function(X){if(X){var ue=X.indexOf(": ");if(ue!==-1){var _e=Ur(X.substring(0,ue)).toLowerCase(),xe=Ur(X.substring(ue+1));we[_e]=xe}else we[Ur(X)]=1}})}return we}function F(Q){for(var we=0;we<Q.batches.length;we++){var G=Q.batches[we].Msfpc();if(G)return encodeURIComponent(G)}return ll}function j(Q){var we=H._responseHandlers;try{for(var G=0;G<we.length;G++)try{we[G](Q)}catch(ue){Gr(m,1,519,"Response handler failed: "+ue)}if(Q){var X=JSON.parse(Q);Un(X.webResult)&&Un(X.webResult[rb])&&L.set("MSFPC",X.webResult[rb],365*86400)}}catch(ue){}}function me(Q,we,G,X){if(Q&&Q.length>0&&i){var ue=i[Fe(we)];if(ue){var _e=G!==0;yn(b,function(){return"HttpManager:_sendBatchesNotification"},function(){I(function(){try{ue.call(i,Q,we,_e,G)}catch(xe){Gr(m,1,74,"send request notification failed: "+xe)}},X||_e,0)},function(){return{batches:Ie(Q),reason:we,isSync:_e,sendSync:X,sendType:G}},!_e)}}}function Fe(Q){var we=vue[Q];return Un(we)||(we=h5,Q>=9e3&&Q<=9999?we=m5:Q>=8e3&&Q<=8999?we=_k:Q>=1e3&&Q<=1999&&(we=f5)),we}})}return r.__ieDyn=1,r}()});function yue(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout(r,e,t)}function bue(r){clearTimeout(r)}function nw(r,e){return{set:r||yue,clear:e||bue}}var W5=he(()=>{p()});var Sue,V5,Iue,j5,B5,_ue,H5,Eue,wh,Nk,q5,J5,Cue,wue,G5,Y5=he(()=>{p();ir();ur();Ih();KF();JF();U5();rw();GF();W5();Sue=.25,V5=500,Iue=20,j5=6,B5=2,_ue=4,H5=2,Eue=1,wh="eventsDiscarded",Nk="overrideInstrumentationKey",q5="maxEventRetryAttempts",J5="maxUnloadEventRetryAttempts",Cue="addUnloadCb",wue=function(r){vn(e,r);function e(){var t=r.call(this)||this;t.identifier="PostChannel",t.priority=1011,t.version="3.2.9";var n,i=!1,o=[],s=null,a=!1,l=0,u=500,c=0,d=1e4,f={},m=_h,g=null,b=null,y=0,P=0,A,D,T={},K,L,B=-1,N,O=!0,h=!1,v=j5,C=B5,k,H;return He(e,t,function(Y,Z){ye(),Y._getDbgPlgTargets=function(){return[D]},Y.initialize=function(ee,oe,ae){yn(oe,function(){return"PostChannel:initialize"},function(){var Se=oe;Z.initialize(ee,oe,ae);try{var Pe=!!oe[Cue];k=Qu(rl(Y.identifier),oe.evtNamespace&&oe.evtNamespace());var Ne=Y._getTelCtx();ee.extensionConfig[Y.identifier]=ee.extensionConfig[Y.identifier]||{},n=Ne.getExtCfg(Y.identifier),H=nw(n.setTimeoutOverride,n.clearTimeoutOverride),O=!n.disableOptimizeObj&&vk(),ie(Se),n.eventsLimitInMem>0&&(d=n.eventsLimitInMem),n.immediateEventLimit>0&&(u=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(K=n.autoFlushEventsLimit),qo(n[q5])&&(v=n[q5]),qo(n[J5])&&(C=n[J5]),xe(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(A=n.httpXHROverride),Un(ee.anonCookieName)&&D.addQueryStringParameter("anoncknm",ee.anonCookieName),D.sendHook=n.payloadPreprocessor,D.sendListener=n.payloadListener;var vt=n.overrideEndpointUrl?n.overrideEndpointUrl:ee.endpointUrl;Y._notificationManager=oe.getNotifyMgr(),D.initialize(vt,Y.core,Y,A,n);var Gt=ee.disablePageUnloadEvents||[];fh(ce,Gt,k),Jy(ce,Gt,k),Gy(be,ee.disablePageShowEvents,k)}catch(Or){throw Y.setInitialized(!1),Or}},function(){return{coreConfig:ee,core:oe,extensions:ae}})},Y.processTelemetry=function(ee,oe){yh(ee,Y.identifier),oe=Y._getTelCtx(oe);var ae=oe.getExtCfg(Y.identifier),Se=!!n.disableTelemetry;ae&&(Se=Se||!!ae.disableTelemetry);var Pe=ee;!Se&&!i&&(n[Nk]&&(Pe.iKey=n[Nk]),ae&&ae[Nk]&&(Pe.iKey=ae[Nk]),q(Pe,!0),h?Ie(2,2):pe()),Y.processNext(Pe,oe)},Y._doTeardown=function(ee,oe){Ie(2,2),i=!0,D.teardown(),OC(null,k),LC(null,k),KC(null,k),ye()};function ie(ee){var oe=ee.getWParam;ee.getWParam=function(){var ae=0;return n.ignoreMc1Ms0CookieProcessing&&(ae=ae|2),ae|oe()}}function ce(ee){var oe=ee||Ec().event;oe.type!=="beforeunload"&&(h=!0,D.setUnloading(h)),Ie(2,2)}function be(ee){h=!1,D.setUnloading(h)}function q(ee,oe){if(ee.sendAttempt||(ee.sendAttempt=0),ee.latency||(ee.latency=1),ee.ext&&ee.ext[qF]&&delete ee.ext[qF],ee.ext&&ee.ext[Dk]&&ee.ext[Dk].id&&delete ee.ext[Dk].id,O&&(yh,ee.ext=Ju(ee.ext),ee.baseData&&(ee.baseData=Ju(ee.baseData)),ee.data&&(ee.data=Ju(ee.data))),ee.sync){if(y||a)ee.latency=3,ee.sync=!1;else if(D){O&&(ee=Ju(ee)),D.sendSynchronousBatch(nb.create(ee.iKey,[ee]),ee.sync===!0?1:ee.sync,3);return}}var ae=ee.latency,Se=c,Pe=d;ae===4&&(Se=l,Pe=u);var Ne=!1;if(Se<Pe)Ne=!Ge(ee,oe);else{var vt=1,Gt=Iue;ae===4&&(vt=4,Gt=1),Ne=!0,Bt(ee.iKey,ee.latency,vt,Gt)&&(Ne=!Ge(ee,oe))}Ne&&Fe(wh,[ee],Qa.QueueFull)}Y.setEventQueueLimits=function(ee,oe){d=ee>0?ee:1e4,K=oe>0?oe:0,xe();var ae=c>ee;if(!ae&&L>0)for(var Se=1;!ae&&Se<=3;Se++){var Pe=T[Se];Pe&&Pe.batches&&We(Pe.batches,function(Ne){Ne&&Ne.count()>=L&&(ae=!0)})}$e(!0,ae)},Y.pause=function(){fe(),a=!0,D.pause()},Y.resume=function(){a=!1,D.resume(),pe()},Y.addResponseHandler=function(ee){D._responseHandlers.push(ee)},Y._loadTransmitProfiles=function(ee){_(),Fr(ee,function(oe,ae){var Se=ae.length;if(Se>=2){var Pe=Se>2?ae[2]:0;if(ae.splice(0,Se-2),ae[1]<0&&(ae[0]=-1),ae[1]>0&&ae[0]>0){var Ne=ae[0]/ae[1];ae[0]=Math.ceil(Ne)*ae[1]}Pe>=0&&ae[1]>=0&&Pe>ae[1]&&(Pe=ae[1]),ae.push(Pe),f[oe]=ae}})},Y.flush=function(ee,oe,ae){if(ee===void 0&&(ee=!0),!a)if(ae=ae||1,ee)s==null?(fe(),M(1,0,ae),s=z(function(){s=null,S(oe,ae)},0)):o.push(oe);else{var Se=fe();$(1,1,ae),oe!=null&&oe(),Se&&pe()}},Y.setMsaAuthTicket=function(ee){D.addHeader(tw,ee)},Y.hasEvents=de,Y._setTransmitProfile=function(ee){m!==ee&&f[ee]!==void 0&&(fe(),m=ee,pe())};function $(ee,oe,ae){var Se=M(ee,oe,ae);return D.sendQueuedRequests(oe,ae),Se}function de(){return c>0}function pe(){if(B>=0&&M(B,0,N)&&D.sendQueuedRequests(0,N),l>0&&!b&&!a){var ee=f[m][2];ee>=0&&(b=z(function(){b=null,$(4,0,1),pe()},ee))}var oe=f[m][1];!g&&!s&&oe>=0&&!a&&(de()?g=z(function(){g=null,$(P===0?3:1,0,1),P++,P%=2,pe()},oe):P=0)}Y._backOffTransmission=function(){y<_ue&&(y++,fe(),pe())},Y._clearBackOff=function(){y&&(y=0,fe(),pe())};function ye(){n=null,i=!1,o=[],s=null,a=!1,l=0,u=500,c=0,d=1e4,f={},m=_h,g=null,b=null,y=0,P=0,A=null,T={},K=void 0,L=0,B=-1,N=null,O=!0,h=!1,v=j5,C=B5,k=null,H=nw(),D=new F5(V5,H5,Eue,{requeue:j,send:we,sent:G,drop:X,rspFail:ue,oth:_e},H),F(),Te(),xe()}function z(ee,oe){oe===0&&y&&(oe=1);var ae=1e3;return y&&(ae=Tk(y-1)),H.set(ee,oe*ae)}function fe(){return g!==null?(H.clear(g),g=null,P=0,!0):!1}function Ie(ee,oe){fe(),s&&(H.clear(s),s=null),a||$(1,ee,oe)}function Te(){T[4]={batches:[],iKeyMap:{}},T[3]={batches:[],iKeyMap:{}},T[2]={batches:[],iKeyMap:{}},T[1]={batches:[],iKeyMap:{}}}function Le(ee,oe,ae){var Se=T[oe];Se||(oe=1,Se=T[oe]);var Pe=Se.iKeyMap[ee];return!Pe&&ae&&(Pe=nb.create(ee),Se.batches.push(Pe),Se.iKeyMap[ee]=Pe),Pe}function $e(ee,oe){D.canSendRequest()&&!y&&(K>0&&c>K&&(oe=!0),oe&&s==null&&Y.flush(ee,null,20))}function Ge(ee,oe){O&&(ee=Ju(ee));var ae=ee.latency,Se=Le(ee.iKey,ae,!0);return Se.addEvent(ee)?(ae!==4?(c++,oe&&ee.sendAttempt===0&&$e(!ee.sync,L>0&&Se.count()>=L)):l++,!0):!1}function Bt(ee,oe,ae,Se){for(;ae<=oe;){var Pe=Le(ee,oe,!0);if(Pe&&Pe.count()>0){var Ne=Pe.split(0,Se),vt=Ne.count();if(vt>0)return ae===4?l-=vt:c-=vt,Q(wh,[Ne],Qa.QueueFull),!0}ae++}return R(),!1}function R(){for(var ee=0,oe=0,ae=function(Pe){var Ne=T[Pe];Ne&&Ne.batches&&We(Ne.batches,function(vt){Pe===4?ee+=vt.count():oe+=vt.count()})},Se=1;Se<=4;Se++)ae(Se);c=oe,l=ee}function M(ee,oe,ae){var Se=!1,Pe=oe===0;return!Pe||D.canSendRequest()?yn(Y.core,function(){return"PostChannel._queueBatches"},function(){for(var Ne=[],vt=4;vt>=ee;){var Gt=T[vt];Gt&&Gt.batches&&Gt.batches.length>0&&(We(Gt.batches,function(Or){D.addBatch(Or)?Se=Se||Or&&Or.count()>0:Ne=Ne.concat(Or.events()),vt===4?l-=Or.count():c-=Or.count()}),Gt.batches=[],Gt.iKeyMap={}),vt--}Ne.length>0&&Fe(wh,Ne,Qa.KillSwitch),Se&&B>=ee&&(B=-1,N=0)},function(){return{latency:ee,sendType:oe,sendReason:ae}},!Pe):(B=B>=0?Math.min(B,ee):ee,N=Math.max(N,ae)),Se}function S(ee,oe){$(1,0,oe),R(),I(function(){ee&&ee(),o.length>0?s=z(function(){s=null,S(o.shift(),oe)},0):(s=null,pe())})}function I(ee){D.isCompletelyIdle()?ee():s=z(function(){s=null,I(ee)},Sue)}function _(){fe(),F(),m=_h,pe()}function F(){f={},f[_h]=[2,1,0],f[bk]=[6,3,0],f[Sk]=[18,9,0]}function j(ee,oe){var ae=[],Se=v;h&&(Se=C),We(ee,function(Pe){Pe&&Pe.count()>0&&We(Pe.events(),function(Ne){Ne&&(Ne.sync&&(Ne.latency=4,Ne.sync=!1),Ne.sendAttempt<Se?(yh(Ne,Y.identifier),q(Ne,!1)):ae.push(Ne))})}),ae.length>0&&Fe(wh,ae,Qa.NonRetryableStatus),h&&Ie(2,2)}function me(ee,oe){var ae=Y._notificationManager||{},Se=ae[ee];if(Se)try{Se.apply(ae,oe)}catch(Pe){Gr(Y.diagLog(),1,74,ee+" notification failed: "+Pe)}}function Fe(ee,oe){for(var ae=[],Se=2;Se<arguments.length;Se++)ae[Se-2]=arguments[Se];oe&&oe.length>0&&me(ee,[oe].concat(ae))}function Q(ee,oe){for(var ae=[],Se=2;Se<arguments.length;Se++)ae[Se-2]=arguments[Se];oe&&oe.length>0&&We(oe,function(Pe){Pe&&Pe.count()>0&&me(ee,[Pe.events()].concat(ae))})}function we(ee,oe,ae){ee&&ee.length>0&&me("eventsSendRequest",[oe>=1e3&&oe<=1999?oe-1e3:0,ae!==!0])}function G(ee,oe){Q("eventsSent",ee,oe),pe()}function X(ee,oe){Q(wh,ee,oe>=8e3&&oe<=8999?oe-8e3:Qa.Unknown)}function ue(ee){Q(wh,ee,Qa.NonRetryableStatus),pe()}function _e(ee,oe){Q(wh,ee,Qa.Unknown),pe()}function xe(){!n||!n.disableAutoBatchFlushLimit?L=Math.max(V5*(H5+1),d/6):L=0}ws(Y,"_setTimeoutOverride",function(){return H.set},function(ee){H=nw(ee,H.clear)}),ws(Y,"_clearTimeoutOverride",function(){return H.clear},function(ee){H=nw(H.set,ee)})}),t}return e.__ieDyn=1,e}(hh),G5=wue});var $5={};Kv($5,{BE_PROFILE:()=>Sk,NRT_PROFILE:()=>bk,PostChannel:()=>G5,RT_PROFILE:()=>_h});var z5=he(()=>{p();Y5();KF()});var xue,Q5,X5=he(()=>{p();xue=async(r,e,t)=>{let n=await Promise.resolve().then(()=>(Ih(),d5)),i=await Promise.resolve().then(()=>(z5(),$5)),o=new n.AppInsightsCore,s=new i.PostChannel,a={instrumentationKey:r,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[s]]};if(t){a.extensionConfig={};let c={alwaysUseXhrOverride:!0,httpXHROverride:t};a.extensionConfig[s.identifier]=c}let u=e.workspace.getConfiguration("telemetry").get("internalTesting");return o.initialize(a,[]),o.addTelemetryInitializer(c=>{var d,f;u&&(c.ext=(d=c.ext)!=null?d:{},c.ext.utc=(f=c.ext.utc)!=null?f:{},c.ext.utc.flags=8462029)}),o},Q5=async(r,e,t)=>{let n=await xue(r,e,t);return{logEvent:(o,s)=>{try{n==null||n.track({name:o,baseData:{name:o,properties:s==null?void 0:s.properties,measurements:s==null?void 0:s.measurements}})}catch(a){throw new Error(`Failed to log event to app insights!
`+a.message)}},flush:async()=>{try{n==null||n.unload()}catch(o){throw new Error(`Failed to flush app insights!
`+o.message)}}}}});var od,Rk,Z5=he(()=>{p();(function(r){r[r.NOT_INSTANTIATED=0]="NOT_INSTANTIATED",r[r.INSTANTIATING=1]="INSTANTIATING",r[r.INSTANTIATED=2]="INSTANTIATED"})(od||(od={}));Rk=class{constructor(e,t){this._instantiationStatus=od.NOT_INSTANTIATED,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=t,this._key=e}sendEventData(e,t){if(!this._telemetryClient){this._instantiationStatus!==od.INSTANTIATED&&this._eventQueue.push({eventName:e,data:t});return}this._telemetryClient.logEvent(e,t)}sendErrorData(e,t){if(!this._telemetryClient){this._instantiationStatus!==od.INSTANTIATED&&this._exceptionQueue.push({exception:e,data:t});return}}async flush(){this._telemetryClient&&(await this._telemetryClient.flush(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach(({eventName:e,data:t})=>this.sendEventData(e,t)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:e,data:t})=>this.sendErrorData(e,t)),this._exceptionQueue=[]}instantiateSender(){this._instantiationStatus===od.NOT_INSTANTIATED&&(this._instantiationStatus=od.INSTANTIATING,this._clientFactory(this._key).then(e=>{this._telemetryClient=e,this._instantiationStatus=od.INSTANTIATED,this._flushQueues()}).catch(e=>{console.error(e),this._instantiationStatus=od.INSTANTIATED}))}}});var Ak,e3=he(()=>{p();Ak=class{constructor(e,t,n){this.telemetrySender=e,this.vscodeAPI=t,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this._onDidChangeTelemetryLevel=new this.vscodeAPI.EventEmitter,this.onDidChangeTelemetryLevel=this._onDidChangeTelemetryLevel.event,this.telemetryLogger=this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender,n),this.updateUserOptIn(),this.telemetryLogger.onDidChangeEnableStates(()=>{this.updateUserOptIn()})}updateUserOptIn(){this.errorOptIn=this.telemetryLogger.isErrorsEnabled,this.userOptIn=this.telemetryLogger.isUsageEnabled,(this.telemetryLogger.isErrorsEnabled||this.telemetryLogger.isUsageEnabled)&&this.telemetrySender.instantiateSender(),this._onDidChangeTelemetryLevel.fire(this.telemetryLevel)}get telemetryLevel(){return this.errorOptIn&&this.userOptIn?"all":this.errorOptIn?"error":"off"}internalSendTelemetryEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logUsage(e,{properties:t,measurements:n})}sendTelemetryEvent(e,t,n){this.internalSendTelemetryEvent(e,t,n,!1)}sendDangerousTelemetryEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryEvent(e,t,n,!0)}internalSendTelemetryErrorEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryErrorEvent(e,t,n){this.internalSendTelemetryErrorEvent(e,t,n,!1)}sendDangerousTelemetryErrorEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryErrorEvent(e,t,n,!0)}internalSendTelemetryException(e,t,n,i){i?this.telemetrySender.sendErrorData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryException(e,t,n){this.internalSendTelemetryException(e,t,n,!1)}sendDangerousTelemetryException(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryException(e,t,n,!0)}dispose(){return this.telemetryLogger.dispose(),Promise.all(this.disposables.map(e=>e.dispose()))}}});var ob,t3=he(()=>{p();ob=class r{static applyReplacements(e,t){for(let n of Object.keys(e))for(let i of t)i.lookup.test(n)&&(i.replacementString!==void 0?e[n]=i.replacementString:delete e[n])}static shouldUseOneDataSystemSDK(e){return e.length===74&&e[32]==="-"&&e[41]==="-"&&e[46]==="-"&&e[51]==="-"&&e[56]==="-"&&e[69]==="-"}static getAdditionalCommonProperties(e){return{"common.os":e.platform,"common.nodeArch":e.architecture,"common.platformversion":(e.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),"common.telemetryclientversion":"0.7.7"}}static getInstance(){return r._instance||(r._instance=new r),r._instance}}});var Mk,sb,sd,Ok,ab,QF,iw,XF,r3,ca,Lk=he(()=>{p();Mk="name",sb="push",sd="length",Ok="messageId",ab="message",QF="diagLog",iw="replace",XF="enableDebugExceptions",r3="logInternalMessage",ca="call"});var cl,Kk,Fk,Uk=he(()=>{p();cl="",Kk="errorToConsole",Fk="warnToConsole"});function Wk(r){return r===void 0||typeof r===Yt}function xh(r){return r===null||Wk(r)}function Ph(r){return!!(r&&typeof r===dt)}function ow(r){return!!(r&&typeof r===Qr)}function wc(r,e){if(r)for(var t in r)nr[ca](r,t)&&e[ca](r,t,r[t])}function Oue(r){return!!(r&&u3[ca](r)==="[object Array]")}function sw(r){return!!(r&&u3[ca](r)==="[object Error]")}function zo(r){return typeof r=="string"}function Vk(r){if(r)return Rue?r[l3]():Lue(r)}function Lue(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[sd]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function aw(r,e,t){var n=r[sd];try{for(var i=0;i<n&&!(i in r&&e[ca](t||r,r[i],i,r)===-1);i++);}catch(o){}}function nU(r,e,t){if(r){if(r[n3])return r[n3](e,t);var n=r[sd],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function Th(r,e,t){var n;if(r){if(r[i3])return r[i3](e,t);var i=r[sd],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[ca](o,r[s],r))}catch(a){}}return n}function iU(r,e,t){var n;if(r){if(r[o3])return r[o3](e,t);var i=r[sd],o=0;if(arguments[sd]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function ul(r){return r&&(r=kue&&r[eU]?r[eU]():r[iw]?r[iw](/^\s+|(?=\s)\s+$/g,cl):r),r}function oU(r){var e=typeof r;if(e!==Qr&&(e!==dt||r===null)&&na("objKeys called on non-object"),!a3&&s3)return s3(r);var t=[];for(var n in r)r&&nr[ca](r,n)&&t[sb](n);if(a3)for(var i=ZF[sd],o=0;o<i;o++)r&&nr[ca](r,ZF[o])&&t[sb](ZF[o]);return t}function Kue(r){return r}function jk(r){return tU&&wc(r,function(e,t){(Dh(t)||Ph(t))&&tU(t)}),d3(r)}function lw(r){return sw(r)?r[Mk]:cl}function cw(r,e){return xh(r)?e:r}function sU(r){return function(){function e(){var t=this;r&&wc(r,function(n,i){t[n]=i})}return e}()}var l3,Due,Tue,n3,i3,o3,eU,c3,tU,fFe,s3,rU,kue,mFe,hFe,Nue,Rue,Aue,u3,Mue,gFe,Dh,a3,ZF,d3,Bk=he(()=>{p();ir();Lk();Uk();l3="toISOString",Due="endsWith",Tue="startsWith",n3="indexOf",i3="map",o3="reduce",eU="trim",c3="toString",tU=Ir.freeze,fFe=Ir.seal,s3=Ir.keys,rU=String[Mt],kue=rU[eU],mFe=rU[Due],hFe=rU[Tue],Nue=Date[Mt],Rue=Nue[l3],Aue=Array.isArray,u3=ra[c3],Mue=nr[c3],gFe=Mue[ca](Ir);Dh=Aue||Oue;a3=!{toString:null}.propertyIsEnumerable("toString"),ZF=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];d3=tU||Kue});function lb(r){var e={};return wc(r,function(t,n){e[t]=n,e[n]=t}),jk(e)}function aU(r){var e={};return wc(r,function(t,n){e[t]=n[1],e[n[0]]=n[1]}),jk(e)}var p3=he(()=>{p();Bk()});function ad(r){var e=Kn();return e&&e[r]?e[r]:r===Fue&&m3()?window:null}function m3(){return!!(typeof window===dt&&window)}function h3(){return!!(typeof document===dt&&document)}function lU(){return h3()?document:ad(Uue)}function cU(){return typeof console!==Yt?console:ad(Wue)}function kh(){return!!(typeof JSON===dt&&JSON||ad(f3)!==null)}function cb(){return kh()?JSON||ad(f3):null}function Nh(r){var e=Object[Mt].toString[ca](r),t=cl;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Mk]+"'":kh()&&(t=cb().stringify(r)),e+t}var Fue,Uue,Wue,f3,Hk=he(()=>{"use strict";p();ir();Lk();Uk();Fue="window",Uue="document",Wue="console",f3="JSON"});function Vue(){var r=ad("Microsoft");return r&&(qk=r.ApplicationInsights),qk}function g3(r){var e=qk;return!e&&r.disableDbgExt!==!0&&(e=qk||Vue()),e?e.ChromeDbgExt:null}var qk,v3=he(()=>{p();Hk();qk=null});function y3(r){return r?'"'+r[iw](/\"/g,cl)+'"':cl}function b3(r,e){var t=cU();if(t){var n="log";t[r]&&(n=r),ow(t[n])&&t[n](e)}}function que(r){return r||new S3}function dl(r,e,t,n,i,o){o===void 0&&(o=!1),que(r).throwInternal(e,t,n,i,o)}var jue,Bue,Hue,uU,S3,I3=he(()=>{"use strict";p();ur();Lk();v3();Hk();Bk();Uk();jue="AI (Internal): ",Bue="AI: ",Hue="AITR_";uU=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Ok]=e,o[ab]=(n?Bue:jue)+e;var s=cl;kh()&&(s=cb().stringify(i));var a=(t?" message:"+y3(t):cl)+(i?" props:"+y3(s):cl);o[ab]+=a}return r.dataType="MessageData",r}(),S3=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[XF]=function(){return a},l.throwInternal=function(m,g,b,y,P){P===void 0&&(P=!1);var A=new uU(g,b,P,y);if(a)throw Nh(A);var D=m===1?Kk:Fk;if(Wk(A[ab]))f("throw"+(m===1?"Critical":"Warning"),A);else{if(P){var T=+A[Ok];!n[T]&&i>=m&&(l[D](A[ab]),n[T]=!0)}else i>=m&&l[D](A[ab]);u(m,A)}},l[Fk]=function(m){b3("warn",m),f("warning",m)},l[Kk]=function(m){b3("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[r3]=u;function u(m,g){if(!d()){var b=!0,y=Hue+g[Ok];if(n[y]?b=!1:n[y]=!0,b&&(m<=o&&(l.queue[sb](g),t++,f(m===1?"error":"warn",g)),t===s)){var P="Internal events throttle limit per PageView reached for this app.",A=new uU(23,P,!1);l.queue[sb](A),m===1?l[Kk](P):l[Fk](P)}}}function c(m){i=cw(m.loggingLevelConsole,0),o=cw(m.loggingLevelTelemetry,1),s=cw(m.maxMessageLimit,25),a=cw(m[XF],!1)}function d(){return t>=s}function f(m,g){var b=g3(e||{});b&&b[QF]&&b[QF](m,g)}})}return r.__ieDyn=1,r}()});var ua=he(()=>{p();Bk();p3();Hk();ir();I3()});var uw,dw,pw,Jk,Rh,ld,ki,pl=he(()=>{p();uw="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",dw="sampleRate",pw="ProcessLegacy",Jk="http.method",Rh="https://dc.services.visualstudio.com",ld="/v2/track",ki="not_specified"});var Ah,At,Mh,fw,fl,_3,qi,cd,E3,mw,hw,Gk,Oh,da,Ji,Gi,Lh,xc,Kh,Yk,$k,dU,Fh,gw,vw,Uh,ub,db,Wh,pU,Vh,C3,w3,x3,P3,Co=he(()=>{p();Ah="split",At="length",Mh="toLowerCase",fw="ingestionendpoint",fl="toString",_3="removeItem",qi="name",cd="message",E3="count",mw="stringify",hw="pathname",Gk="indexOf",Oh="exceptions",da="parsedStack",Ji="properties",Gi="measurements",Lh="sizeInBytes",xc="typeName",Kh="severityLevel",Yk="problemGroup",$k="isManual",dU="CreateFromInterface",Fh="assembly",gw="hasFullStack",vw="level",Uh="method",ub="fileName",db="line",Wh="duration",pU="receivedResponse",Vh="substring",C3="sanitizeKeyAndAddUniqueness",w3="sanitizeException",x3="sanitizeProperties",P3="sanitizeMeasurements"});function zk(r){(isNaN(r)||r<0)&&(r=0),r=Math.round(r);var e=yw+r%1e3,t=yw+Math.floor(r/1e3)%60,n=yw+Math.floor(r/(1e3*60))%60,i=yw+Math.floor(r/(1e3*60*60))%24,o=Math.floor(r/(1e3*60*60*24));return e=e[At]===1?"00"+e:e[At]===2?"0"+e:e,t=t[At]<2?"0"+t:t,n=n[At]<2?"0"+n:n,i=i[At]<2?"0"+i:i,(o>0?o+".":yw)+i+":"+n+":"+t+"."+e}var yw,fU=he(()=>{p();Co();yw=""});var pb,D3=he(()=>{p();ua();pb=aU({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]})});var Qk,QUe,T3=he(()=>{p();ua();Qk=lb({LocalStorage:0,SessionStorage:1}),QUe=lb({AI:0,AI_AND_W3C:1,W3C:2})});function k3(r){try{if(xh(Kn()))return null;var e=new Date()[fl](),t=ad(r===Qk.LocalStorage?"localStorage":"sessionStorage");t.setItem(e,e);var n=t.getItem(e)!==e;if(t[_3](e),!n)return t}catch(i){}return null}function N3(){return Xk()?k3(Qk.SessionStorage):null}function Xk(r){return(r||bw===void 0)&&(bw=!!k3(Qk.SessionStorage)),bw}function mU(r,e){var t=N3();if(t!==null)try{return t.getItem(e)}catch(n){bw=!1,dl(r,2,2,"Browser failed read of session storage. "+lw(n),{exception:Nh(n)})}return null}function Zk(r,e,t){var n=N3();if(n!==null)try{return n.setItem(e,t),!0}catch(i){bw=!1,dl(r,2,4,"Browser failed write to session storage. "+lw(i),{exception:Nh(i)})}return!1}var bw,R3=he(()=>{p();ua();T3();Co();bw=void 0});function e0(r,e,t){var n=e[At],i=hU(r,e);if(i[At]!==n){for(var o=0,s=i;t[s]!==void 0;)o++,s=i[Vh](0,150-3)+gU(o);i=s}return i}function hU(r,e){var t;return e&&(e=ul(e[fl]()),e[At]>150&&(t=e[Vh](0,150),dl(r,2,57,"name is too long.  It has been truncated to 150 characters.",{name:e},!0))),t||e}function Yr(r,e,t){t===void 0&&(t=1024);var n;return e&&(t=t||1024,e=ul(e),e.toString()[At]>t&&(n=e[fl]()[Vh](0,t),dl(r,2,61,"string value is too long. It has been truncated to "+t+" characters.",{value:e},!0))),n||e}function rf(r,e){return n0(r,e,2048,66)}function fb(r,e){var t;return e&&e[At]>32768&&(t=e[Vh](0,32768),dl(r,2,56,"message is too long, it has been truncated to 32768 characters.",{message:e},!0)),t||e}function t0(r,e){var t;if(e){var n=""+e;n[At]>32768&&(t=n[Vh](0,32768),dl(r,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:e},!0))}return t||e}function Yi(r,e){if(e){var t={};wc(e,function(n,i){if(Ph(i)&&kh())try{i=cb()[mw](i)}catch(o){dl(r,2,49,"custom property is not valid",{exception:o},!0)}i=Yr(r,i,8192),n=e0(r,n,t),t[n]=i}),e=t}return e}function $i(r,e){if(e){var t={};wc(e,function(n,i){n=e0(r,n,t),t[n]=i}),e=t}return e}function r0(r,e){return e&&n0(r,e,128,69)[fl]()}function n0(r,e,t,n){var i;return e&&(e=ul(e),e[At]>t&&(i=e[Vh](0,t),dl(r,2,n,"input is too long, it has been truncated to "+t+" characters.",{data:e},!0))),i||e}function gU(r){var e="00"+r;return e.substr(e[At]-3)}var Qo,Que,ml=he(()=>{p();ua();Co();Que=(Qo={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768},Qo[C3]=e0,Qo.sanitizeKey=hU,Qo.sanitizeString=Yr,Qo.sanitizeUrl=rf,Qo.sanitizeMessage=fb,Qo[w3]=t0,Qo[x3]=Yi,Qo[P3]=$i,Qo.sanitizeId=r0,Qo.sanitizeInput=n0,Qo.padNumber=gU,Qo.trim=ul,Qo)});function O3(r){var e=M3,t=Xue,n=t[e];return A3.createElement?t[e]||(n=t[e]=A3.createElement("a")):n={host:L3(r,!0)},n.href=r,e++,e>=t[At]&&(e=0),M3=e,n}function L3(r,e){var t=K3(r,e)||"";if(t){var n=t.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[At]>3&&zo(n[2])&&n[2][At]>0)return n[2]+(n[3]||"")}return t}function K3(r,e){var t=null;if(r){var n=r.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[At]>2&&zo(n[2])&&n[2][At]>0&&(t=n[2]||"",e&&n[At]>2)){var i=(n[1]||"")[Mh](),o=n[3]||"";(i==="http"&&o===":80"||i==="https"&&o===":443")&&(o=""),t+=o}}return t}var A3,M3,Xue,F3=he(()=>{p();ua();Co();A3=lU()||{},M3=0,Xue=[null,null,null,null,null]});function Sw(r){return nU(Zue,r[Mh]())!==-1}function U3(r,e,t,n){var i,o=n,s=n;if(e&&e[At]>0){var a=O3(e);if(i=a.host,!o)if(a[hw]!=null){var l=a.pathname[At]===0?"/":a[hw];l.charAt(0)!=="/"&&(l="/"+l),s=a[hw],o=Yr(r,t?t+" "+l:l)}else o=Yr(r,e)}else i=n,o=n;return{target:i,name:o,data:s}}var Zue,vU=he(()=>{p();ua();pl();ml();F3();Co();Zue=[Rh+ld,"https://breeze.aimon.applicationinsights.io"+ld,"https://dc-int.services.visualstudio.com"+ld]});function yU(r){if(!r)return{};var e=r[Ah](ede),t=iU(e,function(i,o){var s=o[Ah](tde);if(s[At]===2){var a=s[0][Mh](),l=s[1];i[a]=l}return i},{});if(oU(t)[At]>0){if(t.endpointsuffix){var n=t.location?t.location+".":"";t[fw]=t[fw]||"https://"+n+"dc."+t.endpointsuffix}t[fw]=t[fw]||Rh}return t}var ede,tde,W3=he(()=>{p();ua();pl();Co();ede=";",tde="="});var bU,V3=he(()=>{p();ua();pl();Co();ml();bU=function(){function r(e,t,n){var i=this,o=this;o.ver=1,o.sampleRate=100,o.tags={},o[qi]=Yr(e,n)||ki,o.data=t,o.time=Vk(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return i.sampleRate===100?4:1},tags:1,data:1}}return r}()});var ud,j3=he(()=>{p();pl();Co();ml();ud=function(){function r(e,t,n,i){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var o=this;o.ver=2,o[qi]=Yr(e,t)||ki,o[Ji]=Yi(e,n),o[Gi]=$i(e,i)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Event",r.dataType="EventData",r}()});function EU(r,e){var t=r;return t&&!zo(t)&&(JSON&&JSON[mw]?(t=JSON[mw](r),e&&(!t||t==="{}")&&(ow(r[fl])?t=r[fl]():t=""+r)):t=""+r+" - (Missing JSON.stringify)"),t||""}function G3(r,e){var t=r;return r&&(t&&!zo(t)&&(t=r[_U]||r[J3]||t),t&&!zo(t)&&(t=EU(t,!0)),r.filename&&(t=t+" @"+(r.filename||"")+":"+(r.lineno||"?")+":"+(r.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&(t||"")[Gk](e)===-1&&(t=e+": "+t),t||""}function nde(r){try{if(Ph(r))return"hasFullStack"in r&&"typeName"in r}catch(e){}return!1}function ide(r){try{if(Ph(r))return"ver"in r&&"exceptions"in r&&"properties"in r}catch(e){}return!1}function H3(r){return r&&r.src&&zo(r.src)&&r.obj&&Dh(r.obj)}function jh(r){var e=r||"";zo(e)||(zo(e[Xo])?e=e[Xo]:e=""+e);var t=e[Ah](`
`);return{src:e,obj:t}}function ode(r){for(var e=[],t=r[Ah](`
`),n=0;n<t[At];n++){var i=t[n];t[n+1]&&(i+="@"+t[n+1],n++),e.push(i)}return{src:r,obj:e}}function Y3(r){var e=null;if(r)try{if(r[Xo])e=jh(r[Xo]);else if(r[mb]&&r[mb][Xo])e=jh(r[mb][Xo]);else if(r.exception&&r.exception[Xo])e=jh(r.exception[Xo]);else if(H3(r))e=r;else if(H3(r[IU]))e=r[IU];else if(window&&window.opera&&r[_U])e=ode(r[cd]);else if(r.reason&&r.reason[Xo])e=jh(r.reason[Xo]);else if(zo(r))e=jh(r);else{var t=r[_U]||r[J3]||"";zo(r[B3])&&(t&&(t+=`
`),t+=" from "+r[B3]),t&&(e=jh(t))}}catch(n){e=jh(n)}return e||{src:"",obj:null}}function sde(r){var e="";return r&&(r.obj?aw(r.obj,function(t){e+=t+`
`}):e=r.src||""),e}function ade(r){var e,t=r.obj;if(t&&t[At]>0){e=[];var n=0,i=0;aw(t,function(g){var b=g[fl]();if(CU.regex.test(b)){var y=new CU(b,n++);i+=y[Lh],e.push(y)}});var o=32*1024;if(i>o)for(var s=0,a=e[At]-1,l=0,u=s,c=a;s<a;){var d=e[s][Lh],f=e[a][Lh];if(l+=d+f,l>o){var m=c-u+1;e.splice(u,m);break}u=s,c=a,s++,a--}}return e}function i0(r){var e="";if(r&&(e=r.typeName||r[qi]||"",!e))try{var t=/function (.{1,200})\(/,n=t.exec(r.constructor[fl]());e=n&&n[At]>1?n[1]:""}catch(i){}return e}function SU(r){if(r)try{if(!zo(r)){var e=i0(r),t=EU(r,!1);return(!t||t==="{}")&&(r[mb]&&(r=r[mb],e=i0(r)),t=EU(r,!0)),t[Gk](e)!==0&&e!=="String"?e+":"+t:t}}catch(n){}return""+(r||"")}var rde,mb,Xo,IU,B3,_U,J3,Bh,q3,CU,$3=he(()=>{p();ir();ua();pl();Co();ml();rde="<no_method>",mb="error",Xo="stack",IU="stackDetails",B3="errorSrc",_U="message",J3="description";Bh=function(){function r(e,t,n,i,o,s){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var a=this;a.ver=2,ide(t)?(a[Oh]=t[Oh]||[],a[Ji]=t[Ji],a[Gi]=t[Gi],t[Kh]&&(a[Kh]=t[Kh]),t.id&&(a.id=t.id),t[Yk]&&(a[Yk]=t[Yk]),xh(t[$k])||(a[$k]=t[$k])):(n||(n={}),a[Oh]=[new q3(e,t,n)],a[Ji]=Yi(e,n),a[Gi]=$i(e,i),o&&(a[Kh]=o),s&&(a.id=s))}return r.CreateAutoException=function(e,t,n,i,o,s,a,l){var u,c=i0(o||s||e);return u={},u[cd]=G3(e,c),u.url=t,u.lineNumber=n,u.columnNumber=i,u.error=SU(o||s||e),u.evt=SU(s||e),u[xc]=c,u.stackDetails=Y3(a||o||s),u.errorSrc=l,u},r.CreateFromInterface=function(e,t,n,i){var o=t[Oh]&&Th(t[Oh],function(a){return q3[dU](e,a)}),s=new r(e,So(So({},t),{exceptions:o}),n,i);return s},r.prototype.toInterface=function(){var e,t=this,n=t.exceptions,i=t.properties,o=t.measurements,s=t.severityLevel,a=t.problemGroup,l=t.id,u=t.isManual,c=n instanceof Array&&Th(n,function(d){return d.toInterface()})||void 0;return e={ver:"4.0"},e[Oh]=c,e.severityLevel=s,e.properties=i,e.measurements=o,e.problemGroup=a,e.id=l,e.isManual=u,e},r.CreateSimpleException=function(e,t,n,i,o,s){var a;return{exceptions:[(a={},a[gw]=!0,a.message=e,a.stack=o,a.typeName=t,a)]}},r.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",r.dataType="ExceptionData",r.formatError=SU,r}(),q3=function(){function r(e,t,n){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var i=this;if(nde(t))i[xc]=t[xc],i[cd]=t[cd],i[Xo]=t[Xo],i[da]=t[da]||[],i[gw]=t[gw];else{var o=t,s=o&&o.evt;sw(o)||(o=o[mb]||s||o),i[xc]=Yr(e,i0(o))||ki,i[cd]=fb(e,G3(t||o,i[xc]))||ki;var a=t[IU]||Y3(t);i[da]=ade(a),Dh(i[da])&&Th(i[da],function(l){return l[Fh]=Yr(e,l[Fh])}),i[Xo]=t0(e,sde(a)),i.hasFullStack=Dh(i.parsedStack)&&i.parsedStack[At]>0,n&&(n[xc]=n[xc]||i[xc])}}return r.prototype.toInterface=function(){var e,t=this,n=t[da]instanceof Array&&Th(t[da],function(o){return o.toInterface()}),i=(e={id:t.id,outerId:t.outerId,typeName:t[xc],message:t[cd],hasFullStack:t[gw],stack:t[Xo]},e[da]=n||void 0,e);return i},r.CreateFromInterface=function(e,t){var n=t[da]instanceof Array&&Th(t[da],function(o){return CU[dU](o)})||t[da],i=new r(e,So(So({},t),{parsedStack:n}));return i},r}(),CU=function(){function r(e,t){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[Lh]=0,typeof e=="string"){var i=e;n[vw]=t,n[Uh]=rde,n[Fh]=ul(i),n[ub]="",n[db]=0;var o=i.match(r.regex);o&&o[At]>=5&&(n[Uh]=ul(o[2])||n[Uh],n[ub]=ul(o[4]),n[db]=parseInt(o[5])||0)}else n[vw]=e[vw],n[Uh]=e[Uh],n[Fh]=e[Fh],n[ub]=e[ub],n[db]=e[db],n[Lh]=0;n.sizeInBytes+=n.method[At],n.sizeInBytes+=n.fileName[At],n.sizeInBytes+=n.assembly[At],n[Lh]+=r.baseSize,n.sizeInBytes+=n.level.toString()[At],n.sizeInBytes+=n.line.toString()[At]}return r.CreateFromInterface=function(e){return new r(e,null)},r.prototype.toInterface=function(){var e=this;return{level:e[vw],method:e[Uh],assembly:e[Fh],fileName:e[ub],line:e[db]}},r.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,r.baseSize=58,r}()});var z3,Q3=he(()=>{p();z3=function(){function r(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return r}()});var dd,X3=he(()=>{p();pl();Co();Q3();ml();dd=function(){function r(e,t,n,i,o,s,a,l,u){this.aiDataContract={ver:1,metrics:1,properties:0};var c=this;c.ver=2;var d=new z3;d[E3]=i>0?i:void 0,d.max=isNaN(s)||s===null?void 0:s,d.min=isNaN(o)||o===null?void 0:o,d[qi]=Yr(e,t)||ki,d.value=n,d.stdDev=isNaN(a)||a===null?void 0:a,c.metrics=[d],c[Ji]=Yi(e,l),c[Gi]=$i(e,u)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",r.dataType="MetricData",r}()});var Hh,Z3=he(()=>{p();pl();fU();Co();ml();Hh=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var l=this;l.ver=2,l.id=r0(e,a),l.url=rf(e,n),l[qi]=Yr(e,t)||ki,isNaN(i)||(l[Wh]=zk(i)),l[Ji]=Yi(e,o),l[Gi]=$i(e,s)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",r.dataType="PageviewData",r}()});var qh,eq=he(()=>{p();fU();vU();Co();ml();qh=function(){function r(e,t,n,i,o,s,a,l,u,c,d,f){u===void 0&&(u="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var m=this;m.ver=2,m.id=t,m[Wh]=zk(o),m.success=s,m.resultCode=a+"",m.type=Yr(e,u);var g=U3(e,n,l,i);m.data=rf(e,i)||g.data,m.target=Yr(e,g.target),c&&(m.target="".concat(m.target," | ").concat(c)),m[qi]=Yr(e,g[qi]),m[Ji]=Yi(e,d),m[Gi]=$i(e,f)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",r.dataType="RemoteDependencyData",r}()});var Jh,tq=he(()=>{p();pl();Co();ml();Jh=function(){function r(e,t,n,i,o){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var s=this;s.ver=2,t=t||ki,s[cd]=fb(e,t),s[Ji]=Yi(e,i),s[Gi]=$i(e,o),n&&(s[Kh]=n)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Message",r.dataType="MessageData",r}()});var Gh,rq=he(()=>{p();pl();Co();ml();Gh=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var l=this;l.ver=2,l.url=rf(e,n),l[qi]=Yr(e,t)||ki,l[Ji]=Yi(e,o),l[Gi]=$i(e,s),a&&(l.domProcessing=a.domProcessing,l[Wh]=a[Wh],l.networkConnect=a.networkConnect,l.perfTotal=a.perfTotal,l[pU]=a[pU],l.sentRequest=a.sentRequest)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",r.dataType="PageviewPerformanceData",r}()});var pd,nq=he(()=>{p();pd=function(){function r(e,t){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=t}return r}()});var wU,iq=he(()=>{p();ua();wU=lb({Verbose:0,Information:1,Warning:2,Error:3,Critical:4})});function of(r){var e="ai."+r+".";return function(t){return e+t}}var Iw,Zn,o0,hb,xU,nf,Yh,_w,Ew,PU=he(()=>{p();ir();ua();Iw=of("application"),Zn=of("device"),o0=of("location"),hb=of("operation"),xU=of("session"),nf=of("user"),Yh=of("cloud"),_w=of("internal"),Ew=function(r){vn(e,r);function e(){return r.call(this)||this}return e}(sU({applicationVersion:Iw("ver"),applicationBuild:Iw("build"),applicationTypeId:Iw("typeId"),applicationId:Iw("applicationId"),applicationLayer:Iw("layer"),deviceId:Zn("id"),deviceIp:Zn("ip"),deviceLanguage:Zn("language"),deviceLocale:Zn("locale"),deviceModel:Zn("model"),deviceFriendlyName:Zn("friendlyName"),deviceNetwork:Zn("network"),deviceNetworkName:Zn("networkName"),deviceOEMName:Zn("oemName"),deviceOS:Zn("os"),deviceOSVersion:Zn("osVersion"),deviceRoleInstance:Zn("roleInstance"),deviceRoleName:Zn("roleName"),deviceScreenResolution:Zn("screenResolution"),deviceType:Zn("type"),deviceMachineName:Zn("machineName"),deviceVMName:Zn("vmName"),deviceBrowser:Zn("browser"),deviceBrowserVersion:Zn("browserVersion"),locationIp:o0("ip"),locationCountry:o0("country"),locationProvince:o0("province"),locationCity:o0("city"),operationId:hb("id"),operationName:hb("name"),operationParentId:hb("parentId"),operationRootId:hb("rootId"),operationSyntheticSource:hb("syntheticSource"),operationCorrelationVector:hb("correlationVector"),sessionId:xU("id"),sessionIsFirst:xU("isFirst"),sessionIsNew:xU("isNew"),userAccountAcquisitionDate:nf("accountAcquisitionDate"),userAccountId:nf("accountId"),userAgent:nf("userAgent"),userId:nf("id"),userStoreRegion:nf("storeRegion"),userAuthUserId:nf("authUserId"),userAnonymousUserAcquisitionDate:nf("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:nf("authUserAcquisitionDate"),cloudName:Yh("name"),cloudRole:Yh("role"),cloudRoleVer:Yh("roleVer"),cloudRoleInstance:Yh("roleInstance"),cloudEnvironment:Yh("environment"),cloudLocation:Yh("location"),cloudDeploymentUnit:Yh("deploymentUnit"),internalNodeName:_w("nodeName"),internalSdkVersion:_w("sdkVersion"),internalAgentVersion:_w("agentVersion"),internalSnippet:_w("snippet"),internalSdkSrc:_w("sdkSrc")}))});var ei,oq=he(()=>{p();PU();ei=new Ew});var sq,sf=he(()=>{p();vU();W3();D3();pl();V3();j3();$3();X3();Z3();eq();tq();rq();nq();iq();PU();ml();oq();R3();sq="AppInsightsChannelPlugin"});var aq,$h,DU,zi,s0,a0,l0,Ni,c0,hl,lq,TU,cq,fd,u0,gb,vb,kU,zh,md,Pc,Cw,Qh,NU,d0,yb,p0,uq,hd,RU,dq,f0,Qi,Dc,m0,AU,Xh,gl,h0,vl=he(()=>{p();aq="initialize",$h="name",DU="identifier",zi="push",s0="isInitialized",a0="config",l0="logger",Ni="length",c0="time",hl="processNext",lq="getProcessTelContext",TU="getPlugin",cq="splice",fd="teardown",u0="messageId",gb="message",vb="isAsync",kU="_doTeardown",zh="update",md="getNext",Pc="diagLog",Cw="setNextPlugin",Qh="createNew",NU="indexOf",d0="userAgent",yb="split",p0="nodeType",uq="apply",hd="replace",RU="enableDebugExceptions",dq="logInternalMessage",f0="toLowerCase",Qi="call",Dc="type",m0="handler",AU="isChildEvt",Xh="getCtx",gl="setCtx",h0="complete"});var _r,wo,pq,g0,af,fq,MU,v0,ww,OU,Tc=he(()=>{p();_r="",wo="core",pq="disabled",g0="extensionConfig",af="processTelemetry",fq="priority",MU="perfEvent",v0="errorToConsole",ww="warnToConsole",OU="getPerfMgr"});function Sde(r){if(r){if(b0)return b0(r);var e=r[dde]||r[Mt]||r[y0];if(e)return e}return null}function yl(r){return r===void 0||typeof r===Yt}function Ut(r){return r===null||yl(r)}function lf(r){return!!(r&&typeof r===dt)}function Zr(r){return!!(r&&typeof r===Qr)}function xw(r){var e=r;return e&&cf(e)&&(e=e[hd](vde,function(t,n){return n.toUpperCase()}),e=e[hd](yde,"_"),e=e[hd](bde,function(t,n){return"_"+n})),e}function Xi(r,e){if(r)for(var t in r)nr[Qi](r,t)&&e[Qi](r,t,r[t])}function bb(r,e){return r&&e?r[NU](e)!==-1:!1}function Ide(r){return!!(r&&Iq[Qi](r)==="[object Array]")}function Eq(r){return!!(r&&Iq[Qi](r)==="[object Error]")}function cf(r){return typeof r=="string"}function FU(r){return typeof r=="number"}function Cq(r){return typeof r=="boolean"}function vq(r){var e=!1;if(r&&typeof r=="object"){var t=b0?b0(r):Sde(r);t?(t[y0]&&nr[Qi](t,y0)&&(t=t[y0]),e=typeof t===Qr&&_q[Qi](t)===gde):e=!0}return e}function UU(r){if(r)return mde?r[bq]():_de(r)}function _de(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[Ni]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function yi(r,e,t){var n=r[Ni];try{for(var i=0;i<n&&!(i in r&&e[Qi](t||r,r[i],i,r)===-1);i++);}catch(o){}}function S0(r,e,t){if(r){if(r[mq])return r[mq](e,t);var n=r[Ni],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function uf(r){var e=typeof r;if(e!==Qr&&(e!==dt||r===null)&&na("objKeys called on non-object"),!yq&&gq)return gq(r);var t=[];for(var n in r)r&&nr[Qi](r,n)&&t[zi](n);if(yq)for(var i=LU[Ni],o=0;o<i;o++)r&&nr[Qi](r,LU[o])&&t[zi](LU[o]);return t}function WU(r,e,t,n){if(hq)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),hq(r,e,i),!0}catch(o){}return!1}function Ede(r){return r}function gd(){var r=Date;return r.now?r.now():new r().getTime()}function pa(r){return Eq(r)?r[$h]:_r}function Pw(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Dw(r,e){return Ut(r)?e:r}function jU(r){return!!r}function Cde(r,e){var t=null,n=null;return Zr(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][uq](n,i)}}function I0(r,e,t,n,i){r&&e&&t&&(i!==!1||yl(r[e]))&&(r[e]=Cde(t,n))}function BU(r,e,t,n){return r&&e&&lf(r)&&$r(t)&&yi(t,function(i){cf(i)&&I0(r,i,e,i,n)}),r}function _0(r){return r&&Ha&&(r=Ir(Ha({},r))),r}function E0(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[Ni],u=!1,c=1;for(l>0&&Cq(a)&&(u=a,a=s[c]||{},c++),lf(a)||(a={});c<l;c++){var d=s[c],f=$r(d),m=lf(d);for(var g in d){var b=f&&g in d||m&&nr[Qi](d,g);if(b){var y=d[g],P=void 0;if(u&&y&&((P=$r(y))||vq(y))){var A=a[g];P?$r(A)||(A=[]):vq(A)||(A={}),y=E0(u,A,y)}y!==void 0&&(a[g]=y)}}}return a}var bq,lde,cde,mq,ude,Sq,dde,y0,hq,pde,KVe,gq,KU,FVe,UVe,WVe,fde,mde,hde,Iq,_q,gde,vde,yde,bde,b0,$r,yq,LU,VU,bl=he(()=>{p();ir();vl();Tc();bq="toISOString",lde="endsWith",cde="startsWith",mq="indexOf",ude="trim",Sq="toString",dde="__proto__",y0="constructor",hq=yo,pde=Ir.freeze,KVe=Ir.seal,gq=Ir.keys,KU=String[Mt],FVe=KU[ude],UVe=KU[lde],WVe=KU[cde],fde=Date[Mt],mde=fde[bq],hde=Array.isArray,Iq=ra[Sq],_q=nr[Sq],gde=_q[Qi](Ir),vde=/-([a-z])/g,yde=/([^\w\d_$])/g,bde=/^(\d+[\w\d_$])/,b0=Object.getPrototypeOf;$r=hde||Ide;yq=!{toString:null}.propertyIsEnumerable("toString"),LU=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];VU=pde||Ede});function Dq(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Mt];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!yl(i[e])}catch(o){}}return t}function xo(r){var e=Kn();return e&&e[r]?e[r]:r===wq&&$U()?window:null}function $U(){return!!(typeof window===dt&&window)}function Ib(){return $U()?window:xo(wq)}function Tq(){return!!(typeof document===dt&&document)}function C0(){return Tq()?document:xo(wde)}function zU(){return!!(typeof navigator===dt&&navigator)}function df(){return zU()?navigator:xo(Pde)}function QU(){return typeof console!==Yt?console:xo(Dde)}function Zh(){return!!(typeof JSON===dt&&JSON||xo(xq)!==null)}function Zo(){return Zh()?JSON||xo(xq):null}function XU(){return xo(Tde)}function ZU(){return xo(kde)}function eW(){var r=df();if(r&&(r[d0]!==qU||HU===null)){qU=r[d0];var e=(qU||_r)[f0]();HU=bb(e,GU)||bb(e,YU)}return HU}function tW(r){if(r===void 0&&(r=null),!r){var e=df()||{};r=e?(e[d0]||_r)[f0]():_r}var t=(r||_r)[f0]();if(bb(t,GU)){var n=C0()||{};return Math.max(parseInt(t[yb](GU)[1]),n[xde]||0)}else if(bb(t,YU)){var i=parseInt(t[yb](YU)[1]);if(i)return i+4}return null}function Wn(r){var e=Object[Mt].toString[Qi](r),t=_r;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[$h]+"'":Zh()&&(t=Zo().stringify(r)),e+t}function _b(){return JU===null&&(JU=zU()&&!!df().sendBeacon),JU}function w0(r){var e=!1;try{e=!!xo("fetch");var t=xo("Request");e&&r&&t&&(e=Dq(t,"keepalive"))}catch(n){}return e}function x0(){return Sb===null&&(Sb=typeof XDomainRequest!==Yt,Sb&&Tw()&&(Sb=Sb&&!Dq(xo(Pq),"withCredentials"))),Sb}function Tw(){var r=!1;try{var e=xo(Pq);r=!!e}catch(t){}return r}var wq,wde,xde,Pde,Dde,xq,Tde,kde,GU,YU,Pq,HU,qU,Sb,JU,eg=he(()=>{"use strict";p();ir();vl();bl();Tc();wq="window",wde="document",xde="documentMode",Pde="navigator",Dde="console",xq="JSON",Tde="crypto",kde="msCrypto",GU="msie",YU="trident/",Pq="XMLHttpRequest",HU=null,qU=null,Sb=null,JU=null});function Nde(){var r=xo("Microsoft");return r&&(P0=r.ApplicationInsights),P0}function kq(r){var e=P0;return!e&&r.disableDbgExt!==!0&&(e=P0||Nde()),e?e.ChromeDbgExt:null}var P0,Nq=he(()=>{p();eg();P0=null});function Rq(r){return r?'"'+r[hd](/\"/g,_r)+'"':_r}function Aq(r,e){var t=QU();if(t){var n="log";t[r]&&(n=r),Zr(t[n])&&t[n](e)}}function kw(r,e){return(r||{})[l0]||new nW(e)}function Mq(r){return r||new nW}function ft(r,e,t,n,i,o){o===void 0&&(o=!1),Mq(r).throwInternal(e,t,n,i,o)}function Nw(r,e){Mq(r)[ww](e)}var Rde,Ade,Mde,rW,nW,D0=he(()=>{"use strict";p();ur();vl();Nq();eg();bl();Tc();Rde="AI (Internal): ",Ade="AI: ",Mde="AITR_";rW=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[u0]=e,o[gb]=(n?Ade:Rde)+e;var s=_r;Zh()&&(s=Zo().stringify(i));var a=(t?" message:"+Rq(t):_r)+(i?" props:"+Rq(s):_r);o[gb]+=a}return r.dataType="MessageData",r}();nW=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[RU]=function(){return a},l.throwInternal=function(m,g,b,y,P){P===void 0&&(P=!1);var A=new rW(g,b,P,y);if(a)throw Wn(A);var D=m===1?v0:ww;if(yl(A[gb]))f("throw"+(m===1?"Critical":"Warning"),A);else{if(P){var T=+A[u0];!n[T]&&i>=m&&(l[D](A[gb]),n[T]=!0)}else i>=m&&l[D](A[gb]);u(m,A)}},l[ww]=function(m){Aq("warn",m),f("warning",m)},l[v0]=function(m){Aq("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[dq]=u;function u(m,g){if(!d()){var b=!0,y=Mde+g[u0];if(n[y]?b=!1:n[y]=!0,b&&(m<=o&&(l.queue[zi](g),t++,f(m===1?"error":"warn",g)),t===s)){var P="Internal events throttle limit per PageView reached for this app.",A=new rW(23,P,!1);l.queue[zi](A),m===1?l[v0](P):l[ww](P)}}}function c(m){i=Dw(m.loggingLevelConsole,0),o=Dw(m.loggingLevelTelemetry,1),s=Dw(m.maxMessageLimit,25),a=Dw(m[RU],!1)}function d(){return t>=s}function f(m,g){var b=kq(e||{});b&&b[Pc]&&b[Pc](m,g)}})}return r.__ieDyn=1,r}()});function Oq(r,e,t,n,i){if(r){var o=r;if(o[OU]&&(o=o[OU]()),o){var s=void 0,a=o[Xh](iW);try{if(s=o.create(e(),n,i),s){if(a&&s[gl]&&(s[gl](T0[oW],a),a[Xh]&&a[gl])){var l=a[Xh](T0[Rw]);l||(l=[],a[gl](T0[Rw],l)),l[zi](s)}return o[gl](iW,s),t(s)}}catch(u){s&&s[gl]&&s[gl]("exception",u)}finally{s&&o.fire(s),o[gl](iW,a)}}}return t()}var Eb,oW,Rw,T0,uje,iW,Lq=he(()=>{p();ur();vl();bl();Tc();Eb="ctx",oW="ParentContextKey",Rw="ChildrenContextKey",T0=function(){function r(e,t,n){var i=this,o=!1;if(i.start=gd(),i[$h]=e,i[vb]=n,i[AU]=function(){return!1},Zr(t)){var s;o=WU(i,"payload",function(){return!s&&Zr(t)&&(s=t(),t=null),s})}i[Xh]=function(a){return a?a===r[oW]||a===r[Rw]?i[a]:(i[Eb]||{})[a]:null},i[gl]=function(a,l){if(a)if(a===r[oW])i[a]||(i[AU]=function(){return!0}),i[a]=l;else if(a===r[Rw])i[a]=l;else{var u=i[Eb]=i[Eb]||{};u[a]=l}},i[h0]=function(){var a=0,l=i[Xh](r[Rw]);if($r(l))for(var u=0;u<l[Ni];u++){var c=l[u];c&&(a+=c[c0])}i[c0]=gd()-i.start,i.exTime=i[c0]-a,i[h0]=function(){},!o&&Zr(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),uje=function(){function r(e){this.ctx={},He(r,this,function(t){t.create=function(n,i,o){return new T0(n,i,o)},t.fire=function(n){n&&(n[h0](),e&&Zr(e[MU])&&e[MU](n))},t[gl]=function(n,i){if(n){var o=t[Eb]=t[Eb]||{};o[n]=i}},t[Xh]=function(n){return(t[Eb]||{})[n]}})}return r.__ieDyn=1,r}(),iW="CoreUtils.doPerf"});function Ode(r){r<0&&(r>>>=0),Aw=123456789+r&tg,Mw=987654321-r&tg,Uq=!0}function Lde(){try{var r=gd()&2147483647;Ode((Math.random()*Fq^r)+r)}catch(e){}}function Kq(r){var e=0,t=XU()||ZU();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&tg),e===0&&eW()&&(Uq||Lde(),e=Kde()&tg),e===0&&(e=Math.floor(Fq*Math.random()|0)),r||(e>>>=0),e}function Kde(r){Mw=36969*(Mw&65535)+(Mw>>16)&tg,Aw=18e3*(Aw&65535)+(Aw>>16)&tg;var e=(Mw<<16)+(Aw&65535)>>>0&tg|0;return r||(e>>>=0),e}function Wq(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=Kq()>>>0,n=0,i=_r;i[Ni]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(Kq()<<2&4294967295|t&3)>>>0,n=0);return i}var Fq,tg,Uq,Aw,Mw,Vq=he(()=>{p();vl();eg();bl();Tc();Fq=4294967296,tg=4294967295,Uq=!1,Aw=123456789,Mw=987654321});function Wde(r,e,t){if(jq)try{return jq(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function Hq(r){return r[p0]===1||r[p0]===9||!+r[p0]}function Vde(r,e){var t=e[r.id];if(!t){t={};try{Hq(e)&&(Wde(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function vd(r,e){return e===void 0&&(e=!1),xw(r+Ude+++(e?"."+Bq:_r)+Fde)}function k0(r){var e={id:vd("_aiData-"+(r||_r)+"."+Bq),accept:function(t){return Hq(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[xw(n)]:(o&&(s=Vde(e,t),s[xw(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var jq,Bq,Fde,Ude,N0=he(()=>{p();ir();vl();bl();Tc();Vq();jq=yo,Bq="2.8.11",Fde="."+Wq(6),Ude=0});function $q(r){return r&&r[hd]?r[hd](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,_r):r}function aW(r,e){var t;if(e){var n=_r;$r(e)?(n=_r,yi(e,function(o){o=$q(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=$q(e),n&&(n[0]!=="."&&(n="."+n),r=(r||_r)+n)}var i=qde.exec(r||_r)||[];return t={},t[Dc]=i[1],t.ns=(i[2]||_r).replace(jde,".").replace(Bde,_r)[yb](".").sort().join("."),t}function Xq(r,e,t){t===void 0&&(t=!0);var n=R0.get(r,sW,{},t),i=n[e];return i||(i=n[e]=[]),i}function Zq(r,e,t,n){r&&e&&e[Dc]&&(r[Yq]?r[Yq](e[Dc],t,n):r[Gq]&&r[Gq](Qq+e[Dc],t))}function Jde(r,e,t,n){var i=!1;return r&&e&&e[Dc]&&t&&(r[Jq]?(r[Jq](e[Dc],t,n),i=!0):r[qq]&&(r[qq](Qq+e[Dc],t),i=!0)),i}function zq(r,e,t,n){for(var i=e[Ni];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(Zq(r,o.evtName,o[m0],o.capture),e[cq](i,1))}}function Gde(r,e,t){if(e[Dc])zq(r,Xq(r,e[Dc]),e,t);else{var n=R0.get(r,sW,{});Xi(n,function(i,o){zq(r,o,e,t)}),uf(n)[Ni]===0&&R0.kill(r,sW)}}function Ow(r,e){var t;return e?($r(e)?t=[r].concat(e):t=[r,e],t=aW("xx",t).ns[yb](".")):t=r,t}function A0(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=aW(e,n);if(s=Jde(r,a,t,i),s&&R0.accept(r)){var l=(o={guid:Hde++,evtName:a},o[m0]=t,o.capture=i,o);Xq(r,a.type)[zi](l)}}catch(u){}return s}function lW(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=aW(e,n),s=!1;Gde(r,o,function(a){return o.ns&&!t||a[m0]===t?(s=!0,!0):!1}),s||Zq(r,o,t,i)}catch(a){}}var Qq,qq,Jq,Gq,Yq,sW,kje,Nje,jde,Bde,Hde,R0,qde,eJ=he(()=>{p();vl();N0();bl();Tc();Qq="on",qq="attachEvent",Jq="addEventListener",Gq="detachEvent",Yq="removeEventListener",sW="events",kje=vd("aiEvtPageHide"),Nje=vd("aiEvtPageShow"),jde=/\.[\.]+/g,Bde=/[\.]+$/,Hde=1,R0=k0("events"),qde=/^([^.]*)(?:\.(.+)|)/});function M0(r){return Yde.get(r,"state",{},!0)}var Yde,tJ=he(()=>{"use strict";p();N0();Yde=k0("plugin")});function zde(r,e,t){for(;r;){if(r[TU]()===t)return r;r=r[md]()}return Lw([t],e[a0]||{},e)}function cW(r,e,t,n){var i=null,o=[];n!==null&&(i=n?zde(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return kw(t,e)},getCfg:function(){return e},getExtCfg:u,getConfig:c,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:d,onComplete:a}};function a(f,m){for(var g=[],b=2;b<arguments.length;b++)g[b-2]=arguments[b];f&&o[zi]({func:f,self:yl(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[md]():null,!f){var m=o;m&&m[Ni]>0&&(yi(m,function(g){try{g.func[Qi](g.self,g.args)}catch(b){ft(t[l0],2,73,"Unexpected Exception during onComplete - "+Wn(b))}}),o=[])}return f}function u(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var b;if(e){var y=e[g0];y&&f&&(b=y[f])}if(!b)b=m;else if(lf(m)&&g!==0){var P=E0(!0,m,b);e&&g===2&&Xi(m,function(A){if(Ut(P[A])){var D=e[A];Ut(D)||(P[A]=D)}}),b=P}return b}function c(f,m,g){g===void 0&&(g=!1);var b,y=u(f,null);return y&&!Ut(y[m])?b=y[m]:e&&!Ut(e[m])&&(b=e[m]),Ut(b)?g:b}function d(f){for(var m;m=s._next();){var g=m[TU]();g&&f(g)}}return s}function Cb(r,e,t,n){var i=cW(r,e,t,n),o=i.ctx;function s(l){var u=i._next();return u&&u[af](l,o),!u}function a(l,u){return l===void 0&&(l=null),$r(l)&&(l=Lw(l,e,t,u)),Cb(l||o[md](),e,t,u)}return o[hl]=s,o[Qh]=a,o}function uW(r,e,t){var n=e[a0]||{},i=cW(r,n,e,t),o=i.ctx;function s(l){var u=i._next();return u&&u.unload(o,l),!u}function a(l,u){return l===void 0&&(l=null),$r(l)&&(l=Lw(l,n,e,u)),uW(l||o[md](),e,u)}return o[hl]=s,o[Qh]=a,o}function dW(r,e,t){var n=e[a0]||{},i=cW(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(u){Zr(u[zh])&&u[zh](o,l)})}function a(l,u){return l===void 0&&(l=null),$r(l)&&(l=Lw(l,n,e,u)),dW(l||o[md](),e,u)}return o[hl]=s,o[Qh]=a,o}function Lw(r,e,t,n){var i=null,o=!n;if($r(r)&&r[Ni]>0){var s=null;yi(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&Zr(a[af])){var l=Qde(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Lw([n],e,t):i}function Qde(r,e,t){var n=null,i=Zr(r[af]),o=Zr(r[Cw]),s;r?s=r[DU]+"-"+r[fq]+"-"+iJ++:s="Unknown-0-"+iJ++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:c,unload:d,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&Zr(r[nJ])&&(m=r[nJ]()),m||(m=Cb(a,e,t)),m}function u(m,g,b,y,P){var A=!1,D=r?r[DU]:$de,T=m[rJ];return T||(T=m[rJ]={}),m.setNext(n),r&&Oq(m[wo](),function(){return D+":"+b},function(){T[s]=!0;try{var K=n?n._id:_r;K&&(T[K]=!1),A=g(m)}catch(B){var L=n?T[n._id]:!0;L&&(A=!0),(!n||!L)&&ft(m[Pc](),1,73,"Plugin ["+D+"] failed during "+b+" - "+Wn(B)+", run flags: "+Wn(T))}},y,P),A}function c(m,g){g=g||l();function b(y){if(!r||!i)return!1;var P=M0(r);return P[fd]||P[pq]?!1:(o&&r[Cw](n),r[af](m,y),!0)}u(g,b,"processTelemetry",function(){return{item:m}},!m.sync)||g[hl](m)}function d(m,g){function b(){var y=!1;if(r){var P=M0(r),A=r[wo]||P[wo];r&&(!A||A===m.core())&&!P[fd]&&(P[wo]=null,P[fd]=!0,P[s0]=!1,r[fd]&&r[fd](m,g)===!0&&(y=!0))}return y}u(m,b,"unload",function(){},g[vb])||m[hl](g)}function f(m,g){function b(){var y=!1;if(r){var P=M0(r),A=r[wo]||P[wo];r&&(!A||A===m.core())&&!P[fd]&&r[zh]&&r[zh](m,g)===!0&&(y=!0)}return y}u(m,b,"update",function(){},!1)||m[hl](g)}return VU(a)}var $de,rJ,nJ,iJ,Hje,oJ=he(()=>{"use strict";p();vl();D0();eg();bl();Tc();Lq();tJ();$de="TelemetryPluginChain",rJ="_hasRun",nJ="_getTelCtx",iJ=0;Hje=function(){function r(e,t,n,i){var o=this,s=Cb(e,t,n,i);BU(o,s,uf(s))}return r}()});function sJ(){var r=[];function e(n){n&&r[zi](n)}function t(n,i){yi(r,function(o){try{o(n,i)}catch(s){ft(n[Pc](),2,73,"Unexpected error calling unload handler - "+Wn(s))}}),r=[]}return{add:e,run:t}}var aJ=he(()=>{p();vl();D0();eg();bl()});var pf,pW,lJ=he(()=>{"use strict";p();ur();vl();bl();Tc();oJ();aJ();pf="getPlugin",pW=function(){function r(){var e=this,t,n,i,o,s;u(),He(r,e,function(c){c[aq]=function(d,f,m,g){l(d,f,g),t=!0},c[fd]=function(d,f){var m,g=c[wo];if(!g||d&&g!==d[wo]())return;var b,y=!1,P=d||uW(null,g,i&&i[pf]?i[pf]():i),A=f||(m={reason:0},m[vb]=!1,m);function D(){if(!y){y=!0,o.run(P,f);var T=s;s=[],yi(T,function(K){K.rm()}),b===!0&&P[hl](A),u()}}return!c[kU]||c[kU](P,A,D)!==!0?D():b=!0,b},c[zh]=function(d,f){var m=c[wo];if(!m||d&&m!==d[wo]())return;var g,b=!1,y=d||dW(null,m,i&&i[pf]?i[pf]():i),P=f||{reason:0};function A(){b||(b=!0,l(y.getCfg(),y.core(),y[md]()))}return!c._doUpdate||c._doUpdate(y,P,A)!==!0?A():g=!0,g},c._addHook=function(d){d&&($r(d)?s=s.concat(d):s[zi](d))},I0(c,"_addUnloadCb",function(){return o},"add")}),e[Pc]=function(c){return a(c)[Pc]()},e[s0]=function(){return t},e.setInitialized=function(c){t=c},e[Cw]=function(c){i=c},e[hl]=function(c,d){d?d[hl](c):i&&Zr(i[af])&&i[af](c,null)},e._getTelCtx=a;function a(c){c===void 0&&(c=null);var d=c;if(!d){var f=n||Cb(null,{},e[wo]);i&&i[pf]?d=f[Qh](null,i[pf]):d=f[Qh](null,i)}return d}function l(c,d,f){c&&Pw(c,g0,[],null,Ut),!f&&d&&(f=d[lq]()[md]());var m=i;i&&i[pf]&&(m=i[pf]()),e[wo]=d,n=Cb(f,c,d,m)}function u(){t=!1,e[wo]=null,n=null,i=null,s=[],o=sJ()}}return r.__ieDyn=1,r}()});var rg=he(()=>{p();lJ();bl();eJ();eg();D0();N0()});var ff,cJ=he(()=>{p();ff="duration"});var Vn,O0,es,kc,ng,Tt,mf,hf,fa,gf,yd,Kw,ig,vf,bd,Fw,yf,og,bf,sg,wb,Sf,xb,Sd,L0,ag,Zi,fW,K0,Pb,Wr,lg,mW,hW,Uw,If,gW,Db,vW,F0,U0,Tb,yW,uJ,ma,W0,Ww,Vw,dJ,kb,V0,bW,SW,IW,j0,pJ,Id=he(()=>{p();Vn="tags",O0="deviceType",es="data",kc="name",ng="traceID",Tt="length",mf="stringify",hf="measurements",fa="dataType",gf="envelopeType",yd="toString",Kw="onLine",ig="enqueue",vf="count",bd="push",Fw="emitLineDelimitedJson",yf="clear",og="batchPayloads",bf="markAsSent",sg="clearSent",wb="BUFFER_KEY",Sf="SENT_BUFFER_KEY",xb="MAX_BUFFER_SIZE",Sd="namePrefix",L0="maxBatchSizeInBytes",ag="triggerSend",Zi="diagLog",fW="onunloadDisableBeacon",K0="isBeaconApiDisabled",Pb="_sender",Wr="_senderConfig",lg="_buffer",mW="enableSessionStorageBuffer",hW="samplingPercentage",Uw="instrumentationKey",If="endpointUrl",gW="customHeaders",Db="disableXhr",vW="onunloadDisableFetch",F0="disableTelemetry",U0="baseType",Tb="sampleRate",yW="convertUndefined",uJ="_xhrReadyStateChange",ma="_onError",W0="_onPartialSuccess",Ww="_onSuccess",Vw="itemsAccepted",dJ="itemsReceived",kb="isRetryDisabled",V0="setRequestHeader",bW="maxBatchInterval",SW="eventsSendRequest",IW="disableInstrumentationKeyValidation",j0="getSamplingScore",pJ="getHashCodeScore"});function jn(r,e,t){return Pw(r,e,t,jU)}function Xde(r,e,t){var n=t[Vn]=t[Vn]||{},i=e.ext=e.ext||{},o=e[Vn]=e[Vn]||[],s=i.user;s&&(jn(n,ei.userAuthUserId,s.authId),jn(n,ei.userId,s.id||s.localId));var a=i.app;a&&jn(n,ei.sessionId,a.sesId);var l=i.device;l&&(jn(n,ei.deviceId,l.id||l.localId),jn(n,ei[O0],l.deviceClass),jn(n,ei.deviceIp,l.ip),jn(n,ei.deviceModel,l.model),jn(n,ei[O0],l[O0]));var u=e.ext.web;if(u){jn(n,ei.deviceLanguage,u.browserLang),jn(n,ei.deviceBrowserVersion,u.browserVer),jn(n,ei.deviceBrowser,u.browser);var c=t[es]=t[es]||{},d=c[en]=c[en]||{},f=d[bi]=d[bi]||{};jn(f,"domain",u.domain),jn(f,"isManual",u.isManual?fJ:null),jn(f,"screenRes",u.screenRes),jn(f,"userConsent",u.userConsent?fJ:null)}var m=i.os;m&&jn(n,ei.deviceOS,m[kc]);var g=i.trace;g&&(jn(n,ei.operationParentId,g.parentID),jn(n,ei.operationName,Yr(r,g[kc])),jn(n,ei.operationId,g[ng]));for(var b={},y=o[Tt]-1;y>=0;y--){var P=o[y];Xi(P,function(D,T){b[D]=T}),o.splice(y,1)}Xi(o,function(D,T){b[D]=T});var A=So(So({},n),b);A[ei.internalSdkVersion]||(A[ei.internalSdkVersion]="javascript:".concat(Zde.Version)),t[Vn]=_0(A)}function _f(r,e,t){Ut(r)||Xi(r,function(n,i){FU(i)?t[n]=i:cf(i)?e[n]=i:Zh()&&(e[n]=Zo()[mf](i))})}function cg(r,e){Ut(r)||Xi(r,function(t,n){r[t]=n||e})}function ug(r,e,t,n){var i=new bU(r,n,e);jn(i,"sampleRate",t[dw]),(t[en]||{}).startTime&&(i.time=UU(t[en].startTime)),i.iKey=t.iKey;var o=t.iKey.replace(/-/g,"");return i[kc]=i[kc].replace("{0}",o),Xde(r,t,i),t[Vn]=t[Vn]||[],_0(i)}function dg(r,e){Ut(e[en])&&ft(r,1,46,"telemetryItem.baseData cannot be null.")}function mJ(r,e,t){dg(r,e);var n=e[en][hf]||{},i=e[en][bi]||{};_f(e[es],i,n),Ut(t)||cg(i,t);var o=e[en];if(Ut(o))return Nw(r,"Invalid input for dependency data"),null;var s=o[bi]&&o[bi][Jk]?o[bi][Jk]:"GET",a=new qh(r,o.id,o.target,o[kc],o[ff],o.success,o.responseCode,s,o.type,o.correlationContext,i,n),l=new pd(qh[fa],a);return ug(r,qh[gf],e,l)}function EW(r,e,t){dg(r,e);var n={},i={};e[_W]!==ud[fa]&&(n.baseTypeSource=e[_W]),e[_W]===ud[fa]?(n=e[en][bi]||{},i=e[en][hf]||{}):e[en]&&_f(e[en],n,i),_f(e[es],n,i),Ut(t)||cg(n,t);var o=e[en][kc],s=new ud(r,o,n,i),a=new pd(ud[fa],s);return ug(r,ud[gf],e,a)}function hJ(r,e,t){dg(r,e);var n=e[en][hf]||{},i=e[en][bi]||{};_f(e[es],i,n),Ut(t)||cg(i,t);var o=e[en],s=Bh.CreateFromInterface(r,o,i,n),a=new pd(Bh[fa],s);return ug(r,Bh[gf],e,a)}function gJ(r,e,t){dg(r,e);var n=e[en],i=n[bi]||{},o=n[hf]||{};_f(e[es],i,o),Ut(t)||cg(i,t);var s=new dd(r,n[kc],n.average,n.sampleCount,n.min,n.max,n.stdDev,i,o),a=new pd(dd[fa],s);return ug(r,dd[gf],e,a)}function vJ(r,e,t){dg(r,e);var n,i=e[en];!Ut(i)&&!Ut(i[bi])&&!Ut(i[bi][ff])?(n=i[bi][ff],delete i[bi][ff]):!Ut(e[es])&&!Ut(e[es][ff])&&(n=e[es][ff],delete e[es][ff]);var o=e[en],s;((e.ext||{}).trace||{})[ng]&&(s=e.ext.trace[ng]);var a=o.id||s,l=o[kc],u=o.uri,c=o[bi]||{},d=o[hf]||{};if(Ut(o.refUri)||(c.refUri=o.refUri),Ut(o.pageType)||(c.pageType=o.pageType),Ut(o.isLoggedIn)||(c.isLoggedIn=o.isLoggedIn[yd]()),!Ut(o[bi])){var f=o[bi];Xi(f,function(b,y){c[b]=y})}_f(e[es],c,d),Ut(t)||cg(c,t);var m=new Hh(r,l,u,n,c,d,a),g=new pd(Hh[fa],m);return ug(r,Hh[gf],e,g)}function yJ(r,e,t){dg(r,e);var n=e[en],i=n[kc],o=n.uri||n.url,s=n[bi]||{},a=n[hf]||{};_f(e[es],s,a),Ut(t)||cg(s,t);var l=new Gh(r,i,o,void 0,s,a,n),u=new pd(Gh[fa],l);return ug(r,Gh[gf],e,u)}function bJ(r,e,t){dg(r,e);var n=e[en].message,i=e[en].severityLevel,o=e[en][bi]||{},s=e[en][hf]||{};_f(e[es],o,s),Ut(t)||cg(o,t);var a=new Jh(r,n,i,o,s),l=new pd(Jh[fa],a);return ug(r,Jh[gf],e,l)}var _W,en,bi,fJ,Zde,SJ=he(()=>{p();ir();sf();rg();cJ();Id();_W="baseType",en="baseData",bi="properties",fJ="true";Zde={Version:"2.8.11"}});function IJ(r,e){lW(r,null,null,e)}function _J(r){var e=C0(),t=df(),n=!1,i=!0,o=Ow(vd("OfflineListener"),r);try{if(a(Ib())&&(n=!0),e){var s=e.body||e;s.ononline&&a(s)&&(n=!0)}n&&t&&!Ut(t[Kw])&&(i=t[Kw])}catch(f){n=!1}function a(f){var m=!1;return f&&(m=A0(f,"online",l,o),m&&A0(f,"offline",u,o)),m}function l(){i=!0}function u(){i=!1}function c(){var f=!0;return n?f=i:t&&!Ut(t[Kw])&&(f=t[Kw]),f}function d(){var f=Ib();if(f&&n){if(IJ(f,o),e){var m=e.body||e;yl(m.ononline)||IJ(m,o)}n=!1}}return{isOnline:c,isListening:function(){return n},unload:d}}var EJ=he(()=>{p();rg();Id()});var CJ,wJ,xJ,PJ=he(()=>{p();ir();ur();sf();rg();Id();CJ=function(){function r(e,t){var n=[],i=!1;this._get=function(){return n},this._set=function(o){return n=o,n},He(r,this,function(o){o[ig]=function(s){if(o[vf]()>=t.eventsLimitInMem()){i||(ft(e,2,105,"Maximum in-memory buffer size reached: "+o[vf](),!0),i=!0);return}n[bd](s)},o[vf]=function(){return n[Tt]},o.size=function(){for(var s=n[Tt],a=0;a<n[Tt];a++)s+=n[a][Tt];return t[Fw]()||(s+=2),s},o[yf]=function(){n=[],i=!1},o.getItems=function(){return n.slice(0)},o[og]=function(s){if(s&&s[Tt]>0){var a=t[Fw]()?s.join(`
`):"["+s.join(",")+"]";return a}return null}})}return r.__ieDyn=1,r}(),wJ=function(r){vn(e,r);function e(t,n){var i=r.call(this,t,n)||this;return He(e,i,function(o,s){o[bf]=function(a){s[yf]()},o[sg]=function(a){}}),i}return e.__ieDyn=1,e}(CJ),xJ=function(r){vn(e,r);function e(t,n){var i=r.call(this,t,n)||this,o=!1;return He(e,i,function(s,a){var l=f(e[wb]),u=f(e[Sf]),c=s._set(l.concat(u));c[Tt]>e[xb]&&(c[Tt]=e[xb]),m(e[Sf],[]),m(e[wb],c),s[ig]=function(g){if(s[vf]()>=e[xb]){o||(ft(t,2,67,"Maximum buffer size reached: "+s[vf](),!0),o=!0);return}a[ig](g),m(e[wb],s._get())},s[yf]=function(){a[yf](),m(e[wb],s._get()),m(e[Sf],[]),o=!1},s[bf]=function(g){m(e[wb],s._set(d(g,s._get())));var b=f(e[Sf]);b instanceof Array&&g instanceof Array&&(b=b.concat(g),b[Tt]>e[xb]&&(ft(t,1,67,"Sent buffer reached its maximum size: "+b[Tt],!0),b[Tt]=e[xb]),m(e[Sf],b))},s[sg]=function(g){var b=f(e[Sf]);b=d(g,b),m(e[Sf],b)};function d(g,b){var y=[];return yi(b,function(P){!Zr(P)&&S0(g,P)===-1&&y[bd](P)}),y}function f(g){var b=g;try{b=n[Sd]&&n[Sd]()?n[Sd]()+"_"+b:b;var y=mU(t,b);if(y){var P=Zo().parse(y);if(cf(P)&&(P=Zo().parse(P)),P&&$r(P))return P}}catch(A){ft(t,1,42," storage key: "+b+", "+pa(A),{exception:Wn(A)})}return[]}function m(g,b){var y=g;try{y=n[Sd]&&n[Sd]()?n[Sd]()+"_"+y:y;var P=JSON[mf](b);Zk(t,y,P)}catch(A){Zk(t,y,JSON[mf]([])),ft(t,2,41," storage key: "+y+", "+pa(A)+". Buffer cleared",{exception:Wn(A)})}}}),i}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(CJ)});var DJ,TJ=he(()=>{p();ur();rg();Id();DJ=function(){function r(e){He(r,this,function(t){t.serialize=function(s){var a=n(s,"root");try{return Zo()[mf](a)}catch(l){ft(e,1,48,l&&Zr(l[yd])?l[yd]():"Error serializing object",null,!0)}};function n(s,a){var l="__aiCircularRefCheck",u={};if(!s)return ft(e,1,48,"cannot serialize object because it is null or undefined",{name:a},!0),u;if(s[l])return ft(e,2,50,"Circular reference detected while serializing object",{name:a},!0),u;if(!s.aiDataContract){if(a==="measurements")u=o(s,"number",a);else if(a==="properties")u=o(s,"string",a);else if(a==="tags")u=o(s,"string",a);else if($r(s))u=i(s,a);else{ft(e,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:a},!0);try{Zo()[mf](s),u=s}catch(c){ft(e,1,48,c&&Zr(c[yd])?c[yd]():"Error serializing object",null,!0)}}return u}return s[l]=!0,Xi(s.aiDataContract,function(c,d){var f=Zr(d)?d()&1:d&1,m=Zr(d)?d()&4:d&4,g=d&2,b=s[c]!==void 0,y=lf(s[c])&&s[c]!==null;if(f&&!b&&!g)ft(e,1,24,"Missing required field specification. The field is required but not present on source",{field:c,name:a});else if(!m){var P=void 0;y?g?P=i(s[c],c):P=n(s[c],c):P=s[c],P!==void 0&&(u[c]=P)}}),delete s[l],u}function i(s,a){var l;if(s)if(!$r(s))ft(e,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:a},!0);else{l=[];for(var u=0;u<s[Tt];u++){var c=s[u],d=n(c,a+"["+u+"]");l[bd](d)}}return l}function o(s,a,l){var u;return s&&(u={},Xi(s,function(c,d){if(a==="string")d===void 0?u[c]="undefined":d===null?u[c]="null":d[yd]?u[c]=d[yd]():u[c]="invalid field: toString() is not defined.";else if(a==="number")if(d===void 0)u[c]="undefined";else if(d===null)u[c]="null";else{var f=parseFloat(d);isNaN(f)?u[c]="NaN":u[c]=f}else u[c]="invalid field: "+l+" is of unknown type.",ft(e,1,u[c],null,!0)})),u}})}return r.__ieDyn=1,r}()});var epe,kJ,NJ=he(()=>{p();Id();epe=8,kJ=function(){function r(){}return r.prototype.getHashCodeScore=function(e){var t=this.getHashCode(e)/r.INT_MAX_VALUE;return t*100},r.prototype.getHashCode=function(e){if(e==="")return 0;for(;e[Tt]<epe;)e=e.concat(e);for(var t=5381,n=0;n<e[Tt];++n)t=(t<<5)+t+e.charCodeAt(n),t=t&t;return Math.abs(t)},r.INT_MAX_VALUE=2147483647,r}()});var RJ,AJ=he(()=>{p();sf();Id();NJ();RJ=function(){function r(){var e=this,t=new kJ,n=new Ew;e[j0]=function(i){var o=0;return i[Vn]&&i[Vn][n.userId]?o=t.getHashCodeScore(i[Vn][n.userId]):i.ext&&i.ext.user&&i.ext.user.id?o=t[pJ](i.ext.user.id):i[Vn]&&i[Vn][n.operationId]?o=t.getHashCodeScore(i[Vn][n.operationId]):i.ext&&i.ext.telemetryTrace&&i.ext.telemetryTrace[ng]?o=t.getHashCodeScore(i.ext.telemetryTrace[ng]):o=Math.random()*100,o}}return r}()});var MJ,OJ=he(()=>{p();sf();rg();Id();AJ();MJ=function(){function r(e,t){this.INT_MAX_VALUE=2147483647;var n=t||kw(null);(e>100||e<0)&&(n.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[Tb]=e,this.samplingScoreGenerator=new RJ}return r.prototype.isSampledIn=function(e){var t=this[Tb],n=!1;return t==null||t>=100||e.baseType===dd[fa]?!0:(n=this.samplingScoreGenerator[j0](e)<t,n)},r}()});function B0(r){try{return r.responseText}catch(e){}return null}function LJ(){var r,e,t;return r={endpointUrl:function(){return Rh+ld}},r[Fw]=function(){return!1},r[bW]=function(){return 15e3},r[L0]=function(){return 102400},r[F0]=function(){return!1},r[mW]=function(){return!0},r[kb]=function(){return!1},r[K0]=function(){return!0},r[Db]=function(){return!1},r[vW]=function(){return!1},r[fW]=function(){return!1},r[Uw]=function(){return e},r[Sd]=function(){return e},r[hW]=function(){return 100},r[gW]=function(){return t},r[yW]=function(){return e},r.eventsLimitInMem=function(){return 1e4},r}var _d,tpe,rpe,jw,KJ=he(()=>{p();ir();ur();sf();rg();SJ();EJ();PJ();TJ();OJ();Id();tpe=65e3;rpe=(_d={},_d[ud.dataType]=EW,_d[Jh.dataType]=bJ,_d[Hh.dataType]=vJ,_d[Gh.dataType]=yJ,_d[Bh.dataType]=hJ,_d[dd.dataType]=gJ,_d[qh.dataType]=mJ,_d),jw=function(r){vn(e,r);function e(){var t=r.call(this)||this;t.priority=1001,t.identifier=sq,t._senderConfig=LJ();var n,i,o,s,a,l,u,c,d=0,f,m,g,b;return He(e,t,function(y,P){ye(),y.pause=function(){Z(),s=!0},y.resume=function(){s&&(s=!1,i=null,y._buffer.size()>y._senderConfig[L0]()&&y[ag](!0,null,10),Y())},y.flush=function(z,fe,Ie){if(z===void 0&&(z=!0),!s){Z();try{y[ag](z,null,Ie||1)}catch(Te){ft(y[Zi](),1,22,"flush failed, telemetry will not be collected: "+pa(Te),{exception:Wn(Te)})}}},y.onunloadFlush=function(){if(!s)if((y._senderConfig[fW]()===!1||y[Wr][K0]()===!1)&&_b())try{y[ag](!0,K,2)}catch(z){ft(y[Zi](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+pa(z),{exception:Wn(z)})}else y.flush()},y.addHeader=function(z,fe){c[z]=fe},y.initialize=function(z,fe,Ie,Te){y.isInitialized()&&ft(y[Zi](),1,28,"Sender is already initialized"),P.initialize(z,fe,Ie,Te);var Le=y._getTelCtx(),$e=y.identifier;l=new DJ(fe.logger),n=0,i=null,o=0,y[Pb]=null,u=0;var Ge=y[Zi]();b=Ow(vd("Sender"),fe.evtNamespace&&fe.evtNamespace()),g=_J(b);var Bt=LJ();Xi(Bt,function(S,I){y[Wr][S]=function(){var _=Le.getConfig($e,S,I());return!_&&S==="endpointUrl"&&(_=I()),_}}),y._buffer=y[Wr][mW]()&&Xk()?new xJ(Ge,y[Wr]):new wJ(Ge,y[Wr]),y._sample=new MJ(y[Wr][hW](),Ge),pe(z)||ft(Ge,1,100,"Invalid Instrumentation key "+z[Uw]),!Sw(y._senderConfig.endpointUrl())&&y._senderConfig.customHeaders()&&y._senderConfig.customHeaders()[Tt]>0&&yi(y[Wr][gW](),function(S){t.addHeader(S.header,S.value)});var R=y[Wr],M=null;!R[Db]()&&x0()?M=be:!R[Db]()&&Tw()&&(M=N),!M&&w0()&&(M=h),f=M||N,!R[K0]()&&_b()&&(M=B),y[Pb]=M||N,!R[vW]()&&w0(!0)?m=O:_b()?m=B:!R[Db]()&&x0()?m=be:!R[Db]()&&Tw()?m=N:m=f},y.processTelemetry=function(z,fe){fe=y._getTelCtx(fe);var Ie=fe[Zi]();try{if(y[Wr][F0]())return;if(!z){ft(Ie,1,7,"Cannot send empty telemetry");return}if(z.baseData&&!z[U0]){ft(Ie,1,70,"Cannot send telemetry without baseData and baseType");return}if(z[U0]||(z[U0]="EventData"),!y[Pb]){ft(Ie,1,28,"Sender was not initialized");return}if(A(z))z[dw]=y._sample[Tb];else{ft(Ie,2,33,"Telemetry item was sampled out and not sent",{SampleRate:y._sample[Tb]});return}var Te=y[Wr][yW]()||void 0,Le=z.iKey||y[Wr][Uw](),$e=e.constructEnvelope(z,Le,Ie,Te);if(!$e){ft(Ie,1,47,"Unable to create an AppInsights envelope");return}var Ge=!1;if(z[Vn]&&z[Vn][pw]&&(yi(z[Vn][pw],function(S){try{S&&S($e)===!1&&(Ge=!0,Nw(Ie,"Telemetry processor check returns false"))}catch(I){ft(Ie,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+pa(I),{exception:Wn(I)},!0)}}),delete z[Vn][pw]),Ge)return;var Bt=l.serialize($e),R=y[lg],M=R.size();M+Bt[Tt]>y[Wr][L0]()&&y[ag](!0,null,10),R[ig](Bt),Y()}catch(S){ft(Ie,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+pa(S),{exception:Wn(S)})}y.processNext(z,fe)},y[uJ]=function(z,fe,Ie){z.readyState===4&&D(z.status,fe,z.responseURL,Ie,ce(z),B0(z)||z.response)},y[ag]=function(z,fe,Ie){if(z===void 0&&(z=!0),!s)try{var Te=y[lg];if(y[Wr][F0]())Te[yf]();else{if(Te[vf]()>0){var Le=Te.getItems();de(Ie||0,z),fe?fe.call(t,Le,z):y[Pb](Le,z)}o=+new Date}Z()}catch(Ge){var $e=tW();(!$e||$e>9)&&ft(y[Zi](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+pa(Ge),{exception:Wn(Ge)})}},y._doTeardown=function(z,fe){y.onunloadFlush(),g.unload(),ye()},y[ma]=function(z,fe,Ie){ft(y[Zi](),2,26,"Failed to send telemetry.",{message:fe}),y._buffer[sg](z)},y[W0]=function(z,fe){for(var Ie=[],Te=[],Le=fe.errors.reverse(),$e=0,Ge=Le;$e<Ge.length;$e++){var Bt=Ge[$e],R=z.splice(Bt.index,1)[0];ie(Bt.statusCode)?Te[bd](R):Ie[bd](R)}z[Tt]>0&&y[Ww](z,fe[Vw]),Ie[Tt]>0&&y[ma](Ie,ce(null,["partial success",fe[Vw],"of",fe.itemsReceived].join(" "))),Te[Tt]>0&&(k(Te),ft(y[Zi](),2,40,"Partial success. Delivered: "+z[Tt]+", Failed: "+Ie[Tt]+". Will retry to send "+Te[Tt]+" our of "+fe[dJ]+" items"))},y[Ww]=function(z,fe){y._buffer[sg](z)},y._xdrOnLoad=function(z,fe){var Ie=B0(z);if(z&&(Ie+""=="200"||Ie===""))n=0,y[Ww](fe,0);else{var Te=C(Ie);Te&&Te.itemsReceived&&Te.itemsReceived>Te[Vw]&&!y[Wr][kb]()?y[W0](fe,Te):y[ma](fe,q(z))}};function A(z){return y._sample.isSampledIn(z)}function D(z,fe,Ie,Te,Le,$e){var Ge=null;if(y._appId||(Ge=C($e),Ge&&Ge.appId&&(y._appId=Ge.appId)),(z<200||z>=300)&&z!==0){if((z===301||z===307||z===308)&&!T(Ie)){y[ma](fe,Le);return}!y[Wr][kb]()&&ie(z)?(k(fe),ft(y[Zi](),2,40,". Response code "+z+". Will retry to send "+fe[Tt]+" items.")):y[ma](fe,Le)}else if(g&&!g.isOnline()){if(!y[Wr][kb]()){var Bt=10;k(fe,Bt),ft(y[Zi](),2,40,". Offline - Response Code: ".concat(z,". Offline status: ").concat(!g.isOnline(),". Will retry to send ").concat(fe.length," items."))}}else T(Ie),z===206?(Ge||(Ge=C($e)),Ge&&!y[Wr][kb]()?y[W0](fe,Ge):y[ma](fe,Le)):(n=0,y[Ww](fe,Te))}function T(z){return u>=10?!1:!Ut(z)&&z!==""&&z!==y[Wr][If]()?(y[Wr][If]=function(){return z},++u,!0):!1}function K(z,fe){m?m(z,!1):B(z,fe)}function L(z){var fe=df(),Ie=y[lg],Te=y[Wr][If](),Le=y._buffer[og](z),$e=new Blob([Le],{type:"text/plain;charset=UTF-8"}),Ge=fe.sendBeacon(Te,$e);return Ge&&(Ie[bf](z),y._onSuccess(z,z[Tt])),Ge}function B(z,fe){if($r(z)&&z[Tt]>0&&!L(z)){for(var Ie=[],Te=0;Te<z[Tt];Te++){var Le=z[Te];L([Le])||Ie[bd](Le)}Ie[Tt]>0&&(f&&f(Ie,!0),ft(y[Zi](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function N(z,fe){var Ie=new XMLHttpRequest,Te=y[Wr][If]();try{Ie[uw]=!0}catch($e){}Ie.open("POST",Te,fe),Ie[V0]("Content-type","application/json"),Sw(Te)&&Ie[V0](pb[6],pb[7]),yi(uf(c),function($e){Ie[V0]($e,c[$e])}),Ie.onreadystatechange=function(){return y._xhrReadyStateChange(Ie,z,z[Tt])},Ie.onerror=function($e){return y[ma](z,ce(Ie),$e)};var Le=y._buffer[og](z);Ie.send(Le),y._buffer[bf](z)}function O(z,fe){if($r(z)){for(var Ie=z[Tt],Te=0;Te<z[Tt];Te++)Ie+=z[Te][Tt];d+Ie<=tpe?v(z,!1):_b()?B(z,fe):(f&&f(z,!0),ft(y[Zi](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."))}}function h(z,fe){v(z,!0)}function v(z,fe){var Ie,Te=y[Wr][If](),Le=y._buffer[og](z),$e=new Blob([Le],{type:"application/json"}),Ge=new Headers,Bt=Le[Tt],R=!1,M=!1;Sw(Te)&&Ge.append(pb[6],pb[7]),yi(uf(c),function(_){Ge.append(_,c[_])});var S=(Ie={method:"POST",headers:Ge,body:$e},Ie[uw]=!0,Ie);fe||(S.keepalive=!0,R=!0,d+=Bt);var I=new Request(Te,S);try{I[uw]=!0}catch(_){}y._buffer[bf](z);try{fetch(I).then(function(_){fe||(d-=Bt,Bt=0),M||(M=!0,_.ok?_.text().then(function(F){D(_.status,z,_.url,z[Tt],_.statusText,F)}):y[ma](z,_.statusText))}).catch(function(_){fe||(d-=Bt,Bt=0),M||(M=!0,y[ma](z,_.message))})}catch(_){M||y[ma](z,Wn(_))}R&&!M&&(M=!0,y._onSuccess(z,z[Tt]))}function C(z){try{if(z&&z!==""){var fe=Zo().parse(z);if(fe&&fe.itemsReceived&&fe.itemsReceived>=fe[Vw]&&fe.itemsReceived-fe.itemsAccepted===fe.errors[Tt])return fe}}catch(Ie){ft(y[Zi](),1,43,"Cannot parse the response. "+pa(Ie),{response:z})}return null}function k(z,fe){if(fe===void 0&&(fe=1),!(!z||z[Tt]===0)){var Ie=y[lg];Ie[sg](z),n++;for(var Te=0,Le=z;Te<Le.length;Te++){var $e=Le[Te];Ie[ig]($e)}H(fe),Y()}}function H(z){var fe=10,Ie;if(n<=1)Ie=fe;else{var Te=(Math.pow(2,n)-1)/2,Le=Math.floor(Math.random()*Te*fe)+1;Le=z*Le,Ie=Math.max(Math.min(Le,3600),fe)}var $e=gd()+Ie*1e3;i=$e}function Y(){if(!a&&!s){var z=i?Math.max(0,i-gd()):0,fe=Math.max(y[Wr][bW](),z);a=setTimeout(function(){a=null,y[ag](!0,null,1)},fe)}}function Z(){clearTimeout(a),a=null,i=null}function ie(z){return z===401||z===403||z===408||z===429||z===500||z===502||z===503||z===504}function ce(z,fe){return z?"XMLHttpRequest,Status:"+z.status+",Response:"+B0(z)||z.response||"":fe}function be(z,fe){var Ie=y[lg],Te=Ib(),Le=new XDomainRequest;Le.onload=function(){return y._xdrOnLoad(Le,z)},Le.onerror=function(R){return y[ma](z,q(Le),R)};var $e=Te&&Te.location&&Te.location.protocol||"";if(y[Wr][If]().lastIndexOf($e,0)!==0){ft(y[Zi](),2,40,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),Ie[yf]();return}var Ge=y[Wr][If]().replace(/^(https?:)/,"");Le.open("POST",Ge);var Bt=Ie[og](z);Le.send(Bt),Ie[bf](z)}function q(z,fe){return z?"XDomainRequest,Response:"+B0(z)||"":fe}function $(){var z="getNotifyMgr";return y.core[z]?y.core[z]():y.core._notificationManager}function de(z,fe){var Ie=$();if(Ie&&Ie[SW])try{Ie[SW](z,fe)}catch(Te){ft(y[Zi](),1,74,"send request notification failed: "+pa(Te),{exception:Wn(Te)})}}function pe(z){var fe=Ut(z[IW])?!1:z[IW];if(fe)return!0;var Ie="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",Te=new RegExp(Ie);return Te.test(z[Uw])}function ye(){y[Pb]=null,y[lg]=null,y._appId=null,y._sample=null,c={},g=null,n=0,i=null,o=null,s=!1,a=null,l=null,u=0,d=0,f=null,m=null,b=null}}),t}return e.constructEnvelope=function(t,n,i,o){var s;n!==t.iKey&&!Ut(n)?s=So(So({},t),{iKey:n}):s=t;var a=rpe[s.baseType]||EW;return a(i,s,o)},e}(pW)});var CW=he(()=>{p();KJ()});var Sl,ts,Bw,Il,Lt,Ps,Nc,H0,Ds,St,pg,Vr,q0,fg,mg,wW,Hw,hg,Nb,qw,Ef,Ts,Rb,Cf,_l,Ab,gg,ks,ha,wf,Ed,xW,xf,El,Jw,Gw,Cd,vg,J0,Mb,Cl,PW,FJ,UJ,Bn,Yw,WJ,yg,$w,bg,wl,G0,Y0,$0,z0,Pn=he(()=>{p();Sl="initialize",ts="name",Bw="getNotifyMgr",Il="identifier",Lt="push",Ps="isInitialized",Nc="config",H0="instrumentationKey",Ds="logger",St="length",pg="time",Vr="processNext",q0="getProcessTelContext",fg="addNotificationListener",mg="removeNotificationListener",wW="stopPollingInternalLogs",Hw="onComplete",hg="getPlugin",Nb="flush",qw="_extensions",Ef="splice",Ts="teardown",Rb="messageId",Cf="message",_l="isAsync",Ab="_doTeardown",gg="update",ks="getNext",ha="diagLog",wf="setNextPlugin",Ed="createNew",xW="cookieCfg",xf="indexOf",El="substring",Jw="userAgent",Gw="split",Cd="setEnabled",vg="substr",J0="nodeType",Mb="apply",Cl="replace",PW="enableDebugExceptions",FJ="logInternalMessage",UJ="toLowerCase",Bn="call",Yw="type",WJ="handler",yg="listeners",$w="isChildEvt",bg="getCtx",wl="setCtx",G0="complete",Y0="traceId",$0="spanId",z0="traceFlags"});var kt,DW,cn,TW,zw,Ob,VJ,rs,ga,Lb,Pf,Kb,Df,Q0,Qw,Sg,Si=he(()=>{p();kt="",DW="channels",cn="core",TW="createPerfMgr",zw="disabled",Ob="extensionConfig",VJ="extensions",rs="processTelemetry",ga="priority",Lb="eventsSent",Pf="eventsDiscarded",Kb="eventsSendRequest",Df="perfEvent",Q0="errorToConsole",Qw="warnToConsole",Sg="getPerfMgr"});function mpe(r){if(r){if(Z0)return Z0(r);var e=r[ipe]||r[Mt]||r[X0];if(e)return e}return null}function OW(r,e){return typeof r===e}function Dn(r){return r===void 0||typeof r===Yt}function or(r){return r===null||Dn(r)}function LW(r){return!or(r)}function KW(r,e){return!!(r&&nr[Bn](r,e))}function wd(r){return!!(r&&typeof r===dt)}function Er(r){return!!(r&&typeof r===Qr)}function Xw(r){var e=r;return e&&Tf(e)&&(e=e[Cl](dpe,function(t,n){return n.toUpperCase()}),e=e[Cl](ppe,"_"),e=e[Cl](fpe,function(t,n){return"_"+n})),e}function xd(r,e){if(r)for(var t in r)nr[Bn](r,t)&&e[Bn](r,t,r[t])}function FW(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=spe?r[zJ](e):hpe(r,e)),t}function hpe(r,e){var t=!1,n=e?e[St]:0,i=r?r[St]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function Ri(r,e){return r&&e?r[xf](e)!==-1:!1}function UW(r){return!!(r&&MW[Bn](r)==="[object Date]")}function gpe(r){return!!(r&&MW[Bn](r)==="[object Array]")}function eN(r){return!!(r&&MW[Bn](r)==="[object Error]")}function Tf(r){return typeof r=="string"}function WW(r){return typeof r=="number"}function Fb(r){return typeof r=="boolean"}function GJ(r){var e=!1;if(r&&typeof r=="object"){var t=Z0?Z0(r):mpe(r);t?(t[X0]&&nr[Bn](t,X0)&&(t=t[X0]),e=typeof t===Qr&&XJ[Bn](t)===upe):e=!0}return e}function Ub(r){if(r)return lpe?r[$J]():vpe(r)}function vpe(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[St]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function Ct(r,e,t){var n=r[St];try{for(var i=0;i<n&&!(i in r&&e[Bn](t||r,r[i],i,r)===-1);i++);}catch(o){}}function va(r,e,t){if(r){if(r[jJ])return r[jJ](e,t);var n=r[St],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function VW(r,e,t){var n;if(r){if(r[BJ])return r[BJ](e,t);var i=r[St],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[Bn](o,r[s],r))}catch(a){}}return n}function jW(r,e,t){var n;if(r){if(r[HJ])return r[HJ](e,t);var i=r[St],o=0;if(arguments[St]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function xl(r){return r&&(r=ope&&r[NW]?r[NW]():r[Cl]?r[Cl](/^\s+|(?=\s)\s+$/g,kt):r),r}function Wb(r){var e=typeof r;if(e!==Qr&&(e!==dt||r===null)&&na("objKeys called on non-object"),!YJ&&JJ)return JJ(r);var t=[];for(var n in r)r&&nr[Bn](r,n)&&t[Lt](n);if(YJ)for(var i=kW[St],o=0;o<i;o++)r&&nr[Bn](r,kW[o])&&t[Lt](kW[o]);return t}function Vb(r,e,t,n){if(qJ)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),qJ(r,e,i),!0}catch(o){}return!1}function ype(r){return r}function BW(r){return RW&&xd(r,function(e,t){(tn(t)||wd(t))&&RW(t)}),Rc(r)}function Pl(){var r=Date;return r.now?r.now():new r().getTime()}function Zw(r){return eN(r)?r[ts]:kt}function ya(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function jb(r,e,t){var n;return r?(n=r[e],!n&&or(n)&&(n=Dn(t)?{}:t,r[e]=n)):n=Dn(t)?{}:t,n}function ba(r,e){return or(r)?e:r}function tN(r){return!!r}function ti(r){throw new Error(r)}function bpe(r,e){var t=null,n=null;return Er(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][Mb](n,i)}}function Bb(r,e,t,n,i){r&&e&&t&&(i!==!1||Dn(r[e]))&&(r[e]=bpe(t,n))}function Pd(r,e,t,n){return r&&e&&wd(r)&&tn(t)&&Ct(t,function(i){Tf(i)&&Bb(r,i,e,i,n)}),r}function Hb(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[St],u=!1,c=1;for(l>0&&Fb(a)&&(u=a,a=s[c]||{},c++),wd(a)||(a={});c<l;c++){var d=s[c],f=tn(d),m=wd(d);for(var g in d){var b=f&&g in d||m&&nr[Bn](d,g);if(b){var y=d[g],P=void 0;if(u&&y&&((P=tn(y))||GJ(y))){var A=a[g];P?tn(A)||(A=[]):GJ(A)||(A={}),y=Hb(u,A,y)}y!==void 0&&(a[g]=y)}}}return a}var $J,zJ,npe,jJ,BJ,HJ,NW,QJ,ipe,X0,qJ,RW,pHe,JJ,AW,ope,spe,fHe,ape,lpe,cpe,MW,XJ,upe,dpe,ppe,fpe,Z0,tn,YJ,kW,Rc,Hn=he(()=>{p();ir();Pn();Si();$J="toISOString",zJ="endsWith",npe="startsWith",jJ="indexOf",BJ="map",HJ="reduce",NW="trim",QJ="toString",ipe="__proto__",X0="constructor",qJ=yo,RW=Ir.freeze,pHe=Ir.seal,JJ=Ir.keys,AW=String[Mt],ope=AW[NW],spe=AW[zJ],fHe=AW[npe],ape=Date[Mt],lpe=ape[$J],cpe=Array.isArray,MW=ra[QJ],XJ=nr[QJ],upe=XJ[Bn](Ir),dpe=/-([a-z])/g,ppe=/([^\w\d_$])/g,fpe=/^(\d+[\w\d_$])/,Z0=Object.getPrototypeOf;tn=cpe||gpe;YJ=!{toString:null}.propertyIsEnumerable("toString"),kW=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];Rc=RW||ype});function HW(r){var e={};return xd(r,function(t,n){e[t]=n,e[n]=t}),BW(e)}var ZJ=he(()=>{p();Hn()});function Ns(r){var e=Kn();return e&&e[r]?e[r]:r===e4&&r4()?window:null}function r4(){return!!(typeof window===dt&&window)}function n4(){return r4()?window:Ns(e4)}function kpe(){return!!(typeof document===dt&&document)}function rN(){return kpe()?document:Ns(Spe)}function Npe(){return!!(typeof navigator===dt&&navigator)}function GW(){return Npe()?navigator:Ns(Ipe)}function i4(r){if(r&&Tpe){var e=Ns("__mockLocation");if(e)return e}return typeof location===dt&&location?location:Ns(_pe)}function o4(){return typeof console!==Yt?console:Ns(Epe)}function s4(){return Ns(Cpe)}function nN(){return!!(typeof JSON===dt&&JSON||Ns(t4)!==null)}function YW(){return nN()?JSON||Ns(t4):null}function a4(){return Ns(wpe)}function l4(){return Ns(xpe)}function Ig(){var r=GW();if(r&&(r[Jw]!==JW||qW===null)){JW=r[Jw];var e=(JW||kt)[UJ]();qW=Ri(e,Ppe)||Ri(e,Dpe)}return qW}function Sa(r){var e=Object[Mt].toString[Bn](r),t=kt;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[ts]+"'":nN()&&(t=YW().stringify(r)),e+t}var e4,Spe,Ipe,_pe,Epe,Cpe,t4,wpe,xpe,Ppe,Dpe,qW,JW,Tpe,Ac=he(()=>{"use strict";p();ir();Pn();Hn();Si();e4="window",Spe="document",Ipe="navigator",_pe="location",Epe="console",Cpe="performance",t4="JSON",wpe="crypto",xpe="msCrypto",Ppe="msie",Dpe="trident/",qW=null,JW=null,Tpe=!1});function Rpe(r,e){return function(){var t=arguments,n=zW(e);if(n){var i=n.listener;i&&i[r]&&i[r][Mb](i,t)}}}function Ape(){var r=Ns("Microsoft");return r&&(oN=r.ApplicationInsights),oN}function zW(r){var e=oN;return!e&&r.disableDbgExt!==!0&&(e=oN||Ape()),e?e.ChromeDbgExt:null}function c4(r){if(!iN){iN={};for(var e=0;e<$W[St];e++)iN[$W[e]]=Rpe($W[e],r)}return iN}var $W,oN,iN,QW=he(()=>{p();Pn();Ac();$W=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],oN=null});function u4(r){return r?'"'+r[Cl](/\"/g,kt)+'"':kt}function d4(r,e){var t=o4();if(t){var n="log";t[r]&&(n=r),Er(t[n])&&t[n](e)}}function p4(r,e){return(r||{})[Ds]||new qb(e)}function f4(r){return r||new qb}function Dl(r,e,t,n,i,o){o===void 0&&(o=!1),f4(r).throwInternal(e,t,n,i,o)}function m4(r,e){f4(r)[Qw](e)}var Mpe,Ope,Lpe,sN,qb,_g=he(()=>{"use strict";p();ur();Pn();QW();Ac();Hn();Si();Mpe="AI (Internal): ",Ope="AI: ",Lpe="AITR_";sN=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Rb]=e,o[Cf]=(n?Ope:Mpe)+e;var s=kt;nN()&&(s=YW().stringify(i));var a=(t?" message:"+u4(t):kt)+(i?" props:"+u4(s):kt);o[Cf]+=a}return r.dataType="MessageData",r}();qb=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;He(r,this,function(l){c(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[PW]=function(){return a},l.throwInternal=function(m,g,b,y,P){P===void 0&&(P=!1);var A=new sN(g,b,P,y);if(a)throw Sa(A);var D=m===1?Q0:Qw;if(Dn(A[Cf]))f("throw"+(m===1?"Critical":"Warning"),A);else{if(P){var T=+A[Rb];!n[T]&&i>=m&&(l[D](A[Cf]),n[T]=!0)}else i>=m&&l[D](A[Cf]);u(m,A)}},l[Qw]=function(m){d4("warn",m),f("warning",m)},l[Q0]=function(m){d4("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[FJ]=u;function u(m,g){if(!d()){var b=!0,y=Lpe+g[Rb];if(n[y]?b=!1:n[y]=!0,b&&(m<=o&&(l.queue[Lt](g),t++,f(m===1?"error":"warn",g)),t===s)){var P="Internal events throttle limit per PageView reached for this app.",A=new sN(23,P,!1);l.queue[Lt](A),m===1?l[Q0](P):l[Qw](P)}}}function c(m){i=ba(m.loggingLevelConsole,0),o=ba(m.loggingLevelTelemetry,1),s=ba(m.maxMessageLimit,25),a=ba(m[PW],!1)}function d(){return t>=s}function f(m,g){var b=zW(e||{});b&&b[ha]&&b[ha](m,g)}})}return r.__ieDyn=1,r}()});function lN(r,e,t,n,i){if(r){var o=r;if(o[Sg]&&(o=o[Sg]()),o){var s=void 0,a=o[bg](XW);try{if(s=o.create(e(),n,i),s){if(a&&s[wl]&&(s[wl](aN[ZW],a),a[bg]&&a[wl])){var l=a[bg](aN[ex]);l||(l=[],a[wl](aN[ex],l)),l[Lt](s)}return o[wl](XW,s),t(s)}}catch(u){s&&s[wl]&&s[wl]("exception",u)}finally{s&&o.fire(s),o[wl](XW,a)}}}return t()}function g4(){return Kpe}var Jb,ZW,ex,Kpe,aN,h4,XW,cN=he(()=>{p();ur();Pn();Hn();Si();Jb="ctx",ZW="ParentContextKey",ex="ChildrenContextKey",Kpe=null,aN=function(){function r(e,t,n){var i=this,o=!1;if(i.start=Pl(),i[ts]=e,i[_l]=n,i[$w]=function(){return!1},Er(t)){var s;o=Vb(i,"payload",function(){return!s&&Er(t)&&(s=t(),t=null),s})}i[bg]=function(a){return a?a===r[ZW]||a===r[ex]?i[a]:(i[Jb]||{})[a]:null},i[wl]=function(a,l){if(a)if(a===r[ZW])i[a]||(i[$w]=function(){return!0}),i[a]=l;else if(a===r[ex])i[a]=l;else{var u=i[Jb]=i[Jb]||{};u[a]=l}},i[G0]=function(){var a=0,l=i[bg](r[ex]);if(tn(l))for(var u=0;u<l[St];u++){var c=l[u];c&&(a+=c[pg])}i[pg]=Pl()-i.start,i.exTime=i[pg]-a,i[G0]=function(){},!o&&Er(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),h4=function(){function r(e){this.ctx={},He(r,this,function(t){t.create=function(n,i,o){return new aN(n,i,o)},t.fire=function(n){n&&(n[G0](),e&&Er(e[Df])&&e[Df](n))},t[wl]=function(n,i){if(n){var o=t[Jb]=t[Jb]||{};o[n]=i}},t[bg]=function(n){return(t[Jb]||{})[n]}})}return r.__ieDyn=1,r}(),XW="CoreUtils.doPerf"});function b4(r){r<0&&(r>>>=0),tx=123456789+r&kf,rx=987654321-r&kf,y4=!0}function S4(){try{var r=Pl()&2147483647;b4((Math.random()*v4^r)+r)}catch(e){}}function I4(r){return r>0?Math.floor(Eg()/kf*(r+1))>>>0:0}function Eg(r){var e=0,t=a4()||l4();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&kf),e===0&&Ig()&&(y4||S4(),e=e2()&kf),e===0&&(e=Math.floor(v4*Math.random()|0)),r||(e>>>=0),e}function _4(r){r?b4(r):S4()}function e2(r){rx=36969*(rx&65535)+(rx>>16)&kf,tx=18e3*(tx&65535)+(tx>>16)&kf;var e=(rx<<16)+(tx&65535)>>>0&kf|0;return r||(e>>>=0),e}function uN(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=Eg()>>>0,n=0,i=kt;i[St]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(Eg()<<2&4294967295|t&3)>>>0,n=0);return i}var v4,kf,y4,tx,rx,t2=he(()=>{p();Pn();Ac();Hn();Si();v4=4294967296,kf=4294967295,y4=!1,tx=123456789,rx=987654321});function Wpe(r,e,t){if(E4)try{return E4(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function w4(r){return r[J0]===1||r[J0]===9||!+r[J0]}function Vpe(r,e){var t=e[r.id];if(!t){t={};try{w4(e)&&(Wpe(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function Gb(r,e){return e===void 0&&(e=!1),Xw(r+Upe+++(e?"."+C4:kt)+Fpe)}function dN(r){var e={id:Gb("_aiData-"+(r||kt)+"."+C4),accept:function(t){return w4(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[Xw(n)]:(o&&(s=Vpe(e,t),s[Xw(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var E4,C4,Fpe,Upe,pN=he(()=>{p();ir();Pn();Hn();Si();t2();E4=yo,C4="2.8.11",Fpe="."+uN(6),Upe=0});function L4(r,e){var t=nx[Yb]||hN[Yb];return t||(t=nx[Yb]=nx(r,e),hN[Yb]=t),t}function mN(r){return r?r.isEnabled():!0}function jpe(r){var e=r[xW]=r[xW]||{};if(ya(e,"domain",r.cookieDomain,LW,or),ya(e,"path",r.cookiePath||"/",null,or),or(e[i2])){var t=void 0;Dn(r[D4])||(t=!r[D4]),Dn(r[T4])||(t=!r[T4]),e[i2]=t}return e}function K4(r,e){return e&&r&&tn(r.ignoreCookies)?r.ignoreCookies[xf](e)!==-1:!1}function Bpe(r,e){return e&&r&&tn(r.blockedCookies)&&r.blockedCookies[xf](e)!==-1?!0:K4(r,e)}function nx(r,e){var t,n=jpe(r||hN),i=n.path||"/",o=n.domain,s=n[i2]!==!1,a=(t={isEnabled:function(){var l=s&&R4(e),u=hN[Yb];return l&&u&&a!==u&&(l=mN(u)),l}},t[Cd]=function(l){s=l!==!1},t.set=function(l,u,c,d,f){var m=!1;if(mN(a)&&!Bpe(n,l)){var g={},b=xl(u||kt),y=b[xf](";");if(y!==-1&&(b=xl(u[El](0,y)),g=F4(u[El](y+1))),ya(g,"domain",d||o,tN,Dn),!or(c)){var P=Ig();if(Dn(g[r2])){var A=Pl(),D=A+c*1e3;if(D>0){var T=new Date;T.setTime(D),ya(g,r2,A4(T,P?x4:P4)||A4(T,P?x4:P4)||kt,tN)}}P||ya(g,"max-age",kt+c,null,Dn)}var K=i4();K&&K.protocol==="https:"&&(ya(g,"secure",null,null,Dn),n2===null&&(n2=!qpe((GW()||{})[Jw])),n2&&ya(g,"SameSite","None",null,Dn)),ya(g,"path",f||i,null,Dn);var L=n.setCookie||O4;L(l,M4(b,g)),m=!0}return m},t.get=function(l){var u=kt;return mN(a)&&!K4(n,l)&&(u=(n.getCookie||Hpe)(l)),u},t.del=function(l,u){var c=!1;return mN(a)&&(c=a.purge(l,u)),c},t.purge=function(l,u){var c,d=!1;if(R4(e)){var f=(c={},c.path=u||"/",c[r2]="Thu, 01 Jan 1970 00:00:01 GMT",c);Ig()||(f["max-age"]="0");var m=n.delCookie||O4;m(l,M4(kt,f)),d=!0}return d},t);return a[Yb]=a,a}function R4(r){if(fN===null){fN=!1;try{var e=ix||{};fN=e[o2]!==void 0}catch(t){Dl(r,2,68,"Cannot access document.cookie - "+Zw(t),{exception:Sa(t)})}}return fN}function F4(r){var e={};if(r&&r[St]){var t=xl(r)[Gw](";");Ct(t,function(n){if(n=xl(n||kt),n){var i=n[xf]("=");i===-1?e[n]=null:e[xl(n[El](0,i))]=xl(n[El](i+1))}})}return e}function A4(r,e){return Er(r[e])?r[e]():null}function M4(r,e){var t=r||kt;return xd(e,function(n,i){t+="; "+n+(or(i)?kt:"="+i)}),t}function Hpe(r){var e=kt;if(ix){var t=ix[o2]||kt;k4!==t&&(N4=F4(t),k4=t),e=xl(N4[r]||kt)}return e}function O4(r,e){ix&&(ix[o2]=r+"="+e)}function qpe(r){return Tf(r)?!!(Ri(r,"CPU iPhone OS 12")||Ri(r,"iPad; CPU OS 12")||Ri(r,"Macintosh; Intel Mac OS X 10_14")&&Ri(r,"Version/")&&Ri(r,"Safari")||Ri(r,"Macintosh; Intel Mac OS X 10_14")&&FW(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Ri(r,"Chrome/5")||Ri(r,"Chrome/6")||Ri(r,"UnrealEngine")&&!Ri(r,"Chrome")||Ri(r,"UCBrowser/12")||Ri(r,"UCBrowser/11")):!1}var x4,P4,o2,r2,i2,D4,T4,Yb,fN,n2,k4,ix,N4,hN,s2=he(()=>{p();Pn();_g();Ac();Hn();Si();x4="toGMTString",P4="toUTCString",o2="cookie",r2="expires",i2="enabled",D4="isCookieUseDisabled",T4="disableCookiesUsage",Yb="_ckMgr",fN=null,n2=null,k4=null,ix=rN(),N4={},hN={}});function V4(r){return r&&r[Cl]?r[Cl](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,kt):r}function Xpe(r,e){var t;if(e){var n=kt;tn(e)?(n=kt,Ct(e,function(o){o=V4(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=V4(e),n&&(n[0]!=="."&&(n="."+n),r=(r||kt)+n)}var i=Qpe.exec(r||kt)||[];return t={},t[Yw]=i[1],t.ns=(i[2]||kt).replace(Ype,".").replace($pe,kt)[Gw](".").sort().join("."),t}function Zpe(r,e,t){t===void 0&&(t=!0);var n=j4.get(r,Gpe,{},t),i=n[e];return i||(i=n[e]=[]),i}function efe(r,e,t,n){var i=!1;return r&&e&&e[Yw]&&t&&(r[W4]?(r[W4](e[Yw],t,n),i=!0):r[U4]&&(r[U4](Jpe+e[Yw],t),i=!0)),i}function a2(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=Xpe(e,n);if(s=efe(r,a,t,i),s&&j4.accept(r)){var l=(o={guid:zpe++,evtName:a},o[WJ]=t,o.capture=i,o);Zpe(r,a.type)[Lt](l)}}catch(u){}return s}function B4(r,e,t){var n=!1,i=n4();i&&(n=a2(i,r,e,t),n=a2(i.body,r,e,t)||n);var o=rN();return o&&(n=a2(o,r,e,t)||n),n}var Jpe,U4,W4,Gpe,m7e,h7e,Ype,$pe,zpe,j4,Qpe,H4=he(()=>{p();Pn();pN();Ac();Hn();Si();Jpe="on",U4="attachEvent",W4="addEventListener",Gpe="events",m7e=Gb("aiEvtPageHide"),h7e=Gb("aiEvtPageShow"),Ype=/\.[\.]+/g,$pe=/[\.]+$/,zpe=1,j4=dN("events"),Qpe=/^([^.]*)(?:\.(.+)|)/});function q4(){var r=l2();return r[El](0,8)+"-"+r[El](8,12)+"-"+r[El](12,16)+"-"+r[El](16,20)+"-"+r[El](20)}function J4(){var r=s4();return r&&r.now?r.now():Pl()}function l2(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=kt,t,n=0;n<4;n++)t=Eg(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(Eg()&3)|0];return e[vg](0,8)+e[vg](9,4)+"4"+e[vg](13,3)+i+e[vg](16,3)+e[vg](19,12)}function G4(r,e){var t=L4(r,e),n=ax._canUseCookies;return ox===null&&(ox=[],sx=n,Vb(ax,"_canUseCookies",function(){return sx},function(i){sx=i,Ct(ox,function(o){o[Cd](i)})})),va(ox,t)===-1&&ox[Lt](t),Fb(n)&&t[Cd](n),Fb(sx)&&t[Cd](sx),t}function Y4(){G4()[Cd](!1)}var ox,sx,ax,$4=he(()=>{"use strict";p();ir();Pn();s2();Ac();H4();Hn();Si();t2();ox=null;ax={_canUseCookies:void 0,isTypeof:OW,isUndefined:Dn,isNullOrUndefined:or,hasOwnProperty:KW,isFunction:Er,isObject:wd,isDate:UW,isArray:tn,isError:eN,isString:Tf,isNumber:WW,isBoolean:Fb,toISOString:Ub,arrForEach:Ct,arrIndexOf:va,arrMap:VW,arrReduce:jW,strTrim:xl,objCreate:bo,objKeys:Wb,objDefineAccessors:Vb,addEventHandler:B4,dateNow:Pl,isIE:Ig,disableCookies:Y4,newGuid:q4,perfNow:J4,newId:uN,randomValue:I4,random32:Eg,mwcRandomSeed:_4,mwcRandom32:e2,generateW3CId:l2}});function z4(r,e,t){return r&&r[St]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function Q4(r){return z4(r,32,tfe)}function X4(r){return z4(r,16,rfe)}var tfe,rfe,Z4=he(()=>{p();Pn();tfe="00000000000000000000000000000000",rfe="0000000000000000"});function Dd(r){return nfe.get(r,"state",{},!0)}function gN(r,e){for(var t=[],n=null,i=r[ks](),o;i;){var s=i[hg]();if(s){n&&Er(n[wf])&&Er(s[rs])&&n[wf](s);var a=!1;Er(s[Ps])?a=s[Ps]():(o=Dd(s),a=o[Ps]),a||t[Lt](s),n=s,i=i[ks]()}}Ct(t,function(l){var u=r[cn]();l[Sl](r.getCfg(),u,e,r[ks]()),o=Dd(l),!l[cn]&&!o[cn]&&(o[cn]=u),o[Ps]=!0,delete o[Ts]})}function vN(r){return r.sort(function(e,t){var n=0;if(t){var i=Er(t[rs]);Er(e[rs])?n=i?e[ga]-t[ga]:1:i&&(n=-1)}else n=e?1:-1;return n})}function eG(r){var e={};return{getName:function(){return e[ts]},setName:function(t){r&&r.setName(t),e[ts]=t},getTraceId:function(){return e[Y0]},setTraceId:function(t){r&&r.setTraceId(t),Q4(t)&&(e[Y0]=t)},getSpanId:function(){return e[$0]},setSpanId:function(t){r&&r.setSpanId(t),X4(t)&&(e[$0]=t)},getTraceFlags:function(){return e[z0]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[z0]=t}}}var nfe,yN=he(()=>{"use strict";p();Pn();pN();Hn();Si();Z4();nfe=dN("plugin")});function ofe(r,e,t){for(;r;){if(r[hg]()===t)return r;r=r[ks]()}return Mc([t],e[Nc]||{},e)}function c2(r,e,t,n){var i=null,o=[];n!==null&&(i=n?ofe(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return p4(t,e)},getCfg:function(){return e},getExtCfg:u,getConfig:c,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:d,onComplete:a}};function a(f,m){for(var g=[],b=2;b<arguments.length;b++)g[b-2]=arguments[b];f&&o[Lt]({func:f,self:Dn(m)?s.ctx:m,args:g})}function l(){var f=i;if(i=f?f[ks]():null,!f){var m=o;m&&m[St]>0&&(Ct(m,function(g){try{g.func[Bn](g.self,g.args)}catch(b){Dl(t[Ds],2,73,"Unexpected Exception during onComplete - "+Sa(b))}}),o=[])}return f}function u(f,m,g){m===void 0&&(m={}),g===void 0&&(g=0);var b;if(e){var y=e[Ob];y&&f&&(b=y[f])}if(!b)b=m;else if(wd(m)&&g!==0){var P=Hb(!0,m,b);e&&g===2&&xd(m,function(A){if(or(P[A])){var D=e[A];or(D)||(P[A]=D)}}),b=P}return b}function c(f,m,g){g===void 0&&(g=!1);var b,y=u(f,null);return y&&!or(y[m])?b=y[m]:e&&!or(e[m])&&(b=e[m]),or(b)?g:b}function d(f){for(var m;m=s._next();){var g=m[hg]();g&&f(g)}}return s}function Tl(r,e,t,n){var i=c2(r,e,t,n),o=i.ctx;function s(l){var u=i._next();return u&&u[rs](l,o),!u}function a(l,u){return l===void 0&&(l=null),tn(l)&&(l=Mc(l,e,t,u)),Tl(l||o[ks](),e,t,u)}return o[Vr]=s,o[Ed]=a,o}function $b(r,e,t){var n=e[Nc]||{},i=c2(r,n,e,t),o=i.ctx;function s(l){var u=i._next();return u&&u.unload(o,l),!u}function a(l,u){return l===void 0&&(l=null),tn(l)&&(l=Mc(l,n,e,u)),$b(l||o[ks](),e,u)}return o[Vr]=s,o[Ed]=a,o}function lx(r,e,t){var n=e[Nc]||{},i=c2(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(u){Er(u[gg])&&u[gg](o,l)})}function a(l,u){return l===void 0&&(l=null),tn(l)&&(l=Mc(l,n,e,u)),lx(l||o[ks](),e,u)}return o[Vr]=s,o[Ed]=a,o}function Mc(r,e,t,n){var i=null,o=!n;if(tn(r)&&r[St]>0){var s=null;Ct(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&Er(a[rs])){var l=sfe(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Mc([n],e,t):i}function sfe(r,e,t){var n=null,i=Er(r[rs]),o=Er(r[wf]),s;r?s=r[Il]+"-"+r[ga]+"-"+nG++:s="Unknown-0-"+nG++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:c,unload:d,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&Er(r[rG])&&(m=r[rG]()),m||(m=Tl(a,e,t)),m}function u(m,g,b,y,P){var A=!1,D=r?r[Il]:ife,T=m[tG];return T||(T=m[tG]={}),m.setNext(n),r&&lN(m[cn](),function(){return D+":"+b},function(){T[s]=!0;try{var K=n?n._id:kt;K&&(T[K]=!1),A=g(m)}catch(B){var L=n?T[n._id]:!0;L&&(A=!0),(!n||!L)&&Dl(m[ha](),1,73,"Plugin ["+D+"] failed during "+b+" - "+Sa(B)+", run flags: "+Sa(T))}},y,P),A}function c(m,g){g=g||l();function b(y){if(!r||!i)return!1;var P=Dd(r);return P[Ts]||P[zw]?!1:(o&&r[wf](n),r[rs](m,y),!0)}u(g,b,"processTelemetry",function(){return{item:m}},!m.sync)||g[Vr](m)}function d(m,g){function b(){var y=!1;if(r){var P=Dd(r),A=r[cn]||P[cn];r&&(!A||A===m.core())&&!P[Ts]&&(P[cn]=null,P[Ts]=!0,P[Ps]=!1,r[Ts]&&r[Ts](m,g)===!0&&(y=!0))}return y}u(m,b,"unload",function(){},g[_l])||m[Vr](g)}function f(m,g){function b(){var y=!1;if(r){var P=Dd(r),A=r[cn]||P[cn];r&&(!A||A===m.core())&&!P[Ts]&&r[gg]&&r[gg](m,g)===!0&&(y=!0)}return y}u(m,b,"update",function(){},!1)||m[Vr](g)}return Rc(a)}var ife,tG,rG,nG,Y7e,bN=he(()=>{"use strict";p();Pn();_g();Ac();Hn();Si();cN();yN();ife="TelemetryPluginChain",tG="_hasRun",rG="_getTelCtx",nG=0;Y7e=function(){function r(e,t,n,i){var o=this,s=Tl(e,t,n,i);Pd(o,s,Wb(s))}return r}()});function iG(r,e,t){e&&tn(e)&&e[St]>0&&(e=e.sort(function(n,i){return n[ga]-i[ga]}),Ct(e,function(n){n[ga]<cx&&ti(afe+n[Il])}),r[Lt]({queue:Rc(e),chain:Mc(e,t[Nc],t)}))}function oG(r,e){function t(){return Tl(null,e[Nc],e,null)}function n(u,c,d,f){var m=u?u[St]+1:1;function g(){m--,m===0&&(f&&f(),f=null)}m>0&&Ct(u,function(b){if(b&&b.queue[St]>0){var y=b.chain,P=c[Ed](y);P[Hw](g),d(P)}else m--}),g()}function i(u,c){var d=c||{reason:0};return n(r,u,function(f){f[Vr](d)},function(){u[Vr](d)}),!0}function o(u,c){var d=c||{reason:0,isAsync:!1};return n(r,u,function(f){f[Vr](d)},function(){u[Vr](d),a=!1}),!0}function s(u){var c=null;return r&&r[St]>0&&Ct(r,function(d){if(d&&d.queue[St]>0&&(Ct(d.queue,function(f){if(f[Il]===u)return c=f,-1}),c))return-1}),c}var a=!1,l={identifier:"ChannelControllerPlugin",priority:cx,initialize:function(u,c,d,f){a=!0,Ct(r,function(m){m&&m.queue[St]>0&&gN(Tl(m.chain,u,c),d)})},isInitialized:function(){return a},processTelemetry:function(u,c){n(r,c||t(),function(d){d[Vr](u)},function(){c[Vr](u)})},update:i,pause:function(){n(r,t(),function(u){u.iterate(function(c){c.pause&&c.pause()})},null)},resume:function(){n(r,t(),function(u){u.iterate(function(c){c.resume&&c.resume()})},null)},teardown:o,getChannel:s,flush:function(u,c,d,f){var m=1,g=!1,b=null;f=f||5e3;function y(){m--,g&&m===0&&(b&&(clearTimeout(b),b=null),c&&c(g),c=null)}return n(r,t(),function(P){P.iterate(function(A){if(A[Nb]){m++;var D=!1;A[Nb](u,function(){D=!0,y()},d)||D||(u&&b==null?b=setTimeout(function(){b=null,y()},f):y())}})},function(){g=!0,y()}),!0},_setQueue:function(u){r=u}};return l}function sG(r,e,t){var n=[];if(r&&Ct(r,function(o){return iG(n,o,t)}),e){var i=[];Ct(e,function(o){o[ga]>cx&&i[Lt](o)}),iG(n,i,t)}return n}var cx,afe,aG=he(()=>{p();Pn();Hn();Si();bN();yN();cx=500,afe="Channel has invalid priority - "});function SN(){var r=[];function e(n){n&&r[Lt](n)}function t(n,i){Ct(r,function(o){try{o(n,i)}catch(s){Dl(n[ha](),2,73,"Unexpected error calling unload handler - "+Sa(s))}}),r=[]}return{add:e,run:t}}var u2=he(()=>{p();Pn();_g();Ac();Hn()});var Nf,lG,cG=he(()=>{"use strict";p();ur();Pn();Hn();Si();bN();u2();Nf="getPlugin",lG=function(){function r(){var e=this,t,n,i,o,s;u(),He(r,e,function(c){c[Sl]=function(d,f,m,g){l(d,f,g),t=!0},c[Ts]=function(d,f){var m,g=c[cn];if(!g||d&&g!==d[cn]())return;var b,y=!1,P=d||$b(null,g,i&&i[Nf]?i[Nf]():i),A=f||(m={reason:0},m[_l]=!1,m);function D(){if(!y){y=!0,o.run(P,f);var T=s;s=[],Ct(T,function(K){K.rm()}),b===!0&&P[Vr](A),u()}}return!c[Ab]||c[Ab](P,A,D)!==!0?D():b=!0,b},c[gg]=function(d,f){var m=c[cn];if(!m||d&&m!==d[cn]())return;var g,b=!1,y=d||lx(null,m,i&&i[Nf]?i[Nf]():i),P=f||{reason:0};function A(){b||(b=!0,l(y.getCfg(),y.core(),y[ks]()))}return!c._doUpdate||c._doUpdate(y,P,A)!==!0?A():g=!0,g},c._addHook=function(d){d&&(tn(d)?s=s.concat(d):s[Lt](d))},Bb(c,"_addUnloadCb",function(){return o},"add")}),e[ha]=function(c){return a(c)[ha]()},e[Ps]=function(){return t},e.setInitialized=function(c){t=c},e[wf]=function(c){i=c},e[Vr]=function(c,d){d?d[Vr](c):i&&Er(i[rs])&&i[rs](c,null)},e._getTelCtx=a;function a(c){c===void 0&&(c=null);var d=c;if(!d){var f=n||Tl(null,{},e[cn]);i&&i[Nf]?d=f[Ed](null,i[Nf]):d=f[Ed](null,i)}return d}function l(c,d,f){c&&ya(c,Ob,[],null,or),!f&&d&&(f=d[q0]()[ks]());var m=i;i&&i[Nf]&&(m=i[Nf]()),e[cn]=d,n=Tl(f,c,d,m)}function u(){t=!1,e[cn]=null,n=null,i=null,s=[],o=SN()}}return r.__ieDyn=1,r}()});var uG,dG=he(()=>{p();ir();ur();Pn();cG();_g();Ac();Hn();Si();uG=function(r){vn(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),He(e,t,function(s,a){s.addTelemetryInitializer=function(l){var u={id:n++,fn:l};i[Lt](u);var c={remove:function(){Ct(i,function(d,f){if(d.id===u.id)return i[Ef](f,1),-1})}};return c},s[rs]=function(l,u){for(var c=!1,d=i[St],f=0;f<d;++f){var m=i[f];if(m)try{if(m.fn[Mb](null,[l])===!1){c=!0;break}}catch(g){Dl(u[ha](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Zw(g),{exception:Sa(g)},!0)}}c||s[Vr](l,u)},s[Ab]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(lG)});function ufe(r,e){return new h4(e)}function dfe(r,e,t){var n,i=[],o={};return Ct(t,function(s){(or(s)||or(s[Sl]))&&ti(hG);var a=s[ga],l=s[Il];s&&a&&(or(o[a])?o[a]=l:m4(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[Lt](s)}),n={all:t},n[cn]=i,n}function mG(r,e){var t=!1;return Ct(e,function(n){if(n===r)return t=!0,-1}),t}function pfe(){var r;return bo((r={},r[fg]=function(e){},r[mg]=function(e){},r[Lb]=function(e){},r[Pf]=function(e,t){},r[Kb]=function(e,t){},r))}var hG,pG,fG,lfe,cfe,gG,vG=he(()=>{"use strict";p();ir();ur();ir();Pn();aG();s2();pN();QW();_g();Hn();Si();cN();bN();yN();dG();u2();hG="Plugins must provide initialize method",pG="_notificationManager",fG="SDK is still unloading...",lfe="SDK is not initialized",cfe={loggingLevelConsole:1};gG=function(){function r(){var e,t,n,i,o,s,a,l,u,c,d,f,m,g,b,y,P,A,D,T,K=0;He(r,this,function(L){B(),L[Ps]=function(){return t},L[Sl]=function(q,$,de,pe){g&&ti(fG),L[Ps]()&&ti("Core should not be initialized more than once"),e=q||{},L[Nc]=e,or(q[H0])&&ti("Please provide instrumentation key"),i=pe,L[pG]=pe,Y(),Z(),ie(),de&&(L[Ds]=de);var ye=jb(e,VJ,[]);u=[],u[Lt].apply(u,jm(jm([],$,!1),ye,!1)),f=jb(e,DW,[]),O(null),(!m||m[St]===0)&&ti("No "+DW+" available"),t=!0,L.releaseQueue()},L.getTransmissionControls=function(){var q=[];return m&&Ct(m,function($){q[Lt]($.queue)}),Rc(q)},L.track=function(q){q.iKey=q.iKey||e[H0],q[pg]=q[pg]||Ub(new Date),q.ver=q.ver||"4.0",!g&&L[Ps]()?N()[Vr](q):n[Lt](q)},L[q0]=N,L[Bw]=function(){return i||(i=pfe(),L[pG]=i),i},L[fg]=function(q){i&&i[fg](q)},L[mg]=function(q){i&&i[mg](q)},L.getCookieMgr=function(){return a||(a=nx(e,L[Ds])),a},L.setCookieMgr=function(q){a=q},L[Sg]=function(){if(!o&&!s&&ba(e.enablePerfMgr)){var q=ba(e[TW]);Er(q)&&(s=q(L,L[Bw]()))}return o||s||g4()},L.setPerfMgr=function(q){o=q},L.eventCnt=function(){return n[St]},L.releaseQueue=function(){if(t&&n[St]>0){var q=n;n=[],Ct(q,function($){N()[Vr]($)})}},L.pollInternalLogs=function(q){y=q||null;var $=ba(e.diagnosticLogInterval);return(!$||!($>0))&&($=1e4),K&&clearInterval(K),K=setInterval(function(){k()},$),K},L[wW]=function(){K&&(clearInterval(K),K=0,k())},Pd(L,function(){return b},["addTelemetryInitializer"]),L.unload=function(q,$,de){var pe;q===void 0&&(q=!0),t||ti(lfe),g&&ti(fG);var ye=(pe={reason:50},pe[_l]=q,pe.flushComplete=!1,pe),z=$b(v(),L);z[Hw](function(){B(),$&&$(ye)},L);function fe(Ie){ye.flushComplete=Ie,g=!0,A.run(z,ye),L[wW](),z[Vr](ye)}H(q,fe,6,de)||fe(!1)},L[hg]=h,L.addPlugin=function(q,$,de,pe){if(!q){pe&&pe(!1),be(hG);return}var ye=h(q[Il]);if(ye&&!$){pe&&pe(!1),be("Plugin ["+q[Il]+"] is already loaded!");return}var z={reason:16};function fe(Le){u[Lt](q),z.added=[q],O(z),pe&&pe(!0)}if(ye){var Ie=[ye.plugin],Te={reason:2,isAsync:!!de};C(Ie,Te,function(Le){Le?(z.removed=Ie,z.reason|=32,fe(!0)):pe&&pe(!1)})}else fe(!1)},L.evtNamespace=function(){return P},L[Nb]=H,L.getTraceCtx=function(q){return T||(T=eG()),T},L.setTraceCtx=function(q){T=q||null},Bb(L,"addUnloadCb",function(){return A},"add");function B(){t=!1,e=Hb(!0,{},cfe),L[Nc]=e,L[Ds]=new qb(e),L[qw]=[],b=new uG,n=[],i=null,o=null,s=null,a=null,l=null,c=null,u=[],d=null,f=null,m=null,g=!1,y=null,P=Gb("AIBaseCore",!0),A=SN(),T=null}function N(){return Tl(v(),e,L)}function O(q){var $=dfe(L[Ds],cx,u);c=$[cn],l=null;var de=$.all;if(m=Rc(sG(f,de,L)),d){var pe=va(de,d);pe!==-1&&de[Ef](pe,1),pe=va(c,d),pe!==-1&&c[Ef](pe,1),d._setQueue(m)}else d=oG(m,L);de[Lt](d),c[Lt](d),L[qw]=vN(de),d[Sl](e,L,de),gN(N(),de),L[qw]=Rc(vN(c||[])).slice(),q&&ce(q)}function h(q){var $,de=null,pe=null;return Ct(L[qw],function(ye){if(ye[Il]===q&&ye!==d&&ye!==b)return pe=ye,-1}),!pe&&d&&(pe=d.getChannel(q)),pe&&(de=($={plugin:pe},$[Cd]=function(ye){Dd(pe)[zw]=!ye},$.isEnabled=function(){var ye=Dd(pe);return!ye[Ts]&&!ye[zw]},$.remove=function(ye,z){var fe;ye===void 0&&(ye=!0);var Ie=[pe],Te=(fe={reason:1},fe[_l]=ye,fe);C(Ie,Te,function(Le){Le&&O({reason:32,removed:Ie}),z&&z(Le)})},$)),de}function v(){if(!l){var q=(c||[]).slice();va(q,b)===-1&&q[Lt](b),l=Mc(vN(q),e,L)}return l}function C(q,$,de){if(q&&q[St]>0){var pe=Mc(q,e,L),ye=$b(pe,L);ye[Hw](function(){var z=!1,fe=[];Ct(u,function(Te,Le){mG(Te,q)?z=!0:fe[Lt](Te)}),u=fe;var Ie=[];f&&(Ct(f,function(Te,Le){var $e=[];Ct(Te,function(Ge){mG(Ge,q)?z=!0:$e[Lt](Ge)}),Ie[Lt]($e)}),f=Ie),de&&de(z)}),ye[Vr]($)}else de(!1)}function k(){var q=L[Ds]?L[Ds].queue:[];q&&(Ct(q,function($){var de,pe=(de={},de[ts]=y||"InternalMessageId: "+$[Rb],de.iKey=ba(e[H0]),de.time=Ub(new Date),de.baseType=sN.dataType,de.baseData={message:$[Cf]},de);L.track(pe)}),q[St]=0)}function H(q,$,de,pe){return d?d[Nb](q,$,de||6,pe):($&&$(!1),!0)}function Y(){var q=ba(e.disableDbgExt);q===!0&&D&&(i[mg](D),D=null),i&&!D&&q!==!0&&(D=c4(e),i[fg](D))}function Z(){var q=ba(e.enablePerfMgr);!q&&s&&(s=null),q&&jb(e,TW,ufe)}function ie(){var q=jb(e,Ob,{});q.NotificationManager=i}function ce(q){var $=lx(v(),L);(!L._updateHook||L._updateHook($,q)!==!0)&&$[Vr](q)}function be(q){var $=L[Ds];$?Dl($,2,73,q):ti(q)}})}return r.__ieDyn=1,r}()});function IN(r,e,t,n){Ct(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var yG,bG=he(()=>{p();ur();Pn();Hn();Si();yG=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;He(r,this,function(n){n[fg]=function(i){n.listeners[Lt](i)},n[mg]=function(i){for(var o=va(n[yg],i);o>-1;)n.listeners[Ef](o,1),o=va(n[yg],i)},n[Lb]=function(i){IN(n[yg],Lb,!0,function(o){o[Lb](i)})},n[Pf]=function(i,o){IN(n[yg],Pf,!0,function(s){s[Pf](i,o)})},n[Kb]=function(i,o){IN(n[yg],Kb,o,function(s){s[Kb](i,o)})},n[Df]=function(i){i&&(t||!i[$w]())&&IN(n[yg],Df,!1,function(o){i[_l]?setTimeout(function(){return o[Df](i)},0):o[Df](i)})}})}return r.__ieDyn=1,r}()});var ux,SG=he(()=>{p();ir();ur();Pn();vG();_g();Hn();Si();bG();cN();ux=function(r){vn(e,r);function e(){var t=r.call(this)||this;return He(e,t,function(n,i){n[Sl]=function(a,l,u,c){i[Sl](a,l,u||new qb(a),c||new yG(a))},n.track=function(a){lN(n[Sg](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),ti("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){or(a[ts])&&(s(a),ti("telemetry name required"))}function s(a){var l=n[Bw]();l&&l[Pf]([a],2)}}),t}return e.__ieDyn=1,e}(gG)});var Me,Pr,Cg,kl,IG,_G,_N,d2,dx,EN,zb,Nl,Rf,Td,px,EG,ffe,p2,CG=he(()=>{p();ZJ();Pr="Failed",Cg=Pr+"MonitorAjax",kl="Track",IG="Start",_G="Stop",_N="Event",d2="AuthContext",dx="Exception",EN="Local",zb="Session",Nl="Storage",Rf="Browser",Td="Cannot",px="Buffer",EG="InstrumentationKey",ffe=HW({CRITICAL:1,WARNING:2}),p2=HW((Me={},Me[Rf+"DoesNotSupport"+EN+Nl]=0,Me[Rf+Td+"Read"+EN+Nl]=1,Me[Rf+Td+"Read"+zb+Nl]=2,Me[Rf+Td+"Write"+EN+Nl]=3,Me[Rf+Td+"Write"+zb+Nl]=4,Me[Rf+Pr+"RemovalFrom"+EN+Nl]=5,Me[Rf+Pr+"RemovalFrom"+zb+Nl]=6,Me[Td+"SendEmptyTelemetry"]=7,Me.ClientPerformanceMathError=8,Me["ErrorParsingAI"+zb+"Cookie"]=9,Me.ErrorPVCalc=10,Me[dx+"WhileLoggingError"]=11,Me[Pr+"AddingTelemetryTo"+px]=12,Me[Cg+"Abort"]=13,Me[Cg+"Dur"]=14,Me[Cg+"Open"]=15,Me[Cg+"RSC"]=16,Me[Cg+"Send"]=17,Me[Cg+"GetCorrelationHeader"]=18,Me[Pr+"ToAddHandlerForOnBeforeUnload"]=19,Me[Pr+"ToSendQueuedTelemetry"]=20,Me[Pr+"ToReportDataLoss"]=21,Me["Flush"+Pr]=22,Me.MessageLimitPerPVExceeded=23,Me.MissingRequiredFieldSpecification=24,Me.NavigationTimingNotSupported=25,Me.OnError=26,Me[zb+"RenewalDateIsZero"]=27,Me.SenderNotInitialized=28,Me[IG+kl+_N+Pr]=29,Me[_G+kl+_N+Pr]=30,Me[IG+kl+Pr]=31,Me[_G+kl+Pr]=32,Me.TelemetrySampledAndNotSent=33,Me[kl+_N+Pr]=34,Me[kl+dx+Pr]=35,Me[kl+"Metric"+Pr]=36,Me[kl+"PV"+Pr]=37,Me[kl+"PV"+Pr+"Calc"]=38,Me[kl+"Trace"+Pr]=39,Me["Transmission"+Pr]=40,Me[Pr+"ToSet"+Nl+px]=41,Me[Pr+"ToRestore"+Nl+px]=42,Me.InvalidBackendResponse=43,Me[Pr+"ToFixDepricatedValues"]=44,Me.InvalidDurationValue=45,Me.TelemetryEnvelopeInvalid=46,Me.CreateEnvelopeError=47,Me[Td+"SerializeObject"]=48,Me[Td+"SerializeObjectNonSerializable"]=49,Me.CircularReferenceDetected=50,Me["Clear"+d2+Pr]=51,Me[dx+"Truncated"]=52,Me.IllegalCharsInName=53,Me.ItemNotInArray=54,Me.MaxAjaxPerPVExceeded=55,Me.MessageTruncated=56,Me.NameTooLong=57,Me.SampleRateOutOfRange=58,Me["Set"+d2+Pr]=59,Me["Set"+d2+Pr+"AccountName"]=60,Me.StringValueTooLong=61,Me.StartCalledMoreThanOnce=62,Me.StopCalledWithoutStart=63,Me["TelemetryInitializer"+Pr]=64,Me.TrackArgumentsNotSpecified=65,Me.UrlTooLong=66,Me[zb+Nl+px+"Full"]=67,Me[Td+"AccessCookie"]=68,Me.IdTooLong=69,Me.InvalidEvent=70,Me[Cg+"SetRequestHeader"]=71,Me["Send"+Rf+"InfoOnUserInit"]=72,Me["Plugin"+dx]=73,Me["Notification"+dx]=74,Me.SnippetScriptLoadFailure=99,Me["Invalid"+EG]=100,Me[Td+"ParseAiBlobValue"]=101,Me.InvalidContentBlob=102,Me[kl+"PageAction"+_N+Pr]=103,Me[Pr+"AddingCustomDefinedRequestContext"]=104,Me["InMemory"+Nl+px+"Full"]=105,Me[EG+"Deprecation"]=106,Me))});var f2=he(()=>{p();SG();$4();Hn();CG()});var CN,wN,fx,wG=he(()=>{p();CN="instrumentationKey",wN="connectionString",fx="diagnosticLogInterval"});var xG={};Kv(xG,{AppInsightsCore:()=>ux,ApplicationInsights:()=>mfe,CoreUtils:()=>ax,Sender:()=>jw,SeverityLevel:()=>wU,_InternalMessageId:()=>p2,arrForEach:()=>Ct,isNullOrUndefined:()=>or,proxyFunctions:()=>Pd,throwError:()=>ti});var mfe,PG=he(()=>{p();ur();CW();sf();f2();wG();f2();sf();CW();mfe=function(){function r(e){var t=new ux;(or(e)||or(e[CN])&&or(e[wN]))&&ti("Invalid input configuration"),He(r,this,function(n){if(e[wN]){var i=yU(e[wN]),o=i.ingestionendpoint;e.endpointUrl=o?o+ld:e.endpointUrl,e[CN]=i.instrumentationkey||e[CN]}n.config=e,s(),n.initialize=s,n.getSKUDefaults=function(){n.config[fx]=n.config[fx]&&n.config[fx]>0?n.config[fx]:1e4},n.getSKUDefaults(),Pd(n,t,["track","flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb"]);function s(){t.initialize(n.config,[new jw]),t.pollInternalLogs()}})}return r.__ieDyn=1,r}()});var TG={};Kv(TG,{default:()=>xN});function gfe(r){if(r.userAgentData){let e=r.userAgentData.brands[r.userAgentData.brands.length-1];return`${r.userAgentData.platform} - ${e==null?void 0:e.brand} v${e==null?void 0:e.version}}`}else return r.appVersion}var DG,hfe,xN,kG=he(()=>{p();DG=se(require("vscode"));X5();Z5();e3();t3();hfe=async(r,e)=>{let t;try{let i=await Promise.resolve().then(()=>(PG(),xG));t=new i.ApplicationInsights({instrumentationKey:r,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0})}catch(i){return Promise.reject(i)}return{logEvent:(i,o)=>{let s={...o==null?void 0:o.properties,...o==null?void 0:o.measurements};e!=null&&e.length&&ob.applyReplacements(s,e),t==null||t.track({name:i,data:s})},flush:async()=>{t==null||t.flush()}}};xN=class extends Ak{constructor(e,t){let n=s=>hfe(s,t);ob.shouldUseOneDataSystemSDK(e)&&(n=s=>Q5(s,DG));let i={release:gfe(navigator),platform:"web",architecture:"web"},o=new Rk(e,n);if(e&&e.indexOf("AIF")===0)throw new Error("AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions");super(o,DG,{additionalCommonProperties:ob.getAdditionalCommonProperties(i)})}}});var O2=re((mt,XG)=>{p();mt=XG.exports=$t;var Cr;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?Cr=function(){var r=Array.prototype.slice.call(arguments,0);r.unshift("SEMVER"),console.log.apply(console,r)}:Cr=function(){};mt.SEMVER_SPEC_VERSION="2.0.0";var mx=256,AN=Number.MAX_SAFE_INTEGER||9007199254740991,v2=16,Sge=mx-6,hx=mt.re=[],jr=mt.safeRe=[],De=mt.src=[],qt=0,_2="[a-zA-Z0-9-]",y2=[["\\s",1],["\\d",mx],[_2,Sge]];function UN(r){for(var e=0;e<y2.length;e++){var t=y2[e][0],n=y2[e][1];r=r.split(t+"*").join(t+"{0,"+n+"}").split(t+"+").join(t+"{1,"+n+"}")}return r}var eS=qt++;De[eS]="0|[1-9]\\d*";var tS=qt++;De[tS]="\\d+";var E2=qt++;De[E2]="\\d*[a-zA-Z-]"+_2+"*";var FG=qt++;De[FG]="("+De[eS]+")\\.("+De[eS]+")\\.("+De[eS]+")";var UG=qt++;De[UG]="("+De[tS]+")\\.("+De[tS]+")\\.("+De[tS]+")";var b2=qt++;De[b2]="(?:"+De[eS]+"|"+De[E2]+")";var S2=qt++;De[S2]="(?:"+De[tS]+"|"+De[E2]+")";var C2=qt++;De[C2]="(?:-("+De[b2]+"(?:\\."+De[b2]+")*))";var w2=qt++;De[w2]="(?:-?("+De[S2]+"(?:\\."+De[S2]+")*))";var I2=qt++;De[I2]=_2+"+";var vx=qt++;De[vx]="(?:\\+("+De[I2]+"(?:\\."+De[I2]+")*))";var x2=qt++,WG="v?"+De[FG]+De[C2]+"?"+De[vx]+"?";De[x2]="^"+WG+"$";var P2="[v=\\s]*"+De[UG]+De[w2]+"?"+De[vx]+"?",D2=qt++;De[D2]="^"+P2+"$";var sS=qt++;De[sS]="((?:<|>)?=?)";var MN=qt++;De[MN]=De[tS]+"|x|X|\\*";var ON=qt++;De[ON]=De[eS]+"|x|X|\\*";var xg=qt++;De[xg]="[v=\\s]*("+De[ON]+")(?:\\.("+De[ON]+")(?:\\.("+De[ON]+")(?:"+De[C2]+")?"+De[vx]+"?)?)?";var nS=qt++;De[nS]="[v=\\s]*("+De[MN]+")(?:\\.("+De[MN]+")(?:\\.("+De[MN]+")(?:"+De[w2]+")?"+De[vx]+"?)?)?";var VG=qt++;De[VG]="^"+De[sS]+"\\s*"+De[xg]+"$";var jG=qt++;De[jG]="^"+De[sS]+"\\s*"+De[nS]+"$";var BG=qt++;De[BG]="(?:^|[^\\d])(\\d{1,"+v2+"})(?:\\.(\\d{1,"+v2+"}))?(?:\\.(\\d{1,"+v2+"}))?(?:$|[^\\d])";var WN=qt++;De[WN]="(?:~>?)";var iS=qt++;De[iS]="(\\s*)"+De[WN]+"\\s+";hx[iS]=new RegExp(De[iS],"g");jr[iS]=new RegExp(UN(De[iS]),"g");var Ige="$1~",HG=qt++;De[HG]="^"+De[WN]+De[xg]+"$";var qG=qt++;De[qG]="^"+De[WN]+De[nS]+"$";var VN=qt++;De[VN]="(?:\\^)";var oS=qt++;De[oS]="(\\s*)"+De[VN]+"\\s+";hx[oS]=new RegExp(De[oS],"g");jr[oS]=new RegExp(UN(De[oS]),"g");var _ge="$1^",JG=qt++;De[JG]="^"+De[VN]+De[xg]+"$";var GG=qt++;De[GG]="^"+De[VN]+De[nS]+"$";var T2=qt++;De[T2]="^"+De[sS]+"\\s*("+P2+")$|^$";var k2=qt++;De[k2]="^"+De[sS]+"\\s*("+WG+")$|^$";var Pg=qt++;De[Pg]="(\\s*)"+De[sS]+"\\s*("+P2+"|"+De[xg]+")";hx[Pg]=new RegExp(De[Pg],"g");jr[Pg]=new RegExp(UN(De[Pg]),"g");var Ege="$1$2$3",YG=qt++;De[YG]="^\\s*("+De[xg]+")\\s+-\\s+("+De[xg]+")\\s*$";var $G=qt++;De[$G]="^\\s*("+De[nS]+")\\s+-\\s+("+De[nS]+")\\s*$";var zG=qt++;De[zG]="(<|>)?=?\\s*\\*";for(Lc=0;Lc<qt;Lc++)Cr(Lc,De[Lc]),hx[Lc]||(hx[Lc]=new RegExp(De[Lc]),jr[Lc]=new RegExp(UN(De[Lc])));var Lc;mt.parse=Dg;function Dg(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof $t)return r;if(typeof r!="string"||r.length>mx)return null;var t=e.loose?jr[D2]:jr[x2];if(!t.test(r))return null;try{return new $t(r,e)}catch(n){return null}}mt.valid=Cge;function Cge(r,e){var t=Dg(r,e);return t?t.version:null}mt.clean=wge;function wge(r,e){var t=Dg(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null}mt.SemVer=$t;function $t(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof $t){if(r.loose===e.loose)return r;r=r.version}else if(typeof r!="string")throw new TypeError("Invalid Version: "+r);if(r.length>mx)throw new TypeError("version is longer than "+mx+" characters");if(!(this instanceof $t))return new $t(r,e);Cr("SemVer",r,e),this.options=e,this.loose=!!e.loose;var t=r.trim().match(e.loose?jr[D2]:jr[x2]);if(!t)throw new TypeError("Invalid Version: "+r);if(this.raw=r,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>AN||this.major<0)throw new TypeError("Invalid major version");if(this.minor>AN||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>AN||this.patch<0)throw new TypeError("Invalid patch version");t[4]?this.prerelease=t[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<AN)return i}return n}):this.prerelease=[],this.build=t[5]?t[5].split("."):[],this.format()}$t.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};$t.prototype.toString=function(){return this.version};$t.prototype.compare=function(r){return Cr("SemVer.compare",this.version,this.options,r),r instanceof $t||(r=new $t(r,this.options)),this.compareMain(r)||this.comparePre(r)};$t.prototype.compareMain=function(r){return r instanceof $t||(r=new $t(r,this.options)),rS(this.major,r.major)||rS(this.minor,r.minor)||rS(this.patch,r.patch)};$t.prototype.comparePre=function(r){if(r instanceof $t||(r=new $t(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;var e=0;do{var t=this.prerelease[e],n=r.prerelease[e];if(Cr("prerelease compare",e,t,n),t===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(t===void 0)return-1;if(t===n)continue;return rS(t,n)}while(++e)};$t.prototype.inc=function(r,e){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)typeof this.prerelease[t]=="number"&&(this.prerelease[t]++,t=-2);t===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+r)}return this.format(),this.raw=this.version,this};mt.inc=xge;function xge(r,e,t,n){typeof t=="string"&&(n=t,t=void 0);try{return new $t(r,t).inc(e,n).version}catch(i){return null}}mt.diff=Pge;function Pge(r,e){if(N2(r,e))return null;var t=Dg(r),n=Dg(e),i="";if(t.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var s in t)if((s==="major"||s==="minor"||s==="patch")&&t[s]!==n[s])return i+s;return o}mt.compareIdentifiers=rS;var KG=/^[0-9]+$/;function rS(r,e){var t=KG.test(r),n=KG.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1}mt.rcompareIdentifiers=Dge;function Dge(r,e){return rS(e,r)}mt.major=Tge;function Tge(r,e){return new $t(r,e).major}mt.minor=kge;function kge(r,e){return new $t(r,e).minor}mt.patch=Nge;function Nge(r,e){return new $t(r,e).patch}mt.compare=Nd;function Nd(r,e,t){return new $t(r,t).compare(new $t(e,t))}mt.compareLoose=Rge;function Rge(r,e){return Nd(r,e,!0)}mt.rcompare=Age;function Age(r,e,t){return Nd(e,r,t)}mt.sort=Mge;function Mge(r,e){return r.sort(function(t,n){return mt.compare(t,n,e)})}mt.rsort=Oge;function Oge(r,e){return r.sort(function(t,n){return mt.rcompare(t,n,e)})}mt.gt=gx;function gx(r,e,t){return Nd(r,e,t)>0}mt.lt=LN;function LN(r,e,t){return Nd(r,e,t)<0}mt.eq=N2;function N2(r,e,t){return Nd(r,e,t)===0}mt.neq=QG;function QG(r,e,t){return Nd(r,e,t)!==0}mt.gte=R2;function R2(r,e,t){return Nd(r,e,t)>=0}mt.lte=A2;function A2(r,e,t){return Nd(r,e,t)<=0}mt.cmp=KN;function KN(r,e,t,n){switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return N2(r,t,n);case"!=":return QG(r,t,n);case">":return gx(r,t,n);case">=":return R2(r,t,n);case"<":return LN(r,t,n);case"<=":return A2(r,t,n);default:throw new TypeError("Invalid operator: "+e)}}mt.Comparator=Ia;function Ia(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof Ia){if(r.loose===!!e.loose)return r;r=r.value}if(!(this instanceof Ia))return new Ia(r,e);r=r.trim().split(/\s+/).join(" "),Cr("comparator",r,e),this.options=e,this.loose=!!e.loose,this.parse(r),this.semver===yx?this.value="":this.value=this.operator+this.semver.version,Cr("comp",this)}var yx={};Ia.prototype.parse=function(r){var e=this.options.loose?jr[T2]:jr[k2],t=r.match(e);if(!t)throw new TypeError("Invalid comparator: "+r);this.operator=t[1],this.operator==="="&&(this.operator=""),t[2]?this.semver=new $t(t[2],this.options.loose):this.semver=yx};Ia.prototype.toString=function(){return this.value};Ia.prototype.test=function(r){return Cr("Comparator.test",r,this.options.loose),this.semver===yx?!0:(typeof r=="string"&&(r=new $t(r,this.options)),KN(r,this.operator,this.semver,this.options))};Ia.prototype.intersects=function(r,e){if(!(r instanceof Ia))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var t;if(this.operator==="")return t=new un(r.value,e),FN(this.value,t,e);if(r.operator==="")return t=new un(this.value,e),FN(r.semver,t,e);var n=(this.operator===">="||this.operator===">")&&(r.operator===">="||r.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(r.operator==="<="||r.operator==="<"),o=this.semver.version===r.semver.version,s=(this.operator===">="||this.operator==="<=")&&(r.operator===">="||r.operator==="<="),a=KN(this.semver,"<",r.semver,e)&&(this.operator===">="||this.operator===">")&&(r.operator==="<="||r.operator==="<"),l=KN(this.semver,">",r.semver,e)&&(this.operator==="<="||this.operator==="<")&&(r.operator===">="||r.operator===">");return n||i||o&&s||a||l};mt.Range=un;function un(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof un)return r.loose===!!e.loose&&r.includePrerelease===!!e.includePrerelease?r:new un(r.raw,e);if(r instanceof Ia)return new un(r.value,e);if(!(this instanceof un))return new un(r,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=r.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}un.prototype.format=function(){return this.range=this.set.map(function(r){return r.join(" ").trim()}).join("||").trim(),this.range};un.prototype.toString=function(){return this.range};un.prototype.parseRange=function(r){var e=this.options.loose,t=e?jr[$G]:jr[YG];r=r.replace(t,qge),Cr("hyphen replace",r),r=r.replace(jr[Pg],Ege),Cr("comparator trim",r,jr[Pg]),r=r.replace(jr[iS],Ige),r=r.replace(jr[oS],_ge);var n=e?jr[T2]:jr[k2],i=r.split(" ").map(function(o){return Kge(o,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(o){return!!o.match(n)})),i=i.map(function(o){return new Ia(o,this.options)},this),i};un.prototype.intersects=function(r,e){if(!(r instanceof un))throw new TypeError("a Range is required");return this.set.some(function(t){return t.every(function(n){return r.set.some(function(i){return i.every(function(o){return n.intersects(o,e)})})})})};mt.toComparators=Lge;function Lge(r,e){return new un(r,e).set.map(function(t){return t.map(function(n){return n.value}).join(" ").trim().split(" ")})}function Kge(r,e){return Cr("comp",r,e),r=Wge(r,e),Cr("caret",r),r=Fge(r,e),Cr("tildes",r),r=jge(r,e),Cr("xrange",r),r=Hge(r,e),Cr("stars",r),r}function Po(r){return!r||r.toLowerCase()==="x"||r==="*"}function Fge(r,e){return r.trim().split(/\s+/).map(function(t){return Uge(t,e)}).join(" ")}function Uge(r,e){var t=e.loose?jr[qG]:jr[HG];return r.replace(t,function(n,i,o,s,a){Cr("tilde",r,n,i,o,s,a);var l;return Po(i)?l="":Po(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Po(s)?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":a?(Cr("replaceTilde pr",a),l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0"):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0",Cr("tilde return",l),l})}function Wge(r,e){return r.trim().split(/\s+/).map(function(t){return Vge(t,e)}).join(" ")}function Vge(r,e){Cr("caret",r,e);var t=e.loose?jr[GG]:jr[JG];return r.replace(t,function(n,i,o,s,a){Cr("caret",r,n,i,o,s,a);var l;return Po(i)?l="":Po(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Po(s)?i==="0"?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+".0 <"+(+i+1)+".0.0":a?(Cr("replaceCaret pr",a),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+"-"+a+" <"+(+i+1)+".0.0"):(Cr("no pr"),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+" <"+(+i+1)+".0.0"),Cr("caret return",l),l})}function jge(r,e){return Cr("replaceXRanges",r,e),r.split(/\s+/).map(function(t){return Bge(t,e)}).join(" ")}function Bge(r,e){r=r.trim();var t=e.loose?jr[jG]:jr[VG];return r.replace(t,function(n,i,o,s,a,l){Cr("xRange",r,n,i,o,s,a,l);var u=Po(o),c=u||Po(s),d=c||Po(a),f=d;return i==="="&&f&&(i=""),u?i===">"||i==="<"?n="<0.0.0":n="*":i&&f?(c&&(s=0),a=0,i===">"?(i=">=",c?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):i==="<="&&(i="<",c?o=+o+1:s=+s+1),n=i+o+"."+s+"."+a):c?n=">="+o+".0.0 <"+(+o+1)+".0.0":d&&(n=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0"),Cr("xRange return",n),n})}function Hge(r,e){return Cr("replaceStars",r,e),r.trim().replace(jr[zG],"")}function qge(r,e,t,n,i,o,s,a,l,u,c,d,f){return Po(t)?e="":Po(n)?e=">="+t+".0.0":Po(i)?e=">="+t+"."+n+".0":e=">="+e,Po(l)?a="":Po(u)?a="<"+(+l+1)+".0.0":Po(c)?a="<"+l+"."+(+u+1)+".0":d?a="<="+l+"."+u+"."+c+"-"+d:a="<="+a,(e+" "+a).trim()}un.prototype.test=function(r){if(!r)return!1;typeof r=="string"&&(r=new $t(r,this.options));for(var e=0;e<this.set.length;e++)if(Jge(this.set[e],r,this.options))return!0;return!1};function Jge(r,e,t){for(var n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(n=0;n<r.length;n++)if(Cr(r[n].semver),r[n].semver!==yx&&r[n].semver.prerelease.length>0){var i=r[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}mt.satisfies=FN;function FN(r,e,t){try{e=new un(e,t)}catch(n){return!1}return e.test(r)}mt.maxSatisfying=Gge;function Gge(r,e,t){var n=null,i=null;try{var o=new un(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===-1)&&(n=s,i=new $t(n,t))}),n}mt.minSatisfying=Yge;function Yge(r,e,t){var n=null,i=null;try{var o=new un(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===1)&&(n=s,i=new $t(n,t))}),n}mt.minVersion=$ge;function $ge(r,e){r=new un(r,e);var t=new $t("0.0.0");if(r.test(t)||(t=new $t("0.0.0-0"),r.test(t)))return t;t=null;for(var n=0;n<r.set.length;++n){var i=r.set[n];i.forEach(function(o){var s=new $t(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!t||gx(t,s))&&(t=s);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+o.operator)}})}return t&&r.test(t)?t:null}mt.validRange=zge;function zge(r,e){try{return new un(r,e).range||"*"}catch(t){return null}}mt.ltr=Qge;function Qge(r,e,t){return M2(r,e,"<",t)}mt.gtr=Xge;function Xge(r,e,t){return M2(r,e,">",t)}mt.outside=M2;function M2(r,e,t,n){r=new $t(r,n),e=new un(e,n);var i,o,s,a,l;switch(t){case">":i=gx,o=A2,s=LN,a=">",l=">=";break;case"<":i=LN,o=R2,s=gx,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(FN(r,e,n))return!1;for(var u=0;u<e.set.length;++u){var c=e.set[u],d=null,f=null;if(c.forEach(function(m){m.semver===yx&&(m=new Ia(">=0.0.0")),d=d||m,f=f||m,i(m.semver,d.semver,n)?d=m:s(m.semver,f.semver,n)&&(f=m)}),d.operator===a||d.operator===l||(!f.operator||f.operator===a)&&o(r,f.semver))return!1;if(f.operator===l&&s(r,f.semver))return!1}return!0}mt.prerelease=Zge;function Zge(r,e){var t=Dg(r,e);return t&&t.prerelease.length?t.prerelease:null}mt.intersects=eve;function eve(r,e,t){return r=new un(r,t),e=new un(e,t),r.intersects(e)}mt.coerce=tve;function tve(r){if(r instanceof $t)return r;if(typeof r!="string")return null;var e=r.match(jr[BG]);return e==null?null:Dg(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var V2=re((zN,vY)=>{p();(function(r,e){typeof zN=="object"&&typeof vY!="undefined"?e(zN):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(zN,function(r){"use strict";r.ArrayExt=void 0,function(h){function v(R,M,S=0,I=-1){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(S+j)%_;if(R[me]===M)return me}return-1}h.firstIndexOf=v;function C(R,M,S=-1,I=0){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(S-j+_)%_;if(R[me]===M)return me}return-1}h.lastIndexOf=C;function k(R,M,S=0,I=-1){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(S+j)%_;if(M(R[me],me))return me}return-1}h.findFirstIndex=k;function H(R,M,S=-1,I=0){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(S-j+_)%_;if(M(R[me],me))return me}return-1}h.findLastIndex=H;function Y(R,M,S=0,I=-1){let _=k(R,M,S,I);return _!==-1?R[_]:void 0}h.findFirstValue=Y;function Z(R,M,S=-1,I=0){let _=H(R,M,S,I);return _!==-1?R[_]:void 0}h.findLastValue=Z;function ie(R,M,S,I=0,_=-1){let F=R.length;if(F===0)return 0;I<0?I=Math.max(0,I+F):I=Math.min(I,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=I,me=_-I+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;S(R[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function ce(R,M,S,I=0,_=-1){let F=R.length;if(F===0)return 0;I<0?I=Math.max(0,I+F):I=Math.min(I,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=I,me=_-I+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;S(R[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=ce;function be(R,M,S){if(R===M)return!0;if(R.length!==M.length)return!1;for(let I=0,_=R.length;I<_;++I)if(S?!S(R[I],M[I]):R[I]!==M[I])return!1;return!0}h.shallowEqual=be;function q(R,M={}){let{start:S,stop:I,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=R.length;S===void 0?S=_<0?F-1:0:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F),I===void 0?I=_<0?-1:F:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F);let j;_<0&&I>=S||_>0&&S>=I?j=0:_<0?j=Math.floor((I-S+1)/_+1):j=Math.floor((I-S-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=R[S+Fe*_];return me}h.slice=q;function $(R,M,S){let I=R.length;if(I<=1||(M<0?M=Math.max(0,M+I):M=Math.min(M,I-1),S<0?S=Math.max(0,S+I):S=Math.min(S,I-1),M===S))return;let _=R[M],F=M<S?1:-1;for(let j=M;j!==S;j+=F)R[j]=R[j+F];R[S]=_}h.move=$;function de(R,M=0,S=-1){let I=R.length;if(!(I<=1))for(M<0?M=Math.max(0,M+I):M=Math.min(M,I-1),S<0?S=Math.max(0,S+I):S=Math.min(S,I-1);M<S;){let _=R[M],F=R[S];R[M++]=F,R[S--]=_}}h.reverse=de;function pe(R,M,S=0,I=-1){let _=R.length;if(_<=1||(S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S>=I))return;let F=I-S+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=S+M;de(R,S,j-1),de(R,j,I),de(R,S,I)}h.rotate=pe;function ye(R,M,S=0,I=-1){let _=R.length;if(_===0)return;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j)R[(S+j)%_]=M}h.fill=ye;function z(R,M,S){let I=R.length;M<0?M=Math.max(0,M+I):M=Math.min(M,I);for(let _=I;_>M;--_)R[_]=R[_-1];R[M]=S}h.insert=z;function fe(R,M){let S=R.length;if(M<0&&(M+=S),M<0||M>=S)return;let I=R[M];for(let _=M+1;_<S;++_)R[_-1]=R[_];return R.length=S-1,I}h.removeAt=fe;function Ie(R,M,S=0,I=-1){let _=v(R,M,S,I);return _!==-1&&fe(R,_),_}h.removeFirstOf=Ie;function Te(R,M,S=-1,I=0){let _=C(R,M,S,I);return _!==-1&&fe(R,_),_}h.removeLastOf=Te;function Le(R,M,S=0,I=-1){let _=R.length;if(_===0)return 0;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F=0;for(let j=0;j<_;++j)S<=I&&j>=S&&j<=I&&R[j]===M||I<S&&(j<=I||j>=S)&&R[j]===M?F++:F>0&&(R[j-F]=R[j]);return F>0&&(R.length=_-F),F}h.removeAllOf=Le;function $e(R,M,S=0,I=-1){let _,F=k(R,M,S,I);return F!==-1&&(_=fe(R,F)),{index:F,value:_}}h.removeFirstWhere=$e;function Ge(R,M,S=-1,I=0){let _,F=H(R,M,S,I);return F!==-1&&(_=fe(R,F)),{index:F,value:_}}h.removeLastWhere=Ge;function Bt(R,M,S=0,I=-1){let _=R.length;if(_===0)return 0;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F=0;for(let j=0;j<_;++j)S<=I&&j>=S&&j<=I&&M(R[j],j)||I<S&&(j<=I||j>=S)&&M(R[j],j)?F++:F>0&&(R[j-F]=R[j]);return F>0&&(R.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let v of h)yield*v}function*t(){}function*n(h,v=0){for(let C of h)yield[v++,C]}function*i(h,v){let C=0;for(let k of h)v(k,C++)&&(yield k)}function o(h,v){let C=0;for(let k of h)if(v(k,C++))return k}function s(h,v){let C=0;for(let k of h)if(v(k,C++))return C-1;return-1}function a(h,v){let C;for(let k of h){if(C===void 0){C=k;continue}v(k,C)<0&&(C=k)}return C}function l(h,v){let C;for(let k of h){if(C===void 0){C=k;continue}v(k,C)>0&&(C=k)}return C}function u(h,v){let C=!0,k,H;for(let Y of h)C?(k=Y,H=Y,C=!1):v(Y,k)<0?k=Y:v(Y,H)>0&&(H=Y);return C?void 0:[k,H]}function c(h){return Array.from(h)}function d(h){let v={};for(let[C,k]of h)v[C]=k;return v}function f(h,v){let C=0;for(let k of h)if(v(k,C++)===!1)return}function m(h,v){let C=0;for(let k of h)if(v(k,C++)===!1)return!1;return!0}function g(h,v){let C=0;for(let k of h)if(v(k,C++))return!0;return!1}function*b(h,v){let C=0;for(let k of h)yield v(k,C++)}function*y(h,v,C){v===void 0?(v=h,h=0,C=1):C===void 0&&(C=1);let k=P.rangeLength(h,v,C);for(let H=0;H<k;H++)yield h+C*H}var P;(function(h){function v(C,k,H){return H===0?1/0:C>k&&H>0||C<k&&H<0?0:Math.ceil((k-C)/H)}h.rangeLength=v})(P||(P={}));function A(h,v,C){let k=h[Symbol.iterator](),H=0,Y=k.next();if(Y.done&&C===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return C;let Z=k.next();if(Z.done&&C===void 0)return Y.value;if(Z.done)return v(C,Y.value,H++);let ie;C===void 0?ie=v(Y.value,Z.value,H++):ie=v(v(C,Y.value,H++),Z.value,H++);let ce;for(;!(ce=k.next()).done;)ie=v(ie,ce.value,H++);return ie}function*D(h,v){for(;0<v--;)yield h}function*T(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let v=h.length-1;v>-1;v--)yield h[v]}function L(h){let v=[],C=new Set,k=new Map;for(let Z of h)H(Z);for(let[Z]of k)Y(Z);return v;function H(Z){let[ie,ce]=Z,be=k.get(ce);be?be.push(ie):k.set(ce,[ie])}function Y(Z){if(C.has(Z))return;C.add(Z);let ie=k.get(Z);if(ie)for(let ce of ie)Y(ce);v.push(Z)}}function*B(h,v){let C=0;for(let k of h)C++%v===0&&(yield k)}r.StringExt=void 0,function(h){function v(Z,ie,ce=0){let be=new Array(ie.length);for(let q=0,$=ce,de=ie.length;q<de;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=v;function C(Z,ie,ce=0){let be=v(Z,ie,ce);if(!be)return null;let q=0;for(let $=0,de=be.length;$<de;++$){let pe=be[$]-ce;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=C;function k(Z,ie,ce=0){let be=v(Z,ie,ce);if(!be)return null;let q=0,$=ce-1;for(let de=0,pe=be.length;de<pe;++de){let ye=be[de];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=k;function H(Z,ie,ce){let be=[],q=0,$=0,de=ie.length;for(;q<de;){let pe=ie[q],ye=ie[q];for(;++q<de&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(ce(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,v){if(v<1)return;let C=h[Symbol.iterator](),k;for(;0<v--&&!(k=C.next()).done;)yield k.value}function*O(...h){let v=h.map(k=>k[Symbol.iterator]()),C=v.map(k=>k.next());for(;m(C,k=>!k.done);C=v.map(k=>k.next()))yield C.map(k=>k.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=T,r.range=y,r.reduce=A,r.repeat=D,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var Wc=re((QN,yY)=>{p();(function(r,e){typeof QN=="object"&&typeof yY!="undefined"?e(QN,V2()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(QN,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"}u.isPrimitive=c;function d(D){return Array.isArray(D)}u.isArray=d;function f(D){return!c(D)&&!d(D)}u.isObject=f;function m(D,T){if(D===T)return!0;if(c(D)||c(T))return!1;let K=d(D),L=d(T);return K!==L?!1:K&&L?b(D,T):y(D,T)}u.deepEqual=m;function g(D){return c(D)?D:d(D)?P(D):A(D)}u.deepCopy=g;function b(D,T){if(D===T)return!0;if(D.length!==T.length)return!1;for(let K=0,L=D.length;K<L;++K)if(!m(D[K],T[K]))return!1;return!0}function y(D,T){if(D===T)return!0;for(let K in D)if(D[K]!==void 0&&!(K in T))return!1;for(let K in T)if(T[K]!==void 0&&!(K in D))return!1;for(let K in D){let L=D[K],B=T[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function P(D){let T=new Array(D.length);for(let K=0,L=D.length;K<L;++K)T[K]=g(D[K]);return T}function A(D){let T={};for(let K in D){let L=D[K];L!==void 0&&(T[K]=g(L))}return T}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(y=>{let P=this._services.get(y);return P?this._plugins.get(P).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(y){var P,A,D,T;this._activated=!1,this._promise=null,this._service=null,this.id=y.id,this.description=(P=y.description)!==null&&P!==void 0?P:"",this.activate=y.activate,this.deactivate=(A=y.deactivate)!==null&&A!==void 0?A:null,this.provides=(D=y.provides)!==null&&D!==void 0?D:null,this.autoStart=(T=y.autoStart)!==null&&T!==void 0?T:!1,this.requires=y.requires?y.requires.slice():[],this.optional=y.optional?y.optional.slice():[]}get activated(){return this._activated}set activated(y){this._activated=y}get service(){return this._service}set service(y){this._service=y}get promise(){return this._promise}set promise(y){this._promise=y}}function d(b){return new c(b)}u.createPluginData=d;function f(b,y,P){let A=[...b.requires,...b.optional],D=K=>{if(K===b.provides)return!0;let L=P.get(K);if(!L)return!1;let B=y.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(T.push(L),N.some(D)?!0:(T.pop(),!1))};if(!b.provides||A.length===0)return;let T=[b.id];if(A.some(D))throw new ReferenceError(`Cycle detected: ${T.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,y,P){let A=new Array,D=N=>{let O=y.get(N),h=[...O.requires,...O.optional];A.push(...h.reduce((v,C)=>{let k=P.get(C);return k&&v.push([N,k]),v},[]))};for(let N of y.keys())D(N);let T=A.filter(N=>N[1]===b),K=0;for(;T.length>K;){let N=T.length,O=new Set(T.map(h=>h[0]));for(let h of O)A.filter(v=>v[1]===h).forEach(v=>{T.includes(v)||T.push(v)});K=N}let L=e.topologicSort(T),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,y){let P=new Set;for(let A of b.keys())b.get(A).autoStart===!0&&P.add(A);if(y.startPlugins)for(let A of y.startPlugins)P.add(A);if(y.ignorePlugins)for(let A of y.ignorePlugins)P.delete(A);return Array.from(P)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var Rs=re((XN,bY)=>{p();(function(r,e){typeof XN=="object"&&typeof bY!="undefined"?e(XN,V2(),Wc()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(XN,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let v=g.get(N.sender);if(v||(v=[],g.set(N.sender,v)),A(v,N,O,h))return!1;let C=h||O,k=b.get(C);k||(k=[],b.set(C,k));let H={signal:N,slot:O,thisArg:h};return v.push(H),k.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let v=g.get(N.sender);if(!v||v.length===0)return!1;let C=A(v,N,O,h);if(!C)return!1;let k=h||O,H=b.get(k);return C.signal=null,T(v),T(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let v=b.get(O);if(!(!v||v.length===0)){for(let C of v)C.signal&&C.signal.sender===N&&(C.signal=null);T(h),T(v)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let v=h.thisArg||h.slot;h.signal=null,T(b.get(v))}T(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let v=h.signal.sender;h.signal=null,T(g.get(v))}T(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let v=0,C=h.length;v<C;++v){let k=h[v];k.signal===N&&D(k,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,y=new Set,P=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function A(N,O,h,v){return e.find(N,C=>C.signal===O&&C.slot===h&&C.thisArg===v)}function D(N,O){let{signal:h,slot:v,thisArg:C}=N;try{v.call(C,h.sender,O)}catch(k){s.exceptionHandler(k)}}function T(N){y.size===0&&P(K),y.add(N)}function K(){y.forEach(L),y.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var j2=re((ZN,SY)=>{p();(function(r,e){typeof ZN=="object"&&typeof SY!="undefined"?e(ZN):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(ZN,function(r){"use strict";r.ArrayExt=void 0,function(h){function v(R,M,S=0,I=-1){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(S+j)%_;if(R[me]===M)return me}return-1}h.firstIndexOf=v;function C(R,M,S=-1,I=0){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(S-j+_)%_;if(R[me]===M)return me}return-1}h.lastIndexOf=C;function k(R,M,S=0,I=-1){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(S+j)%_;if(M(R[me],me))return me}return-1}h.findFirstIndex=k;function H(R,M,S=-1,I=0){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(S-j+_)%_;if(M(R[me],me))return me}return-1}h.findLastIndex=H;function Y(R,M,S=0,I=-1){let _=k(R,M,S,I);return _!==-1?R[_]:void 0}h.findFirstValue=Y;function Z(R,M,S=-1,I=0){let _=H(R,M,S,I);return _!==-1?R[_]:void 0}h.findLastValue=Z;function ie(R,M,S,I=0,_=-1){let F=R.length;if(F===0)return 0;I<0?I=Math.max(0,I+F):I=Math.min(I,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=I,me=_-I+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;S(R[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function ce(R,M,S,I=0,_=-1){let F=R.length;if(F===0)return 0;I<0?I=Math.max(0,I+F):I=Math.min(I,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=I,me=_-I+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;S(R[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=ce;function be(R,M,S){if(R===M)return!0;if(R.length!==M.length)return!1;for(let I=0,_=R.length;I<_;++I)if(S?!S(R[I],M[I]):R[I]!==M[I])return!1;return!0}h.shallowEqual=be;function q(R,M={}){let{start:S,stop:I,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=R.length;S===void 0?S=_<0?F-1:0:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F),I===void 0?I=_<0?-1:F:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F);let j;_<0&&I>=S||_>0&&S>=I?j=0:_<0?j=Math.floor((I-S+1)/_+1):j=Math.floor((I-S-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=R[S+Fe*_];return me}h.slice=q;function $(R,M,S){let I=R.length;if(I<=1||(M<0?M=Math.max(0,M+I):M=Math.min(M,I-1),S<0?S=Math.max(0,S+I):S=Math.min(S,I-1),M===S))return;let _=R[M],F=M<S?1:-1;for(let j=M;j!==S;j+=F)R[j]=R[j+F];R[S]=_}h.move=$;function de(R,M=0,S=-1){let I=R.length;if(!(I<=1))for(M<0?M=Math.max(0,M+I):M=Math.min(M,I-1),S<0?S=Math.max(0,S+I):S=Math.min(S,I-1);M<S;){let _=R[M],F=R[S];R[M++]=F,R[S--]=_}}h.reverse=de;function pe(R,M,S=0,I=-1){let _=R.length;if(_<=1||(S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S>=I))return;let F=I-S+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=S+M;de(R,S,j-1),de(R,j,I),de(R,S,I)}h.rotate=pe;function ye(R,M,S=0,I=-1){let _=R.length;if(_===0)return;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j)R[(S+j)%_]=M}h.fill=ye;function z(R,M,S){let I=R.length;M<0?M=Math.max(0,M+I):M=Math.min(M,I);for(let _=I;_>M;--_)R[_]=R[_-1];R[M]=S}h.insert=z;function fe(R,M){let S=R.length;if(M<0&&(M+=S),M<0||M>=S)return;let I=R[M];for(let _=M+1;_<S;++_)R[_-1]=R[_];return R.length=S-1,I}h.removeAt=fe;function Ie(R,M,S=0,I=-1){let _=v(R,M,S,I);return _!==-1&&fe(R,_),_}h.removeFirstOf=Ie;function Te(R,M,S=-1,I=0){let _=C(R,M,S,I);return _!==-1&&fe(R,_),_}h.removeLastOf=Te;function Le(R,M,S=0,I=-1){let _=R.length;if(_===0)return 0;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F=0;for(let j=0;j<_;++j)S<=I&&j>=S&&j<=I&&R[j]===M||I<S&&(j<=I||j>=S)&&R[j]===M?F++:F>0&&(R[j-F]=R[j]);return F>0&&(R.length=_-F),F}h.removeAllOf=Le;function $e(R,M,S=0,I=-1){let _,F=k(R,M,S,I);return F!==-1&&(_=fe(R,F)),{index:F,value:_}}h.removeFirstWhere=$e;function Ge(R,M,S=-1,I=0){let _,F=H(R,M,S,I);return F!==-1&&(_=fe(R,F)),{index:F,value:_}}h.removeLastWhere=Ge;function Bt(R,M,S=0,I=-1){let _=R.length;if(_===0)return 0;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F=0;for(let j=0;j<_;++j)S<=I&&j>=S&&j<=I&&M(R[j],j)||I<S&&(j<=I||j>=S)&&M(R[j],j)?F++:F>0&&(R[j-F]=R[j]);return F>0&&(R.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let v of h)yield*v}function*t(){}function*n(h,v=0){for(let C of h)yield[v++,C]}function*i(h,v){let C=0;for(let k of h)v(k,C++)&&(yield k)}function o(h,v){let C=0;for(let k of h)if(v(k,C++))return k}function s(h,v){let C=0;for(let k of h)if(v(k,C++))return C-1;return-1}function a(h,v){let C;for(let k of h){if(C===void 0){C=k;continue}v(k,C)<0&&(C=k)}return C}function l(h,v){let C;for(let k of h){if(C===void 0){C=k;continue}v(k,C)>0&&(C=k)}return C}function u(h,v){let C=!0,k,H;for(let Y of h)C?(k=Y,H=Y,C=!1):v(Y,k)<0?k=Y:v(Y,H)>0&&(H=Y);return C?void 0:[k,H]}function c(h){return Array.from(h)}function d(h){let v={};for(let[C,k]of h)v[C]=k;return v}function f(h,v){let C=0;for(let k of h)if(v(k,C++)===!1)return}function m(h,v){let C=0;for(let k of h)if(v(k,C++)===!1)return!1;return!0}function g(h,v){let C=0;for(let k of h)if(v(k,C++))return!0;return!1}function*b(h,v){let C=0;for(let k of h)yield v(k,C++)}function*y(h,v,C){v===void 0?(v=h,h=0,C=1):C===void 0&&(C=1);let k=P.rangeLength(h,v,C);for(let H=0;H<k;H++)yield h+C*H}var P;(function(h){function v(C,k,H){return H===0?1/0:C>k&&H>0||C<k&&H<0?0:Math.ceil((k-C)/H)}h.rangeLength=v})(P||(P={}));function A(h,v,C){let k=h[Symbol.iterator](),H=0,Y=k.next();if(Y.done&&C===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return C;let Z=k.next();if(Z.done&&C===void 0)return Y.value;if(Z.done)return v(C,Y.value,H++);let ie;C===void 0?ie=v(Y.value,Z.value,H++):ie=v(v(C,Y.value,H++),Z.value,H++);let ce;for(;!(ce=k.next()).done;)ie=v(ie,ce.value,H++);return ie}function*D(h,v){for(;0<v--;)yield h}function*T(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let v=h.length-1;v>-1;v--)yield h[v]}function L(h){let v=[],C=new Set,k=new Map;for(let Z of h)H(Z);for(let[Z]of k)Y(Z);return v;function H(Z){let[ie,ce]=Z,be=k.get(ce);be?be.push(ie):k.set(ce,[ie])}function Y(Z){if(C.has(Z))return;C.add(Z);let ie=k.get(Z);if(ie)for(let ce of ie)Y(ce);v.push(Z)}}function*B(h,v){let C=0;for(let k of h)C++%v===0&&(yield k)}r.StringExt=void 0,function(h){function v(Z,ie,ce=0){let be=new Array(ie.length);for(let q=0,$=ce,de=ie.length;q<de;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=v;function C(Z,ie,ce=0){let be=v(Z,ie,ce);if(!be)return null;let q=0;for(let $=0,de=be.length;$<de;++$){let pe=be[$]-ce;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=C;function k(Z,ie,ce=0){let be=v(Z,ie,ce);if(!be)return null;let q=0,$=ce-1;for(let de=0,pe=be.length;de<pe;++de){let ye=be[de];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=k;function H(Z,ie,ce){let be=[],q=0,$=0,de=ie.length;for(;q<de;){let pe=ie[q],ye=ie[q];for(;++q<de&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(ce(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,v){if(v<1)return;let C=h[Symbol.iterator](),k;for(;0<v--&&!(k=C.next()).done;)yield k.value}function*O(...h){let v=h.map(k=>k[Symbol.iterator]()),C=v.map(k=>k.next());for(;m(C,k=>!k.done);C=v.map(k=>k.next()))yield C.map(k=>k.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=T,r.range=y,r.reduce=A,r.repeat=D,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var t1=re((e1,IY)=>{p();(function(r,e){typeof e1=="object"&&typeof IY!="undefined"?e(e1,j2()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(e1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"}u.isPrimitive=c;function d(D){return Array.isArray(D)}u.isArray=d;function f(D){return!c(D)&&!d(D)}u.isObject=f;function m(D,T){if(D===T)return!0;if(c(D)||c(T))return!1;let K=d(D),L=d(T);return K!==L?!1:K&&L?b(D,T):y(D,T)}u.deepEqual=m;function g(D){return c(D)?D:d(D)?P(D):A(D)}u.deepCopy=g;function b(D,T){if(D===T)return!0;if(D.length!==T.length)return!1;for(let K=0,L=D.length;K<L;++K)if(!m(D[K],T[K]))return!1;return!0}function y(D,T){if(D===T)return!0;for(let K in D)if(D[K]!==void 0&&!(K in T))return!1;for(let K in T)if(T[K]!==void 0&&!(K in D))return!1;for(let K in D){let L=D[K],B=T[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function P(D){let T=new Array(D.length);for(let K=0,L=D.length;K<L;++K)T[K]=g(D[K]);return T}function A(D){let T={};for(let K in D){let L=D[K];L!==void 0&&(T[K]=g(L))}return T}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(y=>{let P=this._services.get(y);return P?this._plugins.get(P).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(y){var P,A,D,T;this._activated=!1,this._promise=null,this._service=null,this.id=y.id,this.description=(P=y.description)!==null&&P!==void 0?P:"",this.activate=y.activate,this.deactivate=(A=y.deactivate)!==null&&A!==void 0?A:null,this.provides=(D=y.provides)!==null&&D!==void 0?D:null,this.autoStart=(T=y.autoStart)!==null&&T!==void 0?T:!1,this.requires=y.requires?y.requires.slice():[],this.optional=y.optional?y.optional.slice():[]}get activated(){return this._activated}set activated(y){this._activated=y}get service(){return this._service}set service(y){this._service=y}get promise(){return this._promise}set promise(y){this._promise=y}}function d(b){return new c(b)}u.createPluginData=d;function f(b,y,P){let A=[...b.requires,...b.optional],D=K=>{if(K===b.provides)return!0;let L=P.get(K);if(!L)return!1;let B=y.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(T.push(L),N.some(D)?!0:(T.pop(),!1))};if(!b.provides||A.length===0)return;let T=[b.id];if(A.some(D))throw new ReferenceError(`Cycle detected: ${T.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,y,P){let A=new Array,D=N=>{let O=y.get(N),h=[...O.requires,...O.optional];A.push(...h.reduce((v,C)=>{let k=P.get(C);return k&&v.push([N,k]),v},[]))};for(let N of y.keys())D(N);let T=A.filter(N=>N[1]===b),K=0;for(;T.length>K;){let N=T.length,O=new Set(T.map(h=>h[0]));for(let h of O)A.filter(v=>v[1]===h).forEach(v=>{T.includes(v)||T.push(v)});K=N}let L=e.topologicSort(T),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,y){let P=new Set;for(let A of b.keys())b.get(A).autoStart===!0&&P.add(A);if(y.startPlugins)for(let A of y.startPlugins)P.add(A);if(y.ignorePlugins)for(let A of y.ignorePlugins)P.delete(A);return Array.from(P)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var EY=re((r1,_Y)=>{p();(function(r,e){typeof r1=="object"&&typeof _Y!="undefined"?e(r1,j2(),t1()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(r1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let v=g.get(N.sender);if(v||(v=[],g.set(N.sender,v)),A(v,N,O,h))return!1;let C=h||O,k=b.get(C);k||(k=[],b.set(C,k));let H={signal:N,slot:O,thisArg:h};return v.push(H),k.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let v=g.get(N.sender);if(!v||v.length===0)return!1;let C=A(v,N,O,h);if(!C)return!1;let k=h||O,H=b.get(k);return C.signal=null,T(v),T(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let v=b.get(O);if(!(!v||v.length===0)){for(let C of v)C.signal&&C.signal.sender===N&&(C.signal=null);T(h),T(v)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let v=h.thisArg||h.slot;h.signal=null,T(b.get(v))}T(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let v=h.signal.sender;h.signal=null,T(g.get(v))}T(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let v=0,C=h.length;v<C;++v){let k=h[v];k.signal===N&&D(k,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,y=new Set,P=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function A(N,O,h,v){return e.find(N,C=>C.signal===O&&C.slot===h&&C.thisArg===v)}function D(N,O){let{signal:h,slot:v,thisArg:C}=N;try{v.call(C,h.sender,O)}catch(k){s.exceptionHandler(k)}}function T(N){y.size===0&&P(K),y.add(N)}function K(){y.forEach(L),y.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var wY=re(n1=>{"use strict";p();Object.defineProperty(n1,"__esModule",{value:!0});n1.ActivityMonitor=void 0;var CY=EY(),B2=class{constructor(e){this._timer=-1,this._timeout=-1,this._isDisposed=!1,this._activityStopped=new CY.Signal(this),e.signal.connect(this._onSignalFired,this),this._timeout=e.timeout||1e3}get activityStopped(){return this._activityStopped}get timeout(){return this._timeout}set timeout(e){this._timeout=e}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,CY.Signal.clearData(this))}_onSignalFired(e,t){clearTimeout(this._timer),this._sender=e,this._args=t,this._timer=setTimeout(()=>{this._activityStopped.emit({sender:this._sender,args:this._args})},this._timeout)}};n1.ActivityMonitor=B2});var PY=re(xY=>{"use strict";p();Object.defineProperty(xY,"__esModule",{value:!0})});var DY=re(i1=>{"use strict";p();Object.defineProperty(i1,"__esModule",{value:!0});i1.LruCache=void 0;var hve=128,H2=class{constructor(e={}){this._map=new Map,this._maxSize=(e==null?void 0:e.maxSize)||hve}get size(){return this._map.size}clear(){this._map.clear()}get(e){let t=this._map.get(e)||null;return t!=null&&(this._map.delete(e),this._map.set(e,t)),t}set(e,t){this._map.size>=this._maxSize&&this._map.delete(this._map.keys().next().value),this._map.set(e,t)}};i1.LruCache=H2});var kY=re(o1=>{"use strict";p();Object.defineProperty(o1,"__esModule",{value:!0});o1.MarkdownCodeBlocks=void 0;var TY;(function(r){r.CODE_BLOCK_MARKER="```";let e=[".markdown",".mdown",".mkdn",".md",".mkd",".mdwn",".mdtxt",".mdtext",".text",".txt",".Rmd"];class t{constructor(s){this.startLine=s,this.code="",this.endLine=-1}}r.MarkdownCodeBlock=t;function n(o){return e.indexOf(o)>-1}r.isMarkdown=n;function i(o){if(!o||o==="")return[];let s=o.split(`
`),a=[],l=null;for(let u=0;u<s.length;u++){let c=s[u],d=c.indexOf(r.CODE_BLOCK_MARKER)===0,f=l!=null;if(!(!d&&!f))if(f)l&&(d?(l.endLine=u-1,a.push(l),l=null):l.code+=c+`
`);else{l=new t(u);let m=c.indexOf(r.CODE_BLOCK_MARKER),g=c.lastIndexOf(r.CODE_BLOCK_MARKER);m!==g&&(l.code=c.substring(m+r.CODE_BLOCK_MARKER.length,g),l.endLine=u,a.push(l),l=null)}}return a}r.findMarkdownCodeBlocks=i})(TY||(o1.MarkdownCodeBlocks=TY={}))});var MY=re((uqe,AY)=>{"use strict";p();function gve(r,e){var t=r;e.slice(0,-1).forEach(function(i){t=t[i]||{}});var n=e[e.length-1];return n in t}function NY(r){return typeof r=="number"||/^0x[0-9a-f]+$/i.test(r)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(r)}function RY(r,e){return e==="constructor"&&typeof r[e]=="function"||e==="__proto__"}AY.exports=function(r,e){e||(e={});var t={bools:{},strings:{},unknownFn:null};typeof e.unknown=="function"&&(t.unknownFn=e.unknown),typeof e.boolean=="boolean"&&e.boolean?t.allBools=!0:[].concat(e.boolean).filter(Boolean).forEach(function(T){t.bools[T]=!0});var n={};function i(T){return n[T].some(function(K){return t.bools[K]})}Object.keys(e.alias||{}).forEach(function(T){n[T]=[].concat(e.alias[T]),n[T].forEach(function(K){n[K]=[T].concat(n[T].filter(function(L){return K!==L}))})}),[].concat(e.string).filter(Boolean).forEach(function(T){t.strings[T]=!0,n[T]&&[].concat(n[T]).forEach(function(K){t.strings[K]=!0})});var o=e.default||{},s={_:[]};function a(T,K){return t.allBools&&/^--[^=]+$/.test(K)||t.strings[T]||t.bools[T]||n[T]}function l(T,K,L){for(var B=T,N=0;N<K.length-1;N++){var O=K[N];if(RY(B,O))return;B[O]===void 0&&(B[O]={}),(B[O]===Object.prototype||B[O]===Number.prototype||B[O]===String.prototype)&&(B[O]={}),B[O]===Array.prototype&&(B[O]=[]),B=B[O]}var h=K[K.length-1];RY(B,h)||((B===Object.prototype||B===Number.prototype||B===String.prototype)&&(B={}),B===Array.prototype&&(B=[]),B[h]===void 0||t.bools[h]||typeof B[h]=="boolean"?B[h]=L:Array.isArray(B[h])?B[h].push(L):B[h]=[B[h],L])}function u(T,K,L){if(!(L&&t.unknownFn&&!a(T,L)&&t.unknownFn(L)===!1)){var B=!t.strings[T]&&NY(K)?Number(K):K;l(s,T.split("."),B),(n[T]||[]).forEach(function(N){l(s,N.split("."),B)})}}Object.keys(t.bools).forEach(function(T){u(T,o[T]===void 0?!1:o[T])});var c=[];r.indexOf("--")!==-1&&(c=r.slice(r.indexOf("--")+1),r=r.slice(0,r.indexOf("--")));for(var d=0;d<r.length;d++){var f=r[d],m,g;if(/^--.+=/.test(f)){var b=f.match(/^--([^=]+)=([\s\S]*)$/);m=b[1];var y=b[2];t.bools[m]&&(y=y!=="false"),u(m,y,f)}else if(/^--no-.+/.test(f))m=f.match(/^--no-(.+)/)[1],u(m,!1,f);else if(/^--.+/.test(f))m=f.match(/^--(.+)/)[1],g=r[d+1],g!==void 0&&!/^(-|--)[^-]/.test(g)&&!t.bools[m]&&!t.allBools&&(!n[m]||!i(m))?(u(m,g,f),d+=1):/^(true|false)$/.test(g)?(u(m,g==="true",f),d+=1):u(m,t.strings[m]?"":!0,f);else if(/^-[^-]+/.test(f)){for(var P=f.slice(1,-1).split(""),A=!1,D=0;D<P.length;D++){if(g=f.slice(D+2),g==="-"){u(P[D],g,f);continue}if(/[A-Za-z]/.test(P[D])&&g[0]==="="){u(P[D],g.slice(1),f),A=!0;break}if(/[A-Za-z]/.test(P[D])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(g)){u(P[D],g,f),A=!0;break}if(P[D+1]&&P[D+1].match(/\W/)){u(P[D],f.slice(D+2),f),A=!0;break}else u(P[D],t.strings[P[D]]?"":!0,f)}m=f.slice(-1)[0],!A&&m!=="-"&&(r[d+1]&&!/^(-|--)[^-]/.test(r[d+1])&&!t.bools[m]&&(!n[m]||!i(m))?(u(m,r[d+1],f),d+=1):r[d+1]&&/^(true|false)$/.test(r[d+1])?(u(m,r[d+1]==="true",f),d+=1):u(m,t.strings[m]?"":!0,f))}else if((!t.unknownFn||t.unknownFn(f)!==!1)&&s._.push(t.strings._||!NY(f)?f:Number(f)),e.stopEarly){s._.push.apply(s._,r.slice(d+1));break}}return Object.keys(o).forEach(function(T){gve(s,T.split("."))||(l(s,T.split("."),o[T]),(n[T]||[]).forEach(function(K){l(s,K.split("."),o[T])}))}),e["--"]?s["--"]=c.slice():c.forEach(function(T){s._.push(T)}),s}});var s1=re((pqe,LY)=>{"use strict";p();function Vc(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function OY(r,e){for(var t="",n=0,i=-1,o=0,s,a=0;a<=r.length;++a){if(a<r.length)s=r.charCodeAt(a);else{if(s===47)break;s=47}if(s===47){if(!(i===a-1||o===1))if(i!==a-1&&o===2){if(t.length<2||n!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",n=0):(t=t.slice(0,l),n=t.length-1-t.lastIndexOf("/")),i=a,o=0;continue}}else if(t.length===2||t.length===1){t="",n=0,i=a,o=0;continue}}e&&(t.length>0?t+="/..":t="..",n=2)}else t.length>0?t+="/"+r.slice(i+1,a):t=r.slice(i+1,a),n=a-i-1;i=a,o=0}else s===46&&o!==-1?++o:o=-1}return t}function vve(r,e){var t=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+n:t+r+n:n}var fS={resolve:function(){for(var e="",t=!1,n,i=arguments.length-1;i>=-1&&!t;i--){var o;i>=0?o=arguments[i]:(n===void 0&&(n=process.cwd()),o=n),Vc(o),o.length!==0&&(e=o+"/"+e,t=o.charCodeAt(0)===47)}return e=OY(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Vc(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=OY(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Vc(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];Vc(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":fS.normalize(e)},relative:function(e,t){if(Vc(e),Vc(t),e===t||(e=fS.resolve(e),t=fS.resolve(t),e===t))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var i=e.length,o=i-n,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var a=t.length,l=a-s,u=o<l?o:l,c=-1,d=0;d<=u;++d){if(d===u){if(l>u){if(t.charCodeAt(s+d)===47)return t.slice(s+d+1);if(d===0)return t.slice(s+d)}else o>u&&(e.charCodeAt(n+d)===47?c=d:d===0&&(c=0));break}var f=e.charCodeAt(n+d),m=t.charCodeAt(s+d);if(f!==m)break;f===47&&(c=d)}var g="";for(d=n+c+1;d<=i;++d)(d===i||e.charCodeAt(d)===47)&&(g.length===0?g+="..":g+="/..");return g.length>0?g+t.slice(s+c):(s+=c,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(Vc(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,i=-1,o=!0,s=e.length-1;s>=1;--s)if(t=e.charCodeAt(s),t===47){if(!o){i=s;break}}else o=!1;return i===-1?n?"/":".":n&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Vc(e);var n=0,i=-1,o=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,l=-1;for(s=e.length-1;s>=0;--s){var u=e.charCodeAt(s);if(u===47){if(!o){n=s+1;break}}else l===-1&&(o=!1,l=s+1),a>=0&&(u===t.charCodeAt(a)?--a===-1&&(i=s):(a=-1,i=l))}return n===i?i=l:i===-1&&(i=e.length),e.slice(n,i)}else{for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!o){n=s+1;break}}else i===-1&&(o=!1,i=s+1);return i===-1?"":e.slice(n,i)}},extname:function(e){Vc(e);for(var t=-1,n=0,i=-1,o=!0,s=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===46?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return vve("/",e)},parse:function(e){Vc(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),i=n===47,o;i?(t.root="/",o=1):o=0;for(var s=-1,a=0,l=-1,u=!0,c=e.length-1,d=0;c>=o;--c){if(n=e.charCodeAt(c),n===47){if(!u){a=c+1;break}continue}l===-1&&(u=!1,l=c+1),n===46?s===-1?s=c:d!==1&&(d=1):s!==-1&&(d=-1)}return s===-1||l===-1||d===0||d===1&&s===l-1&&s===a+1?l!==-1&&(a===0&&i?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(a,l)):(a===0&&i?(t.name=e.slice(1,s),t.base=e.slice(1,l)):(t.name=e.slice(a,s),t.base=e.slice(a,l)),t.ext=e.slice(s,l)),a>0?t.dir=e.slice(0,a-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};fS.posix=fS;LY.exports=fS});var FY=re((mqe,KY)=>{"use strict";p();KY.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var VY=re(q2=>{"use strict";p();var yve=Object.prototype.hasOwnProperty,bve;function UY(r){try{return decodeURIComponent(r.replace(/\+/g," "))}catch(e){return null}}function WY(r){try{return encodeURIComponent(r)}catch(e){return null}}function Sve(r){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},n;n=e.exec(r);){var i=UY(n[1]),o=UY(n[2]);i===null||o===null||i in t||(t[i]=o)}return t}function Ive(r,e){e=e||"";var t=[],n,i;typeof e!="string"&&(e="?");for(i in r)if(yve.call(r,i)){if(n=r[i],!n&&(n===null||n===bve||isNaN(n))&&(n=""),i=WY(i),n=WY(n),i===null||n===null)continue;t.push(i+"="+n)}return t.length?e+t.join("&"):""}q2.stringify=Ive;q2.parse=Sve});var Y2=re((yqe,YY)=>{"use strict";p();var BY=FY(),a1=VY(),_ve=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,HY=/[\n\r\t]/g,Eve=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,qY=/:\d+$/,Cve=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,wve=/^[a-zA-Z]:/;function G2(r){return(r||"").toString().replace(_ve,"")}var J2=[["#","hash"],["?","query"],function(e,t){return jc(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],jY={hash:1,query:1};function JY(r){var e;typeof window!="undefined"?e=window:typeof this!="undefined"?e=this:typeof self!="undefined"?e=self:e={};var t=e.location||{};r=r||t;var n={},i=typeof r,o;if(r.protocol==="blob:")n=new Bc(unescape(r.pathname),{});else if(i==="string"){n=new Bc(r,{});for(o in jY)delete n[o]}else if(i==="object"){for(o in r)o in jY||(n[o]=r[o]);n.slashes===void 0&&(n.slashes=Eve.test(r.href))}return n}function jc(r){return r==="file:"||r==="ftp:"||r==="http:"||r==="https:"||r==="ws:"||r==="wss:"}function GY(r,e){r=G2(r),r=r.replace(HY,""),e=e||{};var t=Cve.exec(r),n=t[1]?t[1].toLowerCase():"",i=!!t[2],o=!!t[3],s=0,a;return i?o?(a=t[2]+t[3]+t[4],s=t[2].length+t[3].length):(a=t[2]+t[4],s=t[2].length):o?(a=t[3]+t[4],s=t[3].length):a=t[4],n==="file:"?s>=2&&(a=a.slice(2)):jc(n)?a=t[4]:n?i&&(a=a.slice(2)):s>=2&&jc(e.protocol)&&(a=t[4]),{protocol:n,slashes:i||jc(n),slashesCount:s,rest:a}}function xve(r,e){if(r==="")return e;for(var t=(e||"/").split("/").slice(0,-1).concat(r.split("/")),n=t.length,i=t[n-1],o=!1,s=0;n--;)t[n]==="."?t.splice(n,1):t[n]===".."?(t.splice(n,1),s++):s&&(n===0&&(o=!0),t.splice(n,1),s--);return o&&t.unshift(""),(i==="."||i==="..")&&t.push(""),t.join("/")}function Bc(r,e,t){if(r=G2(r),r=r.replace(HY,""),!(this instanceof Bc))return new Bc(r,e,t);var n,i,o,s,a,l,u=J2.slice(),c=typeof e,d=this,f=0;for(c!=="object"&&c!=="string"&&(t=e,e=null),t&&typeof t!="function"&&(t=a1.parse),e=JY(e),i=GY(r||"",e),n=!i.protocol&&!i.slashes,d.slashes=i.slashes||n&&e.slashes,d.protocol=i.protocol||e.protocol||"",r=i.rest,(i.protocol==="file:"&&(i.slashesCount!==2||wve.test(r))||!i.slashes&&(i.protocol||i.slashesCount<2||!jc(d.protocol)))&&(u[3]=[/(.*)/,"pathname"]);f<u.length;f++){if(s=u[f],typeof s=="function"){r=s(r,d);continue}o=s[0],l=s[1],o!==o?d[l]=r:typeof o=="string"?(a=o==="@"?r.lastIndexOf(o):r.indexOf(o),~a&&(typeof s[2]=="number"?(d[l]=r.slice(0,a),r=r.slice(a+s[2])):(d[l]=r.slice(a),r=r.slice(0,a)))):(a=o.exec(r))&&(d[l]=a[1],r=r.slice(0,a.index)),d[l]=d[l]||n&&s[3]&&e[l]||"",s[4]&&(d[l]=d[l].toLowerCase())}t&&(d.query=t(d.query)),n&&e.slashes&&d.pathname.charAt(0)!=="/"&&(d.pathname!==""||e.pathname!=="")&&(d.pathname=xve(d.pathname,e.pathname)),d.pathname.charAt(0)!=="/"&&jc(d.protocol)&&(d.pathname="/"+d.pathname),BY(d.port,d.protocol)||(d.host=d.hostname,d.port=""),d.username=d.password="",d.auth&&(a=d.auth.indexOf(":"),~a?(d.username=d.auth.slice(0,a),d.username=encodeURIComponent(decodeURIComponent(d.username)),d.password=d.auth.slice(a+1),d.password=encodeURIComponent(decodeURIComponent(d.password))):d.username=encodeURIComponent(decodeURIComponent(d.auth)),d.auth=d.password?d.username+":"+d.password:d.username),d.origin=d.protocol!=="file:"&&jc(d.protocol)&&d.host?d.protocol+"//"+d.host:"null",d.href=d.toString()}function Pve(r,e,t){var n=this;switch(r){case"query":typeof e=="string"&&e.length&&(e=(t||a1.parse)(e)),n[r]=e;break;case"port":n[r]=e,BY(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[r]="");break;case"hostname":n[r]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[r]=e,qY.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!t;break;case"pathname":case"hash":if(e){var i=r==="pathname"?"/":"#";n[r]=e.charAt(0)!==i?i+e:e}else n[r]=e;break;case"username":case"password":n[r]=encodeURIComponent(e);break;case"auth":var o=e.indexOf(":");~o?(n.username=e.slice(0,o),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=e.slice(o+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(e))}for(var s=0;s<J2.length;s++){var a=J2[s];a[4]&&(n[a[1]]=n[a[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&jc(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function Dve(r){(!r||typeof r!="function")&&(r=a1.stringify);var e,t=this,n=t.host,i=t.protocol;i&&i.charAt(i.length-1)!==":"&&(i+=":");var o=i+(t.protocol&&t.slashes||jc(t.protocol)?"//":"");return t.username?(o+=t.username,t.password&&(o+=":"+t.password),o+="@"):t.password?(o+=":"+t.password,o+="@"):t.protocol!=="file:"&&jc(t.protocol)&&!n&&t.pathname!=="/"&&(o+="@"),(n[n.length-1]===":"||qY.test(t.hostname)&&!t.port)&&(n+=":"),o+=n+t.pathname,e=typeof t.query=="object"?r(t.query):t.query,e&&(o+=e.charAt(0)!=="?"?"?"+e:e),t.hash&&(o+=t.hash),o}Bc.prototype={set:Pve,toString:Dve};Bc.extractProtocol=GY;Bc.location=JY;Bc.trimLeft=G2;Bc.qs=a1;YY.exports=Bc});var $2=re(mS=>{"use strict";p();var Tve=mS&&mS.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(mS,"__esModule",{value:!0});mS.URLExt=void 0;var kve=s1(),l1=Tve(Y2()),$Y;(function(r){function e(u){if(typeof document!="undefined"&&document){let c=document.createElement("a");return c.href=u,c}return(0,l1.default)(u)}r.parse=e;function t(u){return(0,l1.default)(u).hostname}r.getHostName=t;function n(u){return u&&e(u).toString()}r.normalize=n;function i(...u){let c=(0,l1.default)(u[0],{}),d=c.protocol===""&&c.slashes;d&&(c=(0,l1.default)(u[0],"https:"+u[0]));let f=`${d?"":c.protocol}${c.slashes?"//":""}${c.auth}${c.auth?"@":""}${c.host}`,m=kve.posix.join(`${f&&c.pathname[0]!=="/"?"/":""}${c.pathname}`,...u.slice(1));return`${f}${m==="."?"":m}`}r.join=i;function o(u){return i(...u.split("/").map(encodeURIComponent))}r.encodeParts=o;function s(u){let c=Object.keys(u).filter(d=>d.length>0);return c.length?"?"+c.map(d=>{let f=encodeURIComponent(String(u[d]));return d+(f?"="+f:"")}).join("&"):""}r.objectToQueryString=s;function a(u){return u.replace(/^\?/,"").split("&").reduce((c,d)=>{let[f,m]=d.split("=");return f.length>0&&(c[f]=decodeURIComponent(m||"")),c},{})}r.queryStringToObject=a;function l(u,c=!1){let{protocol:d}=e(u);return(!d||u.toLowerCase().indexOf(d)!==0)&&(c?u.indexOf("//")!==0:u.indexOf("/")!==0)}r.isLocal=l})($Y||(mS.URLExt=$Y={}))});var zY=re((exports,module)=>{"use strict";p();var __importDefault=exports&&exports.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(exports,"__esModule",{value:!0});exports.PageConfig=void 0;var coreutils_1=t1(),minimist_1=__importDefault(MY()),url_1=$2(),PageConfig;(function(PageConfig){function getOption(name){if(configData)return configData[name]||getBodyData(name);configData=Object.create(null);let found=!1;if(typeof document!="undefined"&&document){let r=document.getElementById("jupyter-config-data");r&&(configData=JSON.parse(r.textContent||""),found=!0)}if(!found&&typeof process!="undefined"&&process.argv)try{let cli=(0,minimist_1.default)(process.argv.slice(2)),path=s1(),fullPath="";"jupyter-config-data"in cli?fullPath=path.resolve(cli["jupyter-config-data"]):"JUPYTER_CONFIG_DATA"in process.env&&(fullPath=path.resolve(process.env.JUPYTER_CONFIG_DATA)),fullPath&&(configData=eval("require")(fullPath))}catch(r){console.error(r)}if(!coreutils_1.JSONExt.isObject(configData))configData=Object.create(null);else for(let r in configData)typeof configData[r]!="string"&&(configData[r]=JSON.stringify(configData[r]));return configData[name]||getBodyData(name)}PageConfig.getOption=getOption;function setOption(r,e){let t=getOption(r);return configData[r]=e,t}PageConfig.setOption=setOption;function getBaseUrl(){return url_1.URLExt.normalize(getOption("baseUrl")||"/")}PageConfig.getBaseUrl=getBaseUrl;function getTreeUrl(){return url_1.URLExt.join(getBaseUrl(),getOption("treeUrl"))}PageConfig.getTreeUrl=getTreeUrl;function getShareUrl(){return url_1.URLExt.normalize(getOption("shareUrl")||getBaseUrl())}PageConfig.getShareUrl=getShareUrl;function getTreeShareUrl(){return url_1.URLExt.normalize(url_1.URLExt.join(getShareUrl(),getOption("treeUrl")))}PageConfig.getTreeShareUrl=getTreeShareUrl;function getUrl(r){var e,t,n,i;let o=r.toShare?getShareUrl():getBaseUrl(),s=(e=r.mode)!==null&&e!==void 0?e:getOption("mode"),a=(t=r.workspace)!==null&&t!==void 0?t:getOption("workspace"),l=s==="single-document"?"doc":"lab";o=url_1.URLExt.join(o,l),a!==PageConfig.defaultWorkspace&&(o=url_1.URLExt.join(o,"workspaces",encodeURIComponent((n=getOption("workspace"))!==null&&n!==void 0?n:PageConfig.defaultWorkspace)));let u=(i=r.treePath)!==null&&i!==void 0?i:getOption("treePath");return u&&(o=url_1.URLExt.join(o,"tree",url_1.URLExt.encodeParts(u))),o}PageConfig.getUrl=getUrl,PageConfig.defaultWorkspace="default";function getWsUrl(r){let e=getOption("wsUrl");if(!e){if(r=r?url_1.URLExt.normalize(r):getBaseUrl(),r.indexOf("http")!==0)return"";e="ws"+r.slice(4)}return url_1.URLExt.normalize(e)}PageConfig.getWsUrl=getWsUrl;function getNBConvertURL({path:r,format:e,download:t}){let n=url_1.URLExt.encodeParts(r),i=url_1.URLExt.join(getBaseUrl(),"nbconvert",e,n);return t?i+"?download=true":i}PageConfig.getNBConvertURL=getNBConvertURL;function getToken(){return getOption("token")||getBodyData("jupyterApiToken")}PageConfig.getToken=getToken;function getNotebookVersion(){let r=getOption("notebookVersion");return r===""?[0,0,0]:JSON.parse(r)}PageConfig.getNotebookVersion=getNotebookVersion;let configData=null;function getBodyData(r){if(typeof document=="undefined"||!document.body)return"";let e=document.body.dataset[r];return typeof e=="undefined"?"":decodeURIComponent(e)}let Extension;(function(r){function e(i){try{let o=getOption(i);if(o)return JSON.parse(o)}catch(o){console.warn(`Unable to parse ${i}.`,o)}return[]}r.deferred=e("deferredExtensions"),r.disabled=e("disabledExtensions");function t(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.deferred.some(a=>a===i||s&&a===s)}r.isDeferred=t;function n(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.disabled.some(a=>a===i||s&&a===s)}r.isDisabled=n})(Extension=PageConfig.Extension||(PageConfig.Extension={}))})(PageConfig||(exports.PageConfig=PageConfig={}))});var XY=re(c1=>{"use strict";p();Object.defineProperty(c1,"__esModule",{value:!0});c1.PathExt=void 0;var Lf=s1(),QY;(function(r){function e(...d){let f=Lf.posix.join(...d);return f==="."?"":c(f)}r.join=e;function t(...d){let f=Lf.posix.join(...d);return f==="."?"":f}r.joinWithLeadingSlash=t;function n(d,f){return Lf.posix.basename(d,f)}r.basename=n;function i(d){let f=c(Lf.posix.dirname(d));return f==="."?"":f}r.dirname=i;function o(d){return Lf.posix.extname(d)}r.extname=o;function s(d){return d===""?"":c(Lf.posix.normalize(d))}r.normalize=s;function a(...d){return c(Lf.posix.resolve(...d))}r.resolve=a;function l(d,f){return c(Lf.posix.relative(d,f))}r.relative=l;function u(d){return d.length>0&&d.indexOf(".")!==0&&(d=`.${d}`),d}r.normalizeExtension=u;function c(d){return d.indexOf("/")===0&&(d=d.slice(1)),d}r.removeSlash=c})(QY||(c1.PathExt=QY={}))});var ZY=re(u1=>{"use strict";p();Object.defineProperty(u1,"__esModule",{value:!0});u1.signalToPromise=void 0;var Nve=t1();function Rve(r,e){let t=new Nve.PromiseDelegate;function n(){r.disconnect(i)}function i(o,s){n(),t.resolve([o,s])}return r.connect(i),(e!=null?e:0)>0&&setTimeout(()=>{n(),t.reject(`Signal not emitted within ${e} ms.`)},e),t.promise}u1.signalToPromise=Rve});var t$=re(d1=>{"use strict";p();Object.defineProperty(d1,"__esModule",{value:!0});d1.Text=void 0;var e$;(function(r){let e=2>1;function t(s,a){if(e)return s;let l=s;for(let u=0;u+1<a.length&&u<s;u++){let c=a.charCodeAt(u);if(c>=55296&&c<=56319){let d=a.charCodeAt(u+1);d>=56320&&d<=57343&&(l--,u++)}}return l}r.jsIndexToCharIndex=t;function n(s,a){if(e)return s;let l=s;for(let u=0;u+1<a.length&&u<l;u++){let c=a.charCodeAt(u);if(c>=55296&&c<=56319){let d=a.charCodeAt(u+1);d>=56320&&d<=57343&&(l++,u++)}}return l}r.charIndexToJsIndex=n;function i(s,a=!1){return s.replace(/^(\w)|[\s-_:]+(\w)/g,function(l,u,c){return c?c.toUpperCase():a?u.toUpperCase():u.toLowerCase()})}r.camelCase=i;function o(s){return(s||"").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}r.titleCase=o})(e$||(d1.Text=e$={}))});var n$=re(p1=>{"use strict";p();Object.defineProperty(p1,"__esModule",{value:!0});p1.Time=void 0;var Ave=[{name:"years",milliseconds:365*24*60*60*1e3},{name:"months",milliseconds:30*24*60*60*1e3},{name:"days",milliseconds:24*60*60*1e3},{name:"hours",milliseconds:60*60*1e3},{name:"minutes",milliseconds:60*1e3},{name:"seconds",milliseconds:1e3}],r$;(function(r){function e(n,i="long"){let o=document.documentElement.lang||"en",s=new Intl.RelativeTimeFormat(o,{numeric:"auto",style:i}),a=new Date(n).getTime()-Date.now();for(let l of Ave){let u=Math.ceil(a/l.milliseconds);if(u!==0)return s.format(u,l.name)}return s.format(0,"seconds")}r.formatHuman=e;function t(n){let i=document.documentElement.lang||"en";return new Intl.DateTimeFormat(i,{dateStyle:"short",timeStyle:"short"}).format(new Date(n))}r.format=t})(r$||(p1.Time=r$={}))});var ro=re(to=>{"use strict";p();var Mve=to&&to.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Hc=to&&to.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Mve(e,r,t)};Object.defineProperty(to,"__esModule",{value:!0});Hc(wY(),to);Hc(PY(),to);Hc(DY(),to);Hc(kY(),to);Hc(zY(),to);Hc(XY(),to);Hc(ZY(),to);Hc(t$(),to);Hc(n$(),to);Hc($2(),to)});var hS=re(xt=>{"use strict";p();Object.defineProperty(xt,"__esModule",{value:!0});xt.supportedKernelWebSocketProtocols=xt.isInputReplyMsg=xt.isInputRequestMsg=xt.isDebugReplyMsg=xt.isDebugRequestMsg=xt.isExecuteReplyMsg=xt.isInfoRequestMsg=xt.isCommMsgMsg=xt.isCommCloseMsg=xt.isCommOpenMsg=xt.isDebugEventMsg=xt.isClearOutputMsg=xt.isStatusMsg=xt.isErrorMsg=xt.isExecuteResultMsg=xt.isExecuteInputMsg=xt.isUpdateDisplayDataMsg=xt.isDisplayDataMsg=xt.isStreamMsg=xt.createMessage=void 0;var Ove=Wc();function Lve(r){var e,t,n,i,o;return{buffers:(e=r.buffers)!==null&&e!==void 0?e:[],channel:r.channel,content:r.content,header:{date:new Date().toISOString(),msg_id:(t=r.msgId)!==null&&t!==void 0?t:Ove.UUID.uuid4(),msg_type:r.msgType,session:r.session,username:(n=r.username)!==null&&n!==void 0?n:"",version:"5.2"},metadata:(i=r.metadata)!==null&&i!==void 0?i:{},parent_header:(o=r.parentHeader)!==null&&o!==void 0?o:{}}}xt.createMessage=Lve;function Kve(r){return r.header.msg_type==="stream"}xt.isStreamMsg=Kve;function Fve(r){return r.header.msg_type==="display_data"}xt.isDisplayDataMsg=Fve;function Uve(r){return r.header.msg_type==="update_display_data"}xt.isUpdateDisplayDataMsg=Uve;function Wve(r){return r.header.msg_type==="execute_input"}xt.isExecuteInputMsg=Wve;function Vve(r){return r.header.msg_type==="execute_result"}xt.isExecuteResultMsg=Vve;function jve(r){return r.header.msg_type==="error"}xt.isErrorMsg=jve;function Bve(r){return r.header.msg_type==="status"}xt.isStatusMsg=Bve;function Hve(r){return r.header.msg_type==="clear_output"}xt.isClearOutputMsg=Hve;function qve(r){return r.header.msg_type==="debug_event"}xt.isDebugEventMsg=qve;function Jve(r){return r.header.msg_type==="comm_open"}xt.isCommOpenMsg=Jve;function Gve(r){return r.header.msg_type==="comm_close"}xt.isCommCloseMsg=Gve;function Yve(r){return r.header.msg_type==="comm_msg"}xt.isCommMsgMsg=Yve;function $ve(r){return r.header.msg_type==="kernel_info_request"}xt.isInfoRequestMsg=$ve;function zve(r){return r.header.msg_type==="execute_reply"}xt.isExecuteReplyMsg=zve;function Qve(r){return r.header.msg_type==="debug_request"}xt.isDebugRequestMsg=Qve;function Xve(r){return r.header.msg_type==="debug_reply"}xt.isDebugReplyMsg=Xve;function Zve(r){return r.header.msg_type==="input_request"}xt.isInputRequestMsg=Zve;function eye(r){return r.header.msg_type==="input_reply"}xt.isInputReplyMsg=eye;var i$;(function(r){r.v1KernelWebsocketJupyterOrg="v1.kernel.websocket.jupyter.org"})(i$||(xt.supportedKernelWebSocketProtocols=i$={}))});var z2=re(wa=>{"use strict";p();var tye=wa&&wa.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),rye=wa&&wa.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),nye=wa&&wa.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&tye(e,r,t);return rye(e,r),e};Object.defineProperty(wa,"__esModule",{value:!0});wa.deserialize=wa.serialize=void 0;var o$=nye(hS());function iye(r,e=""){switch(e){case o$.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg:return gS.serializeV1KernelWebsocketJupyterOrg(r);default:return gS.serializeDefault(r)}}wa.serialize=iye;function oye(r,e=""){switch(e){case o$.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg:return gS.deserializeV1KernelWebsocketJupyterOrg(r);default:return gS.deserializeDefault(r)}}wa.deserialize=oye;var gS;(function(r){function e(a){let l,u=new DataView(a),c=Number(u.getBigUint64(0,!0)),d=[];for(let D=0;D<c;D++)d.push(Number(u.getBigUint64(8*(D+1),!0)));let f=new TextDecoder("utf8"),m=f.decode(a.slice(d[0],d[1])),g=JSON.parse(f.decode(a.slice(d[1],d[2]))),b=JSON.parse(f.decode(a.slice(d[2],d[3]))),y=JSON.parse(f.decode(a.slice(d[3],d[4]))),P=JSON.parse(f.decode(a.slice(d[4],d[5]))),A=[];for(let D=5;D<d.length-1;D++)A.push(new DataView(a.slice(d[D],d[D+1])));return l={channel:m,header:g,parent_header:b,metadata:y,content:P,buffers:A},l}r.deserializeV1KernelWebsocketJupyterOrg=e;function t(a){let l=JSON.stringify(a.header),u=a.parent_header==null?"{}":JSON.stringify(a.parent_header),c=JSON.stringify(a.metadata),d=JSON.stringify(a.content),f=a.buffers!==void 0?a.buffers:[],m=1+4+f.length+1,g=[];g.push(8*(1+m)),g.push(a.channel.length+g[g.length-1]);let b=new TextEncoder,y=b.encode(a.channel),P=b.encode(l),A=b.encode(u),D=b.encode(c),T=b.encode(d),K=new Uint8Array(y.length+P.length+A.length+D.length+T.length);K.set(y),K.set(P,y.length),K.set(A,y.length+P.length),K.set(D,y.length+P.length+A.length),K.set(T,y.length+P.length+A.length+D.length);for(let h of[P.length,A.length,D.length,T.length])g.push(h+g[g.length-1]);let L=0;for(let h of f){let v=h.byteLength;g.push(v+g[g.length-1]),L+=v}let B=new Uint8Array(8*(1+m)+K.byteLength+L),N=new ArrayBuffer(8),O=new DataView(N);O.setBigUint64(0,BigInt(m),!0),B.set(new Uint8Array(N),0);for(let h=0;h<g.length;h++)O.setBigUint64(0,BigInt(g[h]),!0),B.set(new Uint8Array(N),8*(h+1));B.set(K,g[0]);for(let h=0;h<f.length;h++){let v=f[h];B.set(new Uint8Array(ArrayBuffer.isView(v)?v.buffer:v),g[5+h])}return B.buffer}r.serializeV1KernelWebsocketJupyterOrg=t;function n(a){let l;return typeof a=="string"?l=JSON.parse(a):l=o(a),l}r.deserializeDefault=n;function i(a){var l;let u;return!((l=a.buffers)===null||l===void 0)&&l.length?u=s(a):u=JSON.stringify(a),u}r.serializeDefault=i;function o(a){let l=new DataView(a),u=l.getUint32(0),c=[];if(u<2)throw new Error("Invalid incoming Kernel Message");for(let m=1;m<=u;m++)c.push(l.getUint32(m*4));let d=new Uint8Array(a.slice(c[0],c[1])),f=JSON.parse(new TextDecoder("utf8").decode(d));f.buffers=[];for(let m=1;m<u;m++){let g=c[m],b=c[m+1]||a.byteLength;f.buffers.push(new DataView(a.slice(g,b)))}return f}function s(a){let l=[],u=[],c=new TextEncoder,d=[];a.buffers!==void 0&&(d=a.buffers,delete a.buffers);let f=c.encode(JSON.stringify(a));u.push(f.buffer);for(let y=0;y<d.length;y++){let P=d[y];u.push(ArrayBuffer.isView(P)?P.buffer:P)}let m=u.length;l.push(4*(m+1));for(let y=0;y+1<u.length;y++)l.push(l[l.length-1]+u[y].byteLength);let g=new Uint8Array(l[l.length-1]+u[u.length-1].byteLength),b=new DataView(g.buffer);b.setUint32(0,m);for(let y=0;y<l.length;y++)b.setUint32(4*(y+1),l[y]);for(let y=0;y<u.length;y++)g.set(new Uint8Array(u[y]),l[y]);return g.buffer}})(gS||(gS={}))});var s$=re(Q2=>{"use strict";p();Object.defineProperty(Q2,"__esModule",{value:!0});Q2.default=WebSocket});var Do=re(m1=>{"use strict";p();Object.defineProperty(m1,"__esModule",{value:!0});m1.ServerConnection=void 0;var Kf=ro(),a$=z2(),X2;typeof window=="undefined"?X2=s$():X2=WebSocket;var Z2;(function(r){function e(o){return f1.makeSettings(o)}r.makeSettings=e;function t(o,s,a){return f1.handleRequest(o,s,a)}r.makeRequest=t;class n extends Error{static async create(s){try{let a=await s.json(),{message:l,traceback:u}=a;return u&&console.error(u),new n(s,l!=null?l:n._defaultMessage(s),u!=null?u:"")}catch(a){return console.debug(a),new n(s)}}constructor(s,a=n._defaultMessage(s),l=""){super(a),this.response=s,this.traceback=l}static _defaultMessage(s){return`Invalid response: ${s.status} ${s.statusText}`}}r.ResponseError=n;class i extends TypeError{constructor(s){super(s.message),this.stack=s.stack}}r.NetworkError=i})(Z2||(m1.ServerConnection=Z2={}));var f1;(function(r){function e(i={}){var o;let s=Kf.PageConfig.getBaseUrl(),a=Kf.PageConfig.getWsUrl(),l=Kf.URLExt.normalize(i.baseUrl)||s,u=i.wsUrl;!u&&l===s&&(u=a),!u&&l.indexOf("http")===0&&(u="ws"+l.slice(4)),u=u!=null?u:a;let c=Kf.PageConfig.getOption("appendToken").toLowerCase(),d;return c===""?d=typeof window=="undefined"||typeof process!="undefined"&&((o=process===null||process===void 0?void 0:process.env)===null||o===void 0?void 0:o.JEST_WORKER_ID)!==void 0||Kf.URLExt.getHostName(s)!==Kf.URLExt.getHostName(u):d=c==="true",{init:{cache:"no-store",credentials:"same-origin"},fetch,Headers,Request,WebSocket:X2,token:Kf.PageConfig.getToken(),appUrl:Kf.PageConfig.getOption("appUrl"),appendToken:d,serializer:{serialize:a$.serialize,deserialize:a$.deserialize},...i,baseUrl:l,wsUrl:u}}r.makeSettings=e;function t(i,o,s){var a;if(i.indexOf(s.baseUrl)!==0)throw new Error("Can only be used for notebook server requests");((a=o.cache)!==null&&a!==void 0?a:s.init.cache)==="no-store"&&(i+=(/\?/.test(i)?"&":"?")+new Date().getTime());let u=new s.Request(i,{...s.init,...o}),c=!1;if(s.token&&(c=!0,u.headers.append("Authorization",`token ${s.token}`)),typeof document!="undefined"){let d=n("_xsrf");d!==void 0&&(c=!0,u.headers.append("X-XSRFToken",d))}return!u.headers.has("Content-Type")&&c&&u.headers.set("Content-Type","application/json"),s.fetch.call(null,u).catch(d=>{throw new Z2.NetworkError(d)})}r.handleRequest=t;function n(i){let o="";try{o=document.cookie}catch(a){return}let s=o.match("\\b"+i+"=([^;]*)\\b");return s==null?void 0:s[1]}})(f1||(f1={}))});var Og=re(h1=>{"use strict";p();Object.defineProperty(h1,"__esModule",{value:!0});h1.BaseManager=void 0;var l$=Rs(),sye=Do(),eV=class{constructor(e){var t;this._isDisposed=!1,this._disposed=new l$.Signal(this),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:sye.ServerConnection.makeSettings()}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}get isActive(){return!0}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(void 0),l$.Signal.clearData(this))}};h1.BaseManager=eV});var u$=re(vS=>{"use strict";p();Object.defineProperty(vS,"__esModule",{value:!0});vS.ConfigWithDefaults=vS.ConfigSection=void 0;var aye=ro(),Ex=ri(),lye="api/config",c$;(function(r){function e(t){let n=new tV(t);return n.load().then(()=>n)}r.create=e})(c$||(vS.ConfigSection=c$={}));var tV=class{constructor(e){var t;this._url="unknown";let n=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Ex.ServerConnection.makeSettings();this._url=aye.URLExt.join(n.baseUrl,lye,encodeURIComponent(e.name))}get data(){return this._data}async load(){let e=await Ex.ServerConnection.makeRequest(this._url,{},this.serverSettings);if(e.status!==200)throw await Ex.ServerConnection.ResponseError.create(e);this._data=await e.json()}async update(e){this._data={...this._data,...e};let t={method:"PATCH",body:JSON.stringify(e)},n=await Ex.ServerConnection.makeRequest(this._url,t,this.serverSettings);if(n.status!==200)throw await Ex.ServerConnection.ResponseError.create(n);return this._data=await n.json(),this._data}},rV=class{constructor(e){var t,n;this._className="",this._section=e.section,this._defaults=(t=e.defaults)!==null&&t!==void 0?t:{},this._className=(n=e.className)!==null&&n!==void 0?n:""}get(e){let t=this._classData();return e in t?t[e]:this._defaults[e]}set(e,t){let n={};if(n[e]=t,this._className){let i={};return i[this._className]=n,this._section.update(i)}else return this._section.update(n)}_classData(){let e=this._section.data;return this._className&&this._className in e?e[this._className]:e}};vS.ConfigWithDefaults=rV});var Cx=re(g1=>{"use strict";p();Object.defineProperty(g1,"__esModule",{value:!0});g1.validateProperty=void 0;function cye(r,e,t,n=[]){if(!r.hasOwnProperty(e))throw Error(`Missing property '${e}'`);let i=r[e];if(t!==void 0){let o=!0;switch(t){case"array":o=Array.isArray(i);break;case"object":o=typeof i!="undefined";break;default:o=typeof i===t}if(!o)throw new Error(`Property '${e}' is not of type '${t}'`);if(n.length>0){let s=!0;switch(t){case"string":case"number":case"boolean":s=n.includes(i);break;default:s=n.findIndex(a=>a===i)>=0;break}if(!s)throw new Error(`Property '${e}' is not one of the valid values ${JSON.stringify(n)}`)}}}g1.validateProperty=cye});var d$=re(yS=>{"use strict";p();Object.defineProperty(yS,"__esModule",{value:!0});yS.validateCheckpointModel=yS.validateContentsModel=void 0;var qc=Cx();function uye(r){(0,qc.validateProperty)(r,"name","string"),(0,qc.validateProperty)(r,"path","string"),(0,qc.validateProperty)(r,"type","string"),(0,qc.validateProperty)(r,"created","string"),(0,qc.validateProperty)(r,"last_modified","string"),(0,qc.validateProperty)(r,"mimetype","object"),(0,qc.validateProperty)(r,"content","object"),(0,qc.validateProperty)(r,"format","object")}yS.validateContentsModel=uye;function dye(r){(0,qc.validateProperty)(r,"id","string"),(0,qc.validateProperty)(r,"last_modified","string")}yS.validateCheckpointModel=dye});var oV=re(is=>{"use strict";p();var pye=is&&is.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),fye=is&&is.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),mye=is&&is.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&pye(e,r,t);return fye(e,r),e};Object.defineProperty(is,"__esModule",{value:!0});is.Drive=is.ContentsManager=is.Contents=void 0;var As=ro(),v1=Rs(),bn=ri(),Rd=mye(d$()),hye="api/contents",gye="files",p$;(function(r){function e(n){Rd.validateContentsModel(n)}r.validateContentsModel=e;function t(n){Rd.validateCheckpointModel(n)}r.validateCheckpointModel=t})(p$||(is.Contents=p$={}));var nV=class{constructor(e={}){var t,n;this._isDisposed=!1,this._additionalDrives=new Map,this._fileChanged=new v1.Signal(this);let i=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:bn.ServerConnection.makeSettings();this._defaultDrive=(n=e.defaultDrive)!==null&&n!==void 0?n:new y1({serverSettings:i}),this._defaultDrive.fileChanged.connect(this._onFileChanged,this)}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,v1.Signal.clearData(this))}addDrive(e){this._additionalDrives.set(e.name,e),e.fileChanged.connect(this._onFileChanged,this)}getSharedModelFactory(e){var t;let[n]=this._driveForPath(e);return(t=n==null?void 0:n.sharedModelFactory)!==null&&t!==void 0?t:null}localPath(e){let t=e.split("/"),n=t[0].split(":");return n.length===1||!this._additionalDrives.has(n[0])?As.PathExt.removeSlash(e):As.PathExt.join(n.slice(1).join(":"),...t.slice(1))}normalize(e){let t=e.split(":");return t.length===1?As.PathExt.normalize(e):`${t[0]}:${As.PathExt.normalize(t.slice(1).join(":"))}`}resolvePath(e,t){let n=this.driveName(e),i=this.localPath(e),o=As.PathExt.resolve("/",i,t);return n?`${n}:${o}`:o}driveName(e){let n=e.split("/")[0].split(":");return n.length===1?"":this._additionalDrives.has(n[0])?n[0]:""}get(e,t){let[n,i]=this._driveForPath(e);return n.get(i,t).then(o=>{let s=[];if(o.type==="directory"&&o.content){for(let a of o.content)s.push({...a,path:this._toGlobalPath(n,a.path)});return{...o,path:this._toGlobalPath(n,i),content:s,serverPath:o.path}}else return{...o,path:this._toGlobalPath(n,i),serverPath:o.path}})}getDownloadUrl(e){let[t,n]=this._driveForPath(e);return t.getDownloadUrl(n)}newUntitled(e={}){if(e.path){let t=this.normalize(e.path),[n,i]=this._driveForPath(t);return n.newUntitled({...e,path:i}).then(o=>({...o,path:As.PathExt.join(t,o.name),serverPath:o.path}))}else return this._defaultDrive.newUntitled(e)}delete(e){let[t,n]=this._driveForPath(e);return t.delete(n)}rename(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n!==o)throw Error("ContentsManager: renaming files must occur within a Drive");return n.rename(i,s).then(a=>({...a,path:this._toGlobalPath(n,s),serverPath:a.path}))}save(e,t={}){let n=this.normalize(e),[i,o]=this._driveForPath(e);return i.save(o,{...t,path:o}).then(s=>({...s,path:n,serverPath:s.path}))}copy(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n===o)return n.copy(i,s).then(a=>({...a,path:this._toGlobalPath(n,a.path),serverPath:a.path}));throw Error("Copying files between drives is not currently implemented")}createCheckpoint(e){let[t,n]=this._driveForPath(e);return t.createCheckpoint(n)}listCheckpoints(e){let[t,n]=this._driveForPath(e);return t.listCheckpoints(n)}restoreCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.restoreCheckpoint(i,t)}deleteCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.deleteCheckpoint(i,t)}_toGlobalPath(e,t){return e===this._defaultDrive?As.PathExt.removeSlash(t):`${e.name}:${As.PathExt.removeSlash(t)}`}_driveForPath(e){let t=this.driveName(e),n=this.localPath(e);return t?[this._additionalDrives.get(t),n]:[this._defaultDrive,n]}_onFileChanged(e,t){var n,i;if(e===this._defaultDrive)this._fileChanged.emit(t);else{let o=null,s=null;!((n=t.newValue)===null||n===void 0)&&n.path&&(o={...t.newValue,path:this._toGlobalPath(e,t.newValue.path)}),!((i=t.oldValue)===null||i===void 0)&&i.path&&(s={...t.oldValue,path:this._toGlobalPath(e,t.oldValue.path)}),this._fileChanged.emit({type:t.type,newValue:o,oldValue:s})}}};is.ContentsManager=nV;var y1=class{constructor(e={}){var t,n,i;this._isDisposed=!1,this._fileChanged=new v1.Signal(this),this.name=(t=e.name)!==null&&t!==void 0?t:"Default",this._apiEndpoint=(n=e.apiEndpoint)!==null&&n!==void 0?n:hye,this.serverSettings=(i=e.serverSettings)!==null&&i!==void 0?i:bn.ServerConnection.makeSettings()}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,v1.Signal.clearData(this))}async get(e,t){let n=this._getUrl(e);if(t){t.type==="notebook"&&delete t.format;let a=t.content?"1":"0",l=t.hash?"1":"0",u={...t,content:a,hash:l};n+=As.URLExt.objectToQueryString(u)}let i=this.serverSettings,o=await bn.ServerConnection.makeRequest(n,{},i);if(o.status!==200)throw await bn.ServerConnection.ResponseError.create(o);let s=await o.json();return Rd.validateContentsModel(s),s}getDownloadUrl(e){let t=this.serverSettings.baseUrl,n=As.URLExt.join(t,gye,As.URLExt.encodeParts(e)),i="";try{i=document.cookie}catch(s){}let o=i.match("\\b_xsrf=([^;]*)\\b");if(o){let s=new URL(n);s.searchParams.append("_xsrf",o[1]),n=s.toString()}return Promise.resolve(n)}async newUntitled(e={}){var t;let n="{}";e&&(e.ext&&(e.ext=iV.normalizeExtension(e.ext)),n=JSON.stringify(e));let i=this.serverSettings,o=this._getUrl((t=e.path)!==null&&t!==void 0?t:""),s={method:"POST",body:n},a=await bn.ServerConnection.makeRequest(o,s,i);if(a.status!==201)throw await bn.ServerConnection.ResponseError.create(a);let l=await a.json();return Rd.validateContentsModel(l),this._fileChanged.emit({type:"new",oldValue:null,newValue:l}),l}async delete(e){let t=this._getUrl(e),n=this.serverSettings,i={method:"DELETE"},o=await bn.ServerConnection.makeRequest(t,i,n);if(o.status!==204)throw await bn.ServerConnection.ResponseError.create(o);this._fileChanged.emit({type:"delete",oldValue:{path:e},newValue:null})}async rename(e,t){let n=this.serverSettings,i=this._getUrl(e),o={method:"PATCH",body:JSON.stringify({path:t})},s=await bn.ServerConnection.makeRequest(i,o,n);if(s.status!==200)throw await bn.ServerConnection.ResponseError.create(s);let a=await s.json();return Rd.validateContentsModel(a),this._fileChanged.emit({type:"rename",oldValue:{path:e},newValue:a}),a}async save(e,t={}){let n=this.serverSettings,i=this._getUrl(e),o={method:"PUT",body:JSON.stringify(t)},s=await bn.ServerConnection.makeRequest(i,o,n);if(s.status!==200&&s.status!==201)throw await bn.ServerConnection.ResponseError.create(s);let a=await s.json();return Rd.validateContentsModel(a),this._fileChanged.emit({type:"save",oldValue:null,newValue:a}),a}async copy(e,t){let n=this.serverSettings,i=this._getUrl(t),o={method:"POST",body:JSON.stringify({copy_from:e})},s=await bn.ServerConnection.makeRequest(i,o,n);if(s.status!==201)throw await bn.ServerConnection.ResponseError.create(s);let a=await s.json();return Rd.validateContentsModel(a),this._fileChanged.emit({type:"new",oldValue:null,newValue:a}),a}async createCheckpoint(e){let t=this._getUrl(e,"checkpoints"),n={method:"POST"},i=await bn.ServerConnection.makeRequest(t,n,this.serverSettings);if(i.status!==201)throw await bn.ServerConnection.ResponseError.create(i);let o=await i.json();return Rd.validateCheckpointModel(o),o}async listCheckpoints(e){let t=this._getUrl(e,"checkpoints"),n=await bn.ServerConnection.makeRequest(t,{},this.serverSettings);if(n.status!==200)throw await bn.ServerConnection.ResponseError.create(n);let i=await n.json();if(!Array.isArray(i))throw new Error("Invalid Checkpoint list");for(let o=0;o<i.length;o++)Rd.validateCheckpointModel(i[o]);return i}async restoreCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"POST"},o=await bn.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await bn.ServerConnection.ResponseError.create(o)}async deleteCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"DELETE"},o=await bn.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await bn.ServerConnection.ResponseError.create(o)}_getUrl(...e){let t=e.map(i=>As.URLExt.encodeParts(i)),n=this.serverSettings.baseUrl;return As.URLExt.join(n,this._apiEndpoint,...t)}};is.Drive=y1;var iV;(function(r){function e(t){return t.length>0&&t.indexOf(".")!==0&&(t=`.${t}`),t}r.normalizeExtension=e})(iV||(iV={}))});var sV=re((b1,f$)=>{p();(function(r,e){typeof b1=="object"&&typeof f$!="undefined"?e(b1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(b1,function(r){"use strict";r.ArrayExt=void 0,function(h){function v(R,M,S=0,I=-1){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(S+j)%_;if(R[me]===M)return me}return-1}h.firstIndexOf=v;function C(R,M,S=-1,I=0){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(S-j+_)%_;if(R[me]===M)return me}return-1}h.lastIndexOf=C;function k(R,M,S=0,I=-1){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(S+j)%_;if(M(R[me],me))return me}return-1}h.findFirstIndex=k;function H(R,M,S=-1,I=0){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(S-j+_)%_;if(M(R[me],me))return me}return-1}h.findLastIndex=H;function Y(R,M,S=0,I=-1){let _=k(R,M,S,I);return _!==-1?R[_]:void 0}h.findFirstValue=Y;function Z(R,M,S=-1,I=0){let _=H(R,M,S,I);return _!==-1?R[_]:void 0}h.findLastValue=Z;function ie(R,M,S,I=0,_=-1){let F=R.length;if(F===0)return 0;I<0?I=Math.max(0,I+F):I=Math.min(I,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=I,me=_-I+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;S(R[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function ce(R,M,S,I=0,_=-1){let F=R.length;if(F===0)return 0;I<0?I=Math.max(0,I+F):I=Math.min(I,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=I,me=_-I+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;S(R[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=ce;function be(R,M,S){if(R===M)return!0;if(R.length!==M.length)return!1;for(let I=0,_=R.length;I<_;++I)if(S?!S(R[I],M[I]):R[I]!==M[I])return!1;return!0}h.shallowEqual=be;function q(R,M={}){let{start:S,stop:I,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=R.length;S===void 0?S=_<0?F-1:0:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F),I===void 0?I=_<0?-1:F:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F);let j;_<0&&I>=S||_>0&&S>=I?j=0:_<0?j=Math.floor((I-S+1)/_+1):j=Math.floor((I-S-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=R[S+Fe*_];return me}h.slice=q;function $(R,M,S){let I=R.length;if(I<=1||(M<0?M=Math.max(0,M+I):M=Math.min(M,I-1),S<0?S=Math.max(0,S+I):S=Math.min(S,I-1),M===S))return;let _=R[M],F=M<S?1:-1;for(let j=M;j!==S;j+=F)R[j]=R[j+F];R[S]=_}h.move=$;function de(R,M=0,S=-1){let I=R.length;if(!(I<=1))for(M<0?M=Math.max(0,M+I):M=Math.min(M,I-1),S<0?S=Math.max(0,S+I):S=Math.min(S,I-1);M<S;){let _=R[M],F=R[S];R[M++]=F,R[S--]=_}}h.reverse=de;function pe(R,M,S=0,I=-1){let _=R.length;if(_<=1||(S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S>=I))return;let F=I-S+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=S+M;de(R,S,j-1),de(R,j,I),de(R,S,I)}h.rotate=pe;function ye(R,M,S=0,I=-1){let _=R.length;if(_===0)return;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j)R[(S+j)%_]=M}h.fill=ye;function z(R,M,S){let I=R.length;M<0?M=Math.max(0,M+I):M=Math.min(M,I);for(let _=I;_>M;--_)R[_]=R[_-1];R[M]=S}h.insert=z;function fe(R,M){let S=R.length;if(M<0&&(M+=S),M<0||M>=S)return;let I=R[M];for(let _=M+1;_<S;++_)R[_-1]=R[_];return R.length=S-1,I}h.removeAt=fe;function Ie(R,M,S=0,I=-1){let _=v(R,M,S,I);return _!==-1&&fe(R,_),_}h.removeFirstOf=Ie;function Te(R,M,S=-1,I=0){let _=C(R,M,S,I);return _!==-1&&fe(R,_),_}h.removeLastOf=Te;function Le(R,M,S=0,I=-1){let _=R.length;if(_===0)return 0;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F=0;for(let j=0;j<_;++j)S<=I&&j>=S&&j<=I&&R[j]===M||I<S&&(j<=I||j>=S)&&R[j]===M?F++:F>0&&(R[j-F]=R[j]);return F>0&&(R.length=_-F),F}h.removeAllOf=Le;function $e(R,M,S=0,I=-1){let _,F=k(R,M,S,I);return F!==-1&&(_=fe(R,F)),{index:F,value:_}}h.removeFirstWhere=$e;function Ge(R,M,S=-1,I=0){let _,F=H(R,M,S,I);return F!==-1&&(_=fe(R,F)),{index:F,value:_}}h.removeLastWhere=Ge;function Bt(R,M,S=0,I=-1){let _=R.length;if(_===0)return 0;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F=0;for(let j=0;j<_;++j)S<=I&&j>=S&&j<=I&&M(R[j],j)||I<S&&(j<=I||j>=S)&&M(R[j],j)?F++:F>0&&(R[j-F]=R[j]);return F>0&&(R.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let v of h)yield*v}function*t(){}function*n(h,v=0){for(let C of h)yield[v++,C]}function*i(h,v){let C=0;for(let k of h)v(k,C++)&&(yield k)}function o(h,v){let C=0;for(let k of h)if(v(k,C++))return k}function s(h,v){let C=0;for(let k of h)if(v(k,C++))return C-1;return-1}function a(h,v){let C;for(let k of h){if(C===void 0){C=k;continue}v(k,C)<0&&(C=k)}return C}function l(h,v){let C;for(let k of h){if(C===void 0){C=k;continue}v(k,C)>0&&(C=k)}return C}function u(h,v){let C=!0,k,H;for(let Y of h)C?(k=Y,H=Y,C=!1):v(Y,k)<0?k=Y:v(Y,H)>0&&(H=Y);return C?void 0:[k,H]}function c(h){return Array.from(h)}function d(h){let v={};for(let[C,k]of h)v[C]=k;return v}function f(h,v){let C=0;for(let k of h)if(v(k,C++)===!1)return}function m(h,v){let C=0;for(let k of h)if(v(k,C++)===!1)return!1;return!0}function g(h,v){let C=0;for(let k of h)if(v(k,C++))return!0;return!1}function*b(h,v){let C=0;for(let k of h)yield v(k,C++)}function*y(h,v,C){v===void 0?(v=h,h=0,C=1):C===void 0&&(C=1);let k=P.rangeLength(h,v,C);for(let H=0;H<k;H++)yield h+C*H}var P;(function(h){function v(C,k,H){return H===0?1/0:C>k&&H>0||C<k&&H<0?0:Math.ceil((k-C)/H)}h.rangeLength=v})(P||(P={}));function A(h,v,C){let k=h[Symbol.iterator](),H=0,Y=k.next();if(Y.done&&C===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return C;let Z=k.next();if(Z.done&&C===void 0)return Y.value;if(Z.done)return v(C,Y.value,H++);let ie;C===void 0?ie=v(Y.value,Z.value,H++):ie=v(v(C,Y.value,H++),Z.value,H++);let ce;for(;!(ce=k.next()).done;)ie=v(ie,ce.value,H++);return ie}function*D(h,v){for(;0<v--;)yield h}function*T(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let v=h.length-1;v>-1;v--)yield h[v]}function L(h){let v=[],C=new Set,k=new Map;for(let Z of h)H(Z);for(let[Z]of k)Y(Z);return v;function H(Z){let[ie,ce]=Z,be=k.get(ce);be?be.push(ie):k.set(ce,[ie])}function Y(Z){if(C.has(Z))return;C.add(Z);let ie=k.get(Z);if(ie)for(let ce of ie)Y(ce);v.push(Z)}}function*B(h,v){let C=0;for(let k of h)C++%v===0&&(yield k)}r.StringExt=void 0,function(h){function v(Z,ie,ce=0){let be=new Array(ie.length);for(let q=0,$=ce,de=ie.length;q<de;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=v;function C(Z,ie,ce=0){let be=v(Z,ie,ce);if(!be)return null;let q=0;for(let $=0,de=be.length;$<de;++$){let pe=be[$]-ce;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=C;function k(Z,ie,ce=0){let be=v(Z,ie,ce);if(!be)return null;let q=0,$=ce-1;for(let de=0,pe=be.length;de<pe;++de){let ye=be[de];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=k;function H(Z,ie,ce){let be=[],q=0,$=0,de=ie.length;for(;q<de;){let pe=ie[q],ye=ie[q];for(;++q<de&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(ce(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,v){if(v<1)return;let C=h[Symbol.iterator](),k;for(;0<v--&&!(k=C.next()).done;)yield k.value}function*O(...h){let v=h.map(k=>k[Symbol.iterator]()),C=v.map(k=>k.next());for(;m(C,k=>!k.done);C=v.map(k=>k.next()))yield C.map(k=>k.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=T,r.range=y,r.reduce=A,r.repeat=D,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var aV=re((S1,m$)=>{p();(function(r,e){typeof S1=="object"&&typeof m$!="undefined"?e(S1,sV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(S1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"}u.isPrimitive=c;function d(D){return Array.isArray(D)}u.isArray=d;function f(D){return!c(D)&&!d(D)}u.isObject=f;function m(D,T){if(D===T)return!0;if(c(D)||c(T))return!1;let K=d(D),L=d(T);return K!==L?!1:K&&L?b(D,T):y(D,T)}u.deepEqual=m;function g(D){return c(D)?D:d(D)?P(D):A(D)}u.deepCopy=g;function b(D,T){if(D===T)return!0;if(D.length!==T.length)return!1;for(let K=0,L=D.length;K<L;++K)if(!m(D[K],T[K]))return!1;return!0}function y(D,T){if(D===T)return!0;for(let K in D)if(D[K]!==void 0&&!(K in T))return!1;for(let K in T)if(T[K]!==void 0&&!(K in D))return!1;for(let K in D){let L=D[K],B=T[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function P(D){let T=new Array(D.length);for(let K=0,L=D.length;K<L;++K)T[K]=g(D[K]);return T}function A(D){let T={};for(let K in D){let L=D[K];L!==void 0&&(T[K]=g(L))}return T}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(y=>{let P=this._services.get(y);return P?this._plugins.get(P).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(y){var P,A,D,T;this._activated=!1,this._promise=null,this._service=null,this.id=y.id,this.description=(P=y.description)!==null&&P!==void 0?P:"",this.activate=y.activate,this.deactivate=(A=y.deactivate)!==null&&A!==void 0?A:null,this.provides=(D=y.provides)!==null&&D!==void 0?D:null,this.autoStart=(T=y.autoStart)!==null&&T!==void 0?T:!1,this.requires=y.requires?y.requires.slice():[],this.optional=y.optional?y.optional.slice():[]}get activated(){return this._activated}set activated(y){this._activated=y}get service(){return this._service}set service(y){this._service=y}get promise(){return this._promise}set promise(y){this._promise=y}}function d(b){return new c(b)}u.createPluginData=d;function f(b,y,P){let A=[...b.requires,...b.optional],D=K=>{if(K===b.provides)return!0;let L=P.get(K);if(!L)return!1;let B=y.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(T.push(L),N.some(D)?!0:(T.pop(),!1))};if(!b.provides||A.length===0)return;let T=[b.id];if(A.some(D))throw new ReferenceError(`Cycle detected: ${T.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,y,P){let A=new Array,D=N=>{let O=y.get(N),h=[...O.requires,...O.optional];A.push(...h.reduce((v,C)=>{let k=P.get(C);return k&&v.push([N,k]),v},[]))};for(let N of y.keys())D(N);let T=A.filter(N=>N[1]===b),K=0;for(;T.length>K;){let N=T.length,O=new Set(T.map(h=>h[0]));for(let h of O)A.filter(v=>v[1]===h).forEach(v=>{T.includes(v)||T.push(v)});K=N}let L=e.topologicSort(T),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,y){let P=new Set;for(let A of b.keys())b.get(A).autoStart===!0&&P.add(A);if(y.startPlugins)for(let A of y.startPlugins)P.add(A);if(y.ignorePlugins)for(let A of y.ignorePlugins)P.delete(A);return Array.from(P)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var g$=re((I1,h$)=>{p();(function(r,e){typeof I1=="object"&&typeof h$!="undefined"?e(I1,sV(),aV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(I1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let v=g.get(N.sender);if(v||(v=[],g.set(N.sender,v)),A(v,N,O,h))return!1;let C=h||O,k=b.get(C);k||(k=[],b.set(C,k));let H={signal:N,slot:O,thisArg:h};return v.push(H),k.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let v=g.get(N.sender);if(!v||v.length===0)return!1;let C=A(v,N,O,h);if(!C)return!1;let k=h||O,H=b.get(k);return C.signal=null,T(v),T(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let v=b.get(O);if(!(!v||v.length===0)){for(let C of v)C.signal&&C.signal.sender===N&&(C.signal=null);T(h),T(v)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let v=h.thisArg||h.slot;h.signal=null,T(b.get(v))}T(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let v=h.signal.sender;h.signal=null,T(g.get(v))}T(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let v=0,C=h.length;v<C;++v){let k=h[v];k.signal===N&&D(k,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,y=new Set,P=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function A(N,O,h,v){return e.find(N,C=>C.signal===O&&C.slot===h&&C.thisArg===v)}function D(N,O){let{signal:h,slot:v,thisArg:C}=N;try{v.call(C,h.sender,O)}catch(k){s.exceptionHandler(k)}}function T(N){y.size===0&&P(K),y.add(N)}function K(){y.forEach(L),y.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var Lg=re((_1,v$)=>{p();(function(r,e){typeof _1=="object"&&typeof v$!="undefined"?e(_1,aV(),g$()):typeof define=="function"&&define.amd?define(["exports","@lumino/coreutils","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_polling={},r.lumino_coreutils,r.lumino_signaling))})(_1,function(r,e,t){"use strict";class n{constructor(u){var c;this._disposed=new t.Signal(this),this._lingered=0,this._tick=new e.PromiseDelegate,this._ticked=new t.Signal(this),this._factory=u.factory,this._linger=(c=u.linger)!==null&&c!==void 0?c:i.DEFAULT_LINGER,this._standby=u.standby||i.DEFAULT_STANDBY,this._state={...i.DEFAULT_STATE,timestamp:new Date().getTime()};let d=u.frequency||{},f=Math.max(d.interval||0,d.max||0,i.DEFAULT_FREQUENCY.max);this.frequency={...i.DEFAULT_FREQUENCY,...d,max:f},this.name=u.name||i.DEFAULT_NAME,(!("auto"in u)||u.auto)&&setTimeout(()=>this.start())}get disposed(){return this._disposed}get frequency(){return this._frequency}set frequency(u){if(this.isDisposed||e.JSONExt.deepEqual(u,this.frequency||{}))return;let{backoff:c,interval:d,max:f}=u;if(d=Math.round(d),f=Math.round(f),typeof c=="number"&&c<1)throw new Error("Poll backoff growth factor must be at least 1");if((d<0||d>f)&&d!==n.NEVER)throw new Error("Poll interval must be between 0 and max");if(f>n.MAX_INTERVAL&&f!==n.NEVER)throw new Error(`Max interval must be less than ${n.MAX_INTERVAL}`);this._frequency={backoff:c,interval:d,max:f}}get isDisposed(){return this.state.phase==="disposed"}get standby(){return this._standby}set standby(u){this.isDisposed||this.standby===u||(this._standby=u)}get state(){return this._state}get tick(){return this._tick.promise}get ticked(){return this._ticked}async*[Symbol.asyncIterator](){for(;!this.isDisposed;)yield this.state,await this.tick.catch(()=>{})}dispose(){this.isDisposed||(this._state={...i.DISPOSED_STATE,timestamp:new Date().getTime()},this._tick.promise.catch(u=>{}),this._tick.reject(new Error(`Poll (${this.name}) is disposed.`)),this._disposed.emit(void 0),t.Signal.clearData(this))}refresh(){return this.schedule({cancel:({phase:u})=>u==="refreshed",interval:n.IMMEDIATE,phase:"refreshed"})}async schedule(u={}){if(this.isDisposed||u.cancel&&u.cancel(this.state))return;let c=this._tick,d=new e.PromiseDelegate,f={interval:this.frequency.interval,payload:null,phase:"standby",timestamp:new Date().getTime(),...u};if(this._state=f,this._tick=d,clearTimeout(this._timeout),this._ticked.emit(this.state),c.resolve(this),await c.promise,f.interval===n.NEVER){this._timeout=void 0;return}let m=()=>{this.isDisposed||this.tick!==d.promise||this._execute()};this._timeout=setTimeout(m,f.interval)}start(){return this.schedule({cancel:({phase:u})=>u!=="constructed"&&u!=="standby"&&u!=="stopped",interval:n.IMMEDIATE,phase:"started"})}stop(){return this.schedule({cancel:({phase:u})=>u==="stopped",interval:n.NEVER,phase:"stopped"})}get hidden(){return i.hidden}_execute(){let u=typeof this.standby=="function"?this.standby():this.standby;if(u==="never"?u=!1:u==="when-hidden"&&(this.hidden?u=++this._lingered>this._linger:(this._lingered=0,u=!1)),u){this.schedule();return}let c=this.tick;this._factory(this.state).then(d=>{this.isDisposed||this.tick!==c||this.schedule({payload:d,phase:this.state.phase==="rejected"?"reconnected":"resolved"})}).catch(d=>{this.isDisposed||this.tick!==c||this.schedule({interval:i.sleep(this.frequency,this.state),payload:d,phase:"rejected"})})}}(function(l){l.IMMEDIATE=0,l.MAX_INTERVAL=2147483647,l.NEVER=1/0})(n||(n={}));var i;(function(l){l.DEFAULT_BACKOFF=3,l.DEFAULT_FREQUENCY={backoff:!0,interval:1e3,max:30*1e3},l.DEFAULT_LINGER=1,l.DEFAULT_NAME="unknown",l.DEFAULT_STANDBY="when-hidden",l.DEFAULT_STATE={interval:n.NEVER,payload:null,phase:"constructed",timestamp:new Date(0).getTime()},l.DISPOSED_STATE={interval:n.NEVER,payload:null,phase:"disposed",timestamp:new Date(0).getTime()};function u(d,f){let{backoff:m,interval:g,max:b}=d;if(g===n.NEVER)return g;let y=m===!0?l.DEFAULT_BACKOFF:m===!1?1:m,P=c(g,f.interval*y);return Math.min(b,P)}l.sleep=u,l.hidden=(()=>typeof document=="undefined"?!1:(document.addEventListener("visibilitychange",()=>{l.hidden=document.visibilityState==="hidden"}),document.addEventListener("pagehide",()=>{l.hidden=document.visibilityState==="hidden"}),document.visibilityState==="hidden"))();function c(d,f){return d=Math.ceil(d),f=Math.floor(f),Math.floor(Math.random()*(f-d+1))+d}})(i||(i={}));class o{constructor(u,c=500){this.args=void 0,this.payload=null,this.limit=c,this.poll=new n({auto:!1,factory:async()=>{let{args:d}=this;return this.args=void 0,u(...d)},frequency:{backoff:!1,interval:n.NEVER,max:n.NEVER},standby:"never"}),this.payload=new e.PromiseDelegate,this.poll.ticked.connect((d,f)=>{let{payload:m}=this;if(f.phase==="resolved"){this.payload=new e.PromiseDelegate,m.resolve(f.payload);return}if(f.phase==="rejected"||f.phase==="stopped"){this.payload=new e.PromiseDelegate,m.promise.catch(g=>{}),m.reject(f.payload);return}},this)}get isDisposed(){return this.payload===null}dispose(){this.isDisposed||(this.args=void 0,this.payload=null,this.poll.dispose())}async stop(){return this.poll.stop()}}class s extends o{invoke(...u){return this.args=u,this.poll.schedule({interval:this.limit,phase:"invoked"}),this.payload.promise}}class a extends o{constructor(u,c){super(u,typeof c=="number"?c:c&&c.limit),this._trailing=!1,typeof c!="number"&&c&&c.edge==="trailing"&&(this._trailing=!0),this._interval=this._trailing?this.limit:n.IMMEDIATE}invoke(...u){let c=this.poll.state.phase!=="invoked";return(c||this._trailing)&&(this.args=u),c&&this.poll.schedule({interval:this._interval,phase:"invoked"}),this.payload.promise}}r.Debouncer=s,r.Poll=n,r.RateLimiter=o,r.Throttler=a})});var cV=re(E1=>{"use strict";p();Object.defineProperty(E1,"__esModule",{value:!0});E1.EventManager=void 0;var y$=ro(),vye=Lg(),b$=Rs(),S$=Do(),I$="api/events",lV=class{constructor(e={}){var t;this._socket=null,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:S$.ServerConnection.makeSettings(),this._poll=new vye.Poll({factory:()=>this._subscribe()}),this._stream=new b$.Stream(this),this._poll.start()}get isDisposed(){return this._poll.isDisposed}get stream(){return this._stream}dispose(){if(this.isDisposed)return;this._poll.dispose();let e=this._socket;e&&(this._socket=null,e.onopen=()=>{},e.onerror=()=>{},e.onmessage=()=>{},e.onclose=()=>{},e.close()),b$.Signal.clearData(this),this._stream.stop()}async emit(e){let{serverSettings:t}=this,{baseUrl:n}=t,{makeRequest:i,ResponseError:o}=S$.ServerConnection,s=y$.URLExt.join(n,I$),a={body:JSON.stringify(e),method:"POST"},l=await i(s,a,t);if(l.status!==204)throw new o(l)}_subscribe(){return new Promise((e,t)=>{if(this.isDisposed)return;let{appendToken:n,token:i,WebSocket:o,wsUrl:s}=this.serverSettings,a=y$.URLExt.join(s,I$,"subscribe");n&&i!==""&&(a+=`?token=${encodeURIComponent(i)}`);let l=this._socket=new o(a),u=this._stream;l.onclose=()=>t(new Error("EventManager socket closed")),l.onmessage=c=>c.data&&u.emit(JSON.parse(c.data))})}};E1.EventManager=lV});var E$=re(_$=>{"use strict";p();Object.defineProperty(_$,"__esModule",{value:!0})});var C1=re(Ff=>{"use strict";p();Object.defineProperty(Ff,"__esModule",{value:!0});Ff.validateModels=Ff.validateModel=Ff.validateMessage=void 0;var Kg=Cx(),C$=["username","version","session","msg_id","msg_type"],yye={stream:{name:"string",text:"string"},display_data:{data:"object",metadata:"object"},execute_input:{code:"string",execution_count:"number"},execute_result:{execution_count:"number",data:"object",metadata:"object"},error:{ename:"string",evalue:"string",traceback:"object"},status:{execution_state:["string",["starting","idle","busy","restarting","dead"]]},clear_output:{wait:"boolean"},comm_open:{comm_id:"string",target_name:"string",data:"object"},comm_msg:{comm_id:"string",data:"object"},comm_close:{comm_id:"string"},shutdown_reply:{restart:"boolean"}};function bye(r){for(let e=0;e<C$.length;e++)(0,Kg.validateProperty)(r,C$[e],"string")}function Sye(r){(0,Kg.validateProperty)(r,"metadata","object"),(0,Kg.validateProperty)(r,"content","object"),(0,Kg.validateProperty)(r,"channel","string"),bye(r.header),r.channel==="iopub"&&Iye(r)}Ff.validateMessage=Sye;function Iye(r){if(r.channel==="iopub"){let e=yye[r.header.msg_type];if(e===void 0)return;let t=Object.keys(e),n=r.content;for(let i=0;i<t.length;i++){let o=e[t[i]];Array.isArray(o)||(o=[o]),(0,Kg.validateProperty)(n,t[i],...o)}}}function w$(r){(0,Kg.validateProperty)(r,"name","string"),(0,Kg.validateProperty)(r,"id","string")}Ff.validateModel=w$;function _ye(r){if(!Array.isArray(r))throw new Error("Invalid kernel list");r.forEach(e=>w$(e))}Ff.validateModels=_ye});var x1=re(Sn=>{"use strict";p();Object.defineProperty(Sn,"__esModule",{value:!0});Sn.getKernelModel=Sn.shutdownKernel=Sn.interruptKernel=Sn.restartKernel=Sn.startNew=Sn.listRunning=Sn.KERNEL_SERVICE_URL=void 0;var Ii=Do(),bS=ro(),w1=C1();Sn.KERNEL_SERVICE_URL="api/kernels";async function Eye(r=Ii.ServerConnection.makeSettings()){let e=bS.URLExt.join(r.baseUrl,Sn.KERNEL_SERVICE_URL),t=await Ii.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await Ii.ServerConnection.ResponseError.create(t);let n=await t.json();return(0,w1.validateModels)(n),n}Sn.listRunning=Eye;async function Cye(r={},e=Ii.ServerConnection.makeSettings()){let t=bS.URLExt.join(e.baseUrl,Sn.KERNEL_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await Ii.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await Ii.ServerConnection.ResponseError.create(i);let o=await i.json();return(0,w1.validateModel)(o),o}Sn.startNew=Cye;async function wye(r,e=Ii.ServerConnection.makeSettings()){let t=bS.URLExt.join(e.baseUrl,Sn.KERNEL_SERVICE_URL,encodeURIComponent(r),"restart"),n={method:"POST"},i=await Ii.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await Ii.ServerConnection.ResponseError.create(i);let o=await i.json();(0,w1.validateModel)(o)}Sn.restartKernel=wye;async function xye(r,e=Ii.ServerConnection.makeSettings()){let t=bS.URLExt.join(e.baseUrl,Sn.KERNEL_SERVICE_URL,encodeURIComponent(r),"interrupt"),n={method:"POST"},i=await Ii.ServerConnection.makeRequest(t,n,e);if(i.status!==204)throw await Ii.ServerConnection.ResponseError.create(i)}Sn.interruptKernel=xye;async function Pye(r,e=Ii.ServerConnection.makeSettings()){let t=bS.URLExt.join(e.baseUrl,Sn.KERNEL_SERVICE_URL,encodeURIComponent(r)),n={method:"DELETE"},i=await Ii.ServerConnection.makeRequest(t,n,e);if(i.status===404){let o=`The kernel "${r}" does not exist on the server`;console.warn(o)}else if(i.status!==204)throw await Ii.ServerConnection.ResponseError.create(i)}Sn.shutdownKernel=Pye;async function Dye(r,e=Ii.ServerConnection.makeSettings()){let t=bS.URLExt.join(e.baseUrl,Sn.KERNEL_SERVICE_URL,encodeURIComponent(r)),n=await Ii.ServerConnection.makeRequest(t,{},e);if(n.status===404)return;if(n.status!==200)throw await Ii.ServerConnection.ResponseError.create(n);let i=await n.json();return(0,w1.validateModel)(i),i}Sn.getKernelModel=Dye});var uV=re((P1,x$)=>{p();(function(r,e){typeof P1=="object"&&typeof x$!="undefined"?e(P1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(P1,function(r){"use strict";r.ArrayExt=void 0,function(h){function v(R,M,S=0,I=-1){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(S+j)%_;if(R[me]===M)return me}return-1}h.firstIndexOf=v;function C(R,M,S=-1,I=0){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(S-j+_)%_;if(R[me]===M)return me}return-1}h.lastIndexOf=C;function k(R,M,S=0,I=-1){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(S+j)%_;if(M(R[me],me))return me}return-1}h.findFirstIndex=k;function H(R,M,S=-1,I=0){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(S-j+_)%_;if(M(R[me],me))return me}return-1}h.findLastIndex=H;function Y(R,M,S=0,I=-1){let _=k(R,M,S,I);return _!==-1?R[_]:void 0}h.findFirstValue=Y;function Z(R,M,S=-1,I=0){let _=H(R,M,S,I);return _!==-1?R[_]:void 0}h.findLastValue=Z;function ie(R,M,S,I=0,_=-1){let F=R.length;if(F===0)return 0;I<0?I=Math.max(0,I+F):I=Math.min(I,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=I,me=_-I+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;S(R[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function ce(R,M,S,I=0,_=-1){let F=R.length;if(F===0)return 0;I<0?I=Math.max(0,I+F):I=Math.min(I,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=I,me=_-I+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;S(R[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=ce;function be(R,M,S){if(R===M)return!0;if(R.length!==M.length)return!1;for(let I=0,_=R.length;I<_;++I)if(S?!S(R[I],M[I]):R[I]!==M[I])return!1;return!0}h.shallowEqual=be;function q(R,M={}){let{start:S,stop:I,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=R.length;S===void 0?S=_<0?F-1:0:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F),I===void 0?I=_<0?-1:F:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F);let j;_<0&&I>=S||_>0&&S>=I?j=0:_<0?j=Math.floor((I-S+1)/_+1):j=Math.floor((I-S-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=R[S+Fe*_];return me}h.slice=q;function $(R,M,S){let I=R.length;if(I<=1||(M<0?M=Math.max(0,M+I):M=Math.min(M,I-1),S<0?S=Math.max(0,S+I):S=Math.min(S,I-1),M===S))return;let _=R[M],F=M<S?1:-1;for(let j=M;j!==S;j+=F)R[j]=R[j+F];R[S]=_}h.move=$;function de(R,M=0,S=-1){let I=R.length;if(!(I<=1))for(M<0?M=Math.max(0,M+I):M=Math.min(M,I-1),S<0?S=Math.max(0,S+I):S=Math.min(S,I-1);M<S;){let _=R[M],F=R[S];R[M++]=F,R[S--]=_}}h.reverse=de;function pe(R,M,S=0,I=-1){let _=R.length;if(_<=1||(S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S>=I))return;let F=I-S+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=S+M;de(R,S,j-1),de(R,j,I),de(R,S,I)}h.rotate=pe;function ye(R,M,S=0,I=-1){let _=R.length;if(_===0)return;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j)R[(S+j)%_]=M}h.fill=ye;function z(R,M,S){let I=R.length;M<0?M=Math.max(0,M+I):M=Math.min(M,I);for(let _=I;_>M;--_)R[_]=R[_-1];R[M]=S}h.insert=z;function fe(R,M){let S=R.length;if(M<0&&(M+=S),M<0||M>=S)return;let I=R[M];for(let _=M+1;_<S;++_)R[_-1]=R[_];return R.length=S-1,I}h.removeAt=fe;function Ie(R,M,S=0,I=-1){let _=v(R,M,S,I);return _!==-1&&fe(R,_),_}h.removeFirstOf=Ie;function Te(R,M,S=-1,I=0){let _=C(R,M,S,I);return _!==-1&&fe(R,_),_}h.removeLastOf=Te;function Le(R,M,S=0,I=-1){let _=R.length;if(_===0)return 0;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F=0;for(let j=0;j<_;++j)S<=I&&j>=S&&j<=I&&R[j]===M||I<S&&(j<=I||j>=S)&&R[j]===M?F++:F>0&&(R[j-F]=R[j]);return F>0&&(R.length=_-F),F}h.removeAllOf=Le;function $e(R,M,S=0,I=-1){let _,F=k(R,M,S,I);return F!==-1&&(_=fe(R,F)),{index:F,value:_}}h.removeFirstWhere=$e;function Ge(R,M,S=-1,I=0){let _,F=H(R,M,S,I);return F!==-1&&(_=fe(R,F)),{index:F,value:_}}h.removeLastWhere=Ge;function Bt(R,M,S=0,I=-1){let _=R.length;if(_===0)return 0;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F=0;for(let j=0;j<_;++j)S<=I&&j>=S&&j<=I&&M(R[j],j)||I<S&&(j<=I||j>=S)&&M(R[j],j)?F++:F>0&&(R[j-F]=R[j]);return F>0&&(R.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let v of h)yield*v}function*t(){}function*n(h,v=0){for(let C of h)yield[v++,C]}function*i(h,v){let C=0;for(let k of h)v(k,C++)&&(yield k)}function o(h,v){let C=0;for(let k of h)if(v(k,C++))return k}function s(h,v){let C=0;for(let k of h)if(v(k,C++))return C-1;return-1}function a(h,v){let C;for(let k of h){if(C===void 0){C=k;continue}v(k,C)<0&&(C=k)}return C}function l(h,v){let C;for(let k of h){if(C===void 0){C=k;continue}v(k,C)>0&&(C=k)}return C}function u(h,v){let C=!0,k,H;for(let Y of h)C?(k=Y,H=Y,C=!1):v(Y,k)<0?k=Y:v(Y,H)>0&&(H=Y);return C?void 0:[k,H]}function c(h){return Array.from(h)}function d(h){let v={};for(let[C,k]of h)v[C]=k;return v}function f(h,v){let C=0;for(let k of h)if(v(k,C++)===!1)return}function m(h,v){let C=0;for(let k of h)if(v(k,C++)===!1)return!1;return!0}function g(h,v){let C=0;for(let k of h)if(v(k,C++))return!0;return!1}function*b(h,v){let C=0;for(let k of h)yield v(k,C++)}function*y(h,v,C){v===void 0?(v=h,h=0,C=1):C===void 0&&(C=1);let k=P.rangeLength(h,v,C);for(let H=0;H<k;H++)yield h+C*H}var P;(function(h){function v(C,k,H){return H===0?1/0:C>k&&H>0||C<k&&H<0?0:Math.ceil((k-C)/H)}h.rangeLength=v})(P||(P={}));function A(h,v,C){let k=h[Symbol.iterator](),H=0,Y=k.next();if(Y.done&&C===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return C;let Z=k.next();if(Z.done&&C===void 0)return Y.value;if(Z.done)return v(C,Y.value,H++);let ie;C===void 0?ie=v(Y.value,Z.value,H++):ie=v(v(C,Y.value,H++),Z.value,H++);let ce;for(;!(ce=k.next()).done;)ie=v(ie,ce.value,H++);return ie}function*D(h,v){for(;0<v--;)yield h}function*T(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let v=h.length-1;v>-1;v--)yield h[v]}function L(h){let v=[],C=new Set,k=new Map;for(let Z of h)H(Z);for(let[Z]of k)Y(Z);return v;function H(Z){let[ie,ce]=Z,be=k.get(ce);be?be.push(ie):k.set(ce,[ie])}function Y(Z){if(C.has(Z))return;C.add(Z);let ie=k.get(Z);if(ie)for(let ce of ie)Y(ce);v.push(Z)}}function*B(h,v){let C=0;for(let k of h)C++%v===0&&(yield k)}r.StringExt=void 0,function(h){function v(Z,ie,ce=0){let be=new Array(ie.length);for(let q=0,$=ce,de=ie.length;q<de;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=v;function C(Z,ie,ce=0){let be=v(Z,ie,ce);if(!be)return null;let q=0;for(let $=0,de=be.length;$<de;++$){let pe=be[$]-ce;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=C;function k(Z,ie,ce=0){let be=v(Z,ie,ce);if(!be)return null;let q=0,$=ce-1;for(let de=0,pe=be.length;de<pe;++de){let ye=be[de];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=k;function H(Z,ie,ce){let be=[],q=0,$=0,de=ie.length;for(;q<de;){let pe=ie[q],ye=ie[q];for(;++q<de&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(ce(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,v){if(v<1)return;let C=h[Symbol.iterator](),k;for(;0<v--&&!(k=C.next()).done;)yield k.value}function*O(...h){let v=h.map(k=>k[Symbol.iterator]()),C=v.map(k=>k.next());for(;m(C,k=>!k.done);C=v.map(k=>k.next()))yield C.map(k=>k.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=T,r.range=y,r.reduce=A,r.repeat=D,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var D$=re((D1,P$)=>{p();(function(r,e){typeof D1=="object"&&typeof P$!="undefined"?e(D1,uV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(D1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"}u.isPrimitive=c;function d(D){return Array.isArray(D)}u.isArray=d;function f(D){return!c(D)&&!d(D)}u.isObject=f;function m(D,T){if(D===T)return!0;if(c(D)||c(T))return!1;let K=d(D),L=d(T);return K!==L?!1:K&&L?b(D,T):y(D,T)}u.deepEqual=m;function g(D){return c(D)?D:d(D)?P(D):A(D)}u.deepCopy=g;function b(D,T){if(D===T)return!0;if(D.length!==T.length)return!1;for(let K=0,L=D.length;K<L;++K)if(!m(D[K],T[K]))return!1;return!0}function y(D,T){if(D===T)return!0;for(let K in D)if(D[K]!==void 0&&!(K in T))return!1;for(let K in T)if(T[K]!==void 0&&!(K in D))return!1;for(let K in D){let L=D[K],B=T[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function P(D){let T=new Array(D.length);for(let K=0,L=D.length;K<L;++K)T[K]=g(D[K]);return T}function A(D){let T={};for(let K in D){let L=D[K];L!==void 0&&(T[K]=g(L))}return T}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(y=>{let P=this._services.get(y);return P?this._plugins.get(P).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(y){var P,A,D,T;this._activated=!1,this._promise=null,this._service=null,this.id=y.id,this.description=(P=y.description)!==null&&P!==void 0?P:"",this.activate=y.activate,this.deactivate=(A=y.deactivate)!==null&&A!==void 0?A:null,this.provides=(D=y.provides)!==null&&D!==void 0?D:null,this.autoStart=(T=y.autoStart)!==null&&T!==void 0?T:!1,this.requires=y.requires?y.requires.slice():[],this.optional=y.optional?y.optional.slice():[]}get activated(){return this._activated}set activated(y){this._activated=y}get service(){return this._service}set service(y){this._service=y}get promise(){return this._promise}set promise(y){this._promise=y}}function d(b){return new c(b)}u.createPluginData=d;function f(b,y,P){let A=[...b.requires,...b.optional],D=K=>{if(K===b.provides)return!0;let L=P.get(K);if(!L)return!1;let B=y.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(T.push(L),N.some(D)?!0:(T.pop(),!1))};if(!b.provides||A.length===0)return;let T=[b.id];if(A.some(D))throw new ReferenceError(`Cycle detected: ${T.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,y,P){let A=new Array,D=N=>{let O=y.get(N),h=[...O.requires,...O.optional];A.push(...h.reduce((v,C)=>{let k=P.get(C);return k&&v.push([N,k]),v},[]))};for(let N of y.keys())D(N);let T=A.filter(N=>N[1]===b),K=0;for(;T.length>K;){let N=T.length,O=new Set(T.map(h=>h[0]));for(let h of O)A.filter(v=>v[1]===h).forEach(v=>{T.includes(v)||T.push(v)});K=N}let L=e.topologicSort(T),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,y){let P=new Set;for(let A of b.keys())b.get(A).autoStart===!0&&P.add(A);if(y.startPlugins)for(let A of y.startPlugins)P.add(A);if(y.ignorePlugins)for(let A of y.ignorePlugins)P.delete(A);return Array.from(P)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var k$=re((T1,T$)=>{p();(function(r,e){typeof T1=="object"&&typeof T$!="undefined"?e(T1,uV(),D$()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(T1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let v=g.get(N.sender);if(v||(v=[],g.set(N.sender,v)),A(v,N,O,h))return!1;let C=h||O,k=b.get(C);k||(k=[],b.set(C,k));let H={signal:N,slot:O,thisArg:h};return v.push(H),k.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let v=g.get(N.sender);if(!v||v.length===0)return!1;let C=A(v,N,O,h);if(!C)return!1;let k=h||O,H=b.get(k);return C.signal=null,T(v),T(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let v=b.get(O);if(!(!v||v.length===0)){for(let C of v)C.signal&&C.signal.sender===N&&(C.signal=null);T(h),T(v)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let v=h.thisArg||h.slot;h.signal=null,T(b.get(v))}T(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let v=h.signal.sender;h.signal=null,T(g.get(v))}T(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let v=0,C=h.length;v<C;++v){let k=h[v];k.signal===N&&D(k,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,y=new Set,P=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function A(N,O,h,v){return e.find(N,C=>C.signal===O&&C.slot===h&&C.thisArg===v)}function D(N,O){let{signal:h,slot:v,thisArg:C}=N;try{v.call(C,h.sender,O)}catch(k){s.exceptionHandler(k)}}function T(N){y.size===0&&P(K),y.add(N)}function K(){y.forEach(L),y.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var dV=re((k1,N$)=>{p();(function(r,e){typeof k1=="object"&&typeof N$!="undefined"?e(k1,k$()):typeof define=="function"&&define.amd?define(["exports","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_disposable={},r.lumino_signaling))})(k1,function(r,e){"use strict";class t{constructor(a){this._fn=a}get isDisposed(){return!this._fn}dispose(){if(!this._fn)return;let a=this._fn;this._fn=null,a()}}class n extends t{constructor(){super(...arguments),this._disposed=new e.Signal(this)}get disposed(){return this._disposed}dispose(){this.isDisposed||(super.dispose(),this._disposed.emit(void 0),e.Signal.clearData(this))}}class i{constructor(){this._isDisposed=!1,this._items=new Set}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._items.forEach(a=>{a.dispose()}),this._items.clear())}contains(a){return this._items.has(a)}add(a){this._items.add(a)}remove(a){this._items.delete(a)}clear(){this._items.clear()}}(function(s){function a(l){let u=new s;for(let c of l)u.add(c);return u}s.from=a})(i||(i={}));class o extends i{constructor(){super(...arguments),this._disposed=new e.Signal(this)}get disposed(){return this._disposed}dispose(){this.isDisposed||(super.dispose(),this._disposed.emit(void 0),e.Signal.clearData(this))}}(function(s){function a(l){let u=new s;for(let c of l)u.add(c);return u}s.from=a})(o||(o={})),r.DisposableDelegate=t,r.DisposableSet=i,r.ObservableDisposableDelegate=n,r.ObservableDisposableSet=o})});var R$=re(Jc=>{"use strict";p();var Tye=Jc&&Jc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),kye=Jc&&Jc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Nye=Jc&&Jc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Tye(e,r,t);return kye(e,r),e};Object.defineProperty(Jc,"__esModule",{value:!0});Jc.CommHandler=void 0;var Rye=dV(),N1=Nye(hS()),pV=class extends Rye.DisposableDelegate{constructor(e,t,n,i){super(i),this._target="",this._id="",this._id=t,this._target=e,this._kernel=n}get commId(){return this._id}get targetName(){return this._target}get onClose(){return this._onClose}set onClose(e){this._onClose=e}get onMsg(){return this._onMsg}set onMsg(e){this._onMsg=e}open(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot open");let i=N1.createMessage({msgType:"comm_open",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,target_name:this._target,data:e!=null?e:{}},metadata:t,buffers:n});return this._kernel.sendShellMessage(i,!1,!0)}send(e,t,n=[],i=!0){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot send");let o=N1.createMessage({msgType:"comm_msg",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e},metadata:t,buffers:n});return this._kernel.sendShellMessage(o,!1,i)}close(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot close");let i=N1.createMessage({msgType:"comm_close",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n}),o=this._kernel.sendShellMessage(i,!1,!0),s=this._onClose;if(s){let a=N1.createMessage({msgType:"comm_close",channel:"iopub",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n});s(a)}return this.dispose(),o}};Jc.CommHandler=pV});var M$=re(os=>{"use strict";p();var Aye=os&&os.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Mye=os&&os.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Oye=os&&os.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Aye(e,r,t);return Mye(e,r),e};Object.defineProperty(os,"__esModule",{value:!0});os.KernelShellFutureHandler=os.KernelControlFutureHandler=os.KernelFutureHandler=void 0;var A$=Wc(),Lye=dV(),Kye=Oye(hS()),wx=class extends Lye.DisposableDelegate{constructor(e,t,n,i,o){super(e),this._status=0,this._stdin=Ai.noOp,this._iopub=Ai.noOp,this._reply=Ai.noOp,this._done=new A$.PromiseDelegate,this._hooks=new Ai.HookList,this._disposeOnDone=!0,this._msg=t,n||this._setFlag(Ai.KernelFutureFlag.GotReply),this._disposeOnDone=i,this._kernel=o}get msg(){return this._msg}get done(){return this._done.promise}get onReply(){return this._reply}set onReply(e){this._reply=e}get onIOPub(){return this._iopub}set onIOPub(e){this._iopub=e}get onStdin(){return this._stdin}set onStdin(e){this._stdin=e}registerMessageHook(e){if(this.isDisposed)throw new Error("Kernel future is disposed");this._hooks.add(e)}removeMessageHook(e){this.isDisposed||this._hooks.remove(e)}sendInputReply(e,t){this._kernel.sendInputReply(e,t)}dispose(){this._stdin=Ai.noOp,this._iopub=Ai.noOp,this._reply=Ai.noOp,this._hooks=null,this._testFlag(Ai.KernelFutureFlag.IsDone)||(this._done.promise.catch(()=>{}),this._done.reject(new Error(`Canceled future for ${this.msg.header.msg_type} message before replies were done`))),super.dispose()}async handleMsg(e){switch(e.channel){case"control":case"shell":e.channel===this.msg.channel&&e.parent_header.msg_id===this.msg.header.msg_id&&await this._handleReply(e);break;case"stdin":await this._handleStdin(e);break;case"iopub":await this._handleIOPub(e);break;default:break}}async _handleReply(e){let t=this._reply;t&&await t(e),this._replyMsg=e,this._setFlag(Ai.KernelFutureFlag.GotReply),this._testFlag(Ai.KernelFutureFlag.GotIdle)&&this._handleDone()}async _handleStdin(e){this._kernel.hasPendingInput=!0;let t=this._stdin;t&&await t(e)}async _handleIOPub(e){let t=await this._hooks.process(e),n=this._iopub;t&&n&&await n(e),Kye.isStatusMsg(e)&&e.content.execution_state==="idle"&&(this._setFlag(Ai.KernelFutureFlag.GotIdle),this._testFlag(Ai.KernelFutureFlag.GotReply)&&this._handleDone())}_handleDone(){this._testFlag(Ai.KernelFutureFlag.IsDone)||(this._setFlag(Ai.KernelFutureFlag.IsDone),this._done.resolve(this._replyMsg),this._disposeOnDone&&this.dispose())}_testFlag(e){return(this._status&e)!==0}_setFlag(e){this._status|=e}};os.KernelFutureHandler=wx;var fV=class extends wx{};os.KernelControlFutureHandler=fV;var mV=class extends wx{};os.KernelShellFutureHandler=mV;var Ai;(function(r){r.noOp=()=>{};let e=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();class t{constructor(){this._hooks=[]}add(o){this.remove(o),this._hooks.push(o)}remove(o){let s=this._hooks.indexOf(o);s>=0&&(this._hooks[s]=null,this._scheduleCompact())}async process(o){await this._processing;let s=new A$.PromiseDelegate;this._processing=s.promise;let a;for(let l=this._hooks.length-1;l>=0;l--){let u=this._hooks[l];if(u!==null){try{a=await u(o)}catch(c){a=!0,console.error(c)}if(a===!1)return s.resolve(void 0),!1}}return s.resolve(void 0),!0}_scheduleCompact(){this._compactScheduled||(this._compactScheduled=!0,e(()=>{this._processing=this._processing.then(()=>{this._compactScheduled=!1,this._compact()})}))}_compact(){let o=0;for(let s=0,a=this._hooks.length;s<a;s++){let l=this._hooks[s];this._hooks[s]===null?o++:this._hooks[s-o]=l}this._hooks.length-=o}}r.HookList=t;let n;(function(i){i[i.GotReply=1]="GotReply",i[i.GotIdle=2]="GotIdle",i[i.IsDone=4]="IsDone",i[i.DisposeOnDone=8]="DisposeOnDone"})(n=r.KernelFutureFlag||(r.KernelFutureFlag={}))})(Ai||(Ai={}))});var L$=re(O$=>{"use strict";p();Object.defineProperty(O$,"__esModule",{value:!0})});var F$=re(SS=>{"use strict";p();Object.defineProperty(SS,"__esModule",{value:!0});SS.validateSpecModels=SS.validateSpecModel=void 0;var Fg=Cx();function K$(r){let e=r.spec;if(!e)throw new Error("Invalid kernel spec");(0,Fg.validateProperty)(r,"name","string"),(0,Fg.validateProperty)(r,"resources","object"),(0,Fg.validateProperty)(e,"language","string"),(0,Fg.validateProperty)(e,"display_name","string"),(0,Fg.validateProperty)(e,"argv","array");let t=null;e.hasOwnProperty("metadata")&&((0,Fg.validateProperty)(e,"metadata","object"),t=e.metadata);let n=null;return e.hasOwnProperty("env")&&((0,Fg.validateProperty)(e,"env","object"),n=e.env),{name:r.name,resources:r.resources,language:e.language,display_name:e.display_name,argv:e.argv,metadata:t,env:n}}SS.validateSpecModel=K$;function Fye(r){if(!r.hasOwnProperty("kernelspecs"))throw new Error("No kernelspecs found");let e=Object.keys(r.kernelspecs),t=Object.create(null),n=r.default;for(let i=0;i<e.length;i++){let o=r.kernelspecs[e[i]];try{t[e[i]]=K$(o)}catch(s){console.warn(`Removing errant kernel spec: ${e[i]}`)}}if(e=Object.keys(t),!e.length)throw new Error("No valid kernelspecs found");return(!n||typeof n!="string"||!(n in t))&&(n=e[0],console.warn(`Default kernel not found, using '${e[0]}'`)),{default:n,kernelspecs:t}}SS.validateSpecModels=Fye});var gV=re(R1=>{"use strict";p();Object.defineProperty(R1,"__esModule",{value:!0});R1.getSpecs=void 0;var hV=Do(),Uye=F$(),Wye=ro(),Vye="api/kernelspecs";async function jye(r=hV.ServerConnection.makeSettings()){let e=Wye.URLExt.join(r.baseUrl,Vye),t=await hV.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await hV.ServerConnection.ResponseError.create(t);let n=await t.json();return(0,Uye.validateSpecModels)(n)}R1.getSpecs=jye});var W$=re(Gc=>{"use strict";p();var Bye=Gc&&Gc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Hye=Gc&&Gc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),qye=Gc&&Gc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Bye(e,r,t);return Hye(e,r),e};Object.defineProperty(Gc,"__esModule",{value:!0});Gc.KernelSpecManager=void 0;var Jye=Wc(),Gye=Lg(),U$=Rs(),Yye=qye(gV()),$ye=Og(),vV=class extends $ye.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._connectionFailure=new U$.Signal(this),this._specs=null,this._specsChanged=new U$.Signal(this),this._ready=Promise.all([this.requestSpecs()]).then(n=>{}).catch(n=>{}).then(()=>{this.isDisposed||(this._isReady=!0)}),this._pollSpecs=new Gye.Poll({auto:!1,factory:()=>this.requestSpecs(),frequency:{interval:61*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelSpecManager#specs",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this.ready.then(()=>{this._pollSpecs.start()})}get isReady(){return this._isReady}get ready(){return this._ready}get specs(){return this._specs}get specsChanged(){return this._specsChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose(),super.dispose()}async refreshSpecs(){await this._pollSpecs.refresh(),await this._pollSpecs.tick}async requestSpecs(){let e=await Yye.getSpecs(this.serverSettings);this.isDisposed||Jye.JSONExt.deepEqual(e,this._specs)||(this._specs=e,this._specsChanged.emit(e))}};Gc.KernelSpecManager=vV});var A1=re(To=>{"use strict";p();var V$=To&&To.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),zye=To&&To.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),j$=To&&To.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&V$(e,r,t);return zye(e,r),e},Qye=To&&To.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&V$(e,r,t)};Object.defineProperty(To,"__esModule",{value:!0});To.KernelSpecAPI=To.KernelSpec=void 0;var Xye=j$(L$());To.KernelSpec=Xye;var Zye=j$(gV());To.KernelSpecAPI=Zye;Qye(W$(),To)});var SV=re(Yc=>{"use strict";p();var ebe=Yc&&Yc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),tbe=Yc&&Yc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),bV=Yc&&Yc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&ebe(e,r,t);return tbe(e,r),e};Object.defineProperty(Yc,"__esModule",{value:!0});Yc.KernelConnection=void 0;var B$=ro(),Uf=Wc(),Wf=Rs(),H$=ri(),q$=R$(),ss=bV(hS()),J$=M$(),rbe=bV(C1()),nbe=A1(),xx=bV(x1()),ibe=3e3,IS="_RESTARTING_",obe="",yV=class r{constructor(e){var t,n,i,o;this._createSocket=(s=!0)=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let a=this.serverSettings,l=B$.URLExt.join(a.wsUrl,xx.KERNEL_SERVICE_URL,encodeURIComponent(this._id)),u=l.replace(/^((?:\w+:)?\/\/)(?:[^@\/]+@)/,"$1"),c=B$.URLExt.join(l,"channels?session_id="+encodeURIComponent(this._clientId)),d=a.token;a.appendToken&&d!==""&&(c=c+`&token=${encodeURIComponent(d)}`);let f=s?this._supportedProtocols:[];this._ws=new a.WebSocket(c,f),this._ws.binaryType="arraybuffer";let m=!1,g=async y=>{var P,A;if(!this._isDisposed){this._reason="",this._model=void 0;try{let D=await xx.getKernelModel(this._id,a);this._model=D,(D==null?void 0:D.execution_state)==="dead"?this._updateStatus("dead"):this._onWSClose(y)}catch(D){if(D instanceof H$.ServerConnection.NetworkError||((P=D.response)===null||P===void 0?void 0:P.status)===503||((A=D.response)===null||A===void 0?void 0:A.status)===424){let T=xa.getRandomIntInclusive(10,30)*1e3;setTimeout(g,T,y)}else this._reason="Kernel died unexpectedly",this._updateStatus("dead")}}},b=async y=>{m||(m=!0,await g(y))};this._ws.onmessage=this._onWSMessage,this._ws.onopen=this._onWSOpen,this._ws.onclose=b,this._ws.onerror=b},this._onWSOpen=s=>{if(this._ws.protocol!==""&&!this._supportedProtocols.includes(this._ws.protocol))throw console.log("Server selected unknown kernel wire protocol:",this._ws.protocol),this._updateStatus("dead"),new Error(`Unknown kernel wire protocol:  ${this._ws.protocol}`);this._selectedProtocol=this._ws.protocol,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose,this._updateConnectionStatus("connected")},this._onWSMessage=s=>{let a;try{a=this.serverSettings.serializer.deserialize(s.data,this._ws.protocol),rbe.validateMessage(a)}catch(l){throw l.message=`Kernel message validation error: ${l.message}`,l}this._kernelSession=a.header.session,this._msgChain=this._msgChain.then(()=>this._handleMessage(a)).catch(l=>{l.message.startsWith("Canceled future for ")&&console.error(l)}),this._anyMessage.emit({msg:a,direction:"recv"})},this._onWSClose=s=>{this.isDisposed||this._reconnect()},this._id="",this._name="",this._status="unknown",this._connectionStatus="connecting",this._kernelSession="",this._isDisposed=!1,this._ws=null,this._username="",this._reconnectLimit=7,this._reconnectAttempt=0,this._reconnectTimeout=null,this._supportedProtocols=Object.values(ss.supportedKernelWebSocketProtocols),this._selectedProtocol="",this._futures=new Map,this._comms=new Map,this._targetRegistry=Object.create(null),this._info=new Uf.PromiseDelegate,this._pendingMessages=[],this._statusChanged=new Wf.Signal(this),this._connectionStatusChanged=new Wf.Signal(this),this._disposed=new Wf.Signal(this),this._iopubMessage=new Wf.Signal(this),this._anyMessage=new Wf.Signal(this),this._pendingInput=new Wf.Signal(this),this._unhandledMessage=new Wf.Signal(this),this._displayIdToParentIds=new Map,this._msgIdToDisplayIds=new Map,this._msgChain=Promise.resolve(),this._hasPendingInput=!1,this._reason="",this._noOp=()=>{},this._name=e.model.name,this._id=e.model.id,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:H$.ServerConnection.makeSettings(),this._clientId=(n=e.clientId)!==null&&n!==void 0?n:Uf.UUID.uuid4(),this._username=(i=e.username)!==null&&i!==void 0?i:"",this.handleComms=(o=e.handleComms)!==null&&o!==void 0?o:!0,this._createSocket()}get disposed(){return this._disposed}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get model(){return this._model||{id:this.id,name:this.name,reason:this._reason}}get anyMessage(){return this._anyMessage}get pendingInput(){return this._pendingInput}get id(){return this._id}get name(){return this._name}get username(){return this._username}get clientId(){return this._clientId}get status(){return this._status}get connectionStatus(){return this._connectionStatus}get isDisposed(){return this._isDisposed}get info(){return this._info.promise}get spec(){return this._specPromise?this._specPromise:(this._specPromise=nbe.KernelSpecAPI.getSpecs(this.serverSettings).then(e=>e.kernelspecs[this._name]),this._specPromise)}clone(e={}){return new r({model:this.model,username:this.username,serverSettings:this.serverSettings,handleComms:!1,...e})}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearKernelState(),this._pendingMessages=[],this._clearSocket(),Wf.Signal.clearData(this))}sendShellMessage(e,t=!1,n=!0){return this._sendKernelShellControl(J$.KernelShellFutureHandler,e,t,n)}sendControlMessage(e,t=!1,n=!0){return this._sendKernelShellControl(J$.KernelControlFutureHandler,e,t,n)}_sendKernelShellControl(e,t,n=!1,i=!0){this._sendMessage(t),this._anyMessage.emit({msg:t,direction:"send"});let o=new e(()=>{let s=t.header.msg_id;this._futures.delete(s);let a=this._msgIdToDisplayIds.get(s);a&&(a.forEach(l=>{let u=this._displayIdToParentIds.get(l);if(u){let c=u.indexOf(s);if(c===-1)return;u.length===1?this._displayIdToParentIds.delete(l):(u.splice(c,1),this._displayIdToParentIds.set(l,u))}}),this._msgIdToDisplayIds.delete(s))},t,n,i,this);return this._futures.set(t.header.msg_id,o),o}_sendMessage(e,t=!0){if(this.status==="dead")throw new Error("Kernel is dead");if((this._kernelSession===obe||this._kernelSession===IS)&&ss.isInfoRequestMsg(e))if(this.connectionStatus==="connected"){this._ws.send(this.serverSettings.serializer.serialize(e,this._ws.protocol));return}else throw new Error("Could not send message: status is not connected");if(t&&this._pendingMessages.length>0){this._pendingMessages.push(e);return}if(this.connectionStatus==="connected"&&this._kernelSession!==IS)this._ws.send(this.serverSettings.serializer.serialize(e,this._ws.protocol));else if(t)this._pendingMessages.push(e);else throw new Error("Could not send message")}async interrupt(){if(this.hasPendingInput=!1,this.status==="dead")throw new Error("Kernel is dead");return xx.interruptKernel(this.id,this.serverSettings)}async restart(){if(this.status==="dead")throw new Error("Kernel is dead");this._updateStatus("restarting"),this._clearKernelState(),this._kernelSession=IS,await xx.restartKernel(this.id,this.serverSettings),await this.reconnect(),this.hasPendingInput=!1}reconnect(){this._errorIfDisposed();let e=new Uf.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Kernel connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}async shutdown(){this.status!=="dead"&&await xx.shutdownKernel(this.id,this.serverSettings),this.handleShutdown()}handleShutdown(){this._updateStatus("dead"),this.dispose()}async requestKernelInfo(){let e=ss.createMessage({msgType:"kernel_info_request",channel:"shell",username:this._username,session:this._clientId,content:{}}),t;try{t=await xa.handleShellMessage(this,e)}catch(n){if(this.isDisposed)return;throw n}if(this._errorIfDisposed(),!!t)return t.content.status===void 0&&(t.content.status="ok"),t.content.status!=="ok"?(this._info.reject("Kernel info reply errored"),t):(this._info.resolve(t.content),this._kernelSession=t.header.session,t)}requestComplete(e){let t=ss.createMessage({msgType:"complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestInspect(e){let t=ss.createMessage({msgType:"inspect_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestHistory(e){let t=ss.createMessage({msgType:"history_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestExecute(e,t=!0,n){let i={silent:!1,store_history:!0,user_expressions:{},allow_stdin:!0,stop_on_error:!1},o=ss.createMessage({msgType:"execute_request",channel:"shell",username:this._username,session:this._clientId,content:{...i,...e},metadata:n});return this.sendShellMessage(o,!0,t)}requestDebug(e,t=!0){let n=ss.createMessage({msgType:"debug_request",channel:"control",username:this._username,session:this._clientId,content:e});return this.sendControlMessage(n,!0,t)}requestIsComplete(e){let t=ss.createMessage({msgType:"is_complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}requestCommInfo(e){let t=ss.createMessage({msgType:"comm_info_request",channel:"shell",username:this._username,session:this._clientId,content:e});return xa.handleShellMessage(this,t)}sendInputReply(e,t){let n=ss.createMessage({msgType:"input_reply",channel:"stdin",username:this._username,session:this._clientId,content:e});n.parent_header=t,this._sendMessage(n),this._anyMessage.emit({msg:n,direction:"send"}),this.hasPendingInput=!1}createComm(e,t=Uf.UUID.uuid4()){if(!this.handleComms)throw new Error("Comms are disabled on this kernel connection");if(this._comms.has(t))throw new Error("Comm is already created");let n=new q$.CommHandler(e,t,this,()=>{this._unregisterComm(t)});return this._comms.set(t,n),n}hasComm(e){return this._comms.has(e)}registerCommTarget(e,t){this.handleComms&&(this._targetRegistry[e]=t)}removeCommTarget(e,t){this.handleComms&&!this.isDisposed&&this._targetRegistry[e]===t&&delete this._targetRegistry[e]}registerMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.registerMessageHook(t)}removeMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.removeMessageHook(t)}removeInputGuard(){this.hasPendingInput=!1}async _handleDisplayId(e,t){var n,i;let o=t.parent_header.msg_id,s=this._displayIdToParentIds.get(e);if(s){let l={header:Uf.JSONExt.deepCopy(t.header),parent_header:Uf.JSONExt.deepCopy(t.parent_header),metadata:Uf.JSONExt.deepCopy(t.metadata),content:Uf.JSONExt.deepCopy(t.content),channel:t.channel,buffers:t.buffers?t.buffers.slice():[]};l.header.msg_type="update_display_data",await Promise.all(s.map(async u=>{let c=this._futures&&this._futures.get(u);c&&await c.handleMsg(l)}))}if(t.header.msg_type==="update_display_data")return!0;s=(n=this._displayIdToParentIds.get(e))!==null&&n!==void 0?n:[],s.indexOf(o)===-1&&s.push(o),this._displayIdToParentIds.set(e,s);let a=(i=this._msgIdToDisplayIds.get(o))!==null&&i!==void 0?i:[];return a.indexOf(o)===-1&&a.push(o),this._msgIdToDisplayIds.set(o,a),!1}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}_updateStatus(e){this._status===e||this._status==="dead"||(this._status=e,xa.logKernelStatus(this),this._statusChanged.emit(e),e==="dead"&&this.dispose())}_sendPending(){for(;this.connectionStatus==="connected"&&this._kernelSession!==IS&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}_clearKernelState(){this._kernelSession="",this._pendingMessages=[],this._futures.forEach(e=>{e.dispose()}),this._comms.forEach(e=>{e.dispose()}),this._msgChain=Promise.resolve(),this._futures=new Map,this._comms=new Map,this._displayIdToParentIds.clear(),this._msgIdToDisplayIds.clear()}_assertCurrentMessage(e){if(this._errorIfDisposed(),e.header.session!==this._kernelSession)throw new Error(`Canceling handling of old message: ${e.header.msg_type}`)}async _handleCommOpen(e){this._assertCurrentMessage(e);let t=e.content,n=new q$.CommHandler(t.target_name,t.comm_id,this,()=>{this._unregisterComm(t.comm_id)});this._comms.set(t.comm_id,n);try{await(await xa.loadObject(t.target_name,t.target_module,this._targetRegistry))(n,e)}catch(i){throw n.close(),console.error("Exception opening new comm"),i}}async _handleCommClose(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n){console.error("Comm not found for comm id "+t.comm_id);return}this._unregisterComm(n.commId);let i=n.onClose;i&&await i(e),n.dispose()}async _handleCommMsg(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n)return;let i=n.onMsg;i&&await i(e)}_unregisterComm(e){this._comms.delete(e)}_updateConnectionStatus(e){if(this._connectionStatus!==e){if(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),this.status!=="dead")if(e==="connected"){let t=this._kernelSession===IS,n=this.requestKernelInfo(),i=!1,o=()=>{i||(i=!0,t&&this._kernelSession===IS&&(this._kernelSession=""),clearTimeout(s),this._pendingMessages.length>0&&this._sendPending())};n.then(o);let s=setTimeout(o,ibe)}else this._updateStatus("unknown");this._connectionStatusChanged.emit(e)}}async _handleMessage(e){var t,n;let i=!1;if(e.parent_header&&e.channel==="iopub"&&(ss.isDisplayDataMsg(e)||ss.isUpdateDisplayDataMsg(e)||ss.isExecuteResultMsg(e))){let s=((t=e.content.transient)!==null&&t!==void 0?t:{}).display_id;s&&(i=await this._handleDisplayId(s,e),this._assertCurrentMessage(e))}if(!i&&e.parent_header){let o=e.parent_header,s=(n=this._futures)===null||n===void 0?void 0:n.get(o.msg_id);if(s)await s.handleMsg(e),this._assertCurrentMessage(e);else{let a=o.session===this.clientId;e.channel!=="iopub"&&a&&this._unhandledMessage.emit(e)}}if(e.channel==="iopub"){switch(e.header.msg_type){case"status":{let o=e.content.execution_state;o==="restarting"&&Promise.resolve().then(async()=>{this._updateStatus("autorestarting"),this._clearKernelState(),await this.reconnect()}),this._updateStatus(o);break}case"comm_open":this.handleComms&&await this._handleCommOpen(e);break;case"comm_msg":this.handleComms&&await this._handleCommMsg(e);break;case"comm_close":this.handleComms&&await this._handleCommClose(e);break;default:break}this.isDisposed||(this._assertCurrentMessage(e),this._iopubMessage.emit(e))}}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=xa.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.warn(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`);let t=this._selectedProtocol!=="";this._reconnectTimeout=setTimeout(this._createSocket,e,t),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_errorIfDisposed(){if(this.isDisposed)throw new Error("Kernel connection is disposed")}get hasPendingInput(){return this._hasPendingInput}set hasPendingInput(e){this._hasPendingInput=e,this._pendingInput.emit(e)}};Yc.KernelConnection=yV;var xa;(function(r){function e(o){switch(o.status){case"idle":case"busy":case"unknown":return;default:console.debug(`Kernel: ${o.status} (${o.id})`);break}}r.logKernelStatus=e;async function t(o,s){return o.sendShellMessage(s,!0).done}r.handleShellMessage=t;function n(o,s,a){return new Promise((l,u)=>{if(s){if(typeof requirejs=="undefined")throw new Error("requirejs not found");requirejs([s],c=>{if(c[o]===void 0){let d=`Object '${o}' not found in module '${s}'`;u(new Error(d))}else l(c[o])},u)}else a!=null&&a[o]?l(a[o]):u(new Error(`Object '${o}' not found in registry`))})}r.loadObject=n;function i(o,s){return o=Math.ceil(o),s=Math.floor(s),Math.floor(Math.random()*(s-o+1))+o}r.getRandomIntInclusive=i})(xa||(xa={}))});var Y$=re(Dx=>{"use strict";p();Object.defineProperty(Dx,"__esModule",{value:!0});Dx.KernelManager=void 0;var sbe=Lg(),G$=Rs(),abe=ri(),lbe=Og(),M1=x1(),cbe=SV(),Px=class extends lbe.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._kernelConnections=new Set,this._models=new Map,this._runningChanged=new G$.Signal(this),this._connectionFailure=new G$.Signal(this),this._pollModels=new sbe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._kernelConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){var t;let{id:n}=e.model,i=(t=e.handleComms)!==null&&t!==void 0?t:!0;if(e.handleComms===void 0){for(let s of this._kernelConnections)if(s.id===n&&s.handleComms){i=!1;break}}let o=new cbe.KernelConnection({handleComms:i,...e,serverSettings:this.serverSettings});return this._onStarted(o),this._models.has(n)||this.refreshRunning().catch(()=>{}),o}running(){return this._models.values()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e={},t={}){let n=await(0,M1.startNew)(e,this.serverSettings);return this.connectTo({...t,model:n})}async shutdown(e){await(0,M1.shutdownKernel)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>(0,M1.shutdownKernel)(e,this.serverSettings))),await this.refreshRunning()}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async requestRunning(){var e,t;let n;try{n=await(0,M1.listRunning)(this.serverSettings)}catch(i){throw(i instanceof abe.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&n.every(i=>{let o=this._models.get(i.id);return o?o.connections===i.connections&&o.execution_state===i.execution_state&&o.last_activity===i.last_activity&&o.name===i.name&&o.reason===i.reason&&o.traceback===i.traceback:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._kernelConnections.forEach(i=>{this._models.has(i.id)||i.handleShutdown()}),this._runningChanged.emit(n))}_onStarted(e){this._kernelConnections.add(e),e.statusChanged.connect(this._onStatusChanged,this),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._kernelConnections.delete(e),this.refreshRunning().catch(()=>{})}_onStatusChanged(e,t){t==="dead"&&this.refreshRunning().catch(()=>{})}};Dx.KernelManager=Px;(function(r){class e extends r{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}async startNew(n={},i={}){return Promise.reject(new Error("Not implemented in no-op Kernel Manager"))}connectTo(n){throw new Error("Not implemented in no-op Kernel Manager")}async shutdown(n){return Promise.reject(new Error("Not implemented in no-op Kernel Manager"))}get ready(){return this.parentReady.then(()=>this._readyPromise)}async requestRunning(){return Promise.resolve()}}r.NoopManager=e})(Px||(Dx.KernelManager=Px={}))});var _V=re(ni=>{"use strict";p();var $$=ni&&ni.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ube=ni&&ni.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),IV=ni&&ni.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&$$(e,r,t);return ube(e,r),e},dbe=ni&&ni.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&$$(e,r,t)};Object.defineProperty(ni,"__esModule",{value:!0});ni.KernelConnection=ni.KernelAPI=ni.KernelMessage=ni.Kernel=void 0;var pbe=IV(E$());ni.Kernel=pbe;var fbe=IV(hS());ni.KernelMessage=fbe;var mbe=IV(x1());ni.KernelAPI=mbe;var hbe=SV();Object.defineProperty(ni,"KernelConnection",{enumerable:!0,get:function(){return hbe.KernelConnection}});dbe(Y$(),ni)});var z$=re(O1=>{"use strict";p();Object.defineProperty(O1,"__esModule",{value:!0});O1.BuildManager=void 0;var EV=ro(),Vf=Do(),gbe="api/build",CV=class{constructor(e={}){var t;this._url="",this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Vf.ServerConnection.makeSettings();let{baseUrl:n,appUrl:i}=this.serverSettings;this._url=EV.URLExt.join(n,i,gbe)}get isAvailable(){return EV.PageConfig.getOption("buildAvailable").toLowerCase()==="true"}get shouldCheck(){return EV.PageConfig.getOption("buildCheck").toLowerCase()==="true"}getStatus(){let{_url:e,serverSettings:t}=this;return Vf.ServerConnection.makeRequest(e,{},t).then(i=>{if(i.status!==200)throw new Vf.ServerConnection.ResponseError(i);return i.json()}).then(i=>{if(typeof i.status!="string")throw new Error("Invalid data");if(typeof i.message!="string")throw new Error("Invalid data");return i})}build(){let{_url:e,serverSettings:t}=this,n={method:"POST"};return Vf.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status===400)throw new Vf.ServerConnection.ResponseError(o,"Build aborted");if(o.status!==200){let s=`Build failed with ${o.status}.

        If you are experiencing the build failure after installing an extension (or trying to include previously installed extension after updating JupyterLab) please check the extension repository for new installation instructions as many extensions migrated to the prebuilt extensions system which no longer requires rebuilding JupyterLab (but uses a different installation procedure, typically involving a package manager such as 'pip' or 'conda').

        If you specifically intended to install a source extension, please run 'jupyter lab build' on the server for full output.`;throw new Vf.ServerConnection.ResponseError(o,s)}})}cancel(){let{_url:e,serverSettings:t}=this,n={method:"DELETE"};return Vf.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status!==204)throw new Vf.ServerConnection.ResponseError(o)})}};O1.BuildManager=CV});var PV=re(L1=>{"use strict";p();Object.defineProperty(L1,"__esModule",{value:!0});L1.NbConvertManager=void 0;var vbe=ro(),wV=Do(),ybe=Wc(),bbe="api/nbconvert",xV=class{constructor(e={}){var t;this._exportFormats=null,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:wV.ServerConnection.makeSettings()}async fetchExportFormats(){this._requestingFormats=new ybe.PromiseDelegate,this._exportFormats=null;let e=this.serverSettings.baseUrl,t=vbe.URLExt.join(e,bbe),{serverSettings:n}=this,i=await wV.ServerConnection.makeRequest(t,{},n);if(i.status!==200)throw await wV.ServerConnection.ResponseError.create(i);let o=await i.json(),s={};return Object.keys(o).forEach(function(l){let u=o[l].output_mimetype;s[l]={output_mimetype:u}}),this._exportFormats=s,this._requestingFormats.resolve(s),s}async getExportFormats(e=!0){return this._requestingFormats?this._requestingFormats.promise:e||!this._exportFormats?await this.fetchExportFormats():this._exportFormats}};L1.NbConvertManager=xV});var X$=re(Q$=>{"use strict";p();Object.defineProperty(Q$,"__esModule",{value:!0})});var ez=re(jf=>{"use strict";p();Object.defineProperty(jf,"__esModule",{value:!0});jf.validateModels=jf.updateLegacySessionModel=jf.validateModel=void 0;var Sbe=C1(),Tx=Cx();function Z$(r){(0,Tx.validateProperty)(r,"id","string"),(0,Tx.validateProperty)(r,"type","string"),(0,Tx.validateProperty)(r,"name","string"),(0,Tx.validateProperty)(r,"path","string"),(0,Tx.validateProperty)(r,"kernel","object"),(0,Sbe.validateModel)(r.kernel)}jf.validateModel=Z$;function Ibe(r){r.path===void 0&&r.notebook!==void 0&&(r.path=r.notebook.path,r.type="notebook",r.name="")}jf.updateLegacySessionModel=Ibe;function _be(r){if(!Array.isArray(r))throw new Error("Invalid session list");r.forEach(e=>Z$(e))}jf.validateModels=_be});var U1=re(ii=>{"use strict";p();Object.defineProperty(ii,"__esModule",{value:!0});ii.updateSession=ii.startSession=ii.getSessionModel=ii.shutdownSession=ii.getSessionUrl=ii.listRunning=ii.SESSION_SERVICE_URL=void 0;var no=Do(),K1=ro(),Bf=ez();ii.SESSION_SERVICE_URL="api/sessions";async function Ebe(r=no.ServerConnection.makeSettings()){let e=K1.URLExt.join(r.baseUrl,ii.SESSION_SERVICE_URL),t=await no.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await no.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid Session list");return n.forEach(i=>{(0,Bf.updateLegacySessionModel)(i),(0,Bf.validateModel)(i)}),n}ii.listRunning=Ebe;function F1(r,e){let t=K1.URLExt.join(r,ii.SESSION_SERVICE_URL),n=K1.URLExt.join(t,e);if(!n.startsWith(t))throw new Error("Can only be used for services requests");return n}ii.getSessionUrl=F1;async function Cbe(r,e=no.ServerConnection.makeSettings()){var t;let n=F1(e.baseUrl,r),i={method:"DELETE"},o=await no.ServerConnection.makeRequest(n,i,e);if(o.status===404){let a=(t=(await o.json()).message)!==null&&t!==void 0?t:`The session "${r}"" does not exist on the server`;console.warn(a)}else{if(o.status===410)throw new no.ServerConnection.ResponseError(o,"The kernel was deleted but the session was not");if(o.status!==204)throw await no.ServerConnection.ResponseError.create(o)}}ii.shutdownSession=Cbe;async function wbe(r,e=no.ServerConnection.makeSettings()){let t=F1(e.baseUrl,r),n=await no.ServerConnection.makeRequest(t,{},e);if(n.status!==200)throw await no.ServerConnection.ResponseError.create(n);let i=await n.json();return(0,Bf.updateLegacySessionModel)(i),(0,Bf.validateModel)(i),i}ii.getSessionModel=wbe;async function xbe(r,e=no.ServerConnection.makeSettings()){let t=K1.URLExt.join(e.baseUrl,ii.SESSION_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await no.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await no.ServerConnection.ResponseError.create(i);let o=await i.json();return(0,Bf.updateLegacySessionModel)(o),(0,Bf.validateModel)(o),o}ii.startSession=xbe;async function Pbe(r,e=no.ServerConnection.makeSettings()){let t=F1(e.baseUrl,r.id),n={method:"PATCH",body:JSON.stringify(r)},i=await no.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await no.ServerConnection.ResponseError.create(i);let o=await i.json();return(0,Bf.updateLegacySessionModel)(o),(0,Bf.validateModel)(o),o}ii.updateSession=Pbe});var rz=re(W1=>{"use strict";p();Object.defineProperty(W1,"__esModule",{value:!0});W1.SessionConnection=void 0;var $c=Rs(),Dbe=ri(),tz=U1(),Tbe=Wc(),DV=class{constructor(e){var t,n,i,o;this._id="",this._path="",this._name="",this._type="",this._kernel=null,this._isDisposed=!1,this._disposed=new $c.Signal(this),this._kernelChanged=new $c.Signal(this),this._statusChanged=new $c.Signal(this),this._connectionStatusChanged=new $c.Signal(this),this._pendingInput=new $c.Signal(this),this._iopubMessage=new $c.Signal(this),this._unhandledMessage=new $c.Signal(this),this._anyMessage=new $c.Signal(this),this._propertyChanged=new $c.Signal(this),this._id=e.model.id,this._name=e.model.name,this._path=e.model.path,this._type=e.model.type,this._username=(t=e.username)!==null&&t!==void 0?t:"",this._clientId=(n=e.clientId)!==null&&n!==void 0?n:Tbe.UUID.uuid4(),this._connectToKernel=e.connectToKernel,this._kernelConnectionOptions=(i=e.kernelConnectionOptions)!==null&&i!==void 0?i:{},this.serverSettings=(o=e.serverSettings)!==null&&o!==void 0?o:Dbe.ServerConnection.makeSettings(),this.setupKernel(e.model.kernel)}get disposed(){return this._disposed}get kernelChanged(){return this._kernelChanged}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get pendingInput(){return this._pendingInput}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get anyMessage(){return this._anyMessage}get propertyChanged(){return this._propertyChanged}get id(){return this._id}get kernel(){return this._kernel}get path(){return this._path}get type(){return this._type}get name(){return this._name}get model(){return{id:this.id,kernel:this.kernel&&{id:this.kernel.id,name:this.kernel.name},path:this._path,type:this._type,name:this._name}}get isDisposed(){return this._isDisposed}update(e){let t=this.model;if(this._path=e.path,this._name=e.name,this._type=e.type,this._kernel===null&&e.kernel!==null||this._kernel!==null&&e.kernel===null||this._kernel!==null&&e.kernel!==null&&this._kernel.id!==e.kernel.id){this._kernel!==null&&this._kernel.dispose();let n=this._kernel||null;this.setupKernel(e.kernel);let i=this._kernel||null;this._kernelChanged.emit({name:"kernel",oldValue:n,newValue:i})}this._handleModelChange(t)}dispose(){if(!this.isDisposed){if(this._isDisposed=!0,this._disposed.emit(),this._kernel){this._kernel.dispose();let e=this._kernel;this._kernel=null;let t=this._kernel;this._kernelChanged.emit({name:"kernel",oldValue:e,newValue:t})}$c.Signal.clearData(this)}}async setPath(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({path:e})}async setName(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({name:e})}async setType(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({type:e})}async changeKernel(e){if(this.isDisposed)throw new Error("Session is disposed");return await this._patch({kernel:e}),this.kernel}async shutdown(){if(this.isDisposed)throw new Error("Session is disposed");await(0,tz.shutdownSession)(this.id,this.serverSettings),this.dispose()}setupKernel(e){if(e===null){this._kernel=null;return}let t=this._connectToKernel({...this._kernelConnectionOptions,model:e,username:this._username,clientId:this._clientId,serverSettings:this.serverSettings});this._kernel=t,t.statusChanged.connect(this.onKernelStatus,this),t.connectionStatusChanged.connect(this.onKernelConnectionStatus,this),t.pendingInput.connect(this.onPendingInput,this),t.unhandledMessage.connect(this.onUnhandledMessage,this),t.iopubMessage.connect(this.onIOPubMessage,this),t.anyMessage.connect(this.onAnyMessage,this)}onKernelStatus(e,t){this._statusChanged.emit(t)}onKernelConnectionStatus(e,t){this._connectionStatusChanged.emit(t)}onPendingInput(e,t){this._pendingInput.emit(t)}onIOPubMessage(e,t){this._iopubMessage.emit(t)}onUnhandledMessage(e,t){this._unhandledMessage.emit(t)}onAnyMessage(e,t){this._anyMessage.emit(t)}async _patch(e){let t=await(0,tz.updateSession)({...e,id:this._id},this.serverSettings);return this.update(t),t}_handleModelChange(e){e.name!==this._name&&this._propertyChanged.emit("name"),e.type!==this._type&&this._propertyChanged.emit("type"),e.path!==this._path&&this._propertyChanged.emit("path")}};W1.SessionConnection=DV});var iz=re(Rx=>{"use strict";p();Object.defineProperty(Rx,"__esModule",{value:!0});Rx.SessionManager=void 0;var kbe=Lg(),nz=Rs(),Nbe=Do(),Rbe=Og(),Abe=rz(),kx=U1(),Nx=class extends Rbe.BaseManager{constructor(e){var t;super(e),this._isReady=!1,this._sessionConnections=new Set,this._models=new Map,this._runningChanged=new nz.Signal(this),this._connectionFailure=new nz.Signal(this),this._connectToKernel=n=>this._kernelManager.connectTo(n),this._kernelManager=e.kernelManager,this._pollModels=new kbe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:SessionManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._kernelManager.isActive&&await this._kernelManager.ready,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._sessionConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){let t=new Abe.SessionConnection({...e,connectToKernel:this._connectToKernel,serverSettings:this.serverSettings});return this._onStarted(t),this._models.has(e.model.id)||this.refreshRunning().catch(()=>{}),t}running(){return this._models.values()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e,t={}){let n=await(0,kx.startSession)(e,this.serverSettings);return await this.refreshRunning(),this.connectTo({...t,model:n})}async shutdown(e){await(0,kx.shutdownSession)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>(0,kx.shutdownSession)(e,this.serverSettings))),await this.refreshRunning()}async stopIfNeeded(e){try{let n=(await(0,kx.listRunning)(this.serverSettings)).filter(i=>i.path===e);if(n.length===1){let i=n[0].id;await this.shutdown(i)}}catch(t){}}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async findByPath(e){for(let t of this._models.values())if(t.path===e)return t;await this.refreshRunning();for(let t of this._models.values())if(t.path===e)return t}async requestRunning(){var e,t;let n;try{n=await(0,kx.listRunning)(this.serverSettings)}catch(i){throw(i instanceof Nbe.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&n.every(i=>{var o,s,a,l;let u=this._models.get(i.id);return u?((o=u.kernel)===null||o===void 0?void 0:o.id)===((s=i.kernel)===null||s===void 0?void 0:s.id)&&((a=u.kernel)===null||a===void 0?void 0:a.name)===((l=i.kernel)===null||l===void 0?void 0:l.name)&&u.name===i.name&&u.path===i.path&&u.type===i.type:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._sessionConnections.forEach(i=>{this._models.has(i.id)?i.update(this._models.get(i.id)):i.dispose()}),this._runningChanged.emit(n))}_onStarted(e){this._sessionConnections.add(e),e.disposed.connect(this._onDisposed,this),e.propertyChanged.connect(this._onChanged,this),e.kernelChanged.connect(this._onChanged,this)}_onDisposed(e){this._sessionConnections.delete(e),this.refreshRunning().catch(()=>{})}_onChanged(){this.refreshRunning().catch(()=>{})}};Rx.SessionManager=Nx;(function(r){class e extends r{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}async startNew(n,i={}){return Promise.reject(new Error("Not implemented in no-op Session Manager"))}connectTo(n){throw Error("Not implemented in no-op Session Manager")}get ready(){return this.parentReady.then(()=>this._readyPromise)}async shutdown(n){return Promise.reject(new Error("Not implemented in no-op Session Manager"))}async requestRunning(){return Promise.resolve()}}r.NoopManager=e})(Nx||(Rx.SessionManager=Nx={}))});var TV=re(ko=>{"use strict";p();var oz=ko&&ko.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Mbe=ko&&ko.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),sz=ko&&ko.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&oz(e,r,t);return Mbe(e,r),e},Obe=ko&&ko.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&oz(e,r,t)};Object.defineProperty(ko,"__esModule",{value:!0});ko.SessionAPI=ko.Session=void 0;var Lbe=sz(X$());ko.Session=Lbe;var Kbe=sz(U1());ko.SessionAPI=Kbe;Obe(iz(),ko)});var az=re(V1=>{"use strict";p();Object.defineProperty(V1,"__esModule",{value:!0});V1.DataConnector=void 0;var kV=class{async list(e){throw new Error("DataConnector#list method has not been implemented.")}async remove(e){throw new Error("DataConnector#remove method has not been implemented.")}async save(e,t){throw new Error("DataConnector#save method has not been implemented.")}};V1.DataConnector=kV});var cz=re(lz=>{"use strict";p();Object.defineProperty(lz,"__esModule",{value:!0})});var NV=re((j1,uz)=>{p();(function(r,e){typeof j1=="object"&&typeof uz!="undefined"?e(j1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(j1,function(r){"use strict";r.ArrayExt=void 0,function(h){function v(R,M,S=0,I=-1){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(S+j)%_;if(R[me]===M)return me}return-1}h.firstIndexOf=v;function C(R,M,S=-1,I=0){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(S-j+_)%_;if(R[me]===M)return me}return-1}h.lastIndexOf=C;function k(R,M,S=0,I=-1){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j){let me=(S+j)%_;if(M(R[me],me))return me}return-1}h.findFirstIndex=k;function H(R,M,S=-1,I=0){let _=R.length;if(_===0)return-1;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;S<I?F=S+1+(_-I):F=S-I+1;for(let j=0;j<F;++j){let me=(S-j+_)%_;if(M(R[me],me))return me}return-1}h.findLastIndex=H;function Y(R,M,S=0,I=-1){let _=k(R,M,S,I);return _!==-1?R[_]:void 0}h.findFirstValue=Y;function Z(R,M,S=-1,I=0){let _=H(R,M,S,I);return _!==-1?R[_]:void 0}h.findLastValue=Z;function ie(R,M,S,I=0,_=-1){let F=R.length;if(F===0)return 0;I<0?I=Math.max(0,I+F):I=Math.min(I,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=I,me=_-I+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;S(R[Q],M)<0?(j=Q+1,me-=Fe+1):me=Fe}return j}h.lowerBound=ie;function ce(R,M,S,I=0,_=-1){let F=R.length;if(F===0)return 0;I<0?I=Math.max(0,I+F):I=Math.min(I,F-1),_<0?_=Math.max(0,_+F):_=Math.min(_,F-1);let j=I,me=_-I+1;for(;me>0;){let Fe=me>>1,Q=j+Fe;S(R[Q],M)>0?me=Fe:(j=Q+1,me-=Fe+1)}return j}h.upperBound=ce;function be(R,M,S){if(R===M)return!0;if(R.length!==M.length)return!1;for(let I=0,_=R.length;I<_;++I)if(S?!S(R[I],M[I]):R[I]!==M[I])return!1;return!0}h.shallowEqual=be;function q(R,M={}){let{start:S,stop:I,step:_}=M;if(_===void 0&&(_=1),_===0)throw new Error("Slice `step` cannot be zero.");let F=R.length;S===void 0?S=_<0?F-1:0:S<0?S=Math.max(S+F,_<0?-1:0):S>=F&&(S=_<0?F-1:F),I===void 0?I=_<0?-1:F:I<0?I=Math.max(I+F,_<0?-1:0):I>=F&&(I=_<0?F-1:F);let j;_<0&&I>=S||_>0&&S>=I?j=0:_<0?j=Math.floor((I-S+1)/_+1):j=Math.floor((I-S-1)/_+1);let me=[];for(let Fe=0;Fe<j;++Fe)me[Fe]=R[S+Fe*_];return me}h.slice=q;function $(R,M,S){let I=R.length;if(I<=1||(M<0?M=Math.max(0,M+I):M=Math.min(M,I-1),S<0?S=Math.max(0,S+I):S=Math.min(S,I-1),M===S))return;let _=R[M],F=M<S?1:-1;for(let j=M;j!==S;j+=F)R[j]=R[j+F];R[S]=_}h.move=$;function de(R,M=0,S=-1){let I=R.length;if(!(I<=1))for(M<0?M=Math.max(0,M+I):M=Math.min(M,I-1),S<0?S=Math.max(0,S+I):S=Math.min(S,I-1);M<S;){let _=R[M],F=R[S];R[M++]=F,R[S--]=_}}h.reverse=de;function pe(R,M,S=0,I=-1){let _=R.length;if(_<=1||(S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1),S>=I))return;let F=I-S+1;if(M>0?M=M%F:M<0&&(M=(M%F+F)%F),M===0)return;let j=S+M;de(R,S,j-1),de(R,j,I),de(R,S,I)}h.rotate=pe;function ye(R,M,S=0,I=-1){let _=R.length;if(_===0)return;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F;I<S?F=I+1+(_-S):F=I-S+1;for(let j=0;j<F;++j)R[(S+j)%_]=M}h.fill=ye;function z(R,M,S){let I=R.length;M<0?M=Math.max(0,M+I):M=Math.min(M,I);for(let _=I;_>M;--_)R[_]=R[_-1];R[M]=S}h.insert=z;function fe(R,M){let S=R.length;if(M<0&&(M+=S),M<0||M>=S)return;let I=R[M];for(let _=M+1;_<S;++_)R[_-1]=R[_];return R.length=S-1,I}h.removeAt=fe;function Ie(R,M,S=0,I=-1){let _=v(R,M,S,I);return _!==-1&&fe(R,_),_}h.removeFirstOf=Ie;function Te(R,M,S=-1,I=0){let _=C(R,M,S,I);return _!==-1&&fe(R,_),_}h.removeLastOf=Te;function Le(R,M,S=0,I=-1){let _=R.length;if(_===0)return 0;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F=0;for(let j=0;j<_;++j)S<=I&&j>=S&&j<=I&&R[j]===M||I<S&&(j<=I||j>=S)&&R[j]===M?F++:F>0&&(R[j-F]=R[j]);return F>0&&(R.length=_-F),F}h.removeAllOf=Le;function $e(R,M,S=0,I=-1){let _,F=k(R,M,S,I);return F!==-1&&(_=fe(R,F)),{index:F,value:_}}h.removeFirstWhere=$e;function Ge(R,M,S=-1,I=0){let _,F=H(R,M,S,I);return F!==-1&&(_=fe(R,F)),{index:F,value:_}}h.removeLastWhere=Ge;function Bt(R,M,S=0,I=-1){let _=R.length;if(_===0)return 0;S<0?S=Math.max(0,S+_):S=Math.min(S,_-1),I<0?I=Math.max(0,I+_):I=Math.min(I,_-1);let F=0;for(let j=0;j<_;++j)S<=I&&j>=S&&j<=I&&M(R[j],j)||I<S&&(j<=I||j>=S)&&M(R[j],j)?F++:F>0&&(R[j-F]=R[j]);return F>0&&(R.length=_-F),F}h.removeAllWhere=Bt}(r.ArrayExt||(r.ArrayExt={}));function*e(...h){for(let v of h)yield*v}function*t(){}function*n(h,v=0){for(let C of h)yield[v++,C]}function*i(h,v){let C=0;for(let k of h)v(k,C++)&&(yield k)}function o(h,v){let C=0;for(let k of h)if(v(k,C++))return k}function s(h,v){let C=0;for(let k of h)if(v(k,C++))return C-1;return-1}function a(h,v){let C;for(let k of h){if(C===void 0){C=k;continue}v(k,C)<0&&(C=k)}return C}function l(h,v){let C;for(let k of h){if(C===void 0){C=k;continue}v(k,C)>0&&(C=k)}return C}function u(h,v){let C=!0,k,H;for(let Y of h)C?(k=Y,H=Y,C=!1):v(Y,k)<0?k=Y:v(Y,H)>0&&(H=Y);return C?void 0:[k,H]}function c(h){return Array.from(h)}function d(h){let v={};for(let[C,k]of h)v[C]=k;return v}function f(h,v){let C=0;for(let k of h)if(v(k,C++)===!1)return}function m(h,v){let C=0;for(let k of h)if(v(k,C++)===!1)return!1;return!0}function g(h,v){let C=0;for(let k of h)if(v(k,C++))return!0;return!1}function*b(h,v){let C=0;for(let k of h)yield v(k,C++)}function*y(h,v,C){v===void 0?(v=h,h=0,C=1):C===void 0&&(C=1);let k=P.rangeLength(h,v,C);for(let H=0;H<k;H++)yield h+C*H}var P;(function(h){function v(C,k,H){return H===0?1/0:C>k&&H>0||C<k&&H<0?0:Math.ceil((k-C)/H)}h.rangeLength=v})(P||(P={}));function A(h,v,C){let k=h[Symbol.iterator](),H=0,Y=k.next();if(Y.done&&C===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Y.done)return C;let Z=k.next();if(Z.done&&C===void 0)return Y.value;if(Z.done)return v(C,Y.value,H++);let ie;C===void 0?ie=v(Y.value,Z.value,H++):ie=v(v(C,Y.value,H++),Z.value,H++);let ce;for(;!(ce=k.next()).done;)ie=v(ie,ce.value,H++);return ie}function*D(h,v){for(;0<v--;)yield h}function*T(h){yield h}function*K(h){if(typeof h.retro=="function")yield*h.retro();else for(let v=h.length-1;v>-1;v--)yield h[v]}function L(h){let v=[],C=new Set,k=new Map;for(let Z of h)H(Z);for(let[Z]of k)Y(Z);return v;function H(Z){let[ie,ce]=Z,be=k.get(ce);be?be.push(ie):k.set(ce,[ie])}function Y(Z){if(C.has(Z))return;C.add(Z);let ie=k.get(Z);if(ie)for(let ce of ie)Y(ce);v.push(Z)}}function*B(h,v){let C=0;for(let k of h)C++%v===0&&(yield k)}r.StringExt=void 0,function(h){function v(Z,ie,ce=0){let be=new Array(ie.length);for(let q=0,$=ce,de=ie.length;q<de;++q,++$){if($=Z.indexOf(ie[q],$),$===-1)return null;be[q]=$}return be}h.findIndices=v;function C(Z,ie,ce=0){let be=v(Z,ie,ce);if(!be)return null;let q=0;for(let $=0,de=be.length;$<de;++$){let pe=be[$]-ce;q+=pe*pe}return{score:q,indices:be}}h.matchSumOfSquares=C;function k(Z,ie,ce=0){let be=v(Z,ie,ce);if(!be)return null;let q=0,$=ce-1;for(let de=0,pe=be.length;de<pe;++de){let ye=be[de];q+=ye-$-1,$=ye}return{score:q,indices:be}}h.matchSumOfDeltas=k;function H(Z,ie,ce){let be=[],q=0,$=0,de=ie.length;for(;q<de;){let pe=ie[q],ye=ie[q];for(;++q<de&&ie[q]===ye+1;)ye++;$<pe&&be.push(Z.slice($,pe)),pe<ye+1&&be.push(ce(Z.slice(pe,ye+1))),$=ye+1}return $<Z.length&&be.push(Z.slice($)),be}h.highlight=H;function Y(Z,ie){return Z<ie?-1:Z>ie?1:0}h.cmp=Y}(r.StringExt||(r.StringExt={}));function*N(h,v){if(v<1)return;let C=h[Symbol.iterator](),k;for(;0<v--&&!(k=C.next()).done;)yield k.value}function*O(...h){let v=h.map(k=>k[Symbol.iterator]()),C=v.map(k=>k.next());for(;m(C,k=>!k.done);C=v.map(k=>k.next()))yield C.map(k=>k.value)}r.chain=e,r.each=f,r.empty=t,r.enumerate=n,r.every=m,r.filter=i,r.find=o,r.findIndex=s,r.map=b,r.max=l,r.min=a,r.minmax=u,r.once=T,r.range=y,r.reduce=A,r.repeat=D,r.retro=K,r.some=g,r.stride=B,r.take=N,r.toArray=c,r.toObject=d,r.topologicSort=L,r.zip=O})});var H1=re((B1,dz)=>{p();(function(r,e){typeof B1=="object"&&typeof dz!="undefined"?e(B1,NV()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={},r.lumino_algorithm))})(B1,function(r,e){"use strict";r.JSONExt=void 0,function(u){u.emptyObject=Object.freeze({}),u.emptyArray=Object.freeze([]);function c(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"}u.isPrimitive=c;function d(D){return Array.isArray(D)}u.isArray=d;function f(D){return!c(D)&&!d(D)}u.isObject=f;function m(D,T){if(D===T)return!0;if(c(D)||c(T))return!1;let K=d(D),L=d(T);return K!==L?!1:K&&L?b(D,T):y(D,T)}u.deepEqual=m;function g(D){return c(D)?D:d(D)?P(D):A(D)}u.deepCopy=g;function b(D,T){if(D===T)return!0;if(D.length!==T.length)return!1;for(let K=0,L=D.length;K<L;++K)if(!m(D[K],T[K]))return!1;return!0}function y(D,T){if(D===T)return!0;for(let K in D)if(D[K]!==void 0&&!(K in T))return!1;for(let K in T)if(T[K]!==void 0&&!(K in D))return!1;for(let K in D){let L=D[K],B=T[K];if(!(L===void 0&&B===void 0)&&(L===void 0||B===void 0||!m(L,B)))return!1}return!0}function P(D){let T=new Array(D.length);for(let K=0,L=D.length;K<L;++K)T[K]=g(D[K]);return T}function A(D){let T={};for(let K in D){let L=D[K];L!==void 0&&(T[K]=g(L))}return T}}(r.JSONExt||(r.JSONExt={}));class t{constructor(){this._types=[],this._values=[]}types(){return this._types.slice()}hasData(c){return this._types.indexOf(c)!==-1}getData(c){let d=this._types.indexOf(c);return d!==-1?this._values[d]:void 0}setData(c,d){this.clearData(c),this._types.push(c),this._values.push(d)}clearData(c){let d=this._types.indexOf(c);d!==-1&&(this._types.splice(d,1),this._values.splice(d,1))}clear(){this._types.length=0,this._values.length=0}}class n{constructor(c={}){this._application=null,this._validatePlugin=()=>!0,this._plugins=new Map,this._services=new Map,c.validatePlugin&&(console.info("Plugins may be rejected by the custom validation plugin method."),this._validatePlugin=c.validatePlugin)}get application(){return this._application}set application(c){if(this._application!==null)throw Error("PluginRegistry.application is already set. It cannot be overridden.");this._application=c}get deferredPlugins(){return Array.from(this._plugins).filter(([c,d])=>d.autoStart==="defer").map(([c,d])=>c)}getPluginDescription(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.description)!==null&&f!==void 0?f:""}hasPlugin(c){return this._plugins.has(c)}isPluginActivated(c){var d,f;return(f=(d=this._plugins.get(c))===null||d===void 0?void 0:d.activated)!==null&&f!==void 0?f:!1}listPlugins(){return Array.from(this._plugins.keys())}registerPlugin(c){if(this._plugins.has(c.id))throw new TypeError(`Plugin '${c.id}' is already registered.`);if(!this._validatePlugin(c))throw new Error(`Plugin '${c.id}' is not valid.`);let d=i.createPluginData(c);i.ensureNoCycle(d,this._plugins,this._services),d.provides&&this._services.set(d.provides,d.id),this._plugins.set(d.id,d)}registerPlugins(c){for(let d of c)this.registerPlugin(d)}deregisterPlugin(c,d){let f=this._plugins.get(c);if(f){if(f.activated&&!d)throw new Error(`Plugin '${c}' is still active.`);this._plugins.delete(c)}}async activatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(d.activated)return;if(d.promise)return d.promise;let f=d.requires.map(g=>this.resolveRequiredService(g)),m=d.optional.map(g=>this.resolveOptionalService(g));return d.promise=Promise.all([...f,...m]).then(g=>d.activate.apply(void 0,[this.application,...g])).then(g=>{d.service=g,d.activated=!0,d.promise=null}).catch(g=>{throw d.promise=null,g}),d.promise}async activatePlugins(c,d={}){switch(c){case"defer":{let f=this.deferredPlugins.filter(m=>this._plugins.get(m).autoStart).map(m=>this.activatePlugin(m));await Promise.all(f);break}case"startUp":{let m=i.collectStartupPlugins(this._plugins,d).map(async g=>{try{return await this.activatePlugin(g)}catch(b){console.error(`Plugin '${g}' failed to activate.`,b)}});await Promise.all(m);break}}}async deactivatePlugin(c){let d=this._plugins.get(c);if(!d)throw new ReferenceError(`Plugin '${c}' is not registered.`);if(!d.activated)return[];if(!d.deactivate)throw new TypeError(`Plugin '${c}'#deactivate() method missing`);let f=i.findDependents(c,this._plugins,this._services),m=f.map(g=>this._plugins.get(g));for(let g of m)if(!g.deactivate)throw new TypeError(`Plugin ${g.id}#deactivate() method missing (depends on ${c})`);for(let g of m){let b=[...g.requires,...g.optional].map(y=>{let P=this._services.get(y);return P?this._plugins.get(P).service:null});await g.deactivate(this.application,...b),g.service=null,g.activated=!1}return f.pop(),f}async resolveRequiredService(c){let d=this._services.get(c);if(!d)throw new TypeError(`No provider for: ${c.name}.`);let f=this._plugins.get(d);return f.activated||await this.activatePlugin(d),f.service}async resolveOptionalService(c){let d=this._services.get(c);if(!d)return null;let f=this._plugins.get(d);if(!f.activated)try{await this.activatePlugin(d)}catch(m){return console.error(m),null}return f.service}}var i;(function(u){class c{constructor(y){var P,A,D,T;this._activated=!1,this._promise=null,this._service=null,this.id=y.id,this.description=(P=y.description)!==null&&P!==void 0?P:"",this.activate=y.activate,this.deactivate=(A=y.deactivate)!==null&&A!==void 0?A:null,this.provides=(D=y.provides)!==null&&D!==void 0?D:null,this.autoStart=(T=y.autoStart)!==null&&T!==void 0?T:!1,this.requires=y.requires?y.requires.slice():[],this.optional=y.optional?y.optional.slice():[]}get activated(){return this._activated}set activated(y){this._activated=y}get service(){return this._service}set service(y){this._service=y}get promise(){return this._promise}set promise(y){this._promise=y}}function d(b){return new c(b)}u.createPluginData=d;function f(b,y,P){let A=[...b.requires,...b.optional],D=K=>{if(K===b.provides)return!0;let L=P.get(K);if(!L)return!1;let B=y.get(L),N=[...B.requires,...B.optional];return N.length===0?!1:(T.push(L),N.some(D)?!0:(T.pop(),!1))};if(!b.provides||A.length===0)return;let T=[b.id];if(A.some(D))throw new ReferenceError(`Cycle detected: ${T.join(" -> ")}.`)}u.ensureNoCycle=f;function m(b,y,P){let A=new Array,D=N=>{let O=y.get(N),h=[...O.requires,...O.optional];A.push(...h.reduce((v,C)=>{let k=P.get(C);return k&&v.push([N,k]),v},[]))};for(let N of y.keys())D(N);let T=A.filter(N=>N[1]===b),K=0;for(;T.length>K;){let N=T.length,O=new Set(T.map(h=>h[0]));for(let h of O)A.filter(v=>v[1]===h).forEach(v=>{T.includes(v)||T.push(v)});K=N}let L=e.topologicSort(T),B=L.findIndex(N=>N===b);return B===-1?[b]:L.slice(0,B+1)}u.findDependents=m;function g(b,y){let P=new Set;for(let A of b.keys())b.get(A).autoStart===!0&&P.add(A);if(y.startPlugins)for(let A of y.startPlugins)P.add(A);if(y.ignorePlugins)for(let A of y.ignorePlugins)P.delete(A);return Array.from(P)}u.collectStartupPlugins=g})(i||(i={}));class o{constructor(){this.promise=new Promise((c,d)=>{this._resolve=c,this._reject=d})}resolve(c){let d=this._resolve;d(c)}reject(c){let d=this._reject;d(c)}}class s{constructor(c,d){this.name=c,this.description=d!=null?d:"",this._tokenStructuralPropertyT=null}}function a(u){let c=0;for(let d=0,f=u.length;d<f;++d)d%4===0&&(c=Math.random()*4294967295>>>0),u[d]=c&255,c>>>=8}r.Random=void 0,function(u){u.getRandomValues=(()=>{let c=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return c&&typeof c.getRandomValues=="function"?function(f){return c.getRandomValues(f)}:a})()}(r.Random||(r.Random={}));function l(u){let c=new Uint8Array(16),d=new Array(256);for(let f=0;f<16;++f)d[f]="0"+f.toString(16);for(let f=16;f<256;++f)d[f]=f.toString(16);return function(){return u(c),c[6]=64|c[6]&15,c[8]=128|c[8]&63,d[c[0]]+d[c[1]]+d[c[2]]+d[c[3]]+"-"+d[c[4]]+d[c[5]]+"-"+d[c[6]]+d[c[7]]+"-"+d[c[8]]+d[c[9]]+"-"+d[c[10]]+d[c[11]]+d[c[12]]+d[c[13]]+d[c[14]]+d[c[15]]}}r.UUID=void 0,function(u){u.uuid4=l(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=t,r.PluginRegistry=n,r.PromiseDelegate=o,r.Token=s})});var fz=re((q1,pz)=>{p();(function(r,e){typeof q1=="object"&&typeof pz!="undefined"?e(q1):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_properties={}))})(q1,function(r){"use strict";class e{constructor(i){this._pid=t.nextPID(),this.name=i.name,this._create=i.create,this._coerce=i.coerce||null,this._compare=i.compare||null,this._changed=i.changed||null}get(i){let o,s=t.ensureMap(i);return this._pid in s?o=s[this._pid]:o=s[this._pid]=this._createValue(i),o}set(i,o){let s,a=t.ensureMap(i);this._pid in a?s=a[this._pid]:s=a[this._pid]=this._createValue(i);let l=this._coerceValue(i,o);this._maybeNotify(i,s,a[this._pid]=l)}coerce(i){let o,s=t.ensureMap(i);this._pid in s?o=s[this._pid]:o=s[this._pid]=this._createValue(i);let a=this._coerceValue(i,o);this._maybeNotify(i,o,s[this._pid]=a)}_createValue(i){let o=this._create;return o(i)}_coerceValue(i,o){let s=this._coerce;return s?s(i,o):o}_compareValue(i,o){let s=this._compare;return s?s(i,o):i===o}_maybeNotify(i,o,s){let a=this._changed;a&&!this._compareValue(o,s)&&a(i,o,s)}}(function(n){function i(o){t.ownerData.delete(o)}n.clearData=i})(e||(e={}));var t;(function(n){n.ownerData=new WeakMap,n.nextPID=(()=>{let o=0;return()=>`pid-${`${Math.random()}`.slice(2)}-${o++}`})();function i(o){let s=n.ownerData.get(o);return s||(s=Object.create(null),n.ownerData.set(o,s),s)}n.ensureMap=i})(t||(t={})),r.AttachedProperty=e})});var RV=re((J1,mz)=>{p();(function(r,e){typeof J1=="object"&&typeof mz!="undefined"?e(J1,NV(),H1()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/coreutils"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_coreutils))})(J1,function(r,e,t){"use strict";class n{constructor(a){this.sender=a}connect(a,l){return o.connect(this,a,l)}disconnect(a,l){return o.disconnect(this,a,l)}emit(a){o.emit(this,a)}}(function(s){function a(g,b){o.disconnectBetween(g,b)}s.disconnectBetween=a;function l(g){o.disconnectSender(g)}s.disconnectSender=l;function u(g){o.disconnectReceiver(g)}s.disconnectReceiver=u;function c(g){o.disconnectAll(g)}s.disconnectAll=c;function d(g){o.disconnectAll(g)}s.clearData=d;function f(){return o.exceptionHandler}s.getExceptionHandler=f;function m(g){let b=o.exceptionHandler;return o.exceptionHandler=g,b}s.setExceptionHandler=m})(n||(n={}));class i extends n{constructor(){super(...arguments),this._pending=new t.PromiseDelegate}async*[Symbol.asyncIterator](){let a=this._pending;for(;;)try{let{args:l,next:u}=await a.promise;a=u,yield l}catch(l){return}}emit(a){let l=this._pending,u=this._pending=new t.PromiseDelegate;l.resolve({args:a,next:u}),super.emit(a)}stop(){this._pending.promise.catch(()=>{}),this._pending.reject("stop"),this._pending=new t.PromiseDelegate}}var o;(function(s){s.exceptionHandler=N=>{console.error(N)};function a(N,O,h){h=h||void 0;let v=g.get(N.sender);if(v||(v=[],g.set(N.sender,v)),A(v,N,O,h))return!1;let C=h||O,k=b.get(C);k||(k=[],b.set(C,k));let H={signal:N,slot:O,thisArg:h};return v.push(H),k.push(H),!0}s.connect=a;function l(N,O,h){h=h||void 0;let v=g.get(N.sender);if(!v||v.length===0)return!1;let C=A(v,N,O,h);if(!C)return!1;let k=h||O,H=b.get(k);return C.signal=null,T(v),T(H),!0}s.disconnect=l;function u(N,O){let h=g.get(N);if(!h||h.length===0)return;let v=b.get(O);if(!(!v||v.length===0)){for(let C of v)C.signal&&C.signal.sender===N&&(C.signal=null);T(h),T(v)}}s.disconnectBetween=u;function c(N){let O=g.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let v=h.thisArg||h.slot;h.signal=null,T(b.get(v))}T(O)}}s.disconnectSender=c;function d(N){let O=b.get(N);if(!(!O||O.length===0)){for(let h of O){if(!h.signal)continue;let v=h.signal.sender;h.signal=null,T(g.get(v))}T(O)}}s.disconnectReceiver=d;function f(N){c(N),d(N)}s.disconnectAll=f;function m(N,O){let h=g.get(N.sender);if(!(!h||h.length===0))for(let v=0,C=h.length;v<C;++v){let k=h[v];k.signal===N&&D(k,O)}}s.emit=m;let g=new WeakMap,b=new WeakMap,y=new Set,P=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();function A(N,O,h,v){return e.find(N,C=>C.signal===O&&C.slot===h&&C.thisArg===v)}function D(N,O){let{signal:h,slot:v,thisArg:C}=N;try{v.call(C,h.sender,O)}catch(k){s.exceptionHandler(k)}}function T(N){y.size===0&&P(K),y.add(N)}function K(){y.forEach(L),y.clear()}function L(N){e.ArrayExt.removeAllWhere(N,B)}function B(N){return N.signal===null}})(o||(o={})),r.Signal=n,r.Stream=i})});var gz=re(Y1=>{"use strict";p();Object.defineProperty(Y1,"__esModule",{value:!0});Y1.RestorablePool=void 0;var Fbe=H1(),hz=fz(),G1=RV(),AV=class{constructor(e){this._added=new G1.Signal(this),this._current=null,this._currentChanged=new G1.Signal(this),this._hasRestored=!1,this._isDisposed=!1,this._objects=new Set,this._restore=null,this._restored=new Fbe.PromiseDelegate,this._updated=new G1.Signal(this),this.namespace=e.namespace}get added(){return this._added}get current(){return this._current}set current(e){this._current!==e&&e!==null&&this._objects.has(e)&&(this._current=e,this._currentChanged.emit(this._current))}get currentChanged(){return this._currentChanged}get isDisposed(){return this._isDisposed}get restored(){return this._restored.promise}get size(){return this._objects.size}get updated(){return this._updated}async add(e){var t,n;if(e.isDisposed){let i="A disposed object cannot be added.";throw console.warn(i,e),new Error(i)}if(this._objects.has(e)){let i="This object already exists in the pool.";throw console.warn(i,e),new Error(i)}if(this._objects.add(e),e.disposed.connect(this._onInstanceDisposed,this),!zc.injectedProperty.get(e)){if(this._restore){let{connector:i}=this._restore,o=this._restore.name(e);if(o){let s=`${this.namespace}:${o}`,a=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);zc.nameProperty.set(e,s),await i.save(s,{data:a})}}this._added.emit(e)}}dispose(){this.isDisposed||(this._current=null,this._isDisposed=!0,this._objects.clear(),G1.Signal.clearData(this))}find(e){let t=this._objects.values();for(let n of t)if(e(n))return n}forEach(e){this._objects.forEach(e)}filter(e){let t=[];return this.forEach(n=>{e(n)&&t.push(n)}),t}inject(e){return zc.injectedProperty.set(e,!0),this.add(e)}has(e){return this._objects.has(e)}async restore(e){if(this._hasRestored)throw new Error("This pool has already been restored.");this._hasRestored=!0;let{command:t,connector:n,registry:i,when:o}=e,s=this.namespace,a=o?[n.list(s)].concat(o):[n.list(s)];this._restore=e;let[l]=await Promise.all(a),u=await Promise.all(l.ids.map(async(c,d)=>{let f=l.values[d],m=f&&f.data;return m===void 0?n.remove(c):i.execute(t,m).catch(()=>n.remove(c))}));return this._restored.resolve(),u}async save(e){var t,n;let i=zc.injectedProperty.get(e);if(!this._restore||!this.has(e)||i)return;let{connector:o}=this._restore,s=this._restore.name(e),a=zc.nameProperty.get(e),l=s?`${this.namespace}:${s}`:"";if(a&&a!==l&&await o.remove(a),zc.nameProperty.set(e,l),l){let u=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);await o.save(l,{data:u})}a!==l&&this._updated.emit(e)}_onInstanceDisposed(e){if(this._objects.delete(e),e===this._current&&(this._current=null,this._currentChanged.emit(this._current)),zc.injectedProperty.get(e)||!this._restore)return;let{connector:t}=this._restore,n=zc.nameProperty.get(e);n&&t.remove(n)}};Y1.RestorablePool=AV;var zc;(function(r){r.injectedProperty=new hz.AttachedProperty({name:"injected",create:()=>!1}),r.nameProperty=new hz.AttachedProperty({name:"name",create:()=>""})})(zc||(zc={}))});var vz=re(Mx=>{"use strict";p();Object.defineProperty(Mx,"__esModule",{value:!0});Mx.StateDB=void 0;var Ube=RV(),Ax=class r{constructor(e={}){this._changed=new Ube.Signal(this);let{connector:t,transform:n}=e;this._connector=t||new r.Connector,n?this._ready=n.then(i=>{let{contents:o,type:s}=i;switch(s){case"cancel":return;case"clear":return this._clear();case"merge":return this._merge(o||{});case"overwrite":return this._overwrite(o||{});default:return}}):this._ready=Promise.resolve(void 0)}get changed(){return this._changed}async clear(){await this._ready,await this._clear()}async fetch(e){return await this._ready,this._fetch(e)}async list(e){return await this._ready,this._list(e)}async remove(e){await this._ready,await this._remove(e),this._changed.emit({id:e,type:"remove"})}async save(e,t){await this._ready,await this._save(e,t),this._changed.emit({id:e,type:"save"})}async toJSON(){await this._ready;let{ids:e,values:t}=await this._list();return t.reduce((n,i,o)=>(n[e[o]]=i,n),{})}async _clear(){await Promise.all((await this._list()).ids.map(e=>this._remove(e)))}async _fetch(e){let t=await this._connector.fetch(e);if(t)return JSON.parse(t).v}async _list(e=""){let{ids:t,values:n}=await this._connector.list(e);return{ids:t,values:n.map(i=>JSON.parse(i).v)}}async _merge(e){await Promise.all(Object.keys(e).map(t=>e[t]&&this._save(t,e[t])))}async _overwrite(e){await this._clear(),await this._merge(e)}async _remove(e){return this._connector.remove(e)}async _save(e,t){return this._connector.save(e,JSON.stringify({v:t}))}};Mx.StateDB=Ax;(function(r){class e{constructor(){this._storage={}}async fetch(n){return this._storage[n]}async list(n=""){return Object.keys(this._storage).reduce((i,o)=>((n===""||n===o.split(":")[0])&&(i.ids.push(o),i.values.push(this._storage[o])),i),{ids:[],values:[]})}async remove(n){delete this._storage[n]}async save(n,i){this._storage[n]=i}}r.Connector=e})(Ax||(Mx.StateDB=Ax={}))});var yz=re($1=>{"use strict";p();Object.defineProperty($1,"__esModule",{value:!0});$1.IStateDB=void 0;var Wbe=H1();$1.IStateDB=new Wbe.Token("@jupyterlab/coreutils:IStateDB",`A service for the JupyterLab state database.
  Use this if you want to store data that will persist across page loads.
  See "state database" for more information.`)});var MV=re(Al=>{"use strict";p();var Vbe=Al&&Al.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ox=Al&&Al.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Vbe(e,r,t)};Object.defineProperty(Al,"__esModule",{value:!0});Ox(az(),Al);Ox(cz(),Al);Ox(gz(),Al);Ox(vz(),Al);Ox(yz(),Al)});var KV=re(Q1=>{"use strict";p();Object.defineProperty(Q1,"__esModule",{value:!0});Q1.SettingManager=void 0;var OV=ro(),jbe=MV(),z1=Do(),Bbe="api/settings",LV=class extends jbe.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:z1.ServerConnection.makeSettings()}async fetch(e){if(!e)throw new Error("Plugin `id` parameter is required for settings fetch.");let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=z1.ServerConnection,a=n+i,l=Lx.url(a,e),u=await o(l,{},t);if(u.status!==200)throw await s.create(u);return u.json()}async list(e){var t,n,i,o;let{serverSettings:s}=this,{baseUrl:a,appUrl:l}=s,{makeRequest:u,ResponseError:c}=z1.ServerConnection,d=a+l,f=Lx.url(d,"",e==="ids"),m=await u(f,{},s);if(m.status!==200)throw new c(m);let g=await m.json(),b=(n=(t=g==null?void 0:g.settings)===null||t===void 0?void 0:t.map(P=>P.id))!==null&&n!==void 0?n:[],y=[];return e||(y=(o=(i=g==null?void 0:g.settings)===null||i===void 0?void 0:i.map(P=>(P.data={composite:{},user:{}},P)))!==null&&o!==void 0?o:[]),{ids:b,values:y}}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=z1.ServerConnection,l=i+o,u=Lx.url(l,e),c={body:JSON.stringify({raw:t}),method:"PUT"},d=await s(u,c,n);if(d.status!==204)throw new a(d)}};Q1.SettingManager=LV;var Lx;(function(r){function e(t,n,i){let o=i?OV.URLExt.objectToQueryString({ids_only:!0}):"",s=OV.URLExt.join(t,Bbe),a=OV.URLExt.join(s,n);if(!a.startsWith(s))throw new Error("Can only be used for workspaces requests");return`${a}${o}`}r.url=e})(Lx||(Lx={}))});var Ux=re(No=>{"use strict";p();Object.defineProperty(No,"__esModule",{value:!0});No.shutdownTerminal=No.listRunning=No.startNew=No.isAvailable=No.TERMINAL_SERVICE_URL=void 0;var Kx=ro(),Ad=Do();No.TERMINAL_SERVICE_URL="api/terminals";function bz(){return String(Kx.PageConfig.getOption("terminalsAvailable")).toLowerCase()==="true"}No.isAvailable=bz;async function Hbe(r=Ad.ServerConnection.makeSettings(),e,t){Fx.errorIfNotAvailable();let n=Kx.URLExt.join(r.baseUrl,No.TERMINAL_SERVICE_URL),i={method:"POST",body:JSON.stringify({name:e,cwd:t})},o=await Ad.ServerConnection.makeRequest(n,i,r);if(o.status!==200)throw await Ad.ServerConnection.ResponseError.create(o);return await o.json()}No.startNew=Hbe;async function qbe(r=Ad.ServerConnection.makeSettings()){Fx.errorIfNotAvailable();let e=Kx.URLExt.join(r.baseUrl,No.TERMINAL_SERVICE_URL),t=await Ad.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await Ad.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid terminal list");return n}No.listRunning=qbe;async function Jbe(r,e=Ad.ServerConnection.makeSettings()){var t;Fx.errorIfNotAvailable();let n=Kx.URLExt.join(e.baseUrl,No.TERMINAL_SERVICE_URL),i=Kx.URLExt.join(n,r);if(!i.startsWith(n))throw new Error("Can only be used for terminal requests");let o={method:"DELETE"},s=await Ad.ServerConnection.makeRequest(i,o,e);if(s.status===404){let l=(t=(await s.json()).message)!==null&&t!==void 0?t:`The terminal session "${r}"" does not exist on the server`;console.warn(l)}else if(s.status!==204)throw await Ad.ServerConnection.ResponseError.create(s)}No.shutdownTerminal=Jbe;var Fx;(function(r){function e(){if(!bz())throw new Error("Terminals Unavailable")}r.errorIfNotAvailable=e})(Fx||(Fx={}))});var Sz=re(X1=>{"use strict";p();Object.defineProperty(X1,"__esModule",{value:!0});X1.isAvailable=void 0;var Gbe=Ux();Object.defineProperty(X1,"isAvailable",{enumerable:!0,get:function(){return Gbe.isAvailable}})});var Ez=re(eR=>{"use strict";p();Object.defineProperty(eR,"__esModule",{value:!0});eR.TerminalConnection=void 0;var Iz=ro(),Ybe=Wc(),Z1=Rs(),$be=ri(),_z=Ux(),FV=class r{constructor(e){var t;this._createSocket=()=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let n=this._name,i=this.serverSettings,o=Iz.URLExt.join(i.wsUrl,"terminals","websocket",encodeURIComponent(n)),s=i.token;i.appendToken&&s!==""&&(o=o+`?token=${encodeURIComponent(s)}`),this._ws=new i.WebSocket(o),this._ws.onmessage=this._onWSMessage,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose},this._onWSMessage=n=>{if(this._isDisposed)return;let i=JSON.parse(n.data);if(i[0]==="disconnect"&&this.dispose(),this._connectionStatus==="connecting"){i[0]==="setup"&&this._updateConnectionStatus("connected");return}this._messageReceived.emit({type:i[0],content:i.slice(1)})},this._onWSClose=n=>{console.warn(`Terminal websocket closed: ${n.code}`),this.isDisposed||this._reconnect()},this._connectionStatus="connecting",this._connectionStatusChanged=new Z1.Signal(this),this._isDisposed=!1,this._disposed=new Z1.Signal(this),this._messageReceived=new Z1.Signal(this),this._reconnectTimeout=null,this._ws=null,this._noOp=()=>{},this._reconnectLimit=7,this._reconnectAttempt=0,this._pendingMessages=[],this._name=e.model.name,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:$be.ServerConnection.makeSettings(),this._createSocket()}get disposed(){return this._disposed}get messageReceived(){return this._messageReceived}get name(){return this._name}get model(){return{name:this._name}}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearSocket(),Z1.Signal.clearData(this))}send(e){this._sendMessage(e)}_sendMessage(e,t=!0){if(!(this._isDisposed||!e.content))if(this.connectionStatus==="connected"&&this._ws){let n=[e.type,...e.content];this._ws.send(JSON.stringify(n))}else if(t)this._pendingMessages.push(e);else throw new Error(`Could not send message: ${JSON.stringify(e)}`)}_sendPending(){for(;this.connectionStatus==="connected"&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}reconnect(){this._errorIfDisposed();let e=new Ybe.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Terminal connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=UV.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.error(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`),this._reconnectTimeout=setTimeout(this._createSocket,e),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}async shutdown(){await(0,_z.shutdownTerminal)(this.name,this.serverSettings),this.dispose()}clone(){return new r(this)}_updateConnectionStatus(e){this._connectionStatus!==e&&(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),e==="connected"&&this._sendPending(),this._connectionStatusChanged.emit(e))}_errorIfDisposed(){if(this.isDisposed)throw new Error("Terminal connection is disposed")}get connectionStatusChanged(){return this._connectionStatusChanged}get connectionStatus(){return this._connectionStatus}};eR.TerminalConnection=FV;var UV;(function(r){function e(n,i){return Iz.URLExt.join(n,_z.TERMINAL_SERVICE_URL,encodeURIComponent(i))}r.getTermUrl=e;function t(n,i){return n=Math.ceil(n),i=Math.floor(i),Math.floor(Math.random()*(i-n+1))+n}r.getRandomIntInclusive=t})(UV||(UV={}))});var wz=re(jx=>{"use strict";p();Object.defineProperty(jx,"__esModule",{value:!0});jx.TerminalManager=void 0;var zbe=Lg(),Cz=Rs(),Qbe=ri(),Xbe=Og(),Wx=Ux(),Zbe=Ez(),Vx=class extends Xbe.BaseManager{constructor(e={}){var t;if(super(e),this._isReady=!1,this._names=[],this._terminalConnections=new Set,this._runningChanged=new Cz.Signal(this),this._connectionFailure=new Cz.Signal(this),!this.isAvailable()){this._ready=Promise.reject("Terminals unavailable"),this._ready.catch(n=>{});return}this._pollModels=new zbe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:TerminalManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._names.length=0,this._terminalConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}isAvailable(){return(0,Wx.isAvailable)()}connectTo(e){let t=new Zbe.TerminalConnection({...e,serverSettings:this.serverSettings});return this._onStarted(t),this._names.includes(e.model.name)||this.refreshRunning().catch(()=>{}),t}running(){return this._models[Symbol.iterator]()}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e){let t=await(0,Wx.startNew)(this.serverSettings,e==null?void 0:e.name,e==null?void 0:e.cwd);return await this.refreshRunning(),this.connectTo({model:t})}async shutdown(e){await(0,Wx.shutdownTerminal)(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all(this._names.map(e=>(0,Wx.shutdownTerminal)(e,this.serverSettings))),await this.refreshRunning()}async requestRunning(){var e,t;let n;try{n=await(0,Wx.listRunning)(this.serverSettings)}catch(o){throw(o instanceof Qbe.ServerConnection.NetworkError||((e=o.response)===null||e===void 0?void 0:e.status)===503||((t=o.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(o),o}if(this.isDisposed)return;let i=n.map(({name:o})=>o).sort();i!==this._names&&(this._names=i,this._terminalConnections.forEach(o=>{i.includes(o.name)||o.dispose()}),this._runningChanged.emit(this._models))}_onStarted(e){this._terminalConnections.add(e),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._terminalConnections.delete(e),this.refreshRunning().catch(()=>{})}get _models(){return this._names.map(e=>({name:e}))}};jx.TerminalManager=Vx;(function(r){class e extends r{constructor(){super(...arguments),this._readyPromise=new Promise(()=>{})}get isActive(){return!1}get parentReady(){return super.ready}get ready(){return this.parentReady.then(()=>this._readyPromise)}async startNew(n){return Promise.reject(new Error("Not implemented in no-op Terminal Manager"))}connectTo(n){throw Error("Not implemented in no-op Terminal Manager")}async shutdown(n){return Promise.reject(new Error("Not implemented in no-op Terminal Manager"))}async requestRunning(){return Promise.resolve()}}r.NoopManager=e})(Vx||(jx.TerminalManager=Vx={}))});var WV=re(Ro=>{"use strict";p();var xz=Ro&&Ro.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),eSe=Ro&&Ro.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Pz=Ro&&Ro.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&xz(e,r,t);return eSe(e,r),e},tSe=Ro&&Ro.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&xz(e,r,t)};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.TerminalAPI=Ro.Terminal=void 0;var rSe=Pz(Sz());Ro.Terminal=rSe;var nSe=Pz(Ux());Ro.TerminalAPI=nSe;tSe(wz(),Ro)});var HV=re(tR=>{"use strict";p();Object.defineProperty(tR,"__esModule",{value:!0});tR.UserManager=void 0;var iSe=ro(),oSe=Wc(),sSe=Lg(),Dz=Rs(),aSe=Do(),lSe=Og(),cSe="api/me",VV="@jupyterlab/services:UserManager#user",jV=class extends lSe.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._userChanged=new Dz.Signal(this),this._connectionFailure=new Dz.Signal(this),this._ready=this.requestUser().then(()=>{this.isDisposed||(this._isReady=!0)}).catch(n=>new Promise(()=>{})),this._pollSpecs=new sSe.Poll({auto:!1,factory:()=>this.requestUser(),frequency:{interval:61*1e3,backoff:!0,max:300*1e3},name:VV,standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this.ready.then(()=>{this._pollSpecs.start()})}get isReady(){return this._isReady}get ready(){return this._ready}get identity(){return this._identity}get permissions(){return this._permissions}get userChanged(){return this._userChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose(),super.dispose()}async refreshUser(){await this._pollSpecs.refresh(),await this._pollSpecs.tick}async requestUser(){if(this.isDisposed)return;let{baseUrl:e}=this.serverSettings,{makeRequest:t,ResponseError:n}=aSe.ServerConnection,i=iSe.URLExt.join(e,cSe),o=await t(i,{},this.serverSettings);if(o.status!==200)throw await n.create(o);let s={identity:this._identity,permissions:this._permissions},a=await o.json(),l=a.identity,{localStorage:u}=window,c=u.getItem(VV);if(c&&(!l.initials||!l.color)){let d=JSON.parse(c);l.initials=l.initials||d.initials||l.name.substring(0,1),l.color=l.color||d.color||BV.getRandomColor()}oSe.JSONExt.deepEqual(a,s)||(this._identity=l,this._permissions=a.permissions,u.setItem(VV,JSON.stringify(l)),this._userChanged.emit(a))}};tR.UserManager=jV;var BV;(function(r){let e=["var(--jp-collaborator-color1)","var(--jp-collaborator-color2)","var(--jp-collaborator-color3)","var(--jp-collaborator-color4)","var(--jp-collaborator-color5)","var(--jp-collaborator-color6)","var(--jp-collaborator-color7)"];r.getRandomColor=()=>e[Math.floor(Math.random()*e.length)]})(BV||(BV={}))});var JV=re(rR=>{"use strict";p();Object.defineProperty(rR,"__esModule",{value:!0});rR.WorkspaceManager=void 0;var Tz=ro(),uSe=MV(),Bx=Do(),dSe="api/workspaces",qV=class extends uSe.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Bx.ServerConnection.makeSettings()}async fetch(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Bx.ServerConnection,a=n+i,l=_S.url(a,e),u=await o(l,{},t);if(u.status!==200)throw await s.create(u);return u.json()}async list(){let{serverSettings:e}=this,{baseUrl:t,appUrl:n}=e,{makeRequest:i,ResponseError:o}=Bx.ServerConnection,s=t+n,a=_S.url(s,""),l=await i(a,{},e);if(l.status!==200)throw await o.create(l);return(await l.json()).workspaces}async remove(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Bx.ServerConnection,a=n+i,l=_S.url(a,e),c=await o(l,{method:"DELETE"},t);if(c.status!==204)throw await s.create(c)}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=Bx.ServerConnection,l=i+o,u=_S.url(l,e),c={body:JSON.stringify(t),method:"PUT"},d=await s(u,c,n);if(d.status!==204)throw await a.create(d)}};rR.WorkspaceManager=qV;var _S;(function(r){function e(t,n){let i=Tz.URLExt.join(t,dSe),o=Tz.URLExt.join(i,n);if(!o.startsWith(i))throw new Error("Can only be used for workspaces requests");return o}r.url=e})(_S||(_S={}))});var Nz=re(nR=>{"use strict";p();Object.defineProperty(nR,"__esModule",{value:!0});nR.ServiceManager=void 0;var kz=Rs(),pSe=z$(),fSe=oV(),mSe=cV(),hSe=_V(),gSe=A1(),vSe=PV(),ySe=Do(),bSe=TV(),SSe=KV(),ISe=WV(),_Se=HV(),ESe=JV(),GV=class{constructor(e={}){var t,n;this._isDisposed=!1,this._connectionFailure=new kz.Signal(this),this._isReady=!1;let i=e.defaultDrive,o=(t=e.serverSettings)!==null&&t!==void 0?t:ySe.ServerConnection.makeSettings(),s=(n=e.standby)!==null&&n!==void 0?n:"when-hidden",a={defaultDrive:i,serverSettings:o,standby:s};this.serverSettings=o,this.contents=e.contents||new fSe.ContentsManager(a),this.events=e.events||new mSe.EventManager(a),this.kernels=e.kernels||new hSe.KernelManager(a),this.sessions=e.sessions||new bSe.SessionManager({...a,kernelManager:this.kernels}),this.settings=e.settings||new SSe.SettingManager(a),this.terminals=e.terminals||new ISe.TerminalManager(a),this.builder=e.builder||new pSe.BuildManager(a),this.workspaces=e.workspaces||new ESe.WorkspaceManager(a),this.nbconvert=e.nbconvert||new vSe.NbConvertManager(a),this.kernelspecs=e.kernelspecs||new gSe.KernelSpecManager(a),this.user=e.user||new _Se.UserManager(a),this.kernelspecs.connectionFailure.connect(this._onConnectionFailure,this),this.sessions.connectionFailure.connect(this._onConnectionFailure,this),this.terminals.connectionFailure.connect(this._onConnectionFailure,this);let l=[this.sessions.ready,this.kernelspecs.ready];this.terminals.isAvailable()&&l.push(this.terminals.ready),this._readyPromise=Promise.all(l).then(()=>{this._isReady=!0})}get connectionFailure(){return this._connectionFailure}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,kz.Signal.clearData(this),this.contents.dispose(),this.events.dispose(),this.sessions.dispose(),this.terminals.dispose())}get isReady(){return this._isReady}get ready(){return this._readyPromise}_onConnectionFailure(e,t){this._connectionFailure.emit(t)}};nR.ServiceManager=GV});var ri=re(Jn=>{"use strict";p();var CSe=Jn&&Jn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),as=Jn&&Jn.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&CSe(e,r,t)};Object.defineProperty(Jn,"__esModule",{value:!0});as(Og(),Jn);as(u$(),Jn);as(oV(),Jn);as(cV(),Jn);as(_V(),Jn);as(A1(),Jn);as(Nz(),Jn);as(Do(),Jn);as(TV(),Jn);as(KV(),Jn);as(WV(),Jn);as(HV(),Jn);as(JV(),Jn);as(PV(),Jn)});var zV=re((nGe,Lz)=>{"use strict";p();var Mz=Array.isArray,Oz=Object.keys,xSe=Object.prototype.hasOwnProperty;Lz.exports=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Mz(e),i=Mz(t),o,s,a;if(n&&i){if(s=e.length,s!=t.length)return!1;for(o=s;o--!==0;)if(!r(e[o],t[o]))return!1;return!0}if(n!=i)return!1;var l=e instanceof Date,u=t instanceof Date;if(l!=u)return!1;if(l&&u)return e.getTime()==t.getTime();var c=e instanceof RegExp,d=t instanceof RegExp;if(c!=d)return!1;if(c&&d)return e.toString()==t.toString();var f=Oz(e);if(s=f.length,s!==Oz(t).length)return!1;for(o=s;o--!==0;)if(!xSe.call(t,f[o]))return!1;for(o=s;o--!==0;)if(a=f[o],!r(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}});var mj=re(em=>{"use strict";p();Object.defineProperty(em,"__esModule",{value:!0});em.TargetPopulation=em.Filters=em.VSCodeFilterProvider=void 0;var FR=require("vscode"),fj=class r{constructor(e,t,n){this.extensionName=e,this.extensionVersion=t,this.targetPopulation=n}static trimVersionSuffix(e){let t=/\-[a-zA-Z0-9]+$/;return e.split(t)[0]}getFilterValue(e){switch(e){case ou.ApplicationVersion:return r.trimVersionSuffix(FR.version);case ou.Build:return FR.env.appName;case ou.ClientId:return FR.env.machineId;case ou.ExtensionName:return this.extensionName;case ou.ExtensionVersion:return r.trimVersionSuffix(this.extensionVersion);case ou.Language:return FR.env.language;case ou.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,t=Object.values(ou);for(let n of t)e.set(n,this.getFilterValue(n));return e}};em.VSCodeFilterProvider=fj;var ou;(function(r){r.Market="X-MSEdge-Market",r.CorpNet="X-FD-Corpnet",r.ApplicationVersion="X-VSCode-AppVersion",r.Build="X-VSCode-Build",r.ClientId="X-MSEdge-ClientId",r.ExtensionName="X-VSCode-ExtensionName",r.ExtensionVersion="X-VSCode-ExtensionVersion",r.Language="X-VSCode-Language",r.TargetPopulation="X-VSCode-TargetPopulation"})(ou||(em.Filters=ou={}));var KQ;(function(r){r.Team="team",r.Internal="internal",r.Insiders="insider",r.Public="public"})(KQ||(em.TargetPopulation=KQ={}))});var FQ=re(UR=>{"use strict";p();Object.defineProperty(UR,"__esModule",{value:!0});UR.BaseFeatureProvider=void 0;var hj=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}};UR.BaseFeatureProvider=hj});var UQ=re(WR=>{"use strict";p();Object.defineProperty(WR,"__esModule",{value:!0});WR.FilteredFeatureProvider=void 0;var zSe=FQ(),gj=class extends zSe.BaseFeatureProvider{constructor(e,t){super(e),this.telemetry=e,this.filterProviders=t,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let t of this.filterProviders){let n=t.getFilters();for(let i of n.keys()){let o=n.get(i);e.set(i,o)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;let t=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",t]])),this.cachedTelemetryEvents.push(e)}};WR.FilteredFeatureProvider=gj});var WQ=re(tm=>{"use strict";p();Object.defineProperty(tm,"__esModule",{value:!0});tm.TasApiFeatureProvider=tm.TASAPI_FETCHERROR_EVENTNAME=void 0;var QSe=UQ();tm.TASAPI_FETCHERROR_EVENTNAME="call-tas-error";var vj="ErrorType",yj=class extends QSe.FilteredFeatureProvider{constructor(e,t,n){super(t,n),this.httpClient=e,this.telemetry=t,this.filterProviders=n}async fetch(){let e=this.getFilters(),t={};for(let a of e.keys()){let l=e.get(a);t[a]=l}let n;try{n=await this.httpClient.get({headers:t})}catch(a){let l=a,u=new Map;l.responseReceived&&!l.responseOk?u.set(vj,"ServerError"):l.responseReceived===!1?u.set(vj,"NoResponse"):u.set(vj,"GenericError"),this.telemetry.postEvent(tm.TASAPI_FETCHERROR_EVENTNAME,u)}if(!n)throw Error(tm.TASAPI_FETCHERROR_EVENTNAME);e.keys.length>0&&this.PostEventToTelemetry(t);let i=n.data,o=i.Configs,s=[];for(let a of o)if(a.Parameters)for(let l of Object.keys(a.Parameters)){let u=l+(a.Parameters[l]?"":"cf");s.includes(u)||s.push(u)}return{features:s,assignmentContext:i.AssignmentContext,configs:o}}};tm.TasApiFeatureProvider=yj});var VQ=re(jS=>{"use strict";p();Object.defineProperty(jS,"__esModule",{value:!0});jS.HttpClient=jS.FetchError=void 0;var VS=class extends Error{constructor(e,t,n){super(e),this.responseReceived=t,this.responseOk=n}};jS.FetchError=VS;var bj=class{constructor(e){this.endpoint=e}async get(e){let t=await fetch(this.endpoint,{method:"GET",headers:e==null?void 0:e.headers});if(!t)throw new VS("No response received",!1);if(!t.ok)throw new VS("Response not ok",!0,!1);let n=await t.json();if(!n)throw new VS("No data received",!1);return{data:n}}};jS.HttpClient=bj});var jQ=re(VR=>{"use strict";p();Object.defineProperty(VR,"__esModule",{value:!0});VR.MemoryKeyValueStorage=void 0;var Sj=class{constructor(){this.storage=new Map}async getValue(e,t){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(t||void 0)}setValue(e,t){this.storage.set(e,t)}};VR.MemoryKeyValueStorage=Sj});var BQ=re(jR=>{"use strict";p();Object.defineProperty(jR,"__esModule",{value:!0});jR.ExperimentationServiceBase=void 0;var XSe=jQ(),Ij=class{get features(){return this._features}set features(e){this._features=e,this.telemetry&&this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext)}constructor(e,t,n,i,o){this.telemetry=e,this.assignmentContextTelemetryPropertyName=t,this.telemetryEventName=n,this.storageKey=i,this.storage=o,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(o=new XSe.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise((s,a)=>{this.resolveInitialFetchPromise=s})}async getFeaturesAsync(e=!1){if(this.fetchPromise!=null){try{await this.fetchPromise}catch(t){}return this.features}if(!this.featureProviders||this.featureProviders.length===0)return Promise.resolve({features:[],assignmentContext:"",configs:[]});try{this.fetchPromise=Promise.all(this.featureProviders.map(async n=>await n.getFeatures()));let t=await this.fetchPromise;this.updateFeatures(t,e)}catch(t){}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,t=!1){let n={features:[],assignmentContext:"",configs:[]};for(let i of e){for(let o of i.features)n.features.includes(o)||n.features.push(o);for(let o of i.configs){let s=n.configs.find(a=>a.Id===o.Id);s?s.Parameters=Object.assign(Object.assign({},s.Parameters),o.Parameters):n.configs.push(o)}n.assignmentContext+=i.assignmentContext}(t||!this.featuresConsumed)&&(this.features=n),this.storage&&this.storage.setValue(this.storageKey,n)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),e!==void 0&&e.configs===void 0&&(e.configs=[])),this.features.features.length===0&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){let t=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),t.features.includes(e)}getTreatmentVariable(e,t){this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${t}`);let n=this.features.configs.find(i=>i.Id===e);return n==null?void 0:n.Parameters[t]}async getTreatmentVariableAsync(e,t,n){if(n){let i=this.featuresConsumed,o=this.getTreatmentVariable(e,t);if(o===void 0)this.featuresConsumed=i;else return o}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,t)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(!(e==null||this.featureProviders==null))for(let t of e)this.featureProviders.push(t)}};jR.ExperimentationServiceBase=Ij});var HQ=re(BR=>{"use strict";p();Object.defineProperty(BR,"__esModule",{value:!0});BR.PollingService=void 0;var _j=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),this.onTick!=null&&(e&&this.onTick().then(()=>{}).catch(()=>{}),this.intervalHandle=setInterval(async()=>{await this.onTick()},this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}};BR.PollingService=_j});var qQ=re(HR=>{"use strict";p();Object.defineProperty(HR,"__esModule",{value:!0});HR.ExperimentationServiceAutoPolling=void 0;var ZSe=BQ(),eIe=HQ(),Ej=class extends ZSe.ExperimentationServiceBase{constructor(e,t,n,i,o,s,a){if(super(e,i,o,s,a),this.telemetry=e,this.filterProviders=t,this.refreshRateMs=n,this.assignmentContextTelemetryPropertyName=i,this.telemetryEventName=o,this.storageKey=s,this.storage=a,n<1e3&&n!==0)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");n>0&&(this.pollingService=new eIe.PollingService(n),this.pollingService.OnPollTick(async()=>{await super.getFeaturesAsync()}))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let t=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),t}else return await super.getFeaturesAsync(e)}};HR.ExperimentationServiceAutoPolling=Ej});var JQ=re(JR=>{"use strict";p();Object.defineProperty(JR,"__esModule",{value:!0});JR.ExperimentationService=void 0;var tIe=WQ(),rIe=VQ(),nIe=qQ(),qR=class extends nIe.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],e.refetchInterval!=null?e.refetchInterval:0,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new tIe.TasApiFeatureProvider(new rIe.HttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}};JR.ExperimentationService=qR;qR.REFRESH_RATE_IN_MINUTES=30});var GQ=re(GR=>{"use strict";p();Object.defineProperty(GR,"__esModule",{value:!0});GR.ExperimentationService=void 0;var iIe=JQ();Object.defineProperty(GR,"ExperimentationService",{enumerable:!0,get:function(){return iIe.ExperimentationService}})});var YQ=re(YR=>{"use strict";p();Object.defineProperty(YR,"__esModule",{value:!0});YR.MementoKeyValueStorage=void 0;var Cj=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,t){return await this.mementoGlobalStorage.get(e)||t}setValue(e,t){this.mementoGlobalStorage.update(e,t)}};YR.MementoKeyValueStorage=Cj});var $Q=re(xj=>{"use strict";p();Object.defineProperty(xj,"__esModule",{value:!0});var wj=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,t){}getTreatmentVariableAsync(e,t){return Promise.resolve(void 0)}};xj.default=wj});var QQ=re(BS=>{"use strict";p();Object.defineProperty(BS,"__esModule",{value:!0});BS.getExperimentationServiceAsync=BS.getExperimentationService=void 0;var oIe=mj(),sIe=GQ(),Pj=require("vscode"),aIe=YQ(),lIe=$Q(),cIe="https://default.exp-tas.com/vscode/ab",uIe="query-expfeature",dIe="abexp.assignmentcontext",pIe="VSCode.ABExp.FeatureData",fIe=1e3*60*30;function zQ(r,e,t,n,i,...o){if(!i)throw new Error("Memento storage was not provided.");let s=Pj.workspace.getConfiguration("telemetry");if(!(Pj.env.isTelemetryEnabled===void 0?s.get("enableTelemetry",!0):Pj.env.isTelemetryEnabled))return new lIe.default;let u=[new oIe.VSCodeFilterProvider(r,e,t),...o],c=new aIe.MementoKeyValueStorage(i);return new sIe.ExperimentationService({filterProviders:u,telemetry:n,storageKey:pIe,keyValueStorage:c,featuresTelemetryPropertyName:"",assignmentContextTelemetryPropertyName:dIe,telemetryEventName:uIe,endpoint:cIe,refetchInterval:fIe})}BS.getExperimentationService=zQ;async function mIe(r,e,t,n,i,...o){let s=zQ(r,e,t,n,i,...o);return await s.initializePromise,s}BS.getExperimentationServiceAsync=mIe});var ZQ=re(rm=>{"use strict";p();Object.defineProperty(rm,"__esModule",{value:!0});rm.TargetPopulation=rm.getExperimentationServiceAsync=rm.getExperimentationService=void 0;var XQ=QQ();Object.defineProperty(rm,"getExperimentationService",{enumerable:!0,get:function(){return XQ.getExperimentationService}});Object.defineProperty(rm,"getExperimentationServiceAsync",{enumerable:!0,get:function(){return XQ.getExperimentationServiceAsync}});var hIe=mj();Object.defineProperty(rm,"TargetPopulation",{enumerable:!0,get:function(){return hIe.TargetPopulation}})});var tA=re((Wet,Rj)=>{"use strict";p();function bIe(r){var e=void 0;typeof r=="string"?e=[r]:e=r.raw;for(var t="",n=0;n<e.length;n++)t+=e[n].replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`"),n<(arguments.length<=1?0:arguments.length-1)&&(t+=arguments.length<=n+1?void 0:arguments[n+1]);var i=t.split(`
`),o=null;return i.forEach(function(s){var a=s.match(/^(\s+)\S+/);if(a){var l=a[1].length;o?o=Math.min(o,l):o=l}}),o!==null&&(t=i.map(function(s){return s[0]===" "?s.slice(o):s}).join(`
`)),t=t.trim(),t.replace(/\\n/g,`
`)}typeof Rj!="undefined"&&(Rj.exports=bIe)});var wX=re((Bd,CX)=>{p();var EX=typeof self!="undefined"?self:Bd,aA=function(){function r(){this.fetch=!1,this.DOMException=EX.DOMException}return r.prototype=EX,new r}();(function(r){var e=function(t){var n={searchParams:"URLSearchParams"in r,iterable:"Symbol"in r&&"iterator"in Symbol,blob:"FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(h){return!1}}(),formData:"FormData"in r,arrayBuffer:"ArrayBuffer"in r};function i(h){return h&&DataView.prototype.isPrototypeOf(h)}if(n.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(h){return h&&o.indexOf(Object.prototype.toString.call(h))>-1};function a(h){if(typeof h!="string"&&(h=String(h)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(h))throw new TypeError("Invalid character in header field name");return h.toLowerCase()}function l(h){return typeof h!="string"&&(h=String(h)),h}function u(h){var v={next:function(){var C=h.shift();return{done:C===void 0,value:C}}};return n.iterable&&(v[Symbol.iterator]=function(){return v}),v}function c(h){this.map={},h instanceof c?h.forEach(function(v,C){this.append(C,v)},this):Array.isArray(h)?h.forEach(function(v){this.append(v[0],v[1])},this):h&&Object.getOwnPropertyNames(h).forEach(function(v){this.append(v,h[v])},this)}c.prototype.append=function(h,v){h=a(h),v=l(v);var C=this.map[h];this.map[h]=C?C+", "+v:v},c.prototype.delete=function(h){delete this.map[a(h)]},c.prototype.get=function(h){return h=a(h),this.has(h)?this.map[h]:null},c.prototype.has=function(h){return this.map.hasOwnProperty(a(h))},c.prototype.set=function(h,v){this.map[a(h)]=l(v)},c.prototype.forEach=function(h,v){for(var C in this.map)this.map.hasOwnProperty(C)&&h.call(v,this.map[C],C,this)},c.prototype.keys=function(){var h=[];return this.forEach(function(v,C){h.push(C)}),u(h)},c.prototype.values=function(){var h=[];return this.forEach(function(v){h.push(v)}),u(h)},c.prototype.entries=function(){var h=[];return this.forEach(function(v,C){h.push([C,v])}),u(h)},n.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);function d(h){if(h.bodyUsed)return Promise.reject(new TypeError("Already read"));h.bodyUsed=!0}function f(h){return new Promise(function(v,C){h.onload=function(){v(h.result)},h.onerror=function(){C(h.error)}})}function m(h){var v=new FileReader,C=f(v);return v.readAsArrayBuffer(h),C}function g(h){var v=new FileReader,C=f(v);return v.readAsText(h),C}function b(h){for(var v=new Uint8Array(h),C=new Array(v.length),k=0;k<v.length;k++)C[k]=String.fromCharCode(v[k]);return C.join("")}function y(h){if(h.slice)return h.slice(0);var v=new Uint8Array(h.byteLength);return v.set(new Uint8Array(h)),v.buffer}function P(){return this.bodyUsed=!1,this._initBody=function(h){this._bodyInit=h,h?typeof h=="string"?this._bodyText=h:n.blob&&Blob.prototype.isPrototypeOf(h)?this._bodyBlob=h:n.formData&&FormData.prototype.isPrototypeOf(h)?this._bodyFormData=h:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(h)?this._bodyText=h.toString():n.arrayBuffer&&n.blob&&i(h)?(this._bodyArrayBuffer=y(h.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(h)||s(h))?this._bodyArrayBuffer=y(h):this._bodyText=h=Object.prototype.toString.call(h):this._bodyText="",this.headers.get("content-type")||(typeof h=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(h)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var h=d(this);if(h)return h;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var h=d(this);if(h)return h;if(this._bodyBlob)return g(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(b(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(K)}),this.json=function(){return this.text().then(JSON.parse)},this}var A=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function D(h){var v=h.toUpperCase();return A.indexOf(v)>-1?v:h}function T(h,v){v=v||{};var C=v.body;if(h instanceof T){if(h.bodyUsed)throw new TypeError("Already read");this.url=h.url,this.credentials=h.credentials,v.headers||(this.headers=new c(h.headers)),this.method=h.method,this.mode=h.mode,this.signal=h.signal,!C&&h._bodyInit!=null&&(C=h._bodyInit,h.bodyUsed=!0)}else this.url=String(h);if(this.credentials=v.credentials||this.credentials||"same-origin",(v.headers||!this.headers)&&(this.headers=new c(v.headers)),this.method=D(v.method||this.method||"GET"),this.mode=v.mode||this.mode||null,this.signal=v.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&C)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(C)}T.prototype.clone=function(){return new T(this,{body:this._bodyInit})};function K(h){var v=new FormData;return h.trim().split("&").forEach(function(C){if(C){var k=C.split("="),H=k.shift().replace(/\+/g," "),Y=k.join("=").replace(/\+/g," ");v.append(decodeURIComponent(H),decodeURIComponent(Y))}}),v}function L(h){var v=new c,C=h.replace(/\r?\n[\t ]+/g," ");return C.split(/\r?\n/).forEach(function(k){var H=k.split(":"),Y=H.shift().trim();if(Y){var Z=H.join(":").trim();v.append(Y,Z)}}),v}P.call(T.prototype);function B(h,v){v||(v={}),this.type="default",this.status=v.status===void 0?200:v.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in v?v.statusText:"OK",this.headers=new c(v.headers),this.url=v.url||"",this._initBody(h)}P.call(B.prototype),B.prototype.clone=function(){return new B(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},B.error=function(){var h=new B(null,{status:0,statusText:""});return h.type="error",h};var N=[301,302,303,307,308];B.redirect=function(h,v){if(N.indexOf(v)===-1)throw new RangeError("Invalid status code");return new B(null,{status:v,headers:{location:h}})},t.DOMException=r.DOMException;try{new t.DOMException}catch(h){t.DOMException=function(v,C){this.message=v,this.name=C;var k=Error(v);this.stack=k.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function O(h,v){return new Promise(function(C,k){var H=new T(h,v);if(H.signal&&H.signal.aborted)return k(new t.DOMException("Aborted","AbortError"));var Y=new XMLHttpRequest;function Z(){Y.abort()}Y.onload=function(){var ie={status:Y.status,statusText:Y.statusText,headers:L(Y.getAllResponseHeaders()||"")};ie.url="responseURL"in Y?Y.responseURL:ie.headers.get("X-Request-URL");var ce="response"in Y?Y.response:Y.responseText;C(new B(ce,ie))},Y.onerror=function(){k(new TypeError("Network request failed"))},Y.ontimeout=function(){k(new TypeError("Network request failed"))},Y.onabort=function(){k(new t.DOMException("Aborted","AbortError"))},Y.open(H.method,H.url,!0),H.credentials==="include"?Y.withCredentials=!0:H.credentials==="omit"&&(Y.withCredentials=!1),"responseType"in Y&&n.blob&&(Y.responseType="blob"),H.headers.forEach(function(ie,ce){Y.setRequestHeader(ce,ie)}),H.signal&&(H.signal.addEventListener("abort",Z),Y.onreadystatechange=function(){Y.readyState===4&&H.signal.removeEventListener("abort",Z)}),Y.send(typeof H._bodyInit=="undefined"?null:H._bodyInit)})}return O.polyfill=!0,r.fetch||(r.fetch=O,r.Headers=c,r.Request=T,r.Response=B),t.Headers=c,t.Request=T,t.Response=B,t.fetch=O,Object.defineProperty(t,"__esModule",{value:!0}),t}({})})(aA);aA.fetch.ponyfill=!0;delete aA.fetch.polyfill;var lI=aA;Bd=lI.fetch;Bd.default=lI.fetch;Bd.fetch=lI.fetch;Bd.Headers=lI.Headers;Bd.Request=lI.Request;Bd.Response=lI.Response;CX.exports=Bd});var jX=re((yA,VX)=>{p();var CI=null;typeof WebSocket!="undefined"?CI=WebSocket:typeof MozWebSocket!="undefined"?CI=MozWebSocket:typeof yA!="undefined"?CI=yA.WebSocket||yA.MozWebSocket:typeof window!="undefined"?CI=window.WebSocket||window.MozWebSocket:typeof self!="undefined"&&(CI=self.WebSocket||self.MozWebSocket);VX.exports=CI});var YX=re((_lt,Jj)=>{p();var GX=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);GX?(Hj=new Uint8Array(16),Jj.exports=function(){return GX(Hj),Hj}):(qj=new Array(16),Jj.exports=function(){for(var e=0,t;e<16;e++)e&3||(t=Math.random()*4294967296),qj[e]=t>>>((e&3)<<3)&255;return qj});var Hj,qj});var QX=re((Clt,zX)=>{p();var $X=[];for(hP=0;hP<256;++hP)$X[hP]=(hP+256).toString(16).substr(1);var hP;function TIe(r,e){var t=e||0,n=$X;return[n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]]].join("")}zX.exports=TIe});var $g=re((xlt,XX)=>{p();var kIe=YX(),NIe=QX();function RIe(r,e,t){var n=e&&t||0;typeof r=="string"&&(e=r==="binary"?new Array(16):null,r=null),r=r||{};var i=r.random||(r.rng||kIe)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e)for(var o=0;o<16;++o)e[n+o]=i[o];return e||NIe(i)}XX.exports=RIe});var _Z=re((Xvt,IZ)=>{"use strict";p();IZ.exports=({onlyFirst:r=!1}={})=>{let e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,r?void 0:"g")}});var YZ=re((lCt,GZ)=>{"use strict";p();var QIe=(r,e={})=>{let t=e.safe===!0||e.keepProtected===!0,n=!1,i=(o,s)=>{let a="",l,u;for(let c of o.nodes)switch(c.type){case"block":if(e.first&&n===!0){a+=i(c,o);break}if(e.preserveNewlines===!0){l=i(c,o),u=l.split(`
`),a+=`
`.repeat(u.length-1);break}if(t===!0&&c.protected===!0){a+=i(c,o);break}n=!0;break;case"line":if(e.first&&n===!0){a+=c.value;break}t===!0&&c.protected===!0&&(a+=c.value),n=!0;break;case"open":case"close":case"text":case"newline":default:{a+=c.value||"";break}}return a};return i(r)};GZ.exports=QIe});var zZ=re((uCt,$Z)=>{"use strict";p();var pM=class{constructor(e){this.type=e.type,e.value&&(this.value=e.value),e.match&&(this.match=e.match),this.newline=e.newline||""}get protected(){return!!this.match&&this.match[1]==="!"}},p9=class extends pM{constructor(e){super(e),this.nodes=e.nodes||[]}push(e){this.nodes.push(e)}get protected(){return this.nodes.length>0&&this.nodes[0].protected===!0}};$Z.exports={Node:pM,Block:p9}});var XZ=re(QZ=>{"use strict";p();QZ.javascript={BLOCK_OPEN_REGEX:/^\/\*\*?(!?)/,BLOCK_CLOSE_REGEX:/^\*\/(\n?)/,LINE_REGEX:/^\/\/(!?).*/}});var tee=re((mCt,eee)=>{"use strict";p();var{Node:vm,Block:ZZ}=zZ(),XIe=XZ(),f9={ESCAPED_CHAR_REGEX:/^\\./,QUOTED_STRING_REGEX:/^(['"`])((?:\\.|[^\1])+?)(\1)/,NEWLINE_REGEX:/^\r*\n/},ZIe=(r,e={})=>{if(typeof r!="string")throw new TypeError("Expected input to be a string");let t=new ZZ({type:"root",nodes:[]}),n=[t],i=(e.language||"javascript").toLowerCase(),o=XIe[i];if(typeof o=="undefined")throw new Error(`Language "${i}" is not supported by strip-comments`);let{LINE_REGEX:s,BLOCK_OPEN_REGEX:a,BLOCK_CLOSE_REGEX:l}=o,u=t,c=r,d,f,m=[a,l].filter(Boolean),g=!1;m.every(D=>D.source==='^"""')&&(g=!0);let b=(D=c[0]||"")=>(c=c.slice(D.length),D),y=(D,T="text")=>{let K=D.exec(c);if(K)return b(K[0]),{type:T,value:K[0],match:K}},P=D=>{if(f&&f.type==="text"&&D.type==="text"){f.value+=D.value;return}u.push(D),D.nodes&&(n.push(D),u=D),f=D},A=()=>{if(u.type==="root")throw new SyntaxError("Unclosed block comment");n.pop(),u=n[n.length-1]};for(;c!=="";){if(d=y(f9.ESCAPED_CHAR_REGEX,"text")){P(new vm(d));continue}if(u.type!=="block"&&(!f||!/\w$/.test(f.value))&&!(g&&c.startsWith('"""'))&&(d=y(f9.QUOTED_STRING_REGEX,"text"))){P(new vm(d));continue}if(d=y(f9.NEWLINE_REGEX,"newline")){P(new vm(d));continue}if(a&&e.block&&!(g&&u.type==="block")&&(d=y(a,"open"))){P(new ZZ({type:"block"})),P(new vm(d));continue}if(l&&u.type==="block"&&e.block&&(d=y(l,"close"))){d.newline=d.match[1]||"",P(new vm(d)),A();continue}if(s&&u.type!=="block"&&e.line&&(d=y(s,"line"))){P(new vm(d));continue}if(d=y(/^[a-zABD-Z0-9\t ]+/,"text")){P(new vm(d));continue}P(new vm({type:"text",value:b(c[0])}))}return t};eee.exports=ZIe});var nee=re((gCt,ree)=>{"use strict";p();var fM=YZ(),DP=tee(),mM=ree.exports=(r,e)=>{let t={...e,block:!0,line:!0};return fM(DP(r,t),t)};mM.block=(r,e)=>{let t={...e,block:!0};return fM(DP(r,t),t)};mM.line=(r,e)=>{let t={...e,line:!0};return fM(DP(r,t),t)};mM.first=(r,e)=>{let t={...e,block:!0,line:!0,first:!0};return fM(DP(r,t),t)};mM.parse=DP});var jee=re((BP,Vee)=>{p();var w_e=typeof BP=="object"&&BP&&BP.Object===Object&&BP;Vee.exports=w_e});var Hee=re((DKt,Bee)=>{p();var x_e=jee(),P_e=typeof self=="object"&&self&&self.Object===Object&&self,D_e=x_e||P_e||Function("return this")();Bee.exports=D_e});var tO=re((kKt,qee)=>{p();var T_e=Hee(),k_e=T_e.Symbol;qee.exports=k_e});var Gee=re((RKt,Jee)=>{p();function N_e(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}Jee.exports=N_e});var $ee=re((MKt,Yee)=>{p();var R_e=Array.isArray;Yee.exports=R_e});var Zee=re((LKt,Xee)=>{p();var zee=tO(),Qee=Object.prototype,A_e=Qee.hasOwnProperty,M_e=Qee.toString,HP=zee?zee.toStringTag:void 0;function O_e(r){var e=A_e.call(r,HP),t=r[HP];try{r[HP]=void 0;var n=!0}catch(o){}var i=M_e.call(r);return n&&(e?r[HP]=t:delete r[HP]),i}Xee.exports=O_e});var tte=re((FKt,ete)=>{p();var L_e=Object.prototype,K_e=L_e.toString;function F_e(r){return K_e.call(r)}ete.exports=F_e});var ote=re((WKt,ite)=>{p();var rte=tO(),U_e=Zee(),W_e=tte(),V_e="[object Null]",j_e="[object Undefined]",nte=rte?rte.toStringTag:void 0;function B_e(r){return r==null?r===void 0?j_e:V_e:nte&&nte in Object(r)?U_e(r):W_e(r)}ite.exports=B_e});var ate=re((jKt,ste)=>{p();function H_e(r){return r!=null&&typeof r=="object"}ste.exports=H_e});var cte=re((HKt,lte)=>{p();var q_e=ote(),J_e=ate(),G_e="[object Symbol]";function Y_e(r){return typeof r=="symbol"||J_e(r)&&q_e(r)==G_e}lte.exports=Y_e});var hte=re((JKt,mte)=>{p();var ute=tO(),$_e=Gee(),z_e=$ee(),Q_e=cte(),X_e=1/0,dte=ute?ute.prototype:void 0,pte=dte?dte.toString:void 0;function fte(r){if(typeof r=="string")return r;if(z_e(r))return $_e(r,fte)+"";if(Q_e(r))return pte?pte.call(r):"";var e=r+"";return e=="0"&&1/r==-X_e?"-0":e}mte.exports=fte});var vte=re((YKt,gte)=>{p();var Z_e=hte();function eEe(r){return r==null?"":Z_e(r)}gte.exports=eEe});var Ste=re((zKt,bte)=>{p();var tEe=vte(),yte=/[\\^$.*+?()[\]{}|]/g,rEe=RegExp(yte.source);function nEe(r){return r=tEe(r),r&&rEe.test(r)?r.replace(yte,"\\$&"):r}bte.exports=nEe});var lCe={};Kv(lCe,{activate:()=>iCe,deactivate:()=>oCe});module.exports=nL(lCe);p();p();Reflect.metadata===void 0&&Q9();p();var fr=require("vscode");p();p();function Fv(){try{return(Z9(),nL(X9)).isPreRelesVersionOfJupyterExtension===!0}catch(r){return!0}}var OE={isExiting:!1},sD="_builtin.JupyterServerSelectorForTesting",LE="_builtin.jupyterServerUrlProvider";var eB=!1;function tB(r){eB=r}function rB(){return eB}var nB=!1;function iB(r){nB=r}function _n(){return nB}var Ye="python",UE="markdown",Xl="vscode-notebook-cell";var lD={language:Ye};var Uv="vscode-interactive-input",bt="jupyter-notebook",vr="interactive";var Zl="GitHub.codespaces",Je="ms-toolsai.jupyter",cD="ms-toolsai.datawrangler",oB="ms-toolsai.vscode-jupyter-powertoys",Wv="ms-toolsai.jupyter-hub",sB="0c6ae279ed8443289764825290e4f9e2-1a736e7c-1324-4338-be46-fc2a58ae4d14-7255",Vv="STANDARD_OUTPUT_CHANNEL",aD;(t=>(t.PythonInteractiveHelpLink="https://aka.ms/pyaiinstall",t.JupyterDataRateHelpLink="https://aka.ms/AA5ggm0"))(aD||(aD={}));var ui;(o=>(o.JupyterServerRemoteLaunchNameSeparator=`
`,o.JupyterServerRemoteLaunchService=Je,o.JupyterServerUriListMax=10,o.IntellisenseTimeout=2e3,o.IntellisenseResolveTimeout=5e3))(ui||(ui={}));var di=!1;var Hre=!1;function mn(){return Hre||WE()}var qre=!1;function WE(){return qre}var nt;(b=>(b.GeneratedThemeName="ipython-theme",b.MatplotLibDefaultParams="_VSCode_defaultMatplotlib_Params",b.MatplotLibFigureFormats="_VSCode_matplotLib_FigureFormats",b.DefaultCodeCellMarker="# %%",b.DefaultCommTarget="jupyter.widget",b.ALL_VARIABLES="ALL_VARIABLES",b.KERNEL_VARIABLES="KERNEL_VARIABLES",b.DEBUGGER_VARIABLES="DEBUGGER_VARIABLES",b.PYTHON_VARIABLES_REQUESTER="PYTHON_VARIABLES_REQUESTER",b.MULTIPLEXING_DEBUGSERVICE="MULTIPLEXING_DEBUGSERVICE",b.RUN_BY_LINE_DEBUGSERVICE="RUN_BY_LINE_DEBUGSERVICE",b.REMOTE_URI="https://remote/",b.REMOTE_URI_ID_PARAM="id",b.REMOTE_URI_HANDLE_PARAM="uriHandle",b.REMOTE_URI_EXTENSION_ID_PARAM="extensionId"))(nt||(nt={}));var KE;(n=>(n.ImportIPython=`{0}
from IPython import get_ipython

{1}`,n.MatplotLibInit=`import matplotlib
%matplotlib inline
${nt.MatplotLibDefaultParams} = dict(matplotlib.rcParams)
`,n.DisableJedi="%config Completer.use_jedi = False"))(KE||(KE={}));var aB="JUPYTER_OUTPUT_CHANNEL",iL="Default Light+",$s="ms-python.python",jv="ms-toolsai.jupyter-renderers",lB="ms-python.vscode-pylance",cB=["python","html","xml","javascript","markdown","latex","shellscript","bat","powershell","kusto","ruby","sql","perl","qsharp","raw"],uB=new Map([["bash","shellscript"],["c#","csharp"],["f#","fsharp"],["q#","qsharp"],["c++11","c++"],["c++12","c++"],["c++14","c++"]]),dB=["python","r","julia","c++","c#","f#","q#","powershell","java","scala","haskell","bash","cling","rust","sas","sos","ocaml"];var le;(Oe=>(Oe.RunAllCells="jupyter.runallcells",Oe.RunAllCellsAbove="jupyter.runallcellsabove",Oe.RunCellAndAllBelow="jupyter.runcellandallbelow",Oe.RunAllCellsAbovePalette="jupyter.runallcellsabove.palette",Oe.RunCellAndAllBelowPalette="jupyter.runcurrentcellandallbelow.palette",Oe.RunToLine="jupyter.runtoline",Oe.RunFromLine="jupyter.runfromline",Oe.RunCell="jupyter.runcell",Oe.RunCurrentCell="jupyter.runcurrentcell",Oe.RunCurrentCellAdvance="jupyter.runcurrentcelladvance",Oe.CreateNewInteractive="jupyter.createnewinteractive",Oe.ImportNotebook="jupyter.importnotebook",Oe.ImportNotebookFile="jupyter.importnotebookfile",Oe.ExportFileAsNotebook="jupyter.exportfileasnotebook",Oe.ExportFileAndOutputAsNotebook="jupyter.exportfileandoutputasnotebook",Oe.InterruptKernel="jupyter.interruptkernel",Oe.RestartKernel="jupyter.restartkernel",Oe.RestartKernelAndRunAllCells="jupyter.restartkernelandrunallcells",Oe.RestartKernelAndRunUpToSelectedCell="jupyter.restartkernelandrunuptoselectedcell",Oe.NotebookEditorRemoveAllCells="jupyter.notebookeditor.removeallcells",Oe.NotebookEditorRunAllCells="jupyter.notebookeditor.runallcells",Oe.NotebookEditorRunSelectedCell="jupyter.notebookeditor.runselectedcell",Oe.NotebookEditorAddCellBelow="jupyter.notebookeditor.addcellbelow",Oe.ExpandAllCells="jupyter.expandallcells",Oe.CollapseAllCells="jupyter.collapseallcells",Oe.ExportOutputAsNotebook="jupyter.exportoutputasnotebook",Oe.ExecSelectionInInteractiveWindow="jupyter.execSelectionInteractive",Oe.RunFileInInteractiveWindows="jupyter.runFileInteractive",Oe.DebugFileInInteractiveWindows="jupyter.debugFileInteractive",Oe.AddCellBelow="jupyter.addcellbelow",Oe.DebugCurrentCellPalette="jupyter.debugcurrentcell.palette",Oe.DebugCell="jupyter.debugcell",Oe.DebugStepOver="jupyter.debugstepover",Oe.DebugContinue="jupyter.debugcontinue",Oe.DebugStop="jupyter.debugstop",Oe.RunCurrentCellAndAddBelow="jupyter.runcurrentcellandaddbelow",Oe.InsertCellBelowPosition="jupyter.insertCellBelowPosition",Oe.InsertCellBelow="jupyter.insertCellBelow",Oe.InsertCellAbove="jupyter.insertCellAbove",Oe.DeleteCells="jupyter.deleteCells",Oe.SelectCell="jupyter.selectCell",Oe.SelectCellContents="jupyter.selectCellContents",Oe.ExtendSelectionByCellAbove="jupyter.extendSelectionByCellAbove",Oe.ExtendSelectionByCellBelow="jupyter.extendSelectionByCellBelow",Oe.MoveCellsUp="jupyter.moveCellsUp",Oe.MoveCellsDown="jupyter.moveCellsDown",Oe.ChangeCellToMarkdown="jupyter.changeCellToMarkdown",Oe.ChangeCellToCode="jupyter.changeCellToCode",Oe.GotoNextCellInFile="jupyter.gotoNextCellInFile",Oe.GotoPrevCellInFile="jupyter.gotoPrevCellInFile",Oe.ScrollToCell="jupyter.scrolltocell",Oe.CreateNewNotebook="jupyter.createnewnotebook",Oe.ViewJupyterOutput="jupyter.viewOutput",Oe.ExportAsPythonScript="jupyter.exportAsPythonScript",Oe.ExportToHTML="jupyter.exportToHTML",Oe.ExportToPDF="jupyter.exportToPDF",Oe.Export="jupyter.export",Oe.NativeNotebookExport="jupyter.notebookeditor.export",Oe.LatestExtension="jupyter.latestExtension",Oe.EnableLoadingWidgetsFrom3rdPartySource="jupyter.enableLoadingWidgetScriptsFromThirdPartySource",Oe.ShowDataViewer="jupyter.showDataViewer",Oe.ShowJupyterDataViewer="jupyter.showJupyterDataViewer",Oe.RefreshDataViewer="jupyter.refreshDataViewer",Oe.ClearSavedJupyterUris="jupyter.clearSavedJupyterUris",Oe.OpenVariableView="jupyter.openVariableView",Oe.OpenOutlineView="jupyter.openOutlineView",Oe.InteractiveClearAll="jupyter.interactive.clearAllCells",Oe.InteractiveGoToCode="jupyter.interactive.goToCode",Oe.InteractiveCopyCell="jupyter.interactive.copyCell",Oe.InteractiveExportAsNotebook="jupyter.interactive.exportasnotebook",Oe.InteractiveExportAs="jupyter.interactive.exportas",Oe.RunByLine="jupyter.runByLine",Oe.RunAndDebugCell="jupyter.runAndDebugCell",Oe.RunByLineNext="jupyter.runByLineNext",Oe.RunByLineStop="jupyter.runByLineStop",Oe.ReplayPylanceLog="jupyter.replayPylanceLog",Oe.ReplayPylanceLogStep="jupyter.replayPylanceLogStep",Oe.InstallPythonExtensionViaKernelPicker="jupyter.installPythonExtensionViaKernelPicker",Oe.InstallPythonViaKernelPicker="jupyter.installPythonViaKernelPicker",Oe.ContinueEditSessionInCodespace="jupyter.continueEditSessionInCodespace"))(le||(le={}));var Ru;(n=>(n.DefaultDesignLenses=[le.RunCurrentCell,le.RunAllCellsAbove,le.DebugCell],n.DefaultDebuggingLenses=[le.DebugContinue,le.DebugStop,le.DebugStepOver],n.DebuggerCommands=[le.DebugContinue,le.DebugStop,le.DebugStepOver]))(Ru||(Ru={}));var gr;(N=>(N.HasCodeCells="jupyter.hascodecells",N.IsInteractiveActive="jupyter.isinteractiveactive",N.OwnsSelection="jupyter.ownsSelection",N.HaveNativeCells="jupyter.havenativecells",N.HaveNative="jupyter.havenative",N.IsNativeActive="jupyter.isnativeactive",N.IsInteractiveOrNativeActive="jupyter.isinteractiveornativeactive",N.IsPythonOrNativeActive="jupyter.ispythonornativeactive",N.IsPythonOrInteractiveActive="jupyter.ispythonorinteractiveeactive",N.IsPythonOrInteractiveOrNativeActive="jupyter.ispythonorinteractiveornativeeactive",N.CanRestartNotebookKernel="jupyter.notebookeditor.canrestartNotebookkernel",N.CanInterruptNotebookKernel="jupyter.notebookeditor.canInterruptNotebookKernel",N.CanRestartInteractiveWindowKernel="jupyter.interactive.canRestartNotebookKernel",N.CanInterruptInteractiveWindowKernel="jupyter.interactive.canInterruptNotebookKernel",N.RunByLineCells="jupyter.notebookeditor.runByLineCells",N.RunByLineDocuments="jupyter.notebookeditor.runByLineDocuments",N.DebugDocuments="jupyter.notebookeditor.debugDocuments",N.IsPythonNotebook="jupyter.ispythonnotebook",N.IsJupyterKernelSelected="jupyter.kernel.isjupyter",N.IsDataViewerActive="jupyter.dataViewerActive",N.HasNativeNotebookOrInteractiveWindowOpen="jupyter.hasNativeNotebookOrInteractiveWindowOpen",N.ZmqAvailable="jupyter.zmqavailable",N.ReplayLogLoaded="jupyter.replayLogLoaded",N.KernelSource="jupyter.kernelSource"))(gr||(gr={}));var FE;(l=>(l.PythonCellMarker=/^(#\s*%%|#\s*\<codecell\>|#\s*In\[\d*?\]|#\s*In\[ \])/,l.PythonMarkdownCellMarker=/^(#\s*%%\s*\[markdown\]|#\s*\<markdowncell\>)/,l.UrlPatternRegEx="(?<PREFIX>https?:\\/\\/)((\\(.+\\s+or\\s+(?<IP>.+)\\))|(?<LOCAL>[^\\s]+))(?<REST>:.+)",l.HttpPattern=/https?:\/\//,l.ShapeSplitterRegEx=/.*,\s*(\d+).*/,l.SvgHeightRegex=/(\<svg.*height=\")(.*?)\"/,l.SvgWidthRegex=/(\<svg.*width=\")(.*?)\"/,l.SvgSizeTagRegex=/\<svg.*tag=\"sizeTag=\{(.*),\s*(.*)\}\"/))(FE||(FE={}));var qPe=Symbol("DataScienceStartupTime"),oL={major:4,minor:2},po="application/vnd.jupyter.widget-view+json";var VE=7,uD="unknown";p();p();p();var Jre=new Map;function pB(){return Jre}p();p();p();var fB=Symbol("MicrotaskDelay");async function tc(r){return new Promise(e=>{setTimeout(()=>e(r),r)})}async function pD(r,e,t){return new Promise(n=>{let i,o=setTimeout(()=>i(!1),e),s=setInterval(()=>{r().then(a=>{a&&i(!0)}).catch(a=>i(!1))},t);i=a=>{clearTimeout(o),clearInterval(s),n(a)}})}function fo(r,e,...t){let n=dD(e)?void 0:e;dD(e)&&t.push(e);let i,o=setTimeout(()=>i==null?void 0:i(n),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(o)),new Promise(s=>i=s)])}function Hv(r,e,...t){let n,i=setTimeout(()=>n==null?void 0:n(e),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(i)),new Promise((o,s)=>n=s)])}function qv(r){return typeof(r==null?void 0:r.then)=="function"&&typeof(r==null?void 0:r.catch)=="function"}function dD(r){return typeof(r==null?void 0:r.then)=="function"}var sL=class{constructor(e=null){this.scope=e;this._resolved=!1;this._rejected=!1;this._promise=new Promise((t,n)=>{this._resolve=t,this._reject=n})}get value(){return this._value}resolve(e){this._value=e,this._resolve.apply(this.scope?this.scope:this,arguments),this._resolved=!0}reject(e){this._reject.apply(this.scope?this.scope:this,arguments),this._rejected=!0}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}};function Re(r=null){return new sL(r)}function Au(r){let e=Re();return r.then(e.resolve.bind(e)).catch(e.reject.bind(e)),e}var Bv=class{constructor(){this.currentPromise=Promise.resolve(void 0)}async chain(e){let t=Re(),n=this.currentPromise;return this.currentPromise=this.currentPromise.then(async()=>{try{let i=await e();t.resolve(i)}catch(i){throw t.reject(i),i}}),await n,t.promise}chainFinally(e){let t=Re();return this.currentPromise=this.currentPromise.finally(()=>e().then(n=>t.resolve(n)).catch(n=>t.reject(n))),t.promise}};var Gre=(r,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},r);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},Yre=r=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,r())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},ec=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,o)=>{this.doResolve=i,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}),this.completionPromise.catch(E));let n=()=>{var i;this.deferred=null,(i=this.doResolve)==null||i.call(this,null)};return this.deferred=t===fB?Yre(n):Gre(t,n),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new Error("Canceled")),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}};function E(){}function zs(r){try{let e=r();qv(e)&&e.catch(E)}catch(e){}}function pi(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function hB(r){let e=pi(r)?r:r.uri;return e.scheme.includes(Xl)||e.path.endsWith(".interactive")}function rc(){return process.platform.toString()==="web"}function mB(r,e){return pi(e)?e.toString():e}function gB(r,e){return r===e?!0:r&&!e||!r&&e?!1:JSON.stringify(r,mB)===JSON.stringify(e,mB)}p();var It=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}};var bDe=pB();function hn(r){return function(e,t,n){let i=n.value,o=`Jupyter Extension (Error in ${r||t}, method:${t}):`;n.value=function(...s){try{let a=i.apply(this,s);if(a&&typeof a.then=="function"&&typeof a.catch=="function")return a.catch(l=>{mn()||w.error(o,l)})}catch(a){if(mn())return;w.error(o,a)}}}}function $re(r,e,t){let n=new It;try{t&&r(void 0);let i=e();return qv(i)?i.then(o=>(r({elapsed:n.elapsedTime,returnValue:o}),o)).catch(o=>{r({elapsed:n.elapsedTime,err:o})}):r({elapsed:n.elapsedTime,returnValue:i}),i}catch(i){throw r({elapsed:n.elapsedTime,err:i}),i}}function vB(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a={kind:"Class",name:t&&t.constructor?t.constructor.name:"",args:s,methodName:n,target:t},l=this;return $re(u=>r(a,u),()=>o.apply(l,s),e)},i}}function Jv(){return function(r,e,t){let n=t.value;return t.value=function(...i){if(!mn())throw new Error(`Function: ${e} can only be called from test code`);return n.apply(this,i)},t}}function aL(){return function(r,e,t){let n=t.value,i=`chainedPromiseFor_${e}`;return t.value=async function(...o){let s=this[i];s?s=s.then(()=>n.apply(this,o)):s=n.apply(this,o),this[i]=s;let a=s.then(l=>l).catch(l=>{throw this[i]=void 0,l});return a.catch(E),a},t}}p();function lL(r,e){if(Array.isArray(r))return r.map(t=>lL(t,e)).join(", ");if(r===void 0)return"undefined";if(r===null)return"null";try{return r&&r.path?`<Uri:${r.path}>`:JSON.stringify(r)}catch(t){return`<${e} cannot be serialized for logging>`}}function cL(r){if(!r)return"";try{return r.map((t,n)=>{let i=lL(t,"argument");return`Arg ${n+1}: ${i}`}).join(", ")}catch(e){return""}}function yB(r){return`Return Value: ${lL(r,"Return value")}`}function fD(){let r=new Date,e=String(r.getHours()).padStart(2,"0"),t=String(r.getMinutes()).padStart(2,"0"),n=String(r.getSeconds()).padStart(2,"0"),i=String(r.getMilliseconds()).padStart(3,"0");return`${e}:${t}:${n}.${i}`}p();function at(r,e={removeEmptyEntries:!0,trim:!0}){r=r||"";let t=r.split(/\r?\n/g);return e&&e.trim&&(t=t.map(n=>n.trim())),e&&e.removeEmptyEntries&&(t=t.filter(n=>n.length>0)),t}function zre(r){return r&&(r.indexOf(" ")>=0&&!r.startsWith('"')&&!r.endsWith('"')?`"${r}"`:r.toString())}function uL(r){return r&&zre(r).replace(/\\/g,"/")}function jE(r){return r&&r.replace(/(^['"])|(['"]$)/g,"")}function Gv(r){return r?r.replace(/\$\([a-z0-9\-]+?\)/gi,"").trim():r||""}function Yv(r){let e=r.split(`
`),t=e.find(n=>n.trim().length>0&&!n.trim().startsWith("#"));if(t){let n=t.match(/^\s*/)[0];return e.map(i=>i.startsWith(n)?i.replace(n,""):i).join(`
`)}return r}p();var bL=require("vscode");p();p();p();var hD="en",vD=!1,yD=!1,BE=!1,Qre=!1,Xre=!1,pL=!1,Zre=!1,ene=!1,tne=!1,mD,gD=hD,rne,yp,Qs=typeof self=="object"?self:{},Rn;typeof Qs.vscode!="undefined"&&typeof Qs.vscode.process!="undefined"?Rn=Qs.vscode.process:typeof process!="undefined"&&(Rn=process);var SB,IB=typeof((SB=Rn==null?void 0:Rn.versions)==null?void 0:SB.electron)=="string",_B=IB&&(Rn==null?void 0:Rn.type)==="renderer",xDe=_B&&(Rn==null?void 0:Rn.sandboxed);if(typeof navigator=="object"&&!_B)yp=navigator.userAgent,vD=yp.indexOf("Windows")>=0,yD=yp.indexOf("Macintosh")>=0,ene=(yp.indexOf("Macintosh")>=0||yp.indexOf("iPad")>=0||yp.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,BE=yp.indexOf("Linux")>=0,pL=!0,mD=navigator.language,gD=mD;else if(typeof Rn=="object"){vD=Rn.platform==="win32",yD=Rn.platform==="darwin",BE=Rn.platform==="linux",Qre=BE&&!!Rn.env.SNAP&&!!Rn.env.SNAP_REVISION,Zre=IB,tne=!!Rn.env.CI||!!Rn.env.BUILD_ARTIFACTSTAGINGDIRECTORY,mD=hD,gD=hD;let r=Rn.env.VSCODE_NLS_CONFIG;if(r)try{let e=JSON.parse(r),t=e.availableLanguages["*"];mD=e.locale,gD=t||hD,rne=e._translationsConfigFile}catch(e){}Xre=!0}else console.error("Unable to resolve platform.");var dL=0;yD?dL=1:vD?dL=3:BE&&(dL=2);var HE=vD,EB=yD,CB=BE;var bD=pL,PDe=pL&&typeof Qs.importScripts=="function";var nc=yp,vp=gD,bB;(n=>{function r(){return vp}n.value=r;function e(){return vp.length===2?vp==="en":vp.length>=3?vp[0]==="e"&&vp[1]==="n"&&vp[2]==="-":!1}n.isDefaultVariant=e;function t(){return vp==="en"}n.isDefault=t})(bB||(bB={}));var DDe=(()=>{if(typeof Qs.postMessage=="function"&&!Qs.importScripts){let r=[];Qs.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=r.length;n<i;n++){let o=r[n];if(o.id===t.data.vscodeScheduleAsyncWork){r.splice(n,1),o.callback();return}}});let e=0;return t=>{let n=++e;r.push({id:n,callback:t}),Qs.postMessage({vscodeScheduleAsyncWork:n},"*")}}return r=>setTimeout(r)})();var nne=!!(nc&&nc.indexOf("Chrome")>=0),TDe=!!(nc&&nc.indexOf("Firefox")>=0),kDe=!!(!nne&&nc&&nc.indexOf("Safari")>=0),NDe=!!(nc&&nc.indexOf("Edg/")>=0),RDe=!!(nc&&nc.indexOf("Android")>=0);var Lm;if(typeof Qs.vscode!="undefined"&&typeof Qs.vscode.process!="undefined"){let r=Qs.vscode.process;Lm={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process!="undefined"?Lm={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Lm={get platform(){return HE?"win32":EB?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var SD=Lm.cwd,wB=Lm.env,Lo=Lm.platform,KDe=Lm.arch;var one=65,sne=97,ane=90,lne=122,Ip=46,fi=47,Ko=92,bp=58,cne=63,ID=class extends Error{constructor(t,n,i){let o;typeof n=="string"&&n.indexOf("not ")===0?(o="must not be",n=n.replace(/^not /,"")):o="must be";let s=t.indexOf(".")!==-1?"property":"argument",a=`The "${t}" ${s} ${o} of type ${n}`;a+=`. Received type ${typeof i}`;super(a);this.code="ERR_INVALID_ARG_TYPE"}};function gn(r,e){if(typeof r!="string")throw new ID(e,"string",r)}function Dt(r){return r===fi||r===Ko}function fL(r){return r===fi}function Sp(r){return r>=one&&r<=ane||r>=sne&&r<=lne}function _D(r,e,t,n){let i="",o=0,s=-1,a=0,l=0;for(let u=0;u<=r.length;++u){if(u<r.length)l=r.charCodeAt(u);else{if(n(l))break;l=fi}if(n(l)){if(!(s===u-1||a===1))if(a===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==Ip||i.charCodeAt(i.length-2)!==Ip){if(i.length>2){let c=i.lastIndexOf(t);c===-1?(i="",o=0):(i=i.slice(0,c),o=i.length-1-i.lastIndexOf(t)),s=u,a=0;continue}else if(i.length!==0){i="",o=0,s=u,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",o=2)}else i.length>0?i+=`${t}${r.slice(s+1,u)}`:i=r.slice(s+1,u),o=u-s-1;s=u,a=0}else l===Ip&&a!==-1?++a:a=-1}return i}function xB(r,e){if(e===null||typeof e!="object")throw new ID("pathObject","Object",e);let t=e.dir||e.root,n=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${n}`:`${t}${r}${n}`:n}var An={resolve(...r){let e="",t="",n=!1;for(let i=r.length-1;i>=-1;i--){let o;if(i>=0){if(o=r[i],gn(o,"path"),o.length===0)continue}else e.length===0?o=SD():(o=wB[`=${e}`]||SD(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===Ko)&&(o=`${e}\\`));let s=o.length,a=0,l="",u=!1,c=o.charCodeAt(0);if(s===1)Dt(c)&&(a=1,u=!0);else if(Dt(c))if(u=!0,Dt(o.charCodeAt(1))){let d=2,f=d;for(;d<s&&!Dt(o.charCodeAt(d));)d++;if(d<s&&d!==f){let m=o.slice(f,d);for(f=d;d<s&&Dt(o.charCodeAt(d));)d++;if(d<s&&d!==f){for(f=d;d<s&&!Dt(o.charCodeAt(d));)d++;(d===s||d!==f)&&(l=`\\\\${m}\\${o.slice(f,d)}`,a=d)}}}else a=1;else Sp(c)&&o.charCodeAt(1)===bp&&(l=o.slice(0,2),a=2,s>2&&Dt(o.charCodeAt(2))&&(u=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${o.slice(a)}\\${t}`,n=u,u&&e.length>0)break}return t=_D(t,!n,"\\",Dt),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(r){gn(r,"path");let e=r.length;if(e===0)return".";let t=0,n,i=!1,o=r.charCodeAt(0);if(e===1)return fL(o)?"\\":r;if(Dt(o))if(i=!0,Dt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){let u=r.slice(l,a);for(l=a;a<e&&Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Dt(r.charCodeAt(a));)a++;if(a===e)return`\\\\${u}\\${r.slice(l)}\\`;a!==l&&(n=`\\\\${u}\\${r.slice(l,a)}`,t=a)}}}else t=1;else Sp(o)&&r.charCodeAt(1)===bp&&(n=r.slice(0,2),t=2,e>2&&Dt(r.charCodeAt(2))&&(i=!0,t=3));let s=t<e?_D(r.slice(t),!i,"\\",Dt):"";return s.length===0&&!i&&(s="."),s.length>0&&Dt(r.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(r){gn(r,"path");let e=r.length;if(e===0)return!1;let t=r.charCodeAt(0);return Dt(t)||e>2&&Sp(t)&&r.charCodeAt(1)===bp&&Dt(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let e,t;for(let o=0;o<r.length;++o){let s=r[o];gn(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&Dt(t.charCodeAt(0))){++i;let o=t.length;o>1&&Dt(t.charCodeAt(1))&&(++i,o>2&&(Dt(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&Dt(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return An.normalize(e)},relative(r,e){if(gn(r,"from"),gn(e,"to"),r===e)return"";let t=An.resolve(r),n=An.resolve(e);if(t===n||(r=t.toLowerCase(),e=n.toLowerCase(),r===e))return"";let i=0;for(;i<r.length&&r.charCodeAt(i)===Ko;)i++;let o=r.length;for(;o-1>i&&r.charCodeAt(o-1)===Ko;)o--;let s=o-i,a=0;for(;a<e.length&&e.charCodeAt(a)===Ko;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Ko;)l--;let u=l-a,c=s<u?s:u,d=-1,f=0;for(;f<c;f++){let g=r.charCodeAt(i+f);if(g!==e.charCodeAt(a+f))break;g===Ko&&(d=f)}if(f!==c){if(d===-1)return n}else{if(u>c){if(e.charCodeAt(a+f)===Ko)return n.slice(a+f+1);if(f===2)return n.slice(a+f)}s>c&&(r.charCodeAt(i+f)===Ko?d=f:f===2&&(d=3)),d===-1&&(d=0)}let m="";for(f=i+d+1;f<=o;++f)(f===o||r.charCodeAt(f)===Ko)&&(m+=m.length===0?"..":"\\..");return a+=d,m.length>0?`${m}${n.slice(a,l)}`:(n.charCodeAt(a)===Ko&&++a,n.slice(a,l))},toNamespacedPath(r){if(typeof r!="string")return r;if(r.length===0)return"";let e=An.resolve(r);if(e.length<=2)return r;if(e.charCodeAt(0)===Ko){if(e.charCodeAt(1)===Ko){let t=e.charCodeAt(2);if(t!==cne&&t!==Ip)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Sp(e.charCodeAt(0))&&e.charCodeAt(1)===bp&&e.charCodeAt(2)===Ko)return`\\\\?\\${e}`;return r},dirname(r){gn(r,"path");let e=r.length;if(e===0)return".";let t=-1,n=0,i=r.charCodeAt(0);if(e===1)return Dt(i)?r:".";if(Dt(i)){if(t=n=1,Dt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Dt(r.charCodeAt(a));)a++;if(a===e)return r;a!==l&&(t=n=a+1)}}}}else Sp(i)&&r.charCodeAt(1)===bp&&(t=e>2&&Dt(r.charCodeAt(2))?3:2,n=t);let o=-1,s=!0;for(let a=e-1;a>=n;--a)if(Dt(r.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(o===-1){if(t===-1)return".";o=t}return r.slice(0,o)},basename(r,e){e!==void 0&&gn(e,"ext"),gn(r,"path");let t=0,n=-1,i=!0,o;if(r.length>=2&&Sp(r.charCodeAt(0))&&r.charCodeAt(1)===bp&&(t=2),e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=t;--o){let l=r.charCodeAt(o);if(Dt(l)){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=t;--o)if(Dt(r.charCodeAt(o))){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){gn(r,"path");let e=0,t=-1,n=0,i=-1,o=!0,s=0;r.length>=2&&r.charCodeAt(1)===bp&&Sp(r.charCodeAt(0))&&(e=n=2);for(let a=r.length-1;a>=e;--a){let l=r.charCodeAt(a);if(Dt(l)){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===Ip?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":r.slice(t,i)},format:xB.bind(null,"\\"),parse(r){gn(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.length,n=0,i=r.charCodeAt(0);if(t===1)return Dt(i)?(e.root=e.dir=r,e):(e.base=e.name=r,e);if(Dt(i)){if(n=1,Dt(r.charCodeAt(1))){let d=2,f=d;for(;d<t&&!Dt(r.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&Dt(r.charCodeAt(d));)d++;if(d<t&&d!==f){for(f=d;d<t&&!Dt(r.charCodeAt(d));)d++;d===t?n=d:d!==f&&(n=d+1)}}}}else if(Sp(i)&&r.charCodeAt(1)===bp){if(t<=2)return e.root=e.dir=r,e;if(n=2,Dt(r.charCodeAt(2))){if(t===3)return e.root=e.dir=r,e;n=3}}n>0&&(e.root=r.slice(0,n));let o=-1,s=n,a=-1,l=!0,u=r.length-1,c=0;for(;u>=n;--u){if(i=r.charCodeAt(u),Dt(i)){if(!l){s=u+1;break}continue}a===-1&&(l=!1,a=u+1),i===Ip?o===-1?o=u:c!==1&&(c=1):o!==-1&&(c=-1)}return a!==-1&&(o===-1||c===0||c===1&&o===a-1&&o===s+1?e.base=e.name=r.slice(s,a):(e.name=r.slice(s,o),e.base=r.slice(s,a),e.ext=r.slice(o,a))),s>0&&s!==n?e.dir=r.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},Sr={resolve(...r){let e="",t=!1;for(let n=r.length-1;n>=-1&&!t;n--){let i=n>=0?r[n]:SD();gn(i,"path"),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===fi)}return e=_D(e,!t,"/",fL),t?`/${e}`:e.length>0?e:"."},normalize(r){if(gn(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===fi,t=r.charCodeAt(r.length-1)===fi;return r=_D(r,!e,"/",fL),r.length===0?e?"/":t?"./":".":(t&&(r+="/"),e?`/${r}`:r)},isAbsolute(r){return gn(r,"path"),r.length>0&&r.charCodeAt(0)===fi},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){let n=r[t];gn(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":Sr.normalize(e)},relative(r,e){if(gn(r,"from"),gn(e,"to"),r===e||(r=Sr.resolve(r),e=Sr.resolve(e),r===e))return"";let t=1,n=r.length,i=n-t,o=1,s=e.length-o,a=i<s?i:s,l=-1,u=0;for(;u<a;u++){let d=r.charCodeAt(t+u);if(d!==e.charCodeAt(o+u))break;d===fi&&(l=u)}if(u===a)if(s>a){if(e.charCodeAt(o+u)===fi)return e.slice(o+u+1);if(u===0)return e.slice(o+u)}else i>a&&(r.charCodeAt(t+u)===fi?l=u:u===0&&(l=0));let c="";for(u=t+l+1;u<=n;++u)(u===n||r.charCodeAt(u)===fi)&&(c+=c.length===0?"..":"/..");return`${c}${e.slice(o+l)}`},toNamespacedPath(r){return r},dirname(r){if(gn(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===fi,t=-1,n=!0;for(let i=r.length-1;i>=1;--i)if(r.charCodeAt(i)===fi){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":r.slice(0,t)},basename(r,e){e!==void 0&&gn(e,"ext"),gn(r,"path");let t=0,n=-1,i=!0,o;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=0;--o){let l=r.charCodeAt(o);if(l===fi){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===fi){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){gn(r,"path");let e=-1,t=0,n=-1,i=!0,o=0;for(let s=r.length-1;s>=0;--s){let a=r.charCodeAt(s);if(a===fi){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===Ip?e===-1?e=s:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===t+1?"":r.slice(e,n)},format:xB.bind(null,"/"),parse(r){gn(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.charCodeAt(0)===fi,n;t?(e.root="/",n=1):n=0;let i=-1,o=0,s=-1,a=!0,l=r.length-1,u=0;for(;l>=n;--l){let c=r.charCodeAt(l);if(c===fi){if(!a){o=l+1;break}continue}s===-1&&(a=!1,s=l+1),c===Ip?i===-1?i=l:u!==1&&(u=1):i!==-1&&(u=-1)}if(s!==-1){let c=o===0&&t?1:o;i===-1||u===0||u===1&&i===s-1&&i===o+1?e.base=e.name=r.slice(c,s):(e.name=r.slice(c,i),e.base=r.slice(c,s),e.ext=r.slice(i,s))}return o>0?e.dir=r.slice(0,o-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Sr.win32=An.win32=An;Sr.posix=An.posix=Sr;var bs=Lo==="win32"?An.normalize:Sr.normalize,UDe=Lo==="win32"?An.isAbsolute:Sr.isAbsolute,qE=Lo==="win32"?An.join:Sr.join,PB=Lo==="win32"?An.resolve:Sr.resolve,DB=Lo==="win32"?An.relative:Sr.relative,xi=Lo==="win32"?An.dirname:Sr.dirname,Zt=Lo==="win32"?An.basename:Sr.basename,_p=Lo==="win32"?An.extname:Sr.extname,WDe=Lo==="win32"?An.format:Sr.format,VDe=Lo==="win32"?An.parse:Sr.parse,jDe=Lo==="win32"?An.toNamespacedPath:Sr.toNamespacedPath,Ki=Lo==="win32"?An.sep:Sr.sep,BDe=Lo==="win32"?An.delimiter:Sr.delimiter;p();var GE=require("vscode");p();p();p();p();var une=require("vscode");var ED=class{constructor(e){this.computeFn=e;this.lastCache=void 0;this.lastArgKey=void 0}get(e){let t=JSON.stringify(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this.computeFn(e)),this.lastCache}};p();var JE=class r{constructor(e){this.executor=e;this._didRun=!1}hasValue(){return this._didRun}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}map(e){return new r(()=>e(this.getValue()))}};function AB(r,e){return r<e?-1:r>e?1:0}function dne(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),u=e.charCodeAt(i);if(l<u)return-1;if(l>u)return 1}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function MB(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),u=e.charCodeAt(i);if(l===u)continue;if(l>=128||u>=128)return dne(r.toLowerCase(),e.toLowerCase(),t,n,i,o);TB(l)&&(l-=32),TB(u)&&(u-=32);let c=l-u;if(c!==0)return c}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function TB(r){return r>=97&&r<=122}function OB(r,e){return r.length===e.length&&MB(r,e)===0}function LB(r,e){let t=e.length;return e.length>r.length?!1:MB(r,e,0,t)===0}var ic=class ic{constructor(e){this.confusableDictionary=e}static getInstance(e){return ic.cache.get(Array.from(e))}static getLocales(){return ic._locales.getValue()}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};ic.ambiguousCharacterData=new JE(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}')),ic.cache=new ED(e=>{function t(c){let d=new Map;for(let f=0;f<c.length;f+=2)d.set(c[f],c[f+1]);return d}function n(c,d){let f=new Map(c);for(let[m,g]of d)f.set(m,g);return f}function i(c,d){if(!c)return d;let f=new Map;for(let[m,g]of c)d.has(m)&&f.set(m,g);return f}let o=ic.ambiguousCharacterData.getValue(),s=e.filter(c=>!c.startsWith("_")&&c in o);s.length===0&&(s=["_default"]);let a;for(let c of s){let d=t(o[c]);a=i(a,d)}let l=t(o._common),u=n(l,a);return new ic(u)}),ic._locales=new JE(()=>Object.keys(ic.ambiguousCharacterData.getValue()).filter(e=>!e.startsWith("_")));var kB=ic,$v=class $v{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set($v.getRawData())),this._data}static isInvisibleCharacter(e){return $v.getData().has(e)}static get codePoints(){return $v.getData()}};$v._data=void 0;var NB=$v;function Ep(r){return r===47||r===92}function mL(r){return r.replace(/[\\/]/g,Sr.sep)}function KB(r){return r.indexOf("/")===-1&&(r=mL(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function hL(r,e=Sr.sep){if(!r)return"";let t=r.length,n=r.charCodeAt(0);if(Ep(n)){if(Ep(r.charCodeAt(1))&&!Ep(r.charCodeAt(2))){let o=3,s=o;for(;o<t&&!Ep(r.charCodeAt(o));o++);if(s!==o&&!Ep(r.charCodeAt(o+1))){for(o+=1;o<t;o++)if(Ep(r.charCodeAt(o)))return r.slice(0,o+1).replace(/[\\/]/g,e)}}return e}else if(pne(n)&&r.charCodeAt(1)===58)return Ep(r.charCodeAt(2))?r.slice(0,2)+e:r.slice(0,2);let i=r.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(Ep(r.charCodeAt(i)))return r.slice(0,i+1)}return""}function gL(r,e,t,n=Ki){if(r===e)return!0;if(!r||!e||e.length>r.length)return!1;if(t){if(!LB(r,e))return!1;if(e.length===r.length)return!0;let o=e.length;return e.charAt(e.length-1)===n&&o--,r.charAt(o)===n}return e.charAt(e.length-1)!==n&&(e+=n),r.indexOf(e)===0}function pne(r){return r>=65&&r<=90||r>=97&&r<=122}p();var La;(Y=>(Y.inMemory="inmemory",Y.vscode="vscode",Y.internal="private",Y.walkThrough="walkThrough",Y.walkThroughSnippet="walkThroughSnippet",Y.http="http",Y.https="https",Y.file="file",Y.mailto="mailto",Y.untitled="untitled",Y.data="data",Y.command="command",Y.vscodeRemote="vscode-remote",Y.vscodeRemoteResource="vscode-remote-resource",Y.vscodeUserData="vscode-userdata",Y.vscodeCustomEditor="vscode-custom-editor",Y.vscodeNotebook="vscode-notebook",Y.vscodeNotebookCell="vscode-notebook-cell",Y.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",Y.vscodeNotebookCellOutput="vscode-notebook-cell-output",Y.vscodeInteractive="vscode-interactive",Y.vscodeInteractiveInput="vscode-interactive-input",Y.vscodeSettings="vscode-settings",Y.vscodeWorkspaceTrust="vscode-workspace-trust",Y.vscodeTerminal="vscode-terminal",Y.webviewPanel="webview-panel",Y.vscodeWebview="vscode-webview",Y.extension="extension",Y.vscodeFileResource="vscode-file",Y.tmp="tmp",Y.vsls="vsls"))(La||(La={}));function Ka(r){return bD?(r==null?void 0:r.path)||"":(r==null?void 0:r.fsPath)||""}var YE=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:AB(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1,i=HE?"\\":"/"){if(e.scheme===t.scheme){if(e.scheme===La.file)return gL(Ka(e),Ka(t),this._ignorePathCasing(e),i)&&e.query===t.query&&(n||e.fragment===t.fragment);if(FB(e.authority,t.authority))return gL(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return GE.Uri.joinPath(e,...t)}basenameOrAuthority(e){return mi(e)||e.authority}basename(e,t){return Sr.basename(e.path,t)}extname(e){return Sr.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===La.file?t=GE.Uri.file(xi(Ka(e))).path:(t=Sr.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===La.file?t=GE.Uri.file(bs(Ka(e))).path:t=Sr.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!FB(e.authority,t.authority))return;if(e.scheme===La.file){let o=DB(Ka(e),Ka(t));return HE?mL(o):o}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let o=0;for(let s=Math.min(n.length,i.length);o<s&&!(n.charCodeAt(o)!==i.charCodeAt(o)&&n.charAt(o).toLowerCase()!==i.charAt(o).toLowerCase());o++);n=i.substr(0,o)+n.substr(o)}return Sr.relative(n,i)}resolvePath(e,t){if(e.scheme===La.file){let n=GE.Uri.file(PB(Ka(e),t));return e.with({authority:n.authority,path:n.path})}return t=KB(t),e.with({path:Sr.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&OB(e,t)}hasTrailingPathSeparator(e,t=Ki){if(e.scheme===La.file){let n=Ka(e);return n.length>hL(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=Ki){return UB(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=Ki){let n=!1;if(e.scheme===La.file){let i=Ka(e);n=i!==void 0&&i.length===hL(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!UB(e,t)?e.with({path:e.path+"/"}):e}},ar=new YE(()=>!1),mTe=new YE(r=>r.scheme===La.file?!CB:!0),hTe=new YE(r=>!0),Xs=ar.isEqual.bind(ar),CD=ar.isEqualOrParent.bind(ar),Fa=ar.getComparisonKey.bind(ar),gTe=ar.basenameOrAuthority.bind(ar),mi=ar.basename.bind(ar),zv=ar.extname.bind(ar),Qv=ar.dirname.bind(ar),Fi=ar.joinPath.bind(ar),vTe=ar.normalizePath.bind(ar),vL=ar.relativePath.bind(ar),yTe=ar.resolvePath.bind(ar),bTe=ar.isAbsolutePath.bind(ar),FB=ar.isEqualAuthority.bind(ar),UB=ar.hasTrailingPathSeparator.bind(ar),STe=ar.removeTrailingPathSeparator.bind(ar),ITe=ar.addTrailingPathSeparator.bind(ar),WB;(o=>{o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(c=>{let[d,f]=c.split(":");d&&f&&a.set(d,f)});let u=s.path.substring(0,s.path.indexOf(";"));return u&&a.set(o.META_DATA_MIME,u),a}o.parseMetaData=i})(WB||(WB={}));p();function Pi(r=process.platform){return/^win/.test(r)?"Windows":/^darwin/.test(r)?"OSX":/^linux/.test(r)?"Linux":"Unknown"}function wD(r,e){return r.replace(/^~(?=$|\/|\\)/,e)}function mne(){if(!rc())return bL.Uri.file(require("os").homedir())}function lt(r){let e=Pi()==="Windows";if(r){let t=Ka(r);return t&&t.startsWith(Ki)&&t.length>1&&t[1]!==Ki&&e?t.slice(1):t||""}return""}function Ee(r,e=[],t){t=t||mne();let n;typeof r=="string"&&(n=bL.Uri.file(r)),typeof r!="string"&&(n=r);let i=yL(n,void 0,t),o=e.find(l=>n&&CD(n,l.uri,!0));if(e.length>1&&o)return`${o.name}${Ki}${yL(n,o.uri,t)}`;let s=o?[yL(n,o.uri,t)]:[],a=i;return[i,...s].forEach(l=>{l.length<a.length&&(a=l)}),a}function yL(r,e,t){let n=Pi()==="Windows";if(r&&e&&CD(r,e,!0)){let i=vL(e,r);if(i)return n?i.replace(/\//g,"\\"):i}if(r&&t&&CD(r,t,!0)){let i=vL(t,r);if(i)return i=n?i.replace(/\//g,"\\"):i,`~${Ki}${i}`}return lt(r)}p();p();var xD=class{constructor(){this.event=(e,t,n)=>{let i=this.add(t?e.bind(t):e);return n==null||n.push(i),i}}get size(){return this.listeners?typeof this.listeners=="function"?1:this.listeners.length:0}fire(e){if(this.listeners)if(typeof this.listeners=="function")this.listeners(e);else for(let t of this.listeners)t(e)}dispose(){this.listeners=void 0}add(e){return this.listeners?typeof this.listeners=="function"?this.listeners=[this.listeners,e]:this.listeners.push(e):this.listeners=e,{dispose:()=>this.rm(e)}}rm(e){if(!this.listeners)return;if(typeof this.listeners=="function"){this.listeners===e&&(this.listeners=void 0);return}let t=this.listeners.indexOf(e);t!==-1&&(this.listeners.length===2?this.listeners=t===0?this.listeners[1]:this.listeners[0]:this.listeners=this.listeners.slice(0,t).concat(this.listeners.slice(t+1)))}};p();function lr(r){let e=this,t=!1,n;return function(){return t||(t=!0,n=r.apply(e,arguments)),n}}p();var PD;(y=>{function r(P){return P&&typeof P=="object"&&typeof P[Symbol.iterator]=="function"}y.is=r;let e=Object.freeze([]);function t(){return e}y.empty=t;function*n(P){yield P}y.single=n;function i(P){return r(P)?P:n(P)}y.wrap=i;function o(P){return P||e}y.from=o;function s(P){return!P||P[Symbol.iterator]().next().done===!0}y.isEmpty=s;function a(P){return P[Symbol.iterator]().next().value}y.first=a;function l(P,A){for(let D of P)if(A(D))return!0;return!1}y.some=l;function u(P,A){for(let D of P)if(A(D))return D}y.find=u;function*c(P,A){for(let D of P)A(D)&&(yield D)}y.filter=c;function*d(P,A){let D=0;for(let T of P)yield A(T,D++)}y.map=d;function*f(...P){for(let A of P)for(let D of A)yield D}y.concat=f;function m(P,A,D){let T=D;for(let K of P)T=A(T,K);return T}y.reduce=m;function*g(P,A,D=P.length){for(A<0&&(A+=P.length),D<0?D+=P.length:D>P.length&&(D=P.length);A<D;A++)yield P[A]}y.slice=g;function b(P,A=Number.POSITIVE_INFINITY){let D=[];if(A===0)return[D,P];let T=P[Symbol.iterator]();for(let K=0;K<A;K++){let L=T.next();if(L.done)return[D,y.empty()];D.push(L.value)}return[D,{[Symbol.iterator](){return T}}]}y.consume=b})(PD||(PD={}));var DD;function jB(r){DD=r}function Mu(r){return DD==null||DD.push(r),r}function Ce(r){if(PD.is(r)){for(let e of r)if(e)try{e.dispose()}catch(t){console.warn(`dispose() failed for ${e}`,t)}return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}var kD=class kD{constructor(...e){this._toDispose=new Set;this._isDisposed=!1;e.forEach(t=>this.add(t)),Mu(this)}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Ce(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?kD.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}};kD.DISABLE_DISPOSED_WARNING=!1;var En=kD,Lr=class{constructor(...e){this._store=new En;this._isDisposed=!1;e.forEach(t=>this._store.add(t)),Mu(this)}get isDisposed(){return this._isDisposed}dispose(){this._store.dispose(),this._isDisposed=!0}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},oc=class extends Lr{constructor(){super();this._onDidDispose=new xD,this.onDidDispose=this._onDidDispose.event}dispose(){super.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose()}};var VB=class{constructor(){this._store=new Map;this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Ce(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get(e){return this._store.get(e)}set(e,t,n=!1){var i;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||(i=this._store.get(e))==null||i.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var TD=class{constructor(){this.references=new Map}acquire(e,...t){let n=this.references.get(e);n||(n={counter:0,object:this.createReferencedObject(e,...t)},this.references.set(e,n));let{object:i}=n,o=lr(()=>{n&&--n.counter===0&&(this.destroyReferencedObject(e,n.object),this.references.delete(e))});return n.counter++,{object:i,dispose:o}}};p();var V=require("vscode");p();var et=require("vscode"),SL=60,IL=SL*60,$E=IL*24,BB=$E*7,HB=$E*30,qB=$E*365;function Xv(r,e,t,n){typeof r!="number"&&(r=r.getTime());let i=Math.round((new Date().getTime()-r)/1e3);if(i<-30)return et.l10n.t("in {0}",Xv(new Date().getTime()+i*1e3,!1));if(!n&&i<30)return et.l10n.t("now");let o;return i<SL?(o=i,e?o===1?t?et.l10n.t("{0} second ago",o):et.l10n.t("{0} sec ago",o):t?et.l10n.t("{0} seconds ago",o):et.l10n.t("{0} secs ago",o):o===1?t?et.l10n.t("{0} second",o):et.l10n.t("{0} sec",o):t?et.l10n.t("{0} seconds",o):et.l10n.t("{0} secs",o)):i<IL?(o=Math.floor(i/SL),e?o===1?t?et.l10n.t("{0} minute ago",o):et.l10n.t("{0} min ago",o):t?et.l10n.t("{0} minutes ago",o):et.l10n.t("{0} mins ago",o):o===1?t?et.l10n.t("{0} minute",o):et.l10n.t("{0} min",o):t?et.l10n.t("{0} minutes",o):et.l10n.t("{0} mins",o)):i<$E?(o=Math.floor(i/IL),e?o===1?t?et.l10n.t("{0} hour ago",o):et.l10n.t("{0} hr ago",o):t?et.l10n.t("{0} hours ago",o):et.l10n.t("{0} hrs ago",o):o===1?t?et.l10n.t("{0} hour",o):et.l10n.t("{0} hr",o):t?et.l10n.t("{0} hours",o):et.l10n.t("{0} hrs",o)):i<BB?(o=Math.floor(i/$E),e?o===1?et.l10n.t("{0} day ago",o):et.l10n.t("{0} days ago",o):o===1?et.l10n.t("{0} day",o):et.l10n.t("{0} days",o)):i<HB?(o=Math.floor(i/BB),e?o===1?t?et.l10n.t("{0} week ago",o):et.l10n.t("{0} wk ago",o):t?et.l10n.t("{0} weeks ago",o):et.l10n.t("{0} wks ago",o):o===1?t?et.l10n.t("{0} week",o):et.l10n.t("{0} wk",o):t?et.l10n.t("{0} weeks",o):et.l10n.t("{0} wks",o)):i<qB?(o=Math.floor(i/HB),e?o===1?t?et.l10n.t("{0} month ago",o):et.l10n.t("{0} mo ago",o):t?et.l10n.t("{0} months ago",o):et.l10n.t("{0} mos ago",o):o===1?t?et.l10n.t("{0} month",o):et.l10n.t("{0} mo",o):t?et.l10n.t("{0} months",o):et.l10n.t("{0} mos",o)):(o=Math.floor(i/qB),e?o===1?t?et.l10n.t("{0} year ago",o):et.l10n.t("{0} yr ago",o):t?et.l10n.t("{0} years ago",o):et.l10n.t("{0} yrs ago",o):o===1?t?et.l10n.t("{0} year",o):et.l10n.t("{0} yr",o):t?et.l10n.t("{0} years",o):et.l10n.t("{0} yrs",o))}p();p();p();p();var y7=se(ge());var sy=class{async createHash(e,t="SHA-256"){return ja(e,t)}};sy=U([(0,y7.injectable)()],sy);var lT={},v7=!1,cT;typeof window=="object"?cT=window.crypto:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?cT=self.crypto:cT=require("node:crypto").webcrypto;async function ja(r,e){let t=r.includes("/")||r.includes("\\")||r.endsWith(".interactive");if(t&&lT[r])return lT[r];let n=await ele(r,e);return t&&!v7&&(Object.keys(lT).length>1e4&&(v7=!0),lT[r]=n),n}async function ele(r,e){let t=new TextEncoder().encode(r),n=await cT.subtle.digest({name:e},t);return Array.from(new Uint8Array(n)).map(o=>o.toString(16).padStart(2,"0")).join("")}function ay(r){if(typeof r=="string")try{let[e,t,n]=`${r.trim()}...`.split(".").map(i=>parseInt(i,10));return isNaN(e)?"":isNaN(t)?e.toString():isNaN(n)?`${e}.${t}`:`${e}.${t}.${n}`}catch(e){return w.error(`Failed to parse version ${r}`,e),""}return r?`${r.major}.${r.minor}.${r.micro}`:""}async function Rt(r){return ja(r,"SHA-256")}var eK=se(b7());var tC=require("vscode");function Ku(r){var l,u,c;let e=Hi(r);if(di&&w.ci(`Python Env Info for ${JSON.stringify(r)} is ${JSON.stringify(e)}`),e){let d=[];typeof((l=e.version)==null?void 0:l.major)=="number"&&(d.push(e.version.major.toString()),typeof e.version.minor=="number"&&(d.push(e.version.minor.toString()),typeof e.version.micro=="number"&&d.push(e.version.micro.toString())));let f=d.length?d.join("."):"",m=((u=e.environment)==null?void 0:u.name)||(e.environment?mi((c=e.environment)==null?void 0:c.folderUri):""),g=f?`Python ${f}`:"Python";return Dp(r)&&m?m:m?`${m} (${g})`:g}if(Object.keys(r).length===1&&r.id)return r.id;let t=ay(Fu(r)||"").trim(),n=Dp(r),i=t?`Python ${t}`:"Python",o=Ss(r);if(n&&o)return o;let s=[];o&&s.push(o);let a=Jr(r);return a&&a!=="Unknown"&&s.push(a),[i,s.length?`(${s.join(": ")})`:""].join(" ").trim()}function Ss(r){var n,i,o;let e=Hi(r),t=(n=e==null?void 0:e.environment)==null?void 0:n.name;return!t&&((i=e==null?void 0:e.environment)!=null&&i.folderUri)&&Jr(r)==="Conda"&&(t=mi((o=e==null?void 0:e.environment)==null?void 0:o.folderUri)),t}var nle=["Unknown","Conda","PipEnv","Poetry","Pyenv","Venv","VirtualEnv","VirtualEnvWrapper"];function Jr(r){let e=Hi(r);return e?ile(e):"Unknown"}function ile(r){var t,n;if(((t=r.environment)==null?void 0:t.type)==="Conda")return"Conda";let e=[["Conda","Conda"],["Pyenv","Pyenv"],["Pipenv","PipEnv"],["Poetry","Poetry"],["VirtualEnvWrapper","VirtualEnvWrapper"],["VirtualEnv","VirtualEnv"],["Venv","Venv"]];for(let[i,o]of e)if(r.tools.includes(i))return o;if(((n=r.environment)==null?void 0:n.type)==="VirtualEnvironment")return"VirtualEnv";for(let i of nle)if(r.tools.some(o=>o.toLowerCase()===i.toLowerCase()))return i;return"Unknown"}var Vo;function S7(r){Vo=r}function Dp(r){if(!r||!Vo)return!1;let e=Hi(r);return e&&Jr(e)==="Conda"&&!e.executable.uri}function Hi(r){if(r){if(!Vo)throw new Error("Python API not initialized");return Vo.environments.known.find(e=>e.id===r.id)}}async function tK(r){var n;if(!(r!=null&&r.id))return;if(Vo){let i=Vo.environments.known.find(o=>o.id===r.id);if((n=i==null?void 0:i.executable)!=null&&n.sysPrefix)return i.executable.sysPrefix}let t=await(await eK.PythonExtension.api()).environments.resolveEnvironment(r.id).then(i=>{var o;return(o=i==null?void 0:i.executable)==null?void 0:o.sysPrefix});return t||w.warn(`Unable to find sysPrefix for interpreter ${Ee(r.id)}`),t}function I7(r){var t;if(!(r!=null&&r.id))return;if(!Vo)throw new Error("Python API not initialized");let e=Vo.environments.known.find(n=>n.id===r.id);return(t=e==null?void 0:e.executable)==null?void 0:t.sysPrefix}async function Tp(r,e=!1){if(!(r!=null&&r.id))return;if(Vo&&!e){let i=Vo.environments.known.find(o=>o.id===r.id);if(i!=null&&i.version)return i.version}let n=await(await eK.PythonExtension.api()).environments.resolveEnvironment(r.id);return n!=null&&n.version||w.warn(`Unable to find Version for interpreter ${Ee(r.id)}`),n==null?void 0:n.version}function Fu(r){if(!(r!=null&&r.id))return;if(!Vo)throw new Error("Python API not initialized");let e=Vo.environments.known.find(t=>t.id===r.id);return e==null?void 0:e.version}function _7(){return Vo?Vo.environments.known:[]}function uT(r){var n,i;if(!r)return;let e,t=r.id;if(r.executable.uri)e=r.executable.uri;else if(Jr(r)==="Conda")e=Pi()==="Windows"?tC.Uri.joinPath(((n=r.environment)==null?void 0:n.folderUri)||tC.Uri.file(r.path),"python.exe"):tC.Uri.joinPath(((i=r.environment)==null?void 0:i.folderUri)||tC.Uri.file(r.path),"bin","python");else{w.warn(`Python environment ${Ee(r.id)} excluded as Uri is undefined`);return}return{id:t,uri:e}}function ole(r){return Ku(r)}var Ue;(P=>(P.bannerLabelYes=V.l10n.t("Yes"),P.bannerLabelNo=V.l10n.t("No"),P.canceled=V.l10n.t("Canceled"),P.cancel=V.l10n.t("Cancel"),P.ok=V.l10n.t("Ok"),P.refresh=V.l10n.t("Refresh"),P.refreshing=V.l10n.t("Refreshing..."),P.install=V.l10n.t("Install"),P.loadingExtension=V.l10n.t("Jupyter Extension loading..."),P.handleExtensionActivationError=V.l10n.t("Extension activation failed, run the 'Developer: Toggle Developer Tools' command for more information."),P.doNotShowAgain=V.l10n.t("Do not show again"),P.reload=V.l10n.t("Reload"),P.moreInfo=V.l10n.t("More Info"),P.learnMore=V.l10n.t("Learn more"),P.and=V.l10n.t("and"),P.reportThisIssue=V.l10n.t("Report this issue"),P.clickHereForMoreInfoWithHtml=A=>V.l10n.t("Click <a href='{0}'>here</a> for more info.",A)))(Ue||(Ue={}));var kp;(t=>(t.notInGroup=n=>V.l10n.t("User does not belong to experiment group '{0}'",n),t.inGroup=n=>V.l10n.t("User belongs to experiment group '{0}'",n)))(kp||(kp={}));var dT;(e=>e.jupyter=V.l10n.t("Jupyter"))(dT||(dT={}));var E7;(e=>e.currentWorkingDirectory="cwd:")(E7||(E7={}));var C7;(e=>e.bannerMessage=V.l10n.t("Would you like shift-enter to send code to the new Interactive Window experience?"))(C7||(C7={}));var w7;(e=>e.bannerMessage=V.l10n.t("Can you please take a minute to tell us about your notebooks experience in VS Code?"))(w7||(w7={}));var x7;(t=>(t.bannerLabelYes=V.l10n.t("Yes, take survey now"),t.bannerLabelNo=V.l10n.t("No, thanks")))(x7||(x7={}));var W;(J=>(J.warnWhenSelectingKernelWithUnSupportedPythonVersion=V.l10n.t("The version of Python associated with the selected kernel is no longer supported. Please consider selecting a different kernel."),J.installingPythonExtension=V.l10n.t("Installing Python extension and locating kernels."),J.pythonExtensionRequired=V.l10n.t("The Python Extension is required to perform that task. Click Yes to open Python Extension installation page."),J.rendererExtensionRequired=V.l10n.t("The Renderer Extension is required to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),J.rendererExtension1015Required=V.l10n.t("The installed version of the Renderer Extension is outdated and requires and update to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),J.pythonExtensionInstalled=V.l10n.t("Python Extension is now installed. Some features might not be available until a notebook or interactive window session is restarted."),J.unknownPackage=V.l10n.t("unknown"),J.interactiveWindowTitleFormat=te=>V.l10n.t("Interactive - {0}",te),J.interactiveWindowModeBannerTitle=V.l10n.t({message:"Do you want to open a new Interactive Window for this file? [More Information](command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D).",args:[],comment:'The string "command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D" should not be translated. It is a command that opens the settings page with the "jupyter.interactiveWindowMode" setting selected.'}),J.interactiveWindowModeBannerSwitchYes=V.l10n.t("Yes"),J.interactiveWindowModeBannerSwitchNo=V.l10n.t("No"),J.dataExplorerTitle=V.l10n.t("Data Viewer"),J.badWebPanelFormatString=te=>V.l10n.t({message:"<html><body><h1>{0} is not a valid file name</h1></body></html>",args:[te],comment:["Only translate the text within the HTML tags"]}),J.installingMissingDependencies=V.l10n.t("Installing missing dependencies"),J.validatingKernelDependencies=V.l10n.t("Validating kernel dependencies"),J.performingExport=V.l10n.t("Performing Export"),J.exportNotebookToPython=V.l10n.t("Exporting Notebook to Python"),J.sessionDisposed=V.l10n.t("Cannot execute code, session has been disposed. Please try restarting the Kernel."),J.passwordFailure=V.l10n.t("Failed to connect to password protected server. Check that password is correct."),J.incorrectPassword=V.l10n.t("Incorrect Password."),J.exportDialogFilter=V.l10n.t("Jupyter Notebooks"),J.exportDialogComplete=te=>V.l10n.t("Notebook written to {0}",te),J.exportDialogFailed=te=>V.l10n.t("Failed to export notebook. {0}",te),J.exportOpenQuestion1=V.l10n.t("Open in editor"),J.runCellLensCommandTitle=V.l10n.t("Run Cell"),J.importDialogTitle=V.l10n.t("Import Jupyter Notebook"),J.importDialogFilter="Jupyter Notebooks",J.notebookCheckForImportNo=V.l10n.t("Later"),J.libraryRequiredToLaunchJupyterNotInstalled=te=>V.l10n.t("Running cells requires {0} package.",te),J.librariesRequiredToLaunchJupyterNotInstalled=te=>V.l10n.t("Running cells requires {0} package.",te),J.libraryRequiredToLaunchJupyterNotInstalledInterpreter=(te,Xe)=>V.l10n.t("Running cells with '{0}' requires the {1} package.",te,Xe),J.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter=(te,Xe)=>V.l10n.t("Running cells with '{0}' requires the {1} package.",te,Xe),J.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreterAndRequiresUpdate=(te,Xe)=>V.l10n.t("Running cells with '{0}' requires the {1} package to be installed or requires an update.",te,Xe),J.librariesRequiredToLaunchJupyterNotInstalledInterpreter=(te,Xe)=>V.l10n.t("Running cells with '{0}' requires the {1} package.",te,Xe),J.installPackageInstructions=(te,Xe)=>V.l10n.t(`Run the following command to install '{0}' into the Python environment. 
Command: '{1}'`,te,Xe),J.pythonCondaKernelsWithoutPython=V.l10n.t("The Python Runtime and IPyKernel will be automatically installed upon selecting this environment."),J.selectJupyterInterpreter=V.l10n.t("Select an Interpreter to start Jupyter"),J.jupyterInstall=V.l10n.t("Install"),J.currentlySelectedJupyterInterpreterForPlaceholder=te=>V.l10n.t("Selected Environment {0}",te),J.jupyterNotSupported=te=>V.l10n.t("Jupyter cannot be started. Error attempting to locate Jupyter: {0}",te),J.jupyterNotebookNotInstalledOrNotFound=te=>{if(te){let Xe=ole(te);return V.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment '{0}'.",Xe)}else return V.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment.")},J.jupyterNotSupportedBecauseOfEnvironment=(te,Xe)=>V.l10n.t("Activating {0} to run Jupyter failed with {1}",te,Xe),J.jupyterNbConvertNotSupported=V.l10n.t("Jupyter nbconvert is not installed"),J.jupyterLaunchTimedOut=V.l10n.t("The Jupyter notebook server failed to launch in time"),J.jupyterLaunchNoURL=V.l10n.t("Failed to find the URL of the launched Jupyter notebook server"),J.jupyterSelfCertFail=te=>V.l10n.t(`The security certificate used by server {0} was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,te),J.jupyterExpiredCertFail=te=>V.l10n.t(`The security certificate used by server {0} has expired.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,te),J.jupyterSelfCertFailErrorMessageOnly=V.l10n.t(`The security certificate used by server was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.`),J.jupyterSelfCertExpiredErrorMessageOnly=V.l10n.t(`The security certificate used by server has expired.\r
This may indicate an attempt to steal your information.`),J.jupyterSelfCertEnable=V.l10n.t("Yes, connect anyways"),J.jupyterSelfCertClose=V.l10n.t("No, close the connection"),J.pythonInteractiveHelpLink=V.l10n.t("See <https://aka.ms/pyaiinstall> for help on installing Jupyter."),J.importingFormat=te=>V.l10n.t("Importing {0}",te),J.startingJupyter=V.l10n.t("Starting Jupyter Server"),J.connectingToKernel=te=>V.l10n.t("Connecting to kernel: {0}",te),J.connectingToJupyter=V.l10n.t("Connecting to Jupyter Server"),J.exportingFormat=te=>V.l10n.t("Exporting {0}",te),J.runAllCellsLensCommandTitle=V.l10n.t("Run All Cells"),J.runAllCellsAboveLensCommandTitle=V.l10n.t("Run Above"),J.runCellAndAllBelowLensCommandTitle=V.l10n.t("Run Below"),J.restartKernelMessage=V.l10n.t("Do you want to restart the Jupyter kernel? All variables will be lost."),J.restartKernelMessageYes=V.l10n.t("Restart"),J.restartKernelMessageDontAskAgain=V.l10n.t("Don't Ask Again"),J.automaticallyReconnectingToAKernelProgressMessage=te=>V.l10n.t("Reconnecting to the kernel {0}",te),J.restartingKernelStatus=te=>V.l10n.t("Restarting Kernel {0}",te),J.interruptingKernelFailed=V.l10n.t("Kernel interrupt failed. Jupyter Server is hung. Please reload VS Code."),J.sessionStartFailedWithKernel=te=>V.l10n.t({message:`Failed to start the Kernel '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.failedToStartJupyter=te=>V.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.failedToStartJupyterWithErrorInfo=(te,Xe)=>V.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
{1} 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te,Xe],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.failedToStartJupyterDueToOutdatedTraitlets=(te,Xe)=>V.l10n.t({message:`Failed to start Jupyter in the environment '{0}' possibly due to an outdated version of 'traitlets'. 
{1} 
Consider updating the 'traitlets' module to '5.1.1' or later. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te,Xe],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the text 'traitlets', that is a Python module name"]}),J.failedToStartKernel=V.l10n.t("Failed to start the Kernel."),J.failedToRestartKernel=V.l10n.t("Failed to restart the Kernel."),J.failedToInterruptKernel=V.l10n.t("Failed to interrupt the Kernel."),J.rawKernelStartFailedDueToTimeout=te=>V.l10n.t({message:`Unable to start Kernel '{0}' due to a connection timeout. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.rawKernelStartFailedDueToTimeoutWaitingForPort=te=>V.l10n.t({message:`Unable to start Kernel '{0}' due to a timeout waiting for the ports to get used. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.viewJupyterLogForFurtherInfo=V.l10n.t({message:"View Jupyter [log](command:jupyter.viewOutput) for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.kernelDied=te=>V.l10n.t({message:"The kernel died. Error: {0}... View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.kernelDiedWithoutError=te=>V.l10n.t({message:"The kernel '{0}' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),J.failedToStartAnUntrustedKernelSpec=(te,Xe)=>V.l10n.t({message:`The kernel '{0}' was not started as it is located in an insecure location '{1}'.  
Click [here](https://aka.ms/JupyterTrustedKernelPaths) for further details, optionally update the setting [jupyter.kernels.trusted](command:workbench.action.openSettings?["jupyter.kernels.trusted"]) to trust the kernel.`,args:[te,Xe],comment:['Do not translate the text "jupyter.kernels.trusted", that is a setting in VS Code','Do not translate the text command:workbench.action.openSettings?["jupyter.kernels.trusted"], that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/JupyterTrustedKernelPaths"]}),J.kernelDiedWithoutErrorAndAutoRestarting=te=>V.l10n.t({message:"The kernel '{0}' died and is being automatically restarted by Jupyter. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[te],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),J.kernelCrashedDueToCodeInCurrentOrPreviousCell=V.l10n.t({message:`The Kernel crashed while executing code in the current cell or a previous cell. 
Please review the code in the cell(s) to identify a possible cause of the failure. 
Click <a href='https://aka.ms/vscodeJupyterKernelCrash'>here</a> for more info. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),J.kernelDisconnected=te=>V.l10n.t("Unable to connect to the kernel '{0}', please verify the Jupyter Server connection. View Jupyter [log](command:jupyter.viewOutput) for further details.",te),J.cannotRunCellKernelIsDead=te=>V.l10n.t("Cannot run cells, as the kernel '{0}' is dead.",te),J.showJupyterLogs=V.l10n.t("Show Jupyter Logs."),J.restartKernel=V.l10n.t("Restart Kernel"),J.reloadRequired=V.l10n.t("Please reload the window for new settings to take effect."),J.restartedKernelHeader=te=>V.l10n.t("Restarted {0}",te),J.connectedKernelHeader=te=>V.l10n.t("Connected to {0}",te),J.restartingKernelCustomHeader=te=>V.l10n.t("_Restarting {0}..._",te),J.restartingKernelHeader=V.l10n.t("_Restarting kernel..._"),J.startingNewKernelHeader=V.l10n.t("_Connecting to kernel..._"),J.startingNewKernelCustomHeader=te=>V.l10n.t("_Connecting to {0}..._",te),J.noKernelConnected=V.l10n.t("No kernel connected"),J.jupyterSelectUriCommandLabel=V.l10n.t("Enter the URL of the running Jupyter Server..."),J.jupyterSelectUriInputTitle=V.l10n.t("Enter the URL of the running Jupyter Server"),J.jupyterSelectUriInputPlaceholder=V.l10n.t("Enter the url of the running Jupyter Server"),J.connectToToTheJupyterServer=te=>V.l10n.t("Connect to the Jupyter Server {0}",te),J.enterOrSelectRemoteJupyterPlaceholder=V.l10n.t("Enter a remote url, or select a remote server"),J.selectRemoteJupyterPlaceholder=V.l10n.t("Select a remote server"),J.jupyterServerLastConnectionForQuickPickDescription=te=>V.l10n.t("Last connected {0}",Xv(te,!0,!1,!1)),J.jupyterServerNotUsedBeforeQuickPickSeparatorTitle=V.l10n.t("Jupyter Servers"),J.jupyterSelectURIInvalidURI=V.l10n.t("Invalid URL specified"),J.jupyterSelectURIMustBeHttpOrHttps=V.l10n.t("Invalid protocol in URL specified, only HTTP or HTTPS are supported."),J.jupyterSelectLiveRemoteKernelDescription=(te,Xe)=>te?Xe===0?V.l10n.t("Last activity {0}",Xv(te,!0,!1,!1)):Xe===1?V.l10n.t("Last activity {0}, 1 connection",Xv(te,!0,!1,!1)):V.l10n.t("Last activity {0}, {1} connections",Xv(te,!0,!1,!1),Xe.toString()):Xe===0?"":Xe===1?V.l10n.t("1 connection"):V.l10n.t("{0} connections",Xe.toString()),J.installJupyterHub=V.l10n.t("Install the JupyterHub extension to connect to JupyterHub servers."),J.useJupyterHubExtension=V.l10n.t("Select 'Existing JupyterHub Server...' from the Kernel Picker"),J.useJupyterHubExtensionDetail=V.l10n.t("Use this option when connecting to JupyterHub servers"),J.installJupyterHubDetail=V.l10n.t("Once installed, open the Kernel Picker and select 'Existing JupyterHub Server...'"),J.jupyterSelectUserAndPasswordTitle=V.l10n.t("Enter your user name and password to connect to Jupyter Hub"),J.jupyterRenameServer=V.l10n.t("Change Server Display Name (Leave Blank To Use URL)"),J.jupyterServerUriDisplayNameInputPlaceholder=V.l10n.t("Enter a display name"),J.jupyterSelectUserPrompt=V.l10n.t("Enter your user name"),J.jupyterSelectPasswordPrompt=V.l10n.t("Enter your password"),J.jupyterSelectPasswordTitle=V.l10n.t("Enter your password for the Jupyter Server"),J.pythonNotInstalled=V.l10n.t(`Python is not installed. 
Please download and install Python in order to execute cells in this notebook. 
Once installed please reload VS Code.`),J.pleaseReloadVSCodeOncePythonHasBeenInstalled=V.l10n.t("Upon installing Python please reload VS Code."),J.jupyterNotebookFailure=te=>V.l10n.t(`Jupyter notebook failed to launch. \r
{0}`,te),J.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid=te=>V.l10n.t("The remote Jupyter Server contributed by the extension '{0}' is no longer available.",te),J.remoteJupyterConnectionFailedWithServerWithError=(te,Xe)=>V.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable. ({1}).",te,Xe),J.remoteJupyterConnectionFailedWithServer=te=>V.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable.",te),J.remoteJupyterConnectionFailedWithoutServerWithError=te=>V.l10n.t("Connection failure. Verify the server is running and reachable. ({0}).",te),J.remoteJupyterConnectionFailedWithoutServerWithErrorWeb=te=>V.l10n.t(`Connection failure. Verify the server is running and reachable from a browser. ({0}). 
When connecting from vscode.dev Jupyter servers must be started with specific options to connect. 
Click [here](https://aka.ms/vscjremoteweb) for more information.`,te),J.removeRemoteJupyterConnectionButtonText=V.l10n.t("Forget Connection"),J.jupyterNotebookRemoteConnectFailedWeb=te=>V.l10n.t(`Failed to connect to remote Jupyter Server.\r
Check that the Jupyter Server URL can be reached from a browser.\r
{0}. Click [here](https://aka.ms/vscjremoteweb) for more information.`,te),J.packageNotInstalledWindowsLongPathNotEnabledError=(te,Xe)=>V.l10n.t(`Support for Windows Long Path has not been enabled, hence the package {0} could not be installed into the Python Environment '{1}'.
Please ensure that support for Windows Long Path is enabled.
See [here](https://pip.pypa.io/warnings/enable-long-paths) for more information.`,te,Xe),J.changeRemoteJupyterConnectionButtonText=V.l10n.t("Manage Connections"),J.rawConnectionBrokenError=V.l10n.t("Direct kernel connection broken"),J.jupyterServerCrashed=te=>V.l10n.t(`Jupyter Server crashed. Unable to connect. \r
Error code from Jupyter: {0}`,te.toString()),J.jupyterKernelSpecModuleNotFound=te=>V.l10n.t(`'Kernelspec' module not installed in the selected interpreter ({0}).
 Please re-install or update 'jupyter'.`,te),J.interruptKernelStatus=te=>V.l10n.t("Interrupting Kernel {0}",te),J.exportPythonQuickPickLabel=V.l10n.t("Python Script"),J.exportHTMLQuickPickLabel=V.l10n.t("HTML"),J.exportPDFQuickPickLabel=V.l10n.t("PDF"),J.restartKernelAfterInterruptMessage=te=>V.l10n.t("Interrupting the kernel '{0}' timed out. Do you want to restart the kernel instead? All variables will be lost.",te),J.documentMismatch=te=>V.l10n.t("Cannot run cells, duplicate documents for {0} found.",te),J.jupyterGetVariablesBadResults=V.l10n.t("Failed to fetch variable info from the Jupyter Server."),V.l10n.t("Failure to create an 'Interactive' window. Try reinstalling the Python Extension."),J.jupyterGetVariablesExecutionError=te=>V.l10n.t(`Failure during variable extraction: \r
{0}`,te),J.selectKernel=V.l10n.t("Change Kernel"),J.selectDifferentKernel=V.l10n.t("Select a different Kernel"),J.kernelFilterPlaceholder=V.l10n.t("Choose the kernels that are available in the kernel picker."),J.recommendedItemCategoryInQuickPick=V.l10n.t("Recommended"),J.selectedKernelCategoryInQuickPick=V.l10n.t("Selected"),J.createPythonEnvironmentInQuickPick=V.l10n.t("Create Python Environment"),J.createPythonEnvironmentInQuickPickTooltip=V.l10n.t("Create an isolated Python Environment per workspace folder"),J.selectDifferentJupyterInterpreter=V.l10n.t("Change Interpreter"),J.pandasTooOldForViewingFormat=(te,Xe)=>V.l10n.t({message:"Python package 'pandas' is version {0}. Version {1} or greater is required for viewing data.",args:[te,Xe],comment:["Do not translate 'pandas' as that is a Python module name"]}),J.pandasRequiredForViewing=te=>V.l10n.t({message:"Python package 'pandas' version {0} (or above) is required for viewing data.",args:[te],comment:["Do not translate 'pandas' as that is a Python module name"]}),J.tooManyColumnsMessage=V.l10n.t("Variables with over a 1000 columns may take a long time to display. Are you sure you wish to continue?"),J.tooManyColumnsYes=V.l10n.t("Yes"),J.tooManyColumnsNo=V.l10n.t("No"),J.tooManyColumnsDontAskAgain=V.l10n.t("Don't Ask Again"),J.plotViewerTitle=V.l10n.t("Plots"),J.exportPlotTitle=V.l10n.t("Save plot image"),J.pdfFilter="PDF",J.pngFilter="PNG",J.svgFilter="SVG",J.exportImageFailed=te=>V.l10n.t("Error exporting image: {0}",te),J.jupyterDataRateExceeded=V.l10n.t({message:"Cannot view variable because data rate exceeded. Please restart your server with a higher data rate limit. For example, --NotebookApp.iopub_data_rate_limit=10000000000.0",comment:["Do not translate the text --NotebookApp.iopub_data_rate_limit=10000000000.0 as that is a command argument."]}),J.addCellBelowCommandTitle=V.l10n.t("Add cell"),J.debugCellCommandTitle=V.l10n.t("Debug Cell"),J.debugStepOverCommandTitle=V.l10n.t("Step over"),J.debugContinueCommandTitle=V.l10n.t("Continue"),J.debugStopCommandTitle=V.l10n.t("Stop"),J.runCurrentCellAndAddBelow=V.l10n.t("Run current cell and add empty cell below"),J.jupyterDebuggerNotInstalledError=te=>V.l10n.t("Pip module {0} is required for debugging cells. You will need to install it to debug cells.",te),J.jupyterDebuggerOutputParseError=te=>V.l10n.t("Unable to parse {0} output, please log an issue with https://github.com/microsoft/vscode-jupyter",te),J.cellStopOnErrorMessage=V.l10n.t("Cell was canceled due to an error in a previous cell."),J.scrollToCellTitleFormatMessage=te=>V.l10n.t("Go to [{0}]",te.toString()),J.instructionComments=te=>V.l10n.t(`# To add a new cell, type '{0}'
# To add a new markdown cell, type '{0} [markdown]'
`,te),J.exportButtonTitle=V.l10n.t("Export"),J.exportAsQuickPickPlaceholder=V.l10n.t("Export As..."),J.openExportedFileMessage=V.l10n.t("Would you like to open the exported file?"),J.openExportFileYes=V.l10n.t("Yes"),J.openExportFileNo=V.l10n.t("No"),J.exportFailedGeneralMessage=V.l10n.t({message:"Please check the 'Jupyter' [output](command:jupyter.viewOutput) panel for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),J.exportToPDFDependencyMessage=V.l10n.t(`If you have not installed xelatex (TeX), you will need to do so before you can export to PDF. For further instructions, please see https://nbconvert.readthedocs.io/en/latest/install.html#installing-tex. \r
To avoid installing xelatex (TeX), you might want to try exporting to HTML and using your browser's "Print to PDF" feature.`),J.failedExportMessage=V.l10n.t("Export failed."),J.startingJupyterLogMessage=(te,Xe)=>V.l10n.t("Starting Jupyter from {0} with arguments {1}",te,Xe),J.waitingForJupyterSessionToBeIdle=V.l10n.t("Waiting for Jupyter Session to be idle"),J.gettingListOfKernelsForRemoteConnection=V.l10n.t("Fetching Kernels"),J.gettingListOfKernelSpecs=V.l10n.t("Fetching Kernel specs"),J.startingJupyterNotebook=V.l10n.t("Starting Jupyter Notebook"),J.registeringKernel=V.l10n.t("Registering Kernel"),J.jupyterCommandLineReloadQuestion=V.l10n.t("Please reload the window when changing the Jupyter command line."),J.jupyterCommandLineReloadAnswer=V.l10n.t("Reload"),J.createdNewKernel=(te,Xe)=>V.l10n.t("{0}: Kernel started: {1}",te,Xe),J.kernelInvalid=te=>V.l10n.t("Kernel {0} is not usable. Check the Jupyter output tab for more information.",te),J.removeRemoteJupyterServerEntryInQuickPick=V.l10n.t("Remove"),J.loadClassFailedWithNoInternet=(te,Xe)=>V.l10n.t("Error loading {0}:{1}. Internet connection required for loading 3rd party widgets.",te,Xe),J.useCDNForWidgetsNoInformation=V.l10n.t("Widgets require us to download supporting files from a 3rd party website."),J.enableCDNForWidgetsSetting=(te,Xe)=>V.l10n.t("Widgets require us to download supporting files from a 3rd party website. (Error loading {0}:{1}).",te,Xe),J.enableCDNForWidgetsButton=V.l10n.t("Enable Downloads"),J.unhandledMessage=(te,Xe)=>V.l10n.t("Unhandled kernel message from a widget: {0} : {1}",te,Xe),J.cdnWidgetScriptNotAccessibleWarningMessage=(te,Xe)=>V.l10n.t("Unable to download widget '{0}' from 3rd party website {1}, due to network access. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",te,Xe),J.widgetScriptNotFoundOnCDNWidgetMightNotWork=(te,Xe,Fre)=>V.l10n.t("Unable to find widget '{0}' version '{1}' from configured widget sources {2}. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",te,Xe,Fre),J.insecureSessionMessage=V.l10n.t("Connecting over HTTP without a token may be an insecure connection. Do you want to connect to a possibly insecure server?"),J.insecureSessionDenied=V.l10n.t("Denied connection to insecure server."),J.selectKernelForEditor=V.l10n.t("[Select a kernel](command:_notebook.selectKernel) to run cells."),J.needIpykernel6=V.l10n.t("Ipykernel setup required for this feature"),J.setup=V.l10n.t("Setup"),J.showDataViewerFail=V.l10n.t("Failed to create the Data Viewer. Check the Jupyter tab of the Output window for more info."),J.defaultNotebookName=V.l10n.t("default"),J.recommendExtensionForNotebookLanguage=(te,Xe)=>V.l10n.t("The {0} extension is recommended for notebooks targeting the language '{1}'",te,Xe),J.kernelWasNotStarted=V.l10n.t("Kernel was not started. A kernel session is needed to start debugging."),J.noNotebookToDebug=V.l10n.t("No active notebook document to debug."),J.cantStartDebugging=V.l10n.t("Can't start debugging."),J.restartNotSupported=V.l10n.t("Restarting is not supported in the interactive window."),J.importingIpynb=V.l10n.t("Importing notebook file"),J.exportingToFormat=te=>V.l10n.t("Exporting to {0}",te),J.kernelCategoryForJupyterSession=V.l10n.t("Jupyter Session"),J.kernelDefaultRemoteDisplayName=V.l10n.t("Remote"),J.kernelCategoryForJupyterKernel=V.l10n.t("Jupyter Kernel"),J.kernelCategoryForRemoteJupyterKernel=V.l10n.t("Jupyter Kernel"),J.kernelCategoryForConda=V.l10n.t("Conda Env"),J.kernelCategoryForCondaWithoutPython=V.l10n.t("Conda Env Without Python"),J.kernelCategoryForPoetry=V.l10n.t("Poetry Env"),J.kernelCategoryForPipEnv=V.l10n.t("Pipenv Env"),J.kernelCategoryForPyEnv=V.l10n.t("PyEnv Env"),J.kernelCategoryForGlobal=V.l10n.t("Global Env"),J.kernelCategoryForVirtual=V.l10n.t("Virtual Env"),J.fileSeemsToBeInterferingWithKernelStartup=te=>V.l10n.t("The file '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the file and starting the kernel again.",te),J.moduleSeemsToBeInterferingWithKernelStartup=te=>V.l10n.t("The module '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the folder and starting the kernel again.",te),J.pipCondaInstallHoverWarning=(te,Xe)=>V.l10n.t("'!{0} install' could install packages into the wrong environment. [More info]({1})",te,Xe),J.percentPipCondaInstallInsteadOfBang=te=>V.l10n.t({message:"Use '%{0} install' instead of '!{0} install'",args:[te],comment:['Do not translate the string within quotes, such as "%{0} install" and "!{0} install" as that is a Jupyter Shell Magic command']}),J.replacePipCondaInstallCodeAction=te=>V.l10n.t("Replace with '%{0} install'",te),J.failedToStartKernelDueToMissingModule=te=>V.l10n.t("The kernel failed to start due to the missing module '{0}'. Consider installing this module.",te),J.failedToStartKernelDueToImportFailure=te=>V.l10n.t("The kernel failed to start as the module '{0}' could not be imported.",te),J.failedToStartKernelDueToImportFailureFromFile=(te,Xe)=>V.l10n.t("The kernel failed to start as '{0}' could not be imported from '{1}'.",te,Xe),J.failedToStartKernelDueToUnknownDllLoadFailure=V.l10n.t("The kernel failed to start as a dll could not be loaded."),J.failedToStartKernelDueToDllLoadFailure=te=>V.l10n.t("The kernel failed to start as the dll '{0}' could not be loaded.",te),J.failedToStartKernelDueToWin32APIFailure=V.l10n.t("The kernel failed to start due to an error with the Win32api module. Consider (re) installing this module."),J.failedToStartKernelDueToPyZmqFailure=V.l10n.t({message:"The kernel failed to start due to an error with the 'pyzmq' module. Consider re-installing this module.",comment:['Do not translate the string "pyzmq" as that is a Python module.']}),J.failedToStartKernelDueToOldIPython=V.l10n.t("The kernel failed to start due to an outdated version of IPython. Consider updating this module to the latest version."),J.failedToStartKernelDueToOldIPyKernel=V.l10n.t("The kernel failed to start due to an outdated version of IPyKernel. Consider updating this module to the latest version."),J.failedToStartKernelDueToMissingPythonEnv=te=>V.l10n.t("The kernel failed to start as the Python Environment '{0}' is no longer available. Consider selecting another kernel or refreshing the list of Python Environments.",te),J.matplotlibWidgetInsteadOfOther=V.l10n.t("'%matplotlib' widget works best inside of VS Code"),J.matplotlibWidgetCodeActionTitle=V.l10n.t("More info"),J.allowExtensionToUseJupyterKernelApi=(te,Xe)=>V.l10n.t("Do you want to give the extension '{0}' access to the Jupyter Kernels? Clicking '{1}' would allow this extension to execute code against the Jupyter Kernels.",te,Xe),J.thanksForUsingJupyterKernelApiPleaseRegisterWithUs=te=>V.l10n.t("Thank you for trying the Jupyter API. Please file an issue on our repo to allow the extension {0} to use this API in production. This would prevent us from breaking your extension when updating the API (as it is still a work in progress).",te),J.activatingPythonEnvironment=te=>V.l10n.t("Activating Python Environment '{0}'",te),J.runningKernelStartupHooksFor=te=>V.l10n.t("Running Kernel startup hooks in '{0}'",te),J.cellAtFormat=(te,Xe)=>V.l10n.t("{0} Cell {1}",te,Xe),J.jupyterServerConsoleOutputChannel=V.l10n.t("Jupyter Server Console"),J.kernelConsoleOutputChannel=te=>V.l10n.t("{0} Kernel Console Output",te),J.webNotSupported=V.l10n.t("Operation not supported in web version of Jupyter Extension."),J.failedToInstallPythonExtension=V.l10n.t("Failed to install the Python Extension."),J.filesPossiblyOverridingPythonModulesMayHavePreventedKernelFromStarting=te=>V.l10n.t("Some of the following files found in the working directory may have prevented the Kernel from starting. Consider renaming them.",te),J.listOfFilesWithLinksThatMightNeedToBeRenamed=te=>V.l10n.t("File(s): {0} might need to be renamed.",te),J.failedToGetVersionOfPandas=V.l10n.t("Failed to get version of Pandas to use the Data Viewer."),J.failedToInstallPandas=V.l10n.t("Failed to install Pandas to use the Data Viewer."),J.localKernelSpecs=V.l10n.t("Jupyter Kernel..."),J.localPythonEnvironments=V.l10n.t("Python Environments..."),J.quickPickTitleForSelectionOfJupyterServer=V.l10n.t("Select a Jupyter Server"),J.UserJupyterServerUrlProviderDisplayName=V.l10n.t("Existing Jupyter Server..."),J.UserJupyterServerUrlProviderDetail=V.l10n.t("Connect to an existing Jupyter Server"),J.kernelPickerSelectKernelTitle=V.l10n.t("Select Kernel"),J.kernelPickerSelectLocalKernelSpecTitle=V.l10n.t("Select a Jupyter Kernel"),J.quickPickSelectPythonEnvironmentTitle=V.l10n.t("Select a Python Environment"),J.kernelPickerSelectKernelFromRemoteTitle=te=>V.l10n.t("Select a Kernel from {0}",te),J.kernelPickerSelectKernelFromRemoteTitleWithoutName=V.l10n.t("Select a Jupyter Kernel"),J.installPythonExtensionViaKernelPickerTitle=V.l10n.t("Install Python Extension"),J.installPythonExtensionViaKernelPickerToolTip=V.l10n.t("Python Extension is required to detect and use Python environments for the execution of code cells."),J.installPythonQuickPickTitle=V.l10n.t("Install Python"),J.installPythonQuickPickToolTip=V.l10n.t("Python Environments not detected. Upon installation reload VS Code or refresh the list of Kernels."),J.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel=V.l10n.t({message:"$(error) Unable to connect to the remote server",comment:"Do not translate the string $(error) as that is a VS Code icon."}),J.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail=V.l10n.t("Ensure the server is running and reachable."),J.dataViewerDeprecationMessage=V.l10n.t("The built-in data viewer will be deprecated soon. Please install other data viewing extensions to keep the ability to inspect data."),J.dataViewerDeprecationRecommendationActionMessage=V.l10n.t("See Recommended Extensions"),J.dataViewerExtensionRequired=V.l10n.t("A Data Viewer Extension is required to view data frames. Click Yes to see recommended extensions."),J.selectExternalDataViewer=V.l10n.t("Select DataFrame Viewer")))(W||(W={}));var Ft;(ce=>(ce.collapseSingle=V.l10n.t("Collapse"),ce.expandSingle=V.l10n.t("Expand"),ce.noRowsInDataViewer=V.l10n.t("No rows match current filter"),ce.sliceIndexError=V.l10n.t({message:"Index {0} out of range for axis {1} with {2} elements",comment:["Do not translate the strings {0}, {1} and {2} as they are variable names and will be replaced later"]}),ce.sliceMismatchedAxesError=V.l10n.t({message:"Expected {0} axes, got {1} in slice expression",comment:["Do not translate the strings {0} and {2} as they are variable names and will be replaced later"]}),ce.fetchingDataViewer=V.l10n.t("Fetching data ..."),ce.dataViewerHideFilters=V.l10n.t("Hide filters"),ce.dataViewerShowFilters=V.l10n.t("Show filters"),ce.refreshDataViewer=V.l10n.t("Refresh data viewer"),ce.sliceSummaryTitle=V.l10n.t("SLICING"),ce.sliceData=V.l10n.t("Slice Data"),ce.sliceSubmitButton=V.l10n.t("Apply"),ce.sliceDropdownAxisLabel=V.l10n.t("Axis"),ce.sliceDropdownIndexLabel=V.l10n.t("Index"),ce.variableExplorerNameColumn=V.l10n.t("Name"),ce.variableExplorerTypeColumn=V.l10n.t("Type"),ce.variableExplorerCountColumn=V.l10n.t("Size"),ce.variableExplorerValueColumn=V.l10n.t("Value"),ce.collapseVariableExplorerLabel=V.l10n.t("Variables"),ce.variableLoadingValue=V.l10n.t("Loading..."),ce.showDataExplorerTooltip=V.l10n.t("Show variable snapshot in data viewer"),ce.noRowsInVariableExplorer=V.l10n.t("No variables defined"),ce.loadingRowsInVariableExplorer=V.l10n.t("Loading variables"),ce.previousPlot=V.l10n.t("Previous"),ce.nextPlot=V.l10n.t("Next"),ce.panPlot=V.l10n.t("Pan"),ce.zoomInPlot=V.l10n.t("Zoom in"),ce.zoomOutPlot=V.l10n.t("Zoom out"),ce.exportPlot=V.l10n.t("Export to different formats"),ce.deletePlot=V.l10n.t("Remove"),ce.selectedImageListLabel=V.l10n.t("Selected Image"),ce.selectedImageLabel=V.l10n.t("Image"),ce.errorOutputExceedsLinkToOpenFormatString=V.l10n.t({message:"Output exceeds the <a href={0}>size limit</a>. Open the full output data <a href={1}>in a text editor</a>",comment:['Do not translate the the Hyperlink text "<a href={0}>size limit</a>" and "<a href={1}>in a text editor</a>". However the text inside those tags can be translated']}),ce.dvDeprecationWarning=V.l10n.t('The built-in data viewer will be deprecated and no longer usable starting with Visual Studio Code 1.92. Please <a href="command:workbench.extensions.search?%22@tag:jupyterVariableViewers%22">install other data viewing extensions</a> to continue inspecting data')))(Ft||(Ft={}));var cy;(n=>(n.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE=V.l10n.t({message:"The setting 'python.formatting.formatOnSave' is deprecated, please use 'editor.formatOnSave'.",comment:['Do not translate the string "python.formatting.formatOnSave" as that is a setting in VS Code','Do not translate the string "editor.formatOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE=V.l10n.t({message:"The setting 'python.linting.lintOnTextChange' is deprecated, please enable 'python.linting.lintOnSave' and 'files.autoSave'.",comment:['Do not translate the string "python.linting.lintOnTextChange" as that is a setting in VS Code','Do not translate the string "python.linting.lintOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES=V.l10n.t({message:"The setting 'python.autoComplete.preloadModules' is deprecated, please consider using Pylance Language Server ('python.languageServer' setting).",comment:['Do not translate the string "python.autoComplete.preloadModules" as that is a setting in VS Code','Do not translate the string "python.languageServer" as that is a setting in VS Code']})))(cy||(cy={}));var P7;(n=>(n.noCondaOrPipInstaller=V.l10n.t("There is no Conda or Pip installer available in the selected environment."),n.noPipInstaller=V.l10n.t("There is no Pip installer available in the selected environment."),n.searchForHelp=V.l10n.t("Search for help")))(P7||(P7={}));var D7;(e=>e.installingModule=t=>V.l10n.t("Installing {0}",t))(D7||(D7={}));p();var k7=rK(),pT=class{constructor(e,t,n){this.channel=e;this.homeReplaceRegEx=t,this.userNameReplaceRegEx=n}format(e,t,...n){let i=e?`${fD()} [${e}] ${k7(t,...n)}`:k7(t,...n);return this.homeReplaceRegEx&&(i=i.replace(this.homeReplaceRegEx,"~")),this.userNameReplaceRegEx&&(i=i.replace(this.userNameReplaceRegEx,"<username>")),i}error(e,...t){this.channel.appendLine(this.format("error",e,...t))}warn(e,...t){this.channel.appendLine(this.format("warn",e,...t))}info(e,...t){this.channel.appendLine(this.format("info",e,...t))}debug(e,...t){this.channel.appendLine(this.format("debug",e,...t))}trace(e,...t){this.channel.appendLine(this.format("trace",e,...t))}ci(e,...t){}};p();var N7=rK();function rC(r,e,...t){let i=[...t].length===0?N7(e):N7(e,...t);return r?`${r} ${fD()}: ${i}`:i}var fT=class{constructor(e){this.prefix=e}error(e,...t){console.error(rC("error",`${this.prefix||""} ${e}`,...t))}warn(e,...t){console.warn(rC("warn",`${this.prefix||""} ${e}`,...t))}info(e,...t){console.info(rC("info",`${this.prefix||""} ${e}`,...t))}debug(e,...t){console.log(rC("debug",`${this.prefix||""} ${e}`,...t))}trace(e,...t){console.trace(rC("trace",`${this.prefix||""} ${e}`,...t))}ci(e,...t){}};var nK="",lle=3,Np=[],Rp=fr.LogLevel.Info,w={error:(r,...e)=>cle(r,...e),warn:(r,...e)=>K7(r,...e),info:(r,...e)=>ule(r,...e),debug:(r,...e)=>dle(r,...e),trace:(r,...e)=>ple(r,...e),ci:(r,...e)=>{e&&Array.isArray(e)?M7(r,...e):M7(r)}};function O7(r){Rp=A7(),Mu(fr.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("jupyter.logging")&&(Rp=A7())}));let e=fr.window.createOutputChannel(dT.jupyter,"log");return R7(new pT(e,r==null?void 0:r.userNameRegEx,r==null?void 0:r.homePathRegEx)),r.addConsoleLogger&&R7(new fT(di?void 0:"Jupyter Extension:")),e}function R7(r){return Np.push(r),{dispose:()=>{Np=Np.filter(e=>e!==r)}}}function A7(){try{let{level:r}=fr.workspace.getConfiguration("jupyter").get("logging",{level:"Info"});switch(r){case"debug":case"Debug":return fr.LogLevel.Debug;case"warn":case"Warn":case"warning":case"Warning":return fr.LogLevel.Warning;case"Off":case"off":return fr.LogLevel.Off;case"Error":case"error":return fr.LogLevel.Error;case"Trace":case"trace":return fr.LogLevel.Trace;default:return fr.LogLevel.Info}}catch(r){return console.error("Failed to get logging level from configuration",r),fr.LogLevel.Info}}function L7(...r){return Rp<=fr.LogLevel.Debug?r:r.map(t=>{if(!(t instanceof Error)||!("isJupyterError"in t))return t;let n=[`${t.name}: ${t.message}`.trim()];if("kernelConnectionMetadata"in t&&t.kernelConnectionMetadata&&typeof t.kernelConnectionMetadata=="object"&&"id"in t.kernelConnectionMetadata&&(n.push(`Kernel Id = ${t.kernelConnectionMetadata.id}`),"interpreter"in t.kernelConnectionMetadata&&t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter=="object"&&"id"in t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter.id=="string"&&n.push(`Interpreter Id = ${Ee(t.kernelConnectionMetadata.interpreter.id)}`)),t.stack){let o=at(t.stack),s=o.find(a=>a.indexOf("at ")===0);o.length===1||(o.length===1?n.push(o[0]):o.length>1&&(s!=null&&s.length)?n.push(s):n.push(o[0]))}let i=["stack","message","name","kernelConnectionMetadata","category","exitCode","isJupyterError"];return Object.keys(t).filter(o=>i.indexOf(o)===-1).forEach(o=>n.push(`${o} = ${String(t[o]).trim()}`)),n.filter(o=>o.trim().length).map((o,s)=>s===0?o:`    > ${o}`).join(`
`)})}function cle(r,...e){Rp<=fr.LogLevel.Error&&(e=L7(...e),Np.forEach(t=>t.error(r,...e)))}function K7(r,...e){Rp<=fr.LogLevel.Warning&&(e=L7(...e),Np.forEach(t=>t.warn(r,...e)))}function ule(r,...e){Rp<=fr.LogLevel.Info&&Np.forEach(t=>t.info(r,...e))}function dle(r,...e){Rp<=fr.LogLevel.Debug&&Np.forEach(t=>t.debug(r,...e))}function ple(r,...e){Rp<=fr.LogLevel.Trace&&Np.forEach(t=>t.trace(r,...e))}function M7(r,...e){if(di)if(typeof r=="function"){let n=r(),i="",o=[];typeof n=="string"?i=n:(i=n.shift(),o=n),w.info(i,...o)}else w.info(r,...e)}function F7(r,e=lle){return fle({message:r,opts:e,level:fr.LogLevel.Debug})}var Uu=new WeakMap;function oK(r){return(e,t,n)=>{Uu.has(e)||Uu.set(e,new Map);let i=Uu.get(e);i||Uu.set(e,i=new Map),i.has(t)||i.set(t,[]),i.get(t).push({parameterIndex:n,propertyOfParameterToLog:r})}}function U7(){return(r,e,t)=>{Uu.has(r)||Uu.set(r,new Map);let n=Uu.get(r);n||Uu.set(r,n=new Map),n.has(e)||n.set(e,[]),n.get(e).push({parameterIndex:t,ignore:!0})}}function fle(r){return vB((e,t)=>yle(r,t,e),(r.opts&4)>0)}function mle(r){let{kind:e,name:t,args:n}=r;return(!e||e==="")&&(e="Function"),(!t||t==="")&&(t="<anon>"),n||(n=[]),{kind:e,name:t,args:n,methodName:r.methodName||"",target:r.target||void 0}}function hle(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function iK(r){let e=nK?r.toLowerCase().indexOf(nK):-1;return e===-1?r:`~${r.substring(e+nK.length)}`}function gle(r,e,t,n){var a;if(hle(t))return iK(t.path);if(!t)return t;let i=(a=Uu.get(r))==null?void 0:a.get(e),o=i==null?void 0:i.find(l=>l.parameterIndex===n);if(!o)return typeof t=="string"?iK(t):t;if("ignore"in o&&o.ignore)return"";let s=t;return"propertyOfParameterToLog"in o&&o.propertyOfParameterToLog&&(s=t[o.propertyOfParameterToLog]),typeof s=="string"?iK(s):s}function vle(r,e,t){t=mle(t);let n=[r.message];return n.push(`${t.kind} name = ${t.name}`.trim()),e?(n.push(`completed in ${e.elapsed}ms`),n.push(`has a ${e.returnValue?"truthy":"falsy"} return value`)):n[n.length-1]=`${n[n.length-1]} (started execution)`,(r.opts&1)===1&&(r.level===fr.LogLevel.Debug?n.push(cL(t.args.map((i,o)=>t?gle(t.target,t.methodName,i,o):i))):n.push(cL(t.args))),e&&(r.opts&2)===2&&n.push(yB(e.returnValue)),n.join(", ")}function yle(r,e,t){let n=vle(r,e,t);e?e.err===void 0?r.level&&r.level===fr.LogLevel.Error||(r.level?mT(r.level,n):mT(fr.LogLevel.Info,n)):mT(fr.LogLevel.Error,n,e.err):r.level&&r.level!==fr.LogLevel.Error&&mT(r.level,n)}function mT(r,e,...t){switch(r){case fr.LogLevel.Error:w.error(e,...t);break;case fr.LogLevel.Warning:K7(e,...t);break;case fr.LogLevel.Info:w.info(e,...t);break;case fr.LogLevel.Debug:case fr.LogLevel.Trace:w.debug(e,...t);break;default:break}}var Ql=require("vscode");p();var cj=require("vscode");p();var W7=Symbol("IsDevMode"),Wm=Symbol("IOutputChannel"),V7=Symbol("IS_WINDOWS"),ve=Symbol("IDisposableRegistry"),_t=Symbol("IGlobalMemento"),rr=Symbol("IGlobalMemento"),Is=Symbol("IWorkspaceMemento");var hT=Symbol("IPersistentStateFactory"),VNe=Symbol("IRandom"),Ke=Symbol("IConfigurationService"),st=Symbol("ExtensionContext"),Ba=Symbol("IExtensions"),jNe=Symbol("IJupyterExtensionBanner"),gT=Symbol("IFeaturesManager"),uy=Symbol("ICryptoUtils"),Wu=Symbol("IAsyncDisposableRegistry");var dy=Symbol("IExperimentService"),py=Symbol("IDataScienceCommandListener"),fy=Symbol("IVariableScriptGenerator"),my=Symbol("IDataFrameScriptGenerator");p();var ER=require("vscode");p();var Z7=se(X7()),nC=se(ge());try{(0,nC.decorate)((0,nC.injectable)(),Z7.EventEmitter)}catch(r){w.warn("Failed to decorate EventEmitter for DI (possibly already decorated by another Extension)",r)}var tt=class{constructor(e){this.container=e;tt._instance=this}static get instance(){return tt._instance}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}};tt=U([(0,nC.injectable)()],tt);p();p();var wt=require("vscode");p();var gy=Symbol("IPythonApi"),vo=Symbol("IPythonExtensionChecker");var Ca=se(ge());p();p();p();var aK="Python Kernel Debug Adapter",lK="Python Interactive Window Debug Adapter";p();p();var bT=se(t8()),sC=se(r8());p();p();var yy=require("vscode");p();p();var ot=class extends Error{constructor(t,n){super(n);this.category=t;this.isJupyterError=!0}},Ln=class r extends ot{constructor(t,n,i){super(i||cK(n),t);this.originalException=n;n&&(this.stack=`${new Error("").stack}

${n.stack}`)}static from(t,n){return n instanceof ot?n:new r(t,n)}static unwrap(t){return t&&(t instanceof r&&t.originalException&&t.originalException instanceof ot&&(t=t.originalException),t)}};function cK(r){return r&&r instanceof ot?r.category:"unknown"}var Ap=class extends ot{constructor(t,n,i){super("jupyterconnection",t+(n?`
${n}`:""));this.interpreter=i}};p();var zr=class extends ot{constructor(){super("sessionDisposed",W.sessionDisposed)}};function i8(r=""){let e=o8(r);return e?e[1]:void 0}function o8(r=""){if(!r)return;let e=r.trim().split(`
`).map(t=>t.trim()).filter(t=>t.trim().length).reverse();if(e.length!==0&&e[0].includes("Error"))return[e.length>1?e[1]:"",e[0]]}function s8(r){if(!r)return;let t=(Array.isArray(r)?r[0]:r).split(`
`).map(l=>l.trim().toLowerCase()).filter(l=>l.length).reverse().find(l=>l.startsWith("file ")&&l.includes(", line ")&&l.includes(".py")&&l.includes(".py"));if(!t)return;let i=(t.substring(0,t.lastIndexOf(".py"))+".py").replace(/\\/g,"/").split("/"),o=i.indexOf("site-packages"),s=o>=0&&i.length>o+1?i[o+1]:"",a=i.reverse();if(!(a.length<2))return{fileName:a[0],folderName:a[1],packageName:s}}function Vm(r,e,t,n="",i=[]){let o=e instanceof ot?e.stdErr||e.stack||"":e.toString(),s=o8(o),a=o.toLowerCase();if(e instanceof zr)return{reason:"sessionDisposed",message:W.sessionDisposed,moreInfoLink:"https://aka.ms/kernelDisposedCannotRunCell",telemetrySafeTags:["deadSession"]};if(a.includes("ImportError: No module named 'win32api'".toLowerCase()))return{reason:"importWin32apiFailure",message:W.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())&&a.includes("win32api"))return{reason:"importWin32apiFailure",message:W.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["dll.load.failed","win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())){let c=s&&s[0].toLowerCase().startsWith("import")?s[0].substring(6).trim():void 0;return{reason:"dllLoadFailure",moduleName:c,message:c?W.failedToStartKernelDueToDllLoadFailure(c):W.failedToStartKernelDueToUnknownDllLoadFailure,moreInfoLink:"https://aka.ms/kernelFailuresDllLoad",telemetrySafeTags:["dll.load.failed"]}}if(a.includes("AssertionError: Couldn't find Class NSProcessInfo".toLowerCase()))return{reason:"oldIPythonFailure",message:W.failedToStartKernelDueToOldIPython,moreInfoLink:"https://aka.ms/kernelFailuresOldIPython",telemetrySafeTags:["oldipython"]};if(a.includes("NotImplementedError".toLowerCase())&&a.includes("asyncio".toLowerCase())&&a.includes("events.py".toLowerCase()))return{reason:"oldIPyKernelFailure",message:W.failedToStartKernelDueToOldIPyKernel,moreInfoLink:"https://aka.ms/kernelFailuresOldIPyKernel",telemetrySafeTags:["oldipykernel"]};{let c=[];if(a.includes("ImportError: cannot import name".toLowerCase())&&a.includes("from partially initialized module".toLowerCase())&&a.includes("zmq.backend.cython".toLowerCase())&&c.push("zmq.backend.cython"),a.includes("zmq".toLowerCase())&&a.includes("cython".toLowerCase())&&a.includes("__init__.py".toLowerCase())&&c.push("zmq.cython"),a.includes("zmq.error.ZMQError")&&c.push("zmq.error"),c.length)return{reason:"zmqModuleFailure",message:W.failedToStartKernelDueToPyZmqFailure,moreInfoLink:"https://aka.ms/kernelFailuresPyzmq",telemetrySafeTags:c}}if(s&&s[1].toLowerCase().startsWith("importerror")){let c=n8(s[1]);if(c&&n){let d=Dle(c.moduleName,c.fileName,r,n);return d||{reason:"importFailure",moduleName:c.moduleName,fileName:c.fileName,message:c.fileName?W.failedToStartKernelDueToImportFailureFromFile(c.moduleName,c.fileName):W.failedToStartKernelDueToImportFailure(c.moduleName),moreInfoLink:c.fileName?"https://aka.ms/kernelFailuresModuleImportErrFromFile":"https://aka.ms/kernelFailuresModuleImportErr",telemetrySafeTags:["import.error"]}}}let l="No module named".toLowerCase(),u="is not a package".toLowerCase();if(a.includes(l)&&!u){let c=at(o).map(f=>f.trim()).filter(f=>f.length).find(f=>f.toLowerCase().includes(l)),d=c?c.substring(c.toLowerCase().indexOf(l)+l.length).trim():"";if(c)return{reason:"moduleNotFound",moduleName:d,message:W.failedToStartKernelDueToMissingModule(d),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(a.includes(l)&&u){let c=at(o).map(b=>b.trim()).filter(b=>b.length).find(b=>b.toLowerCase().includes(l)),d=c?c.substring(c.toLowerCase().indexOf(l)+l.length).trim():"",f="",m="";d.split("'").length>2&&(f=d.split("'").slice(-2)[0]||"",f=f?`${f}.py`:"",m=f||"",d=d.split("'")[1]||d);let g=i.filter(b=>mi(b).toLowerCase()==="__init__.py").map(b=>mi(Qv(b)));return d&&f&&d!==f&&i.some(b=>mi(b).toLowerCase()===f.toLowerCase())?{reason:"overridingBuiltinModules",fileName:f,moduleName:d,message:W.fileSeemsToBeInterferingWithKernelStartup(f),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:d&&g&&d!==m&&g.some(b=>b.toLowerCase()===m.toLowerCase())?{reason:"overridingBuiltinModules",folderName:m,moduleName:d,message:W.moduleSeemsToBeInterferingWithKernelStartup(m),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:{reason:"moduleNotFound",moduleName:d,message:W.failedToStartKernelDueToMissingModule(d),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(e instanceof ot&&e.category==="invalidkernel"&&i.length){let c=mi(i[0]);return{reason:"overridingBuiltinModules",fileName:c,moduleName:mi(i[0],".py"),message:W.fileSeemsToBeInterferingWithKernelStartup(c),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}else if(s&&s[1].toLowerCase().startsWith("ModuleNotFoundError".toLowerCase())){let c=n8(s[1]);if(c)return{reason:"moduleNotFound",moduleName:c.moduleName,message:W.failedToStartKernelDueToMissingModule(c.moduleName),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}if(e instanceof Ap){let c=at(o).map(y=>y.trim()).reverse().find(y=>y.toLowerCase().includes("error: ")),d="AttributeError: 'Namespace' object has no attribute '_flags'",f=["jupyter.startup.failure"],m,g="jupyterStartFailure",b=at(e.message,{removeEmptyEntries:!0,trim:!0}).reverse().find(y=>y.toLowerCase().includes("error: "));if(b=b||at(e.stdErr||"",{removeEmptyEntries:!0,trim:!0}).reverse().find(y=>y.toLowerCase().includes("error: ")),a.includes(d.toLowerCase())?(g="jupyterStartFailureOutdatedTraitlets",c=W.failedToStartJupyterDueToOutdatedTraitlets(t||"",b||""),f.push("outdated.traitlets"),m="https://aka.ms/kernelFailuresJupyterTrailtletsOutdated"):(c=b?W.failedToStartJupyterWithErrorInfo(t||"",b):W.failedToStartJupyter(t||""),m=void 0),c)return{reason:g,message:c,pythonError:b,moreInfoLink:m,telemetrySafeTags:f}}}function n8(r){r=r.replace(/"/g,"'");let e=r.match(/'[^\\']*(\\'[^\\']*)*'/g),t=r.match(/\((.*?)\)/g),n,i;return e&&e[0].length>2&&(n=e[0],n=n.substring(1,n.length-1)),t&&t[0].length>2&&(i=t[0],i=i.substring(1,i.length-1)),n?{moduleName:n,fileName:i}:void 0}function Dle(r,e,t,n){if(n&&t.length!==0&&e&&!e.toLowerCase().startsWith(n)&&t.some(i=>e.toLowerCase().startsWith(i.uri.fsPath.toLowerCase())))return{reason:"overridingBuiltinModules",fileName:e,moduleName:r,message:W.fileSeemsToBeInterferingWithKernelStartup(Ee(yy.Uri.file(e),t||[])),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}function by(r){if(!r)return;let e=/\[([^\[\]]*)\]\((.*?)\)/gm,t;for(;(t=e.exec(r))!==null;)t.length===3&&(r=r.replace(t[0],`<a href='${t[2]}'>${t[1]}</a>`));let n=at(r,{removeEmptyEntries:!1,trim:!1}).map(i=>`\x1B[1;31m${i}`).join(`
`);return new yy.NotebookCellOutput([yy.NotebookCellOutputItem.error({message:"",name:"",stack:n})])}var Tle=[kle,Nle];function a8(r){let e=[],t=Array.isArray(r)?r[0].toLowerCase():r.toLowerCase();Tle.forEach(i=>i(t,e));let n=Vm([],t,void 0);return n!=null&&n.telemetrySafeTags.length&&e.push(...n.telemetrySafeTags),Array.from(new Set(e)).join(",")}function kle(r,e=[]){r.includes("ChildProcess.exithandler".toLowerCase())&&e.push("childproc.exit")}function Nle(r,e=[]){r.includes("KernelRestarter: restart failed".toLowerCase())&&e.push("KernelRestarter.failed")}function l8(){return(new Error().stack||"").split(`
`).filter(r=>r.includes(Je))}async function c8(r,e){r.failed=!0,r.failureCategory=r.failureCategory||cK(e);let t=!bT.FetchError&&(e==null?void 0:e.name)==="TypeError"&&(e==null?void 0:e.message)==="Failed to fetch",i=(t||bT.FetchError!==void 0)&&Mle(e,t?TypeError:bT.FetchError);r.failureCategory==="unknown"&&i&&(r.failureCategory="fetcherror"),r.stackTrace=Rle(e),typeof e=="string"&&(r.failureSubCategory="errorisstring");let o=e.stdErr?e.stdErr:e.stack||"";if(!o)return;r.failureSubCategory=r.failureSubCategory||a8(o);let s=s8(o);s&&([r.pythonErrorFile,r.pythonErrorFolder,r.pythonErrorPackage]=await Promise.all([Promise.resolve(r.pythonErrorFile||Rt(s.fileName)),Promise.resolve(r.pythonErrorFolder||Rt(s.folderName)),Promise.resolve(r.pythonErrorPackage||Rt(s.packageName))]))}function uK(r){if(r.stack&&Array.isArray(r.stack)){let e={...r,stack:r.stack.join(`
`)};return sC.parse.call(sC,e)}return sC.parse.call(sC,r)}function Rle(r){let e="";for(let t of uK(r)){let n=t.getFileName();if(n){let i=t.getLineNumber(),o=t.getColumnNumber();e+=`
	at ${Ale(t)} ${n}:${i}:${o}`}else e+=`
	at <anonymous>`}return e.trim().replace(/\\/g,"/")}function Ale(r){let e=[];return typeof r.getTypeName()=="string"&&r.getTypeName().length>0&&e.push(r.getTypeName()),typeof r.getMethodName()=="string"&&r.getMethodName().length>0&&e.push(r.getMethodName()),typeof r.getFunctionName()=="string"&&r.getFunctionName().length>0&&(e.length!==2||e.join(".")!==r.getFunctionName())&&e.push(r.getFunctionName()),e.join(".")}function Mle(r,e){return e?r instanceof e||r instanceof Ln&&r.originalException instanceof e:(console.error("Error type is not defined",r),!1)}var PN=require("vscode");function vfe(){try{return require("vscode")===void 0?!1:AG()!==void 0}catch(r){return!1}}function TN(){return PN.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1}function kN(r){return PN.workspace.onDidChangeConfiguration(e=>{if(!e.affectsConfiguration("telemetry"))return;let n=PN.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1;r(n)})}var DN={};function Qb(r,e){let t=r;WE()&&t.startsWith("ds_")||(e===void 0?delete DN[t]:DN[t]=e)}var m2;function AG(){if(m2)return m2;let r=(kG(),nL(TG)).default;return m2=new r(sB)}function NG(r,e){let t={};return Object.getOwnPropertyNames(e).forEach(n=>{if(!(e[n]===void 0||e[n]===null))try{t[n]=typeof e[n]=="string"?e[n]:typeof e[n]=="object"?"object":e[n].toString()}catch(i){w.error(`Failed to serialize ${n} for ${r}`,i)}}),t}function ne(r,e,t,n){!MG(r.toString())&&(mn()||!vfe())||yfe(r,e,t,n)}function MG(r){return r==="DATASCIENCE.JUPYTER_NOTEBOOK_EDIT_PERFORMANCE"||r==="DATASCIENCE.JUPYTER_JUPYTER_NOTEBOOK_EXEC_PERFORMANCE"||r==="DATASCIENCE.JUPYTER_NOTEBOOK_EXEC_PERFORMANCE"}function yfe(r,e,t,n){let i=AG(),o={},s=r;n?(o={},Object.assign(o,DN),Object.assign(o,t||{}),c8(o,n).then(()=>{o=NG(s,o),i.sendTelemetryEvent(s,o,e)}).catch(E)):(t&&(o=NG(s,t)),Object.assign(o,DN),MG(s)?i.sendDangerousTelemetryEvent(s,o,e):i.sendTelemetryEvent(s,o,e))}var RG=new Set;function Dr(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a=e||{},l=new It,u=`${r.toString()}${JSON.stringify(a)}`,c=!RG.has(u);RG.add(u);let d=o.apply(this,s);return d&&typeof d.then=="function"&&typeof d.catch=="function"?d.then(f=>{let m={...a};return c&&(m.firstTime=c),ne(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,m),f}).catch(f=>{let m={...a};m.failed=!0,ne(r,l?{duration:l==null?void 0:l.elapsedTime}:{},m,f)}):ne(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,a),d},i}}function Tn(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){return ne(r,void 0,e),o.apply(this,s)},i}}function bfe(){return{isInsiderExtension:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether this is the Insider version of the Jupyter extension or not. Common to all events."},isPythonExtensionInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether Python extension is installed or not. Common to all events."},rawKernelSupported:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether the raw kernel is supported or not. Common to all events."}}}function ct(){return{duration:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth",isMeasurement:!0}}}function ns(){return{resourceType:{classification:"PublicNonPersonalData",comment:"",purpose:"FeatureInsight"}}}function kd(){return{failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureSubCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFile:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFolder:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorPackage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},stackTrace:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}}function eo(){return{properties:{actionSource:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},disableUI:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},userExecutedCell:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},resourceHash:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},pythonEnvironmentVersion:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPath:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPackages:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSessionId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelLanguage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelConnectionType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},isUsingActiveInterpreter:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},capturedEnvVars:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},newKernelPicker:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},...ns()}}}var p5e={...ct(),...kd(),...bfe()};var Sfe,Ife,_fe,Efe,Cfe,wfe,xfe,Pfe,Dfe,Tfe,kfe,Nfe,Rfe,Afe,Mfe,Ofe,Lfe,Kfe,Ffe,Ufe,Wfe,Vfe,jfe,Bfe,Hfe,qfe,Jfe,Gfe,Yfe,$fe,zfe,Qfe,Xfe,Zfe,eme,tme,rme,nme,ime,ome,sme,ame,lme,cme,ume,dme,pme,fme,mme,hme,gme,vme,yme,bme,Sme,Ime,_me,Eme,Cme,wme,xme,Pme,Dme,Tme,kme,Nme,Rme,Ame,Mme,Ome,Lme,Kme,Fme,Ume,Wme,Vme,jme,Bme,Hme,qme,Jme,Gme,Yme,$me,zme,Qme,Xme,Zme,ehe,the,rhe,nhe,ihe,ohe,she,ahe,lhe,che,uhe,dhe,phe,fhe,mhe,hhe,ghe,vhe,yhe,bhe,She,Ihe,_he,Ehe,Che,whe,xhe,Phe,Dhe,The,khe,Nhe,Rhe,Ahe,Mhe,Ohe,Lhe,Khe,Fhe,Uhe,Whe,Vhe,jhe,Bhe,Hhe,qhe,Jhe,Ghe,Yhe,$he,zhe,Qhe,Xhe,Zhe,ege,tge,rge,nge,ige,oge,sge,age,lge,cge,uge,dge,pge,fge,mge,hge,gge,vge,yge,bge,OG=class{constructor(){this[Sfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{totalActivateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},codeLoadingTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},workspaceFolderCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[Ife]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:ct()};this[_fe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Efe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Cfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{hashedNamev2:{classification:"SystemMetaData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...ns()}};this[wfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{firstTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:ct()};this[xfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{mimeType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...ns()}};this[Pfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:ct()};this[Dfe]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[Tfe]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer","VariableViewer"]};this[kfe]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[Nfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:ct()};this[Rfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:ct()};this[Afe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:{codeLensUpdateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},maxCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Mfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Ofe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Lfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Kfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Ffe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Ufe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...kd(),failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Reason for failure to fetch kernel specs"},sessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},specsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSpecsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:ct()};this[Wfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},serverIdHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},providerExtensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},baseUrlHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelId:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelLanguage:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},isArgv0SameAsInterpreter:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Vfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{serverIdHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},baseUrlHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isLocalHost:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isJupyterHub:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},reason:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[jfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Bfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Hfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:eo().properties,measures:{...ct()}};this[qfe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[Jfe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[Gfe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Yfe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"},cancelled:{classification:"SystemMetaData",purpose:"FeatureInsight"},successful:{classification:"SystemMetaData",purpose:"FeatureInsight"},opened:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[$fe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{scope:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[zfe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Qfe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Xfe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Zfe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[eme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},info:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[tme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[rme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[nme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[ime]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[ome]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{nbformat:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"},nbformat_minor:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"}}};this[sme]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"User Action"};this[ame]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[lme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[cme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[ume]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[dme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[pme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[fme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[mme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[hme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[gme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[vme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[yme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[bme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Sme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Ime]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[_me]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Eme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Cme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[wme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[xme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Pme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Dme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Tme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[kme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Nme]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Rme]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Ame]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[Mme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Ome]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[Lme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Kme]={owner:"IanMatthewHuff",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Fme]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Ume]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Wme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"},isModulePresent:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pythonEnvType:{classification:"SystemMetaData",purpose:"FeatureInsight"},resourceHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},...ns()},measures:ct()};this[Vme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[jme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",measures:ct()};this[Bme]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rows:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0},columns:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Hme]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rowsTimer:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[qme]={owner:"amunger",feature:["DataFrameViewer","VariableViewer"],source:"N/A",properties:{reason:{classification:"SystemMetaData",purpose:"FeatureInsight"},fromVariableView:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Jme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action"};this[Gme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Yme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},errorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},fallbackErrorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},zmqBinaries:{classification:"CallstackOrException",purpose:"FeatureInsight"}}};this[$me]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:ct()};this[zme]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:{variableCount:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Qme]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{kind:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},usesShell:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Xme]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...kd(),...ns()},measures:{...ct()}};this[Zme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonPathDefined:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonEnvFound:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},isCreatedByUs:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[ehe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[the]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",properties:{hasKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the kernel was known at the time of creation"},hasOwner:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the window was created for a text file"},mode:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Creation mode: multiple, perfile or single"},restored:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Was the window restored from a previous session"}},measures:{windowCount:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Number of active interactive windows the user has open",isMeasurement:!0}}};this[rhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{cdnSearched:{classification:"SystemMetaData",purpose:"FeatureInsight"},hashedName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},modelName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[nhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{type:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:ct()};this[ihe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[ohe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[she]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},isOnline:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[ahe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[lhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[che]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{selection:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[uhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[dhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{msg_type:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[phe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:{...ct(),attempts:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{...eo().properties,timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[fhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:ct()};this[mhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],measures:{...ct()},properties:{...eo().properties,...kd()}};this[hhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Code Execution"],measures:ct(),properties:{...eo().properties,...kd(),extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[ghe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],properties:{...eo().properties,...kd()}};this[vhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],properties:{...eo().properties,...kd()}};this[yhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:eo().properties};this[bhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{result:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},...ns(),...kd(),...eo().properties},measures:{...ct()}};this[She]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{...ns(),...kd(),...eo().properties},measures:ct()};this[Ihe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...ns(),...eo().properties},measures:{reason:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}}};this[_he]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{exitReason:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...ns(),...eo().properties},measures:{exitCode:{classification:"CallstackOrException",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[Ehe]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...ns(),...eo().properties,manuallySelectedKernel:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...ct(),computeCwd:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},duration:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},envVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},executeCell:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},getConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},interruptHandle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelIdle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInfo:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelReady:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},portUsage:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},postKernelStart:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},preExecuteCellTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},pythonEnvVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},sessionTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},spawn:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startupCode:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},updateConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputsByteSize:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Che]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...ns(),...eo().properties,wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...ct(),callPythonApi:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},activatePython:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},discoverEnv:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},createController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},selectController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[whe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{isRequestToShutdownRestartSession:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...ns(),...eo().properties}};this[xhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...ns(),...eo().properties}};this[Phe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Dhe]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{kernelSpecCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInterpreterCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelLiveCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},localKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},remoteKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[The]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{outputType:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[khe]={owner:"IanMatthewHuff",feature:["InteractiveWindow"],tags:["IntelliSense"],source:"N/A",measures:ct(),properties:{isResultNull:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Nhe]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:ct()};this[Rhe]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[Ahe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:ct()};this[Mhe]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"N/A",measures:ct()};this[Ohe]={owner:"amunger",feature:"N/A",source:"N/A",properties:{command:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Lhe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{newState:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Khe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:{numberOfDimensions:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Fhe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{source:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Uhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},dependenciesInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Whe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Vhe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[jhe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Bhe]={owner:"roblourens",feature:["Debugger"],properties:{status:{classification:"SystemMetaData",purpose:"FeatureInsight"}},source:"N/A"};this[Hhe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[qhe]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[Jhe]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[Ghe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Yhe]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[$he]={owner:"roblourens",feature:["Debugger"],source:"N/A",properties:{reason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[zhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{...ct(),requestDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},timesExceededTimeout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},completionItems:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},monacoLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},completed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusAfterRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusBeforeRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Qhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Xhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Zhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"}},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[ege]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{accessAllowed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[tge]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},cancelledAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestAcknowledgedAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestSentAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},...ct()},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},mimeTypes:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}};this[rge]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{clientExtId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[nge]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},allowed:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[ige]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},providerId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}},measures:ct()};this[oge]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[sge]={owner:"roblourens",feature:["InteractiveWindow","Debugger"],source:"N/A"};this[age]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...eo().properties,...ns()}};this[lge]={owner:"donjayamanne",source:"N/A",feature:["KernelPicker"]};this[cge]={owner:"donjayamanne",source:"User Action",feature:["KernelPicker"]};this[uge]={owner:"amunger",feature:"N/A",source:"N/A",properties:{testName:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},testResult:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},perfWarmup:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},commitHash:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},timedCheckpoints:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[dge]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{matchedReason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[pge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{requireEntryPointCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}},properties:{failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},failure:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},patternUsedToRegisterRequireConfig:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},widgetFolderNameHash:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[fge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:ct()};this[mge]={owner:"donjayamanne",feature:["DataFrameViewer"],source:"N/A"};this[hge]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[gge]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[vge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...ct(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0},preExecuteDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent in VS Code before starting execution.",isMeasurement:!0},executeDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent executing cells.",isMeasurement:!0},postExecuteDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent in VS Code after executing cells.",isMeasurement:!0}},properties:{outputType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",comment:"The kind of outputs generated in the notebook, text, html or images."}}};this[yge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...ct(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0}},properties:{outputType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",comment:"The kind of outputs generated in the notebook, text, html or images."}}};this[bge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...ct(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0}}}}};Sfe="EXTENSION.LOAD",Ife="DS_INTERNAL.EXPERIMENT_LOAD",_fe="ENVFILE_VARIABLE_SUBSTITUTION",Efe="ENVFILE_WORKSPACE",Cfe="HASHED_PACKAGE_NAME",wfe="DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",xfe="DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",Pfe="DS_INTERNAL.GET_ACTIVATED_ENV_VARIABLES",Dfe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX",Tfe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",kfe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX",Nfe="DATASCIENCE.ADD_CELL_BELOW",Rfe="DS_INTERNAL.CODE_LENS_ACQ_TIME",Afe="DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",Mfe="DATASCIENCE.DEBUG_CONTINUE",Ofe="DATASCIENCE.DEBUG_CURRENT_CELL",Lfe="DATASCIENCE.DEBUG_STEP_OVER",Kfe="DATASCIENCE.DEBUG_STOP",Ffe="DATASCIENCE.DEBUG_FILE_INTERACTIVE",Ufe="DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",Wfe="DS_INTERNAL.JUPYTER_KERNEL_SPEC",Vfe="DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",jfe="DATASCIENCE.DISABLE_INTERACTIVE_SHIFT_ENTER",Bfe="DATASCIENCE.ENABLE_INTERACTIVE_SHIFT_ENTER",Hfe="DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",qfe="DATASCIENCE.EXPORT_PYTHON_FILE",Jfe="DATASCIENCE.EXPORT_PYTHON_FILE_AND_OUTPUT",Gfe="DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",Yfe="DATASCIENCE.EXPORT_NOTEBOOK_AS",$fe="DATASCIENCE.IMPORT_NOTEBOOK",zfe="DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",Qfe="DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",Xfe="DS_INTERNAL.GET_PASSWORD_FAILURE",Zfe="DS_INTERNAL.GET_PASSWORD_SUCCESS",eme="DS_INTERNAL.JUPYTER_HUB_PASSWORD",tme="DS_INTERNAL.SHOW_DATA_NO_PANDAS",rme="DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD",nme="DS_INTERNAL.SHOW_DATA_PANDAS_OK",ime="DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED",ome="DATASCIENCE.NATIVE.OPEN_NOTEBOOK_ALL",sme="DATASCIENCE.OPEN_PLOT_VIEWER",ame="DATASCIENCE.RUN_ALL_CELLS",lme="DATASCIENCE.RUN_SELECTION_OR_LINE",cme="DATASCIENCE.RUN_CURRENT_CELL",ume="DATASCIENCE.RUN_ALL_CELLS_ABOVE",dme="DATASCIENCE.RUN_CELL_AND_ALL_BELOW",pme="DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE",fme="DATASCIENCE.RUN_FILE_INTERACTIVE",mme="DATASCIENCE.RUN_TO_LINE",hme="DATASCIENCE.RUN_FROM_LINE",gme="DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION",vme="DATASCIENCE.RUN_INSERT_CELL_BELOW",yme="DATASCIENCE.RUN_INSERT_CELL_ABOVE",bme="DATASCIENCE.RUN_DELETE_CELLS",Sme="DATASCIENCE.RUN_SELECT_CELL",Ime="DATASCIENCE.RUN_SELECT_CELL_CONTENTS",_me="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE",Eme="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW",Cme="DATASCIENCE.RUN_MOVE_CELLS_UP",wme="DATASCIENCE.RUN_MOVE_CELLS_DOWN",xme="DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN",Pme="DATASCIENCE.RUN_CHANGE_CELL_TO_CODE",Dme="DATASCIENCE.GOTO_NEXT_CELL_IN_FILE",Tme="DATASCIENCE.GOTO_PREV_CELL_IN_FILE",kme="DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW",Nme="DATASCIENCE.SELFCERTSMESSAGECLOSE",Rme="DATASCIENCE.SELFCERTSMESSAGEENABLED",Ame="DATASCIENCE.USER_INSTALLED_JUPYTER",Mme="DATASCIENCE.USER_INSTALLED_PANDAS",Ome="DATASCIENCE.USER_DID_NOT_INSTALL_JUPYTER",Lme="DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS",Kme="DS_INTERNAL.PYTHON_NOT_INSTALLED",Fme="DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",Ume="DS_INTERNAL.PYTHON_EXTENSION_INSTALLED_VIA_KERNEL_PICKER",Wme="DS_INTERNAL.PYTHON_MODULE_INSTALL",Vme="DS_INTERNAL.SHIFTENTER_BANNER_SHOWN",jme="DATASCIENCE.START_SHOW_DATA_EXPLORER",Bme="DATASCIENCE.SHOW_DATA_EXPLORER",Hme="DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",qme="DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",Jme="DATASCIENCE.REFRESH_DATA_VIEWER",Gme="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT",Yme="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT_FAILURE",$me="DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME",zme="DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",Qme="DATASCIENCE.KERNEL_SPEC_LANGUAGE",Xme="DS_INTERNAL.KERNEL_LAUNCHER_PERF",Zme="GLOBAL_PYTHON_KERNELSPEC",ehe="DS_INTERNAL.NEW_FILE_USED_IN_INTERACTIVE",the="DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",rhe="DS_INTERNAL.IPYWIDGET_USED_BY_USER",nhe="DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",ihe="DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED",ohe="DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",she="DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",ahe="DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",lhe="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN",che="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",uhe="DS_INTERNAL.IPYWIDGET_RENDER_FAILURE",dhe="DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",phe="DS_INTERNAL.RAWKERNEL_INFO_RESPONSE",fhe="DS_INTERNAL.RAWKERNEL_PROCESS_LAUNCH",mhe="DATASCIENCE.EXECUTE_CELL",hhe="DATASCIENCE.EXECUTE_CODE",ghe="DATASCIENCE.RESUME_EXECUTE_CELL",vhe="DATASCIENCE.NOTEBOOK_START",yhe="DS_INTERNAL.SWITCH_KERNEL",bhe="DATASCIENCE.NOTEBOOK_INTERRUPT",She="DATASCIENCE.NOTEBOOK_RESTART",Ihe="DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",_he="DS_INTERNAL.RAWKERNEL_SESSION_KERNEL_PROCESS_EXITED",Ehe="DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",Che="DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",whe="DS_INTERNAL.RAWKERNEL_SESSION_SHUTDOWN",xhe="DS_INTERNAL.RAWKERNEL_SESSION_DISPOSED",Phe="DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER",Dhe="DS_INTERNAL.KERNEL_COUNT",The="DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",khe="DS_INTERNAL.INTERACTIVE_FILE_TOOLTIPS_PERF",Nhe="DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED",Rhe="DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE",Ahe="DATAVIEWER.WEBVIEW_LOADED",Mhe="PLOTVIEWER.WEBVIEW_LOADED",Ohe="DS_INTERNAL.COMMAND_EXECUTED",Lhe="DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",Khe="DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",Fhe="DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",Uhe="DATASCIENCE.CREATE_PYTHON_ENVIRONMENT",Whe="DATASCIENCE.RECOMMENT_EXTENSION",Vhe="DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP",jhe="DATASCIENCE.DEBUGGING.CLOSED_MODAL",Bhe="DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",Hhe="DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE",qhe="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE",Jhe="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_IW_JUPYTER",Ghe="DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL",Yhe="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL",$he="DATASCIENCE.DEBUGGING.ENDED_SESSION",zhe="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",Qhe="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",Xhe="DATASCIENCE.JUPYTER_KERNEL_API_USAGE",Zhe="DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",ege="DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",tge="DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",rge="DATASCIENCE.JUPYTER_API_USAGE",nge="DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",ige="DATASCIENCE.JUPYTER_KERNEL_STARTUP_HOOK",oge="DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE",sge="DATASCIENCE.INTERACTIVE_WINDOW_DEBUG_SETUP_CODE_FAILURE",age="DATASCIENCE.KERNEL_CRASH",lge="DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER",cge="DATASCIENCE.JUPYTER_KERNEL_FILTER_USED",uge="DS_INTERNAL.RUNTEST",dge="DS_INTERNAL.PREFERRED_KERNEL_EXACT_MATCH",pge="DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",fge="DS_INTERNAL.IPYWIDGET_TIME_TO_COPY_NBEXTENSIONS_DIR",mge="DATASCIENCE.NO_ACTIVE_KERNEL_SESSION",hge="DATAVIEWER.USING_INTERPRETER",gge="DATAVIEWER.USING_KERNEL",vge="DATASCIENCE.JUPYTER_NOTEBOOK_EXEC_PERFORMANCE",yge="DATASCIENCE.JUPYTER_JUPYTER_NOTEBOOK_EXEC_PERFORMANCE",bge="DATASCIENCE.JUPYTER_NOTEBOOK_EDIT_PERFORMANCE";p();var Af=require("vscode");function Xb(r){let e=Oc(r.uri);return Rt(e.path)}function g2(r=Af.Uri.file(""),e=Af.Uri.file(""),t=Pi(),n=!1){let i=Oc(r,t,t=="Windows"||n),o=Oc(e,t,t=="Windows"||n);return i===o||Xs(i,o,!0)}function Oc(r=Af.Uri.file(""),e=Pi(),t=!1){let n=lt(r);return t&&(n=n.toLowerCase()),n.endsWith("/bin/python")?["Linux","OSX"].includes(e)?n.endsWith("/bin/python")&&n.split("/").length>4?Af.Uri.file(n.replace("/bin/python","/python")):Af.Uri.file(n):Af.Uri.file(n):Af.Uri.file(n)}p();var LG=require("vscode");var Zb=class{constructor(){this.promises=new Set;this._onStateChange=new LG.EventEmitter;this.onStateChange=this._onStateChange.event}get isComplete(){return this.promises.size===0}dispose(){this._onStateChange.dispose()}push(e){this.promises.add(e),this._onStateChange.fire(),e.finally(()=>{this.promises.delete(e),this.isComplete&&this._onStateChange.fire()}).catch(E)}};p();var NN=class extends Ln{constructor(e){super("Python Extension failed to activate",e,"pythonExtension")}};p();var RN=class extends ot{constructor(){super("pythonExtension","Python Extension API not exported")}};var hY=se(O2());p();var Tg=require("vscode");var jN=class{};function ZG(r,e=""){let t=r?Tg.workspace.getWorkspaceFolder(r):Tg.workspace.workspaceFolders?Tg.workspace.workspaceFolders[0]:void 0;return t?bs(Pi()==="Windows"?t.uri.path.toUpperCase():t.uri.path):e}function aS(){let r=Array.isArray(Tg.workspace.workspaceFolders)&&Tg.workspace.workspaceFolders.length>0?Tg.workspace.workspaceFolders[0]:void 0;return r==null?void 0:r.uri}p();var Mg=require("vscode");p();p();p();var eY=se(O2());var Ng=require("vscode");p();function kg(r){return(e,t=null,n)=>{let i=!1,o;return o=r(s=>{if(!i)return o?o.dispose():i=!0,e.call(t,s)},null,n),i&&o.dispose(),o}}function bx(r,e=null,t){return new Promise(n=>kg(r)(n,e,t))}var rve={output_type:"stream",name:"stdout",text:""},nve={output_type:"error",ename:"",evalue:"",traceback:[""]},ive={output_type:"display_data",data:{},metadata:{}},ove={output_type:"execute_result",execution_count:0,data:{},metadata:{}},G5e={stream:new Set(Object.keys(rve)),error:new Set(Object.keys(nve)),display_data:new Set(Object.keys(ive)),execute_result:new Set(Object.keys(ove))};function Rl(r){return r&&zv(r).toLowerCase().endsWith("ipynb")?"notebook":"interactive"}function Kc(r){return r=r.toLowerCase(),r.length===2&&r.endsWith("#")?`${r.substring(0,1)}sharp`:uB.get(r)||r}function mr(r){return typeof r=="string"?r===bt||r===vr:r.notebookType===bt||r.notebookType===vr}function _a(r){let e=r.metadata;return JSON.parse(JSON.stringify((e==null?void 0:e.metadata)||{}))}async function tY(r,e){let t=new Ng.WorkspaceEdit;t.set(r.uri,[Ng.NotebookEdit.updateNotebookMetadata(L2({...r.metadata||{},metadata:e}))]),await Ng.workspace.applyEdit(t)}function lS(r){return Ng.workspace.notebookDocuments.find(e=>mr(e)&&e.getCells().some(t=>t.document===r))}function Fc(r){if(Array.isArray(r)){let e="";for(let t=0;t<r.length;t+=1){let n=r[t];t<r.length-1&&!n.endsWith(`
`)?e=e.concat(`${n}
`):e=e.concat(n)}return e}return r.toString()}function cS(r){if(Array.isArray(r))return r;let e=r.toString();if(e.length>0){let t=e.split(`
`);return t.map((n,i)=>i<t.length-1?`${n}
`:n).filter(n=>n.length>0)}return[]}function sve(r){let e=r;do r=e,e=r.replace(/[^\n]\x08/gm,"");while(e.length<r.length);return r}function ave(r){for(r=r.replace(/\r+\n/gm,`
`);r.search(/\r[^$]/g)>-1;){var e=r.match(/^(.*)\r+/m)[1],t=r.match(/\r+(.*)$/m)[1];t=t+e.slice(t.length,e.length),r=r.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,t)}return r}function rY(r){return ave(sve(r))}var BN="'''",HN='"""';function Rg(r,e,t){let n,i,o=0;for(let s of r){let a=s.trim(),l=a.startsWith(BN)?BN:a.startsWith(HN)?HN:void 0,u=a.includes(BN)?BN:a.includes(HN)?HN:void 0;if(i)i===u&&(i=void 0),t(s,o);else if(n)n===l&&(n=void 0),n&&e(s,o);else if(u&&!l){let c=a.indexOf(u);i=a.lastIndexOf(u)!==c?void 0:u,t(s,o)}else if(l){let c=a.indexOf(l,3);n=c>=0?void 0:l,a.length>3&&e(a.slice(3,c>=0?c:void 0),o)}else a.startsWith("#")?e(a.slice(1),o):t(s,o);o+=1}}function uS(r,e=`
`,t){return r.map((n,i)=>{let o=t?t(n):n;return i===r.length-1?`${o}`:`${o}${e}`})}function lve(r){let e=[];return Rg(r,t=>e.push(t),t=>{}),e}function qN(r){return uS(lve(r.slice(r.length>1?1:0)))}function nY(r){let e=r.length,t=-1;return r.forEach((n,i)=>{n.trim()&&(e=i,t<0&&(t=i))}),t>=0?r.slice(t,e+1):[]}function iY(r){var t;let e=/^\s*(\d+)\.(\d+)\.(.+)\s*$/.exec(r);if(e&&e.length>2){let n=parseInt(e[1],10),i=parseInt(e[2],10),o=parseInt(e[3],10);return(t=(0,eY.parse)(`${n}.${i}.${o}`,!0))!=null?t:void 0}}function Mf(r){let e=JSON.parse(JSON.stringify(r.metadata||{}))||{metadata:{}};return e.metadata=e.metadata||{},e}function L2(r){return cve(r)}function cve(r){return Array.isArray(r)?r.map(L2):r!=null&&typeof r=="object"&&Object.keys(r).length>0?Object.keys(r).sort().reduce((e,t)=>(e[t]=L2(r[t]),e),{}):r}async function Ag(r,e=[]){let t=bx(r.onDidDispose,void 0,e);r.dispose(),await t}var JN=new Map,F2=new Map,K2;function oY(r){K2=r}function U2(r,e){if(!r.pythonEnvironmentPath)return;let t=Re();uve({interpreterHash:r.pythonEnvironmentPath}).then(n=>{r.pythonEnvironmentPackages=n||r.pythonEnvironmentPackages,e&&(e.pythonEnvironmentPackages=n||e.pythonEnvironmentPackages)}).catch(()=>{}).finally(()=>{t.resolve()})}async function uve(r){if(!K2)return w.error("Python package provider is not initialized."),"{}";let e;if("interpreter"in r?e=r.interpreter:e=F2.get(r.interpreterHash),!e)return"{}";let t=await K2(e);return!t||t.size===0?"{}":JSON.stringify(Object.fromEntries(t))}async function sY(r){if(!r)return{};let e=JN.get(Fa(r)),t=Rl(r);if(!e&&t)return{resourceType:t,resourceHash:r?await Rt(r.toString()):void 0};if(!e)return{};let n=JSON.parse(JSON.stringify(e[0]));return U2(e[0],n),n}function Br(r,e,t,n,i){sY(r).then(o=>{Object.assign(o,n||{}),ne(e,t,o,i)}).catch(E)}var qn=!1,dS=new WeakMap,GN=new Map,Ea,lY=0;function Uc(r){var t,n;if(!r)return;if(pi(r)&&!GN.has(r.toString())){let i=Mg.workspace.notebookDocuments.find(o=>o.uri.toString()===r.toString());i&&GN.set(r.toString(),new WeakRef(i))}let e=pi(r)?(t=GN.get(r.toString()))==null?void 0:t.deref():r;if(e)return(n=dS.get(e))==null?void 0:n.tracker}function cY(r){let e=new En;return Ea=r,lY=r.elapsedTime,Mg.workspace.notebookDocuments.forEach(t=>dS.set(t,aY(t,!0,r))),e.add(Mg.workspace.onDidOpenNotebookDocument(t=>{!dS.has(t)&&!qn&&dS.set(t,aY(t,!1,r))})),e.add(Mg.workspace.onDidCloseNotebookDocument(t=>{dS.delete(t),GN.delete(t.uri.toString())})),e}function uY(r){var e;(e=dS.get(r))==null||e.tracker.kernelManuallySelected()}var YN={starAfter:-1,completedAfter:-1},W2=new Map,dY=new Map,dve=new Map,pY=lr(()=>(YN.starAfter=Ea==null?void 0:Ea.elapsedTime,{stop:lr(()=>{YN.completedAfter=Ea.elapsedTime})}));function fY(r,e){W2.set(r,Ea==null?void 0:Ea.elapsedTime),dve.set(r,e||"")}function mY(r){r.executable.uri&&dY.set(r.id,Ea==null?void 0:Ea.elapsedTime)}function aY(r,e,t){let n=Ea.elapsedTime,i=t.elapsedTime,o={openedAfter:i},s=u=>(u==="executeCell"&&(qn=!0),o[`${u}StartedAfter`]=t.elapsedTime,{stop:lr(()=>{o[`${u}CompletedAfter`]=t.elapsedTime})}),a={wasAlreadyOpen:e},l=()=>{};return{measures:o,info:a,tracker:{kernelSelected:lr((u,c)=>{let d=W2.get(u);typeof d=="number"&&(a.wasAlreadyOpen?o.controllerCreatedAfter=W2.get(u):o.controllerCreatedAfter=n-d),o.interpreterDiscoveredAfter=dY.get(c||""),o.kernelSelectedAfter=t.elapsedTime,a.manuallySelectedKernel||mve(r,{wasAlreadyOpen:a.wasAlreadyOpen},{controllerCreatedAfter:o.controllerCreatedAfter,kernelSelectedAfter:o.kernelSelectedAfter,openedAfter:i,interpreterDiscoveredAfter:o.interpreterDiscoveredAfter})}),kernelManuallySelected:lr(()=>a.manuallySelectedKernel=!0),cellExecutionCount:qn?l:lr(u=>o.executeCellCount=u),preExecuteCellTelemetry:qn?l:lr(()=>s("preExecuteCellTelemetry")),startKernel:qn?l:lr(()=>s("startKernel")),executeCell:qn?l:lr(()=>s("executeCell")),executeCellAcknowledged:qn?l:lr(()=>{o.executeCellAcknowledgedAfter=t.elapsedTime,pve(r,a,o)}),jupyterSessionTelemetry:qn?l:lr(()=>s("sessionTelemetry")),postKernelStartup:qn?l:lr(()=>s("postKernelStart")),computeCwd:qn?l:lr(()=>s("computeCwd")),getConnection:qn?l:lr(()=>s("getConnection")),updateConnection:qn?l:lr(()=>s("updateConnection")),kernelReady:qn?l:lr(()=>s("kernelReady")),portUsage:qn?l:lr(()=>s("portUsage")),spawn:qn?l:lr(()=>s("spawn")),pythonEnvVars:qn?l:lr(()=>s("pythonEnvVars")),envVars:qn?l:lr(()=>s("envVars")),interruptHandle:qn?l:lr(()=>s("interruptHandle")),kernelInfo:qn?l:lr(()=>s("kernelInfo")),kernelIdle:qn?l:lr(()=>s("kernelIdle"))}}}var pve=lr(function(r,e,t){if(typeof t.preExecuteCellTelemetryStartedAfter!="number"||typeof t.preExecuteCellTelemetryCompletedAfter!="number"||typeof t.executeCellAcknowledgedAfter!="number"||typeof t.startKernelStartedAfter!="number"||typeof t.startKernelCompletedAfter!="number"||typeof t.executeCellStartedAfter!="number"||typeof t.sessionTelemetryStartedAfter!="number"||typeof t.sessionTelemetryCompletedAfter!="number"||typeof t.postKernelStartStartedAfter!="number"||typeof t.postKernelStartCompletedAfter!="number"||typeof t.kernelInfoStartedAfter!="number"||typeof t.kernelInfoCompletedAfter!="number"||typeof t.kernelIdleStartedAfter!="number"||typeof t.kernelIdleCompletedAfter!="number"||typeof t.computeCwdStartedAfter!="number"||typeof t.computeCwdCompletedAfter!="number"||typeof t.kernelReadyStartedAfter!="number"||typeof t.kernelReadyCompletedAfter!="number"||typeof t.getConnectionStartedAfter!="number"||typeof t.getConnectionCompletedAfter!="number"||typeof t.updateConnectionStartedAfter!="number"||typeof t.updateConnectionCompletedAfter!="number"||typeof t.portUsageStartedAfter!="number"||typeof t.portUsageCompletedAfter!="number"||typeof t.spawnStartedAfter!="number"||typeof t.spawnCompletedAfter!="number"||typeof t.pythonEnvVarsStartedAfter!="number"||typeof t.pythonEnvVarsCompletedAfter!="number"||typeof t.envVarsStartedAfter!="number"||typeof t.envVarsCompletedAfter!="number")return;let n={duration:0,preExecuteCellTelemetry:0,startKernel:0,executeCell:0};{let u=[{name:"preExecuteCellTelemetry",start:t.preExecuteCellTelemetryStartedAfter,end:t.preExecuteCellTelemetryCompletedAfter},{name:"startKernel",start:t.startKernelStartedAfter,end:t.startKernelCompletedAfter},{name:"executeCell",start:t.executeCellStartedAfter,end:t.executeCellAcknowledgedAfter}],c=t.executeCellAcknowledgedAfter-t.preExecuteCellTelemetryStartedAfter;n.duration=c,Sx(n,u,c,t.openedAfter)}let i={sessionTelemetry:0,postKernelStart:0,computeCwd:0,getConnection:0,updateConnection:0,kernelReady:0,portUsage:0,spawn:0};{let u=[{name:"sessionTelemetry",start:t.sessionTelemetryStartedAfter,end:t.sessionTelemetryCompletedAfter},{name:"postKernelStart",start:t.postKernelStartStartedAfter,end:t.postKernelStartCompletedAfter},{name:"computeCwd",start:t.computeCwdStartedAfter,end:t.computeCwdCompletedAfter},{name:"getConnection",start:t.getConnectionStartedAfter,end:t.getConnectionCompletedAfter},{name:"updateConnection",start:t.updateConnectionStartedAfter,end:t.updateConnectionCompletedAfter},{name:"spawn",start:t.spawnStartedAfter,end:t.spawnCompletedAfter},{name:"portUsage",start:t.portUsageStartedAfter,end:t.portUsageCompletedAfter},{name:"kernelReady",start:t.kernelReadyStartedAfter,end:t.kernelReadyCompletedAfter}],c=t.startKernelCompletedAfter-t.startKernelStartedAfter;Sx(i,u,c,t.openedAfter)}let o={startupCode:0,kernelInfo:0,kernelIdle:0};{let u=[{name:"startupCode",start:t.postKernelStartStartedAfter,end:t.kernelInfoStartedAfter},{name:"kernelInfo",start:t.kernelInfoStartedAfter,end:t.kernelInfoCompletedAfter},{name:"kernelIdle",start:t.kernelIdleStartedAfter,end:t.kernelIdleCompletedAfter}],c=t.postKernelStartCompletedAfter-t.postKernelStartStartedAfter;Sx(o,u,c,t.openedAfter)}let s={pythonEnvVars:0,envVars:0,interruptHandle:0};{let u=[{name:"pythonEnvVars",start:t.pythonEnvVarsStartedAfter,end:t.pythonEnvVarsCompletedAfter},{name:"envVars",start:t.envVarsStartedAfter,end:t.envVarsCompletedAfter},{name:"interruptHandle",start:t.interruptHandleStartedAfter||0,end:t.interruptHandleCompletedAfter||0}],c=t.spawnCompletedAfter-t.spawnStartedAfter;Sx(s,u,c,t.openedAfter)}let a=fve(r),l={...n,...i,...o,...s,...a};Br(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",l,e)});function fve(r){let e={attachmentCharLength:0,attachmentCount:0,codeCellCharLength:0,codeCellCount:0,mdCellCharLength:0,mdCellCount:0,outputCount:0,outputsByteSize:0};return r.getCells().forEach(t=>{let n=t.document.lineAt(t.document.lineCount-1).range.end,i=t.document.offsetAt(n);if(t.kind===Mg.NotebookCellKind.Markup){e.mdCellCount+=1,e.mdCellCharLength+=i;try{let s=Mf(t).attachments||{};Object.keys(s).forEach(a=>{e.attachmentCount+=1;let l=s[a];typeof l=="object"&&Object.keys(l).forEach(u=>{let c=l[u];c&&typeof c=="string"&&(e.attachmentCharLength+=c.length)})})}catch(o){w.warn("Error parsing attachments in cell metadata",o)}}else e.codeCellCount+=1,e.codeCellCharLength+=i,e.outputCount+=t.outputs.length,e.outputsByteSize+=t.outputs.reduce((o,s)=>o+s.items.reduce((a,l)=>a+l.data.byteLength,0),0)}),e}var mve=lr(function(r,e,t){if(t.pythonExtensionActivationStartedAfter=YN.starAfter,t.pythonExtensionActivationCompletedAfter=YN.completedAfter,typeof t.controllerCreatedAfter=="undefined"||typeof t.interpreterDiscoveredAfter=="undefined"||typeof t.pythonExtensionActivationCompletedAfter=="undefined"||typeof t.pythonExtensionActivationStartedAfter=="undefined")return;let n=[{name:"callPythonApi",start:lY,end:t.pythonExtensionActivationStartedAfter},{name:"activatePython",start:t.pythonExtensionActivationStartedAfter,end:t.pythonExtensionActivationCompletedAfter},{name:"discoverEnv",start:t.pythonExtensionActivationCompletedAfter,end:t.interpreterDiscoveredAfter},{name:"createController",start:t.interpreterDiscoveredAfter,end:t.controllerCreatedAfter},{name:"selectController",start:t.controllerCreatedAfter,end:t.kernelSelectedAfter}],i=t.kernelSelectedAfter-t.openedAfter,o={duration:i};Sx(o,n,i,t.openedAfter),Br(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",o,e)});function Sx(r,e,t,n){e.sort((i,o)=>i.start-o.start).forEach(i=>{typeof n=="number"&&n>=i.start&&n<=i.end?r[i.name]=(i.end-n)*100/t:typeof n=="number"&&n>i.end?r[i.name]=0:(typeof n=="number"&&n<i.start||typeof n!="number")&&(r[i.name]=(i.end-i.start)*100/t)})}function Ix(r,e){if(r){let t={...r,uri:wt.Uri.file(r.path||""),id:e||r.id};return delete t.path,t}}function _x(r){if(r){let e=Object.assign({},r,{path:lt(r.uri)});return delete e.uri,e}}var pS=class{constructor(e,t){this.disposables=e;this.extensionChecker=t;this.api=Re();this.didActivatePython=new wt.EventEmitter;this._pythonExtensionHooked=Re();this.extensionChecker.isPythonExtensionInstalled||wt.extensions.onDidChange(async()=>{this.extensionChecker.isPythonExtensionInstalled&&await this.registerHooks()},this,this.disposables),this.disposables.push(this.didActivatePython)}get onDidActivatePythonExtension(){return this.didActivatePython.event}get pythonExtensionHooked(){return this._pythonExtensionHooked.promise}get pythonExtensionVersion(){return this._pythonExtensionVersion}getApi(){return this.init().catch(E),this.api.promise}async getNewApi(){var t,n;await this.init();let e=wt.extensions.getExtension($s);return(t=e==null?void 0:e.packageJSON)!=null&&t.version&&(this._pythonExtensionVersion=new hY.SemVer((n=e==null?void 0:e.packageJSON)==null?void 0:n.version)),e!=null&&e.exports&&(S7(e.exports),e.exports.environments.known.forEach(i=>{mY(i)})),e==null?void 0:e.exports}setApi(e){this.api.resolved||!wt.workspace.isTrusted||this.api.resolve(e)}async init(){if(this.initialized)return;wt.extensions.getExtension($s)?await this.registerHooks():await this.extensionChecker.showPythonExtensionInstallRequiredPrompt(),this.initialized=!0}async registerHooks(){var n;if(this.hooksRegistered)return;let e=wt.extensions.getExtension($s);if(!e)return;let t=!1;if(!e.isActive){let i=pY();try{let o=e.activate();o.then(()=>i.stop(),()=>i.stop()),await o,t=!0}catch(o){w.error("Failed activating the python extension: ",o),this.api.reject(new NN(o));return}}this.hooksRegistered||(this.hooksRegistered=!0,t&&this.didActivatePython.fire(),(n=e.exports)!=null&&n.jupyter?e.exports.jupyter.registerHooks():(w.error("Python extension is not exporting the jupyter API"),this.api.reject(new RN)),this._pythonExtensionHooked.resolve())}};pS=U([(0,Ca.injectable)(),x(0,(0,Ca.inject)(ve)),x(1,(0,Ca.inject)(vo))],pS);var Of=class{constructor(e){this.disposables=e;this.pythonExtensionInstallationStatusChanged=new wt.EventEmitter;wt.extensions.onDidChange(this.extensionsChangeHandler.bind(this),this,this.disposables),this.previousInstallState=this.isPythonExtensionInstalled}get onPythonExtensionInstallationStatusChanged(){return this.pythonExtensionInstallationStatusChanged.event}get isPythonExtensionInstalled(){return wt.extensions.getExtension($s)!==void 0}get isPythonExtensionActive(){var e;return((e=wt.extensions.getExtension($s))==null?void 0:e.isActive)===!0}async directlyInstallPythonExtension(){return wt.commands.executeCommand("workbench.extensions.installExtension",$s,{context:{skipWalkthrough:!0}})}async showPythonExtensionInstallRequiredPrompt(){if(!wt.workspace.isTrusted)return;Of.promptDisplayed=!0;let e=Ue.bannerLabelYes;ne("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"displayed"}),await wt.window.showInformationMessage(W.pythonExtensionRequired,{modal:!0},e)===e?(ne("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"download"}),await this.installPythonExtension()):ne("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"dismissed"})}async installPythonExtension(){wt.commands.executeCommand("extension.open",$s).then(E,E)}async extensionsChangeHandler(){let e=this.isPythonExtensionInstalled;e!==this.previousInstallState&&(this.pythonExtensionInstallationStatusChanged.fire(e?"installed":"uninstalled"),this.previousInstallState=e)}};Of=U([(0,Ca.injectable)(),x(0,(0,Ca.inject)(ve))],Of);var $N=class{constructor(e,t,n,i){this.apiProvider=e;this.extensionChecker=t;this.disposables=n;this.context=i;this.didChangeInterpreter=new wt.EventEmitter;this.didChangeInterpreters=new wt.EventEmitter;this._onDidEnvironmentVariablesChange=new wt.EventEmitter;this._onDidRemoveInterpreter=new wt.EventEmitter;this.onDidRemoveInterpreter=this._onDidRemoveInterpreter.event;this.onDidEnvironmentVariablesChange=this._onDidEnvironmentVariablesChange.event;this._status="idle";this._onDidChangeStatus=new wt.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.refreshPromises=new Zb;this.onResumeEnvDetection=new wt.EventEmitter;this.workspaceCachedActiveInterpreter=new Set;this.lastLoggedResourceAndInterpreterId="";this.pythonEnvHashes=new Map;this.loggedEnvsWithoutInterpreterPath=new Set;this.pendingInterpreterChangeEventTriggers=new Map;this.pendingInterpretersChangeEventTriggers=new Map;this.extensionChecker.isPythonExtensionInstalled&&!this.extensionChecker.isPythonExtensionActive&&this.apiProvider.onDidActivatePythonExtension(()=>{this.hookupOnDidChangeInterpreterEvent()},this,this.disposables),wt.workspace.onDidGrantWorkspaceTrust(()=>this.refreshInterpreters(!0),this,this.disposables),this.disposables.push(this._onDidChangeStatus),this.disposables.push(this.refreshPromises),this.disposables.push(this.onResumeEnvDetection),this.refreshPromises.onStateChange(()=>{this.status=this.refreshPromises.isComplete?"idle":"refreshing"})}get status(){return this._status}set status(e){this._status!==e&&(this._status=e,this._onDidChangeStatus.fire())}initialize(){this.hookupOnDidChangeInterpreterEvent()}async resolveEnvironment(e){return this.getApi().then(t=>{if(!t)return;let n=typeof e=="string"?t.environments.known.find(i=>i.id===e||i.path===e):e;return t.environments.resolveEnvironment(n||e)})}get onDidChangeInterpreter(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreter.event}get onDidChangeInterpreters(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreters.event}async refreshInterpreters(e=!1){let t=(async()=>{let n=await this.getApi();if(n)try{await n.environments.refreshEnvironments({forceRefresh:e}),this.hookupOnDidChangeInterpreterEvent(),w.debug("Refreshed Environments")}catch(i){w.error("Failed to refresh the list of interpreters")}})();this.refreshPromises.push(t),this.refreshPromises.push(t.then(()=>tc(1e3))),await t}async getActiveInterpreter(e){var o,s,a;if(!wt.workspace.isTrusted)return;let t=new It;this.hookupOnDidChangeInterpreterEvent(),!e&&((o=wt.workspace.workspaceFolders)==null?void 0:o.length)===1&&(e=wt.workspace.workspaceFolders[0].uri),(s=wt.workspace.workspaceFolders)!=null&&s.length&&(e=(e?(a=wt.workspace.getWorkspaceFolder(e))==null?void 0:a.uri:void 0)||wt.workspace.workspaceFolders[0].uri);let n=ZG(e),i=this.getApi().then(async l=>{if(!l)return;let u=l.environments.getActiveEnvironmentPath(e),c=await l.environments.resolveEnvironment(u);return this.trackResolvedEnvironment(c)});return i.then(()=>{this.workspaceCachedActiveInterpreter.has(n)||(this.workspaceCachedActiveInterpreter.add(n),ne("DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",{duration:t.elapsedTime},{firstTime:!0}))}).catch(l=>{w.warn(`Failed to get active interpreter from Python for workspace ${n}`,l)}),(di||[wt.ExtensionMode.Development,wt.ExtensionMode.Test].includes(this.context.extensionMode))&&i.then(l=>{let u=`${Ee(e)}'-${Ee(l==null?void 0:l.id)}`;if(this.lastLoggedResourceAndInterpreterId===u)return;this.lastLoggedResourceAndInterpreterId=u;let c=Fu(l);w.trace(`Active Interpreter ${e?`for '${Ee(e)}' `:""}is ${Ee(l==null?void 0:l.id)} (${l&&Jr(l)}, '${l?Ss(l):""}', ${c==null?void 0:c.major}.${c==null?void 0:c.minor}.${c==null?void 0:c.micro})`)}).catch(E),i}getInterpreterHash(e){return this.pythonEnvHashes.get(e)}async getInterpreterDetails(e,t){if(!wt.workspace.isTrusted)throw new Error("Unable to determine active Interpreter as Workspace is not trusted");this.hookupOnDidChangeInterpreterEvent();try{return await this.getApi().then(async n=>{if(!n||t!=null&&t.isCancellationRequested)return;let i=n.environments.known.find(l=>pi(e)?g2(l.executable.uri,e):typeof e=="string"?l.id===e:g2(wt.Uri.file(l.path),wt.Uri.file(e.path))),o=pi(e)?Ee(e):typeof e=="string"?e:Ee(wt.Uri.file(e.path));if(i){let l=await n.environments.resolveEnvironment(i),u=this.trackResolvedEnvironment(l);return w.ci(`Interpreter details for ${o} from Python is ${JSON.stringify(l)} and our mapping is ${JSON.stringify(u)}`),u}let s=o;if(this.loggedEnvsWithoutInterpreterPath.has(s)||(this.loggedEnvsWithoutInterpreterPath.add(s),w.warn(`No interpreter with path ${o} found in Python API, will convert Uri path to string as Id ${o}`)),t!=null&&t.isCancellationRequested)return;let a=await n.environments.resolveEnvironment(pi(e)?e.fsPath:typeof e=="string"?e:e.path);return this.trackResolvedEnvironment(a)})}catch(n){w.warn(`Failed to get Python interpreter details from Python Extension API for ${typeof e=="string"?e:Ee(pi(e)?e:wt.Uri.file(e.path))}`,n);return}}trackResolvedEnvironment(e){if(e){let t=uT(e);return t?(Xb(t).then(n=>{this.pythonEnvHashes.set(t.id,n)}).catch(E),this.triggerEventIfAllowed("interpretersChangeEvent",t),t):void 0}}triggerEventIfAllowed(e,t){e==="interpreterChangeEvent"?this.pendingInterpreterChangeEventTriggers.set((t==null?void 0:t.id)||"",t):this.pendingInterpretersChangeEventTriggers.set((t==null?void 0:t.id)||"",t),this.triggerPendingEvents()}triggerPendingEvents(){this.pendingInterpreterChangeEventTriggers.forEach(t=>this.didChangeInterpreter.fire(t)),this.pendingInterpreterChangeEventTriggers.clear();let e=Array.from(this.pendingInterpretersChangeEventTriggers.values());if(e.length){let t=e.filter(n=>!!n);t.length!==e.length&&t.length===0?this.didChangeInterpreters.fire([]):this.didChangeInterpreters.fire(t)}this.pendingInterpretersChangeEventTriggers.clear()}async getApi(){if(this.extensionChecker.isPythonExtensionInstalled)return this.apiPromise||(this.apiPromise=this.apiProvider.getNewApi()),this.apiPromise}hookupOnDidChangeInterpreterEvent(){this.eventHandlerAdded||this.getApi().then(e=>{!this.eventHandlerAdded&&e&&(this.eventHandlerAdded=!0,e.environments.onDidEnvironmentVariablesChange(t=>{var n,i;w.debug(`Detected changes to env file ${(i=(n=t.resource)==null?void 0:n.uri)==null?void 0:i.path} in PythonApi`),this._onDidEnvironmentVariablesChange.fire()},this,this.disposables),e.environments.onDidChangeActiveEnvironmentPath(()=>{w.trace("Detected change in Active Python environment via Python API"),this.workspaceCachedActiveInterpreter.clear(),this.triggerEventIfAllowed("interpreterChangeEvent",void 0)},this,this.disposables),e.environments.onDidChangeEnvironments(async t=>{if(w.trace(`Python API env change detected, ${t.type} => '${t.env.id}'`),t.type==="remove"){this.triggerEventIfAllowed("interpreterChangeEvent",void 0),this.triggerEventIfAllowed("interpretersChangeEvent",void 0),this._onDidRemoveInterpreter.fire({id:t.env.id});return}let n=uT(Hi(t.env));n&&(this.triggerEventIfAllowed("interpreterChangeEvent",n),this.triggerEventIfAllowed("interpretersChangeEvent",n))},this,this.disposables),this.didChangeInterpreters.fire(_7().map(uT).filter(t=>!!t).map(t=>t)))}).catch(E)}};$N=U([(0,Ca.injectable)(),x(0,(0,Ca.inject)(gy)),x(1,(0,Ca.inject)(vo)),x(2,(0,Ca.inject)(ve)),x(3,(0,Ca.inject)(st))],$N);p();var ES=require("vscode");p();function gY(r,e){let t=r.length>0?`?token=${r}`:"";return`${e}${t}`}async function iR(r,e){let t=W.jupyterSelfCertEnable,n=W.jupyterSelfCertClose,i=await ES.window.showErrorMessage(W.jupyterSelfCertFail(e),{modal:!0},t,n);return i===t?(ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,ES.ConfigurationTarget.Workspace),!0):(i===n&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}async function oR(r,e){let t=W.jupyterSelfCertEnable,n=W.jupyterSelfCertClose,i=await ES.window.showErrorMessage(W.jupyterExpiredCertFail(e),{modal:!0},t,n);return i===t?(ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,ES.ConfigurationTarget.Workspace),!0):(i===n&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}function YV(r,e,t,n,i,o,s){var A;let a=e.baseUrl,l=e.token,u=new URL(e.baseUrl).hostname,c=e.authorizationHeader&&Object.keys((A=e==null?void 0:e.authorizationHeader)!=null?A:{}).length>0?e.authorizationHeader:void 0;l&&r.extensionId===Je&&r.id===LE&&(c=c||{},c.Authorization=c.Authorization||`token ${l}`);let d=c?()=>c:void 0,f={baseUrl:a,appUrl:"",wsUrl:a.replace("http","ws"),fetch:e.fetch,WebSocket:e.WebSocket},m=t.getRequestInit();(!(l===""||l==="null")||d)&&(f={...f,token:l,appendToken:!0});let b=i.getSettings(void 0).allowUnauthorizedRemoteConnection;if(a.startsWith("https")&&b&&n){let D=n.createHttpRequestAgent();m={...m,agent:D}}let{ServerConnection:y}=ri();return f={...f,init:m,WebSocket:e.WebSocket?t.wrapWebSocketCtor(e.WebSocket):t.getWebsocketCtor(void 0,b,d),fetch:e.fetch||t.getFetchMethod(),Request:t.getRequestCtor(void 0,b,d),Headers:t.getHeadersCtor()},{baseUrl:a,providerId:r.id,serverProviderHandle:r,token:l,hostName:u,displayName:e&&e.displayName?e.displayName:gY(l,a),dispose:()=>s==null?void 0:s.dispose(),rootDirectory:o,getAuthHeader:d,settings:y.makeSettings(f)}}async function Rz(r){let e=Vt(r);return ja(e,"SHA-256")}var wSe=new Set([Je,"ms-toolsai.vscode-ai","GitHub.codespaces"].map(r=>r.toLowerCase()));function Vt(r){return wSe.has(r.extensionId.toLowerCase())?`${nt.REMOTE_URI}?${nt.REMOTE_URI_ID_PARAM}=${r.id}&${nt.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}`:`${nt.REMOTE_URI}?${nt.REMOTE_URI_ID_PARAM}=${r.id}&${nt.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}&${nt.REMOTE_URI_EXTENSION_ID_PARAM}=${encodeURI(r.extensionId)}`}async function sR(r){var e;if(!rc()&&((e=r.interpreter)!=null&&e.uri)){let t=r.interpreter.uri.fsPath,n=Oc(r.interpreter.uri).fsPath,i=r.id.replace(t,n);return Rt(i)}return Rt(r.id)}var Qc=class{static fromJSON(e){let t=Object.assign(e,{});switch(t.interpreter&&(t.interpreter=Ix(t.interpreter,"")),e.kind){case"startUsingLocalKernelSpec":return $V.create(t);case"connectToLiveRemoteKernel":return Hx.create(t);case"startUsingRemoteKernelSpec":return qx.create(t);case"startUsingPythonInterpreter":return Jx.create(t);default:throw new Error(`Invalid object to be deserialized into a connection, kind = ${t.kind}`)}}},Hx=class r{constructor(e){this.kind="connectToLiveRemoteKernel";this.kernelModel=e.kernelModel,this.interpreter=e.interpreter,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,aR(this)}static create(e){return new r(e)}updateModel(e){Object.assign(this.kernelModel,e)}getHashId(){return sR(this)}toJSON(){return{id:this.id,kind:this.kind,baseUrl:this.baseUrl,interpreter:_x(this.interpreter),kernelModel:this.kernelModel,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return Qc.fromJSON(e)}},$V=class r{constructor(e){this.kind="startUsingLocalKernelSpec";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,aR(this)}static create(e){return new r(e)}getHashId(){return sR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:_x(this.interpreter),kind:this.kind}}static fromJSON(e){return Qc.fromJSON(e)}},qx=class r{constructor(e){this.kind="startUsingRemoteKernelSpec";this.interpreter=e.interpreter,this.kernelSpec=e.kernelSpec,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,aR(this)}static create(e){return new r(e)}getHashId(){return sR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:_x(this.interpreter),baseUrl:this.baseUrl,kind:this.kind,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return Qc.fromJSON(e)}},Jx=class r{constructor(e){this.kind="startUsingPythonInterpreter";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,aR(this)}static create(e){return new r(e)}getHashId(){return sR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:_x(this.interpreter),kind:this.kind}}updateInterpreter(e){Object.assign(this.interpreter,e)}static fromJSON(e){return Qc.fromJSON(e)}};function zt(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"}function Wt(r){return!zt(r)}var qe=Symbol("IKernelProvider"),Ug=Symbol("IThirdPartyKernelProvider");var X4e=Symbol("IJupyterServerConnector"),Gx=Symbol("IKernelSessionFactory");var CS=Symbol("IKernelDependencyService"),oi=Symbol("IKernelFinder"),wS=Symbol("ITracebackFormatter");var Md=Symbol("IStartupCodeProviders"),Az=new Set;function aR(r){var m,g;if(Az.has(r.id))return;Az.add(r.id);let e="kernelSpec"in r?r.kernelSpec:void 0,t=(e==null?void 0:e.language)||(r.kind==="startUsingPythonInterpreter"?Ye:void 0),n="",i="",o="interpreter"in r?r.interpreter:void 0,s="<#>",a;e&&Array.isArray(e.argv)&&e.argv.length>0&&(n=e.argv[0],a=n.toLowerCase()===((g=(m=o==null?void 0:o.uri)==null?void 0:m.fsPath)==null?void 0:g.toLowerCase()),Zt(n)!==n&&(n=`<P>${Zt(n)}`),i=e.argv.map(b=>b.includes("/")||b.includes("\\")?`<P>${Zt(b)}`:b).join(s));let l="kernelSpec"in r&&r.kernelSpec.specFile?Rt(r.kernelSpec.specFile):Promise.resolve(""),u=Rt(r.id),c=Wt(r)?Rt(Vt(r.serverProviderHandle)):Promise.resolve(""),d=Wt(r)?r.serverProviderHandle.extensionId:Je,f=Wt(r)?Rt(r.baseUrl.toLowerCase()):Promise.resolve("");Promise.all([l,u,c,f]).then(([b,y,P,A])=>ne("DS_INTERNAL.JUPYTER_KERNEL_SPEC",void 0,{kernelId:y,serverIdHash:P,kernelSpecHash:b,baseUrlHash:A,providerExtensionId:d,kernelConnectionType:r.kind,kernelLanguage:t,envType:o&&Jr(o),isArgv0SameAsInterpreter:a,argv0:n,argv:i})).catch(E)}p();var Gn=require("vscode");p();var ASe=se(Y2()),Ld=require("vscode");p();var xS=class{constructor(e,t,n,i){this.specFile=t;this.interpreterPath=n;this.isRegisteredByVSC=i;this.name=e.name,this.argv=e.argv,this.language=e.language,this.executable=e.argv&&e.argv.length>0?e.argv[0]:"",this.display_name=e.display_name,this.metadata=e.metadata,this.env=e.env,this.interrupt_mode=e.interrupt_mode}};p();var si=require("vscode"),Vz=se(zV());p();var QV=class{constructor(e,t,n,i=!1){this._impl=e;this.controllerId=t;this._endCallback=n;this.clearOutputOnStartWithTime=i;this._started=!1}get started(){return this._started}get cell(){return this._impl.cell}get token(){return this._impl.token}get executionOrder(){return this._impl.executionOrder}set executionOrder(e){var t;e&&((t=Uc(this._impl.cell.notebook))==null||t.executeCellAcknowledged()),this._impl.executionOrder=e}startIfNecessary(){this.started||this._impl.start()}start(e){this.started||(this._started=!0,this._impl.start(e),this._startTime=e,this.clearOutputOnStartWithTime?(w.trace(`Start cell ${this.cell.index} execution @ ${e} (clear output)`),this._impl.clearOutput().then(E,E)):w.trace(`Start cell ${this.cell.index} execution @ ${e}`))}end(e,t){if(this._endCallback)try{this._impl.end(e,t,this.errorInfo),w.trace(`Cell ${this.cell.index} completed in ${((t||0)-(this._startTime||0))/1e3}s (start: ${this._startTime}, end: ${t})`)}finally{this._endCallback(),this._endCallback=void 0}}clearOutput(e){return this.startIfNecessary(),this._impl.clearOutput(e)}replaceOutput(e,t){return this.startIfNecessary(),this._impl.replaceOutput(e,t)}appendOutput(e,t){return this.startIfNecessary(),this._impl.appendOutput(e,t)}replaceOutputItems(e,t){return this.startIfNecessary(),this._impl.replaceOutputItems(e,t)}appendOutputItems(e,t){return this.startIfNecessary(),this._impl.appendOutputItems(e,t)}},Hf=class Hf{static getOrCreate(e,t,n=!1){let i,o=e.document;if(i=this.get(e),!i)i=Hf.create(o,e,t,n);else if(i.controllerId!==t.id){let s=i;s.end(void 0),i=Hf.create(o,e,t,n),s.started&&i.start(new Date().getTime())}return i}static get(e){let t=e.document;return Hf._map.get(t)}static create(e,t,n,i=!1){let o=new QV(n.createNotebookCellExecution(t),n.id,()=>{Hf._map.delete(e)},i);return Hf._map.set(e,o),o}};Hf._map=new WeakMap;var io=Hf;p();function lR(r){return typeof Buffer!="undefined"&&typeof Buffer.from=="function"?Buffer.from(r,"base64"):Uint8Array.from(atob(r),e=>e.charCodeAt(0))}var PSe=new TextDecoder;function cR(r){if(typeof Buffer!="undefined"&&typeof Buffer.from=="function")return Buffer.from(r).toString("base64");{let e=PSe.decode(r);return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(t,n){return String.fromCharCode(Number.parseInt("0x"+n))}))}}var Kz=["application/vnd.*","application/vdom.*","application/geo+json","application/x-nteract-model-debug+json","text/html","application/javascript","image/gif","text/latex","text/markdown","image/png","image/svg+xml","image/jpeg","application/json","text/plain"];function Fz(r){if(r.mime.startsWith("application/vnd."))try{return new TextDecoder().decode(r.data).length===0}catch(e){}return!1}function DSe(r){return r.sort((e,t)=>{let n=(s,a)=>(s.endsWith(".*")&&(s=s.substr(0,s.indexOf(".*"))),a.startsWith(s)),i=Kz.findIndex(s=>n(s,e.mime)),o=Kz.findIndex(s=>n(s,t.mime));return Fz(e)&&(i=-1),Fz(t)&&(o=-1),i=i==-1?100:i,o=o==-1?100:o,i-o})}var qf=class qf{static getCellState(e){var t;return(t=qf.cellStates.get(e))==null?void 0:t.state}static getCellStatus(e){var t;return(((t=qf.cellStates.get(e))==null?void 0:t.stateTransition)||[]).join(", ")||""}static setCellState(e,t){var o,s;let n=((o=qf.cellStates.get(e))==null?void 0:o.start)||new It,i=((s=qf.cellStates.get(e))==null?void 0:s.stateTransition)||[];i.push(`${t} ${i.length===0?"@ start":`After ${n.elapsedTime}ms`}`),qf.cellStates.set(e,{stateTransition:i,state:t,start:n})}};qf.cellStates=new WeakMap;var Jf=qf;function it(r,e){let t=typeof e=="string"?()=>e:e;w.ci(()=>{var n;return`Cell Index:${r.index}, of document ${mi(r.notebook.uri)} with state:${Jf.getCellStatus(r)}, exec: ${(n=r.executionSummary)==null?void 0:n.executionOrder}. ${t()}. called from ${l8()}`})}var DS=new Map;DS.set("display_data",dR);DS.set("error",RSe);DS.set("execute_result",dR);DS.set("stream",TSe);DS.set("update_display_data",dR);function ls(r){let e=DS.get(r.output_type),t;return e?t=e(r):(w.warn(`Unable to translate cell from ${r.output_type} to NotebookCellData for VS Code.`),t=dR(r)),t}function XV(r){let e={outputType:r.output_type};switch(r.transient&&(e.transient=r.transient),r.output_type){case"display_data":case"execute_result":case"update_display_data":{e.executionCount=r.execution_count,e.metadata=r.metadata?JSON.parse(JSON.stringify(r.metadata)):{};break}default:break}return e}function Wg(r){return r.metadata}function dR(r){let e=XV(r);("image/svg+xml"in r.data||"image/png"in r.data)&&(e.__displayOpenPlotIcon=!0);let t=[];if(r.data)for(let n in r.data)t.push(NSe(n,r.data[n]));return new si.NotebookCellOutput(DSe(t),e)}function TSe(r){let e=Fc(r.text),t=r.name==="stderr"?si.NotebookCellOutputItem.stderr:si.NotebookCellOutputItem.stdout;return new si.NotebookCellOutput([t(e)],XV(r))}function kSe(r){if(r.items.length>0)return r.items[0].mime==="application/vnd.code.notebook.stderr"?"stderr":"stdout"}function Uz(r){var i;let e=r.items[0];if(!e.data)return{output_type:"error",ename:"",evalue:"",traceback:[]};let t=(i=r.metadata)==null?void 0:i.originalError,n=JSON.parse(new TextDecoder().decode(e.data));return{output_type:"error",ename:n.name,evalue:n.message,traceback:(t==null?void 0:t.traceback)||cS(n.stack||n.message||"")}}var PS=new TextDecoder,jz=["text/plain","text/markdown","application/vnd.code.notebook.stderr","application/vnd.code.notebook.stdout"];function uR(r,e){if(!e)return"";try{if(r==="application/vnd.code.notebook.error"){let t=PS.decode(e);return JSON.parse(t)}else if(r.startsWith("text/")||jz.includes(r)){let t=PS.decode(e);return cS(t)}else{if(r.startsWith("image/")&&r!=="image/svg+xml")return cR(e);if(r.toLowerCase().startsWith("application/vnd.holoviews_load.v")&&r.toLowerCase().endsWith("+json")){let t=PS.decode(e);try{return t.length>0?JSON.parse(t):t}catch(n){return t}}else if(r.toLowerCase().includes("json")){let t=PS.decode(e);return t.length>0?JSON.parse(t):t}else return PS.decode(e)}}catch(t){return w.error(`Failed to convert ${r} output from a buffer ${typeof e}, ${e}`,t),""}}function NSe(r,e){if(!e)return si.NotebookCellOutputItem.text("",r);try{if((r.startsWith("text/")||jz.includes(r))&&(Array.isArray(e)||typeof e=="string")){let t=Array.isArray(e)?Fc(e):e;return si.NotebookCellOutputItem.text(t,r)}else return r.startsWith("image/")&&typeof e=="string"&&r!=="image/svg+xml"?new si.NotebookCellOutputItem(lR(e),r):typeof e=="object"&&e!==null&&!Array.isArray(e)?si.NotebookCellOutputItem.text(JSON.stringify(e),r):(e=Array.isArray(e)?Fc(e):e,si.NotebookCellOutputItem.text(e,r))}catch(t){return w.error(`Failed to convert ${r} output to a buffer ${typeof e}, ${e}`,t),si.NotebookCellOutputItem.text("")}}function Wz(r){let e=[];r.items.filter(n=>n.mime==="application/vnd.code.notebook.stderr"||n.mime==="application/vnd.code.notebook.stdout").map(n=>PS.decode(n.data)).forEach(n=>{let i=n.split(`
`);e.length&&i.length&&i[0].length>0&&(e[e.length-1]=`${e[e.length-1]}${i.shift()}`);for(let o of i)e.push(o)});for(let n=0;n<e.length-1;n++)e[n]=`${e[n]}
`;return e.length&&e[e.length-1].length===0&&e.pop(),{output_type:"stream",name:kSe(r)||"stdout",text:e}}function ZV(r){let e=r.metadata,t;switch(e==null?void 0:e.outputType){case"error":{t=Uz(r);break}case"stream":{t=Wz(r);break}case"display_data":{t={output_type:"display_data",data:r.items.reduce((i,o)=>(i[o.mime]=uR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}case"execute_result":{t={output_type:"execute_result",data:r.items.reduce((i,o)=>(i[o.mime]=uR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{},execution_count:typeof(e==null?void 0:e.executionCount)=="number"?e==null?void 0:e.executionCount:null};break}case"update_display_data":{t={output_type:"update_display_data",data:r.items.reduce((i,o)=>(i[o.mime]=uR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}default:{let i=r.items.length===1&&r.items.every(l=>l.mime==="application/vnd.code.notebook.error"),o=r.items.every(l=>l.mime==="application/vnd.code.notebook.stderr"||l.mime==="application/vnd.code.notebook.stdout");if(i)return Uz(r);let s=(e==null?void 0:e.outputType)||(o?"stream":"display_data");ne("DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",void 0,{outputType:s});let a;s==="stream"?a=Wz(r):s==="display_data"?a={data:{},metadata:{},output_type:"display_data"}:a={output_type:s},e!=null&&e.metadata&&(a.metadata=e.metadata),r.items.length>0&&(a.data=r.items.reduce((l,u)=>(l[u.mime]=uR(u.mime,u.data),l),{})),t=a;break}}return t&&e&&e.transient&&(t.transient=e.transient),t}function RSe(r){return r=r||{output_type:"error",ename:"",evalue:"",traceback:[]},new si.NotebookCellOutput([si.NotebookCellOutputItem.error({name:(r==null?void 0:r.ename)||"",message:(r==null?void 0:r.evalue)||"",stack:((r==null?void 0:r.traceback)||[]).join(`
`)})],{...XV(r),originalError:r})}async function Bz(r,e,t){var a,l,u,c,d,f,m,g,b,y,P,A,D,T,K,L,B;let n=!1,i;if(!r)return{changed:n,kernelId:i};(a=r==null?void 0:r.language_info)!=null&&a.name||(r.language_info=r.language_info||{name:""});let o;switch(e==null?void 0:e.kind){case"connectToLiveRemoteKernel":o=e.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":o=e.kernelSpec.language;break;case"startUsingPythonInterpreter":o=Ye;break;default:break}if(r.language_info.name!==o&&o&&(r.language_info.name=o,n=!0),t&&"language_info"in t&&t.language_info)(0,Vz.default)(r.language_info,t.language_info)||(r.language_info=JSON.parse(JSON.stringify(t.language_info)),n=!0);else{let N=jt(e),O=N?qz(e):void 0,h=await Tp(O),v=h?`${h.major}.${h.minor}.${h.micro}`:"";O&&h&&r&&r.language_info&&r.language_info.version!==v?(r.language_info.version=v,n=!0):!O&&(r!=null&&r.language_info)&&N&&(r.language_info=void 0,n=!0)}let s=e&&TS(e)?e.kernelModel:e&&"kernelSpec"in e?e.kernelSpec:void 0;if((e==null?void 0:e.kind)==="startUsingPythonInterpreter"){let N=e.kernelSpec,O=N.display_name||((u=(l=Hi(e.interpreter))==null?void 0:l.environment)==null?void 0:u.name)||"",h="";switch(Vg(N)){case"registeredByOldVersionOfExt":case"registeredByNewVersionOfExt":h="python3";break;case"registeredByNewVersionOfExtForCustomKernelSpec":{h=((d=(c=N.metadata)==null?void 0:c.vscode)!=null&&d.originalSpecFile?Zt(xi(N.metadata.vscode.originalSpecFile)):void 0)||N.name,O=((m=(f=N.metadata)==null?void 0:f.vscode)==null?void 0:m.originalDisplayName)||O;break}default:h=N.name;break}(((g=r.kernelspec)==null?void 0:g.name)!==h||((b=r.kernelspec)==null?void 0:b.display_name)!==O)&&(n=!0,r.kernelspec={name:h,language:Ye,display_name:O},"vscode"in r&&delete r.vscode,"interpreter"in r&&delete r.interpreter)}else if(s&&!r.kernelspec){let N=(P=(y=s.metadata)==null?void 0:y.vscode)!=null&&P.originalSpecFile?Zt(xi(s.metadata.vscode.originalSpecFile)):void 0;r.kernelspec={name:N||s.name||s.display_name||"",display_name:((D=(A=s.metadata)==null?void 0:A.vscode)==null?void 0:D.originalDisplayName)||s.display_name||s.name||""},s.language&&(r.kernelspec.language=s.language),i=s.id,n=!0}else if(s&&r.kernelspec){let O=((K=(T=s.metadata)==null?void 0:T.vscode)!=null&&K.originalSpecFile?Zt(xi(s.metadata.vscode.originalSpecFile)):void 0)||s.name||s.display_name||"",h=((B=(L=s.metadata)==null?void 0:L.vscode)==null?void 0:B.originalDisplayName)||s.display_name||s.name||"",v=s.language||s.language||"";(r.kernelspec.name!==O||r.kernelspec.language!==v||r.kernelspec.display_name!==h||i!==s.id)&&(n=!0,r.kernelspec.name=O,r.kernelspec.display_name=h,r.kernelspec.language=v,i=s.id);try{delete r.kernelspec.metadata}catch(C){}}return{changed:n,kernelId:i}}async function Od(r,e,t,n){var a,l,u,c,d,f,m;let i=by(t);if(!i){let g=io.get(r);n&&(g!=null&&g.started)&&g.end(n?void 0:!1,(l=(a=r.executionSummary)==null?void 0:a.timing)==null?void 0:l.endTime);return}io.get(r)||(n=!0);let o=io.getOrCreate(r,e),s=o.executionOrder;o.started||(o.start((c=(u=r.executionSummary)==null?void 0:u.timing)==null?void 0:c.startTime),o.executionOrder=((d=r.executionSummary)==null?void 0:d.executionOrder)||s),await o.appendOutput(i),o.end(n?void 0:!1,(m=(f=r.executionSummary)==null?void 0:f.timing)==null?void 0:m.endTime)}function Hz(r,e){var s;let t=/Cell\s+(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,n=/Input\s+?(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\][^<]*<cell line:\s?(?<lineNumber>\d+)>.*/,i;for(let a of r){let l=(s=t.exec(a))!=null?s:n.exec(a);if(l&&l.groups){i=parseInt(l.groups.lineNumber);break}}let o;if(i&&i>0&&i<=e.document.lineCount){let a=e.document.lineAt(i-1),l=a.text.split("#")[0].trimEnd().length;o=new si.Range(new si.Position(a.lineNumber,a.firstNonWhitespaceCharacterIndex),new si.Position(a.lineNumber,l))}return o}p();function Yx(r){if(r.hasOwnProperty("text/html")){let e=r["text/html"];typeof e=="string"&&e.includes('<iframe id="tensorboard-frame-')&&(r["text/html"]=e.replace(/new URL\((.*), window.location\)/,'new URL("http://localhost")'))}return r}var MSe="{connection_file}";var Gf="-jvsc-",OSe=/^python\d*.?\d*$/;async function zx(r,e){return LSe(await VSe(r),r,e)}function LSe(r,e,t){var s,a;let n=e?{path:lt(e.uri)}:{},i={name:r,language:"python",display_name:(e?(a=(s=Hi(e))==null?void 0:s.environment)==null?void 0:a.name:"")||"Python 3",metadata:{interpreter:n},argv:["python","-m","ipykernel_launcher","-f",MSe],env:{},resources:{}},o=t&&i.name?Fi(t,i.name,"kernel.json"):void 0;return new xS(i,o?lt(o):void 0,lt(e==null?void 0:e.uri),"registeredByNewVersionOfExt")}function pR(r){var t,n,i;let e=r==null?void 0:r.kernelspec;return(t=r==null?void 0:r.language_info)!=null&&t.name&&r.language_info.name!==Ye?!1:(n=e==null?void 0:e.name)!=null&&n.includes(Ye)?!0:(e==null?void 0:e.language)===Ye||((i=r==null?void 0:r.language_info)==null?void 0:i.name)===Ye}function KSe(r){var i,o,s,a,l;let e=((o=(i=r.metadata)==null?void 0:i.vscode)==null?void 0:o.originalSpecFile)||((s=r.metadata)==null?void 0:s.originalSpecFile),t=e?Zt(xi(e)):r.name||"",n=((l=(a=r.metadata)==null?void 0:a.vscode)==null?void 0:l.originalDisplayName)||r.display_name||"";return!!(t.toLowerCase().match(OSe)||n.toLowerCase()==="python 3 (ipykernel)"||n.toLowerCase()==="python 3")}function FSe(r){if(r.includes(Gf)){let e=/[a-f0-9]$/;if(r.substring(r.lastIndexOf(Gf)+Gf.length).search(e)!==-1){let t=r.substring(0,r.lastIndexOf(Gf));return t.toLowerCase().endsWith(".ipynb")||t.toLowerCase().endsWith(".py")?t:`${t}.ipynb`}}return r}function fR(r){return r.kind!=="connectToLiveRemoteKernel"}function TS(r){return r.kind==="connectToLiveRemoteKernel"}function mR(r,e,t){var u,c,d;e=ej(r)?e:void 0;let n=r.name,i=Vg(r);if(i&&n.includes($x)&&(n=n.substring(n.indexOf($x)),i==="registeredByNewVersionOfExtForCustomKernelSpec")){let f=((c=(u=r.metadata)==null?void 0:u.vscode)==null?void 0:c.originalSpecFile)||((d=r.metadata)==null?void 0:d.originalSpecFile);f&&(n=`${n}#${Zt(xi(f))}`)}let o="";ej(r)?o=r.argv.slice(1).filter(f=>!["-f","{connection_file}"].includes(f)).join("#").toLowerCase():o=r.argv.join("#").toLowerCase();let s=t?`${t}.`:"",a=lt(Oc(r.interpreterPath?Ld.Uri.file(r.interpreterPath):Ld.Uri.file(r.executable))),l=lt(Oc(e==null?void 0:e.uri))||"";return`${s}${r.id||""}.${n}.${a}.${l}.${o}`}function ut(r){var t,n,i,o;let e=USe(r);if(!r)return e;switch(r.kind){case"connectToLiveRemoteKernel":{let a=FSe(((n=(t=r.kernelModel)==null?void 0:t.notebook)==null?void 0:n.path)||((o=(i=r.kernelModel)==null?void 0:i.model)==null?void 0:o.path)||"");return a?`${e} (${a})`:e}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":if(r.interpreter&&Jr(r.interpreter)!=="Unknown"){let a=Ss(r.interpreter);if(r.kernelSpec.language===Ye){let l=`Python ${ay(Fu(r.interpreter))||""}`.trim();return a?`${e} (${l})`:e}else return a?`${e} (${a})`:e}else return e;case"startUsingPythonInterpreter":let s=(ay(Fu(r.interpreter))||"").trim();if(r.interpreter&&Jr(r.interpreter)!=="Unknown"){if(r.kernelSpec.display_name&&Vg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec")return r.kernelSpec.display_name;let a=Dp(r.interpreter),l=s.trim()?`Python ${s}`:"Python",u=Ss(r.interpreter);return a&&u?u:u?`${u} (${l})`:l}else return`Python ${s}`.trim()}return e}function USe(r){var i,o;if(!r)return"";let e=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.display_name:(i=r.kernelSpec)==null?void 0:i.display_name,t=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(o=r.kernelSpec)==null?void 0:o.name,n=r.kind==="startUsingPythonInterpreter"?Ku(r.interpreter):void 0;return[e,t,n,""].find(s=>typeof s=="string"&&s.length>0)||""}function Jz(r,e=""){var t;return r?r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(t=r.kernelSpec)==null?void 0:t.name:e}function WSe(r){var n,i,o,s,a;if(!r)return;let e=TS(r)?r.kernelModel:void 0,t=fR(r)?r.kernelSpec:void 0;if(r.kind==="startUsingPythonInterpreter"||(r.kind==="startUsingRemoteKernelSpec"||r.kind==="startUsingLocalKernelSpec")&&r.kernelSpec.language===Ye){let l=((i=(n=t==null?void 0:t.metadata)==null?void 0:n.interpreter)==null?void 0:i.path)||(t==null?void 0:t.interpreterPath)||(t==null?void 0:t.executable);if(l==="/python"||l==="python"){let u=Hi(r.interpreter);return((o=u==null?void 0:u.environment)==null?void 0:o.folderUri)||(u?Ld.Uri.file(u.path):void 0)}return l?Ld.Uri.file(l):void 0}else{let l=(e==null?void 0:e.executable)||(t==null?void 0:t.executable)||((a=(s=t==null?void 0:t.metadata)==null?void 0:s.interpreter)==null?void 0:a.path)||(t==null?void 0:t.interpreterPath);return l?Ld.Uri.file(l):void 0}}function tj(r,e=""){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel"){let t;if(typeof r.kernelModel.lastActivityTime=="string")try{t=new Date(r.kernelModel.lastActivityTime)}catch(n){w.debug(`Error parsing date ${n}`)}else t=r.kernelModel.lastActivityTime;return W.jupyterSelectLiveRemoteKernelDescription(t,r.kernelModel.numberOfConnections)}return e}function Gz(r,e){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel")return;let t=WSe(r),n=Ld.workspace.workspaceFolders?Ld.workspace.workspaceFolders:[];return t?Ee(t,n,e.homeDir):""}function qz(r){var n,i,o;if(!r)return;if(r.interpreter)return r.interpreter;let e=TS(r)?r.kernelModel:void 0;if((n=e==null?void 0:e.metadata)!=null&&n.interpreter)return Ix((i=e==null?void 0:e.metadata)==null?void 0:i.interpreter,"");let t=fR(r)?r.kernelSpec:void 0;return Ix((o=t==null?void 0:t.metadata)==null?void 0:o.interpreter,"")}function Yz(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"&&r.kernelSpec&&Vg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec"}function jt(r){if(!r)return!1;if(r.kind==="startUsingPythonInterpreter")return!0;let e=TS(r)?r.kernelModel:void 0,t=fR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)===Ye||ej(t)}function ej(r){return((r==null?void 0:r.language)||"").toLowerCase()===Ye}function Xc(r){if(!r)return;if(r.kind==="startUsingPythonInterpreter")return Ye;let e=TS(r)?r.kernelModel:void 0,t=fR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)||zz(t)}function $z(r){var t;if(!r)return;let e=r.kernelspec;return zz(e)||((t=r.language_info)==null?void 0:t.name)}function zz(r){return r==null?void 0:r.language}var $x="jvsc74a57bd0";async function VSe(r){let t=(ay(Fu(r))||"3").replace(/\./g,""),n=r?`python${t}`:"";return r?`${n}${$x}${await Xb(r)}`:"python3"}function Vg(r){var o,s,a,l;if(r.isRegisteredByVSC)return r.isRegisteredByVSC;if(!r.name)return;let e=((s=(o=r.metadata)==null?void 0:o.vscode)==null?void 0:s.originalSpecFile)||((a=r.metadata)==null?void 0:a.originalSpecFile),t=e?Zt(xi(e)):r.name,n=KSe({...r,name:t})?Object.keys(r.env||{}).length>0:typeof e=="string"&&!e.includes($x);if(r.name.includes($x))return n?"registeredByNewVersionOfExtForCustomKernelSpec":"registeredByNewVersionOfExt";let i=/[a-f0-9]{32}$/;if((l=r.metadata)!=null&&l.interpreter&&r.name.toLowerCase().search(i)!==-1)return"registeredByOldVersionOfExt"}function Qz(r,e){return!r&&!e?!0:!r&&e||r&&!e?!1:(r==null?void 0:r.id)===(e==null?void 0:e.id)}async function Mi(r,e,t){w.trace(`Executing silently Code (${r.status}) = ${at(e.substring(0,100)).join("\\n")}`);let n=ri(),i=r.requestExecute({code:e.replace(/\r\n/g,`
`),silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!1},!0),o=[];i.onIOPub=a=>{if(n.KernelMessage.isStreamMsg(a))if(w.ci(`Got io pub message (stream), ${at(a.content.text.substr(0,100)).join("\\n")}`),o.length>0&&o[o.length-1].output_type==="stream"&&o[o.length-1].name===a.content.name){let l=o[o.length-1];l.text+=a.content.text}else{let l={name:a.content.name,text:a.content.text,output_type:"stream"};o.push(l)}else if(n.KernelMessage.isExecuteResultMsg(a)){w.ci("Got io pub message (execresult)}");let l={data:a.content.data,execution_count:a.content.execution_count,metadata:a.content.metadata,output_type:"execute_result"};o.push(l)}else if(n.KernelMessage.isDisplayDataMsg(a)){w.ci("Got io pub message (displaydata)}");let l={data:a.content.data,metadata:a.content.metadata,output_type:"display_data"};o.push(l)}else if(n.KernelMessage.isErrorMsg(a)){if(w.ci(`Got io pub message (error), ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join().substring(0,100)}}`),t!=null&&t.traceErrors){let u=`${t.traceErrorsMessage||"Failed to execute (silent) code against the kernel"}, 
Code = ${e}
Error details: `;w.error(`${u} ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join()}`)}let l={ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback,output_type:"error"};o.push(l)}else w.ci(`Got io pub message (${a.header.msg_type})`)},await i.done;let s=at(e.substring(0,100)).join("\\n");return t&&jSe(o,t,s),w.trace(`Executing silently Code (completed) = ${s} with ${o.length} output(s)`),o}function Xz(r,e,t,n){e=e.replace(/\r\n/g,`
`);let i=ri(),o=r.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!1,store_history:!1},!0),s=lr(t);return o.onIOPub=a=>{s(),i.KernelMessage.isStreamMsg(a)?n(ls({output_type:"stream",name:a.content.name,text:a.content.text})):i.KernelMessage.isExecuteResultMsg(a)?n(ls({output_type:"execute_result",data:a.content.data,metadata:a.content.metadata,transient:a.content.transient,execution_count:a.content.execution_count})):i.KernelMessage.isDisplayDataMsg(a)?n(ls({output_type:"display_data",data:Yx(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isUpdateDisplayDataMsg(a)?n(ls({output_type:"display_data",data:Yx(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isErrorMsg(a)?n(ls({output_type:"error",ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback})):i.KernelMessage.isExecuteInputMsg(a)||i.KernelMessage.isStatusMsg(a)||w.warn(`Got unexpected io pub message when executing code sillenty (${a.header.msg_type})`)},o}function jSe(r,e,t){r.filter(n=>n.output_type==="error").forEach(n=>{let i=n,o=`${i.ename}: ${i.evalue} 
 ${i.traceback.map(a=>`    ${a}`).join(`
`)}`,s=`${e.traceErrorsMessage||""} ${t} ${o}`;e.traceErrors?w.error(s):w.warn(s),e.telemetryName&&ne(e.telemetryName)})}p();var hR="application/vnd.vscode.chat_message",Zz=`
def __VSCODE_inject_module():

    def __VSCODE_call_function(function, callback, data=None):
        __VSCODE_send_chat_message__(function, data, callback=callback)

    def __VSCODE_send_chat_message__(function, data, callback):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        import uuid as __VSCODE_send_chat_message__uuid
        import IPython.display as __VSCODE_send_chat_message__ipython_display

        id = str(__VSCODE_send_chat_message__uuid.uuid4())
        requests[id] = callback
        data_is_none = data is None
        __VSCODE_send_chat_message__ipython_display.display({"${hR}": data}, metadata={"id":id, "function": function, "dataIsNone": data_is_none}, raw=True)

        del __VSCODE_send_chat_message__ipython_display
        del __VSCODE_send_chat_message__uuid

    def __VSCODE_on_chat_message(id, data):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        if id in requests:
            requests[id](data)
            del requests[id]
        else:
            raise NotImplementedError(f"Callback not found for message {id}")

    import sys as __VSCODE_send_chat_message__sys
    import IPython as __VSCODE_send_chat_message__IPython
    chat = type(__VSCODE_send_chat_message__IPython)("chat")
    chat.send_message = __VSCODE_send_chat_message__
    chat.call_function = __VSCODE_call_function
    chat.__on_message = __VSCODE_on_chat_message
    __VSCODE_send_chat_message__sys.modules["vscode"] = type(__VSCODE_send_chat_message__IPython)("vscode")
    __VSCODE_send_chat_message__sys.modules["vscode"].chat = chat
    del __VSCODE_send_chat_message__sys
    del __VSCODE_send_chat_message__IPython


__VSCODE_inject_module()
del __VSCODE_inject_module
`,BSe=[[new RegExp("\\\\","g"),"\\\\"],[new RegExp('"',"g"),'\\"'],[new RegExp("'","g"),"'"],[new RegExp("\\\b","g"),"\\b"],[new RegExp("\\f","g"),"\\f"],[new RegExp("\\n","g"),"\\n"],[new RegExp("\\r","g"),"\\r"],[new RegExp("\\t","g"),"\\t"]];function eQ(r,e){let t=Qx(e),n=typeof t=="string"?`"${t}"`:"None";return`
import vscode as __vscode
try:
    __vscode.chat.__on_message('${r}', ${n})
finally:
    del __vscode
`}function Qx(r){if(typeof r!="string")return r;for(let[e,t]of BSe)r=r.replace(e,t);return r}p();var Xx=new WeakMap;function gR(r,e,t){var a,l;let n=Wg(t),i=(a=n==null?void 0:n.transient)==null?void 0:a.display_id;if(((l=t.metadata)==null?void 0:l.outputType)!=="display_data"||!i)return;let o=Xx.get(e)||new Map;Xx.set(e,o);let s=o.get(r)||[];o.set(r,s),s.push(i),s.length>1e3&&s.shift()}function tQ(r,e){let t=Xx.get(r)||new Map;for(let n of t.values())if(n.includes(e))return!0;return!1}function rQ(r,e,t){return((Xx.get(e)||new Map).get(r)||[]).includes(t)}function nQ(r,e){let t=Xx.get(r)||new Map;for(let n of t.values()){let i=n.indexOf(e);i>=0&&n.splice(i,1)}}p();var kn=require("vscode");var kS=new Map,iQ=new Set,bR=new kn.EventEmitter;Mu(bR);function oQ(r){return bR.event(r)}async function sQ(r){if(!kn.workspace.isTrusted)return{accessAllowed:!1};if(r===Je)return{accessAllowed:!0};let e=kS.get(r);return e||(e=HSe(r),kS.set(r,e),e.then(({result:t})=>{(t==="learnMore"||t==="cancelled")&&kS.get(r)===e&&(kS.delete(r),iQ.add(r))})),e.then(({result:t})=>({accessAllowed:t==="allowed"}))}async function HSe(r){var s,a;let e=await rj();if(e.get(r)===!0)return{result:"allowed"};if(e.get(r)===!1)return w.warn(`Kernel API access already revoked for extension ${r}`),{result:"denied"};let t=(a=(s=kn.extensions.getExtension(r))==null?void 0:s.packageJSON)==null?void 0:a.displayName;if(!t)return w.error(`Kernel API access revoked, as extension ${r} does not exist!`),{result:"denied"};let n=kn.l10n.t("Allow"),i=kn.l10n.t("Deny"),o=await kn.window.showInformationMessage(kn.l10n.t("Do you want to grant Kernel access to the extension {0} ({1})?",t,r),{modal:!0,detail:kn.l10n.t("This allows the extension to execute code against Jupyter Kernels.")},n,Ue.learnMore,i);switch(o===Ue.learnMore?kn.env.openExternal(kn.Uri.parse("https://aka.ms/vscodeJupyterKernelApiAccess")).then(E,E):(o===n||o===i)&&await qSe(r,o===n),o){case n:return{result:"allowed"};case Ue.learnMore:return{result:"learnMore"};case i:return w.error(`Kernel API access revoked for extension ${r}`),{result:"denied"};default:return{result:"cancelled"}}}async function aQ(){let r=new Set,[e]=await Promise.all([rj().then(t=>new Map(t)),...Array.from(kS.entries()).map(async([t,n])=>{(await n).result!=="allowed"&&r.add(t)})]);return r.forEach(t=>e.set(t,!1)),iQ.forEach(t=>e.set(t,e.get(t)===!0)),e}var vR="API.Access",Yf;async function rj(r=!1){let e=tt.instance.get(st);if(e.extensionMode===kn.ExtensionMode.Test)return new Map;if(lr(()=>{tt.instance.get(ve).push(e.secrets.onDidChange(i=>{i.key===vR&&(Yf=void 0)}))})(),Yf&&!r)return Yf;let t="";try{return t=await e.secrets.get(vR),!t||t.length===0?new Map:(Yf=new Map(Object.entries(JSON.parse(t))),Yf)}catch(n){return w.error(`Failed to parse API access information ${t}`,n),new Map}}var yR=Promise.resolve();async function lQ(r){return yR=yR.then(async()=>{await Promise.all(Array.from(kS.entries()).map(async([t,n])=>{let i=await n;i.result=r.includes(t)===!0?"allowed":"denied"})),Yf=new Map(r.map(t=>[t,!0]));let e=tt.instance.get(st);if(e.extensionMode!==kn.ExtensionMode.Test)try{await e.secrets.store(vR,JSON.stringify(Object.fromEntries(Yf))),bR.fire()}catch(t){w.error(`Failed to update API access information ${JSON.stringify(Object.fromEntries(Yf))}`,t)}})}async function qSe(r,e){return yR=yR.then(async()=>{let t=tt.instance.get(st);if(t.extensionMode===kn.ExtensionMode.Test)return;let n=await rj(!0);if(e!==n.get(r)){n.set(r,e);try{await t.secrets.store(vR,JSON.stringify(Object.fromEntries(n))),bR.fire()}catch(i){w.error(`Failed to store API access information ${JSON.stringify(Object.fromEntries(n))}`,i)}}})}p();var cQ=" (Interactive)",Nt=Symbol("IControllerRegistration");var SR=Symbol("IRemoteNotebookKernelSourceSelector"),uQ=Symbol("ILocalNotebookKernelSourceSelector"),IR=Symbol("ILocalPythonNotebookKernelSourceSelector"),NS=Symbol("IConnectionDisplayData");var ij=class extends TD{constructor(t,n){super();this.controller=t;this.notebook=n}dispose(){this.disposeExistingExecution()}createReferencedObject(t,...n){return this.existingExecutions||(this.existingExecutions=this.controller.createNotebookExecution(this.notebook),this.existingExecutions.start()),this.existingExecutions}destroyReferencedObject(t,n){this.disposeExistingExecution()}disposeExistingExecution(){var t;try{(t=this.existingExecutions)==null||t.end()}catch(n){}this.existingExecutions=void 0}},Zx=class Zx{constructor(e,t,n){this.extensionId=e;this.kernel=t;var o,s;this.executionRefCountedDisposableFactory=n?new ij(n,t.notebook):void 0;let i=((s=(o=Gn.extensions.getExtension(e))==null?void 0:o.packageJSON)==null?void 0:s.displayName)||e;this.notebook=Gn.workspace.notebookDocuments.find(a=>{var l;return a.uri.toString()===((l=t.resourceUri)==null?void 0:l.toString())}),this.controllerDisplayName=ut(t.kernelConnectionMetadata),this.title=Gn.l10n.t("Executing code in {0} from {1}",this.controllerDisplayName,i),this.eventHandler=Gn.window.onDidChangeVisibleNotebookEditors(this.showProgressImpl,this)}dispose(){var e,t;this.eventHandler.dispose(),(e=this.disposable)==null||e.dispose(),(t=this.executionRefCountedDisposableFactory)==null||t.dispose()}show(){var t;let e=(t=this.executionRefCountedDisposableFactory)==null?void 0:t.acquire("");if(this.deferred&&!this.deferred.completed){let n=this.deferred;this.deferred=Re(),n.resolve()}else this.deferred=Re(),this.showProgress().catch(E);return this.disposable=new Gn.Disposable(()=>{var n;e==null||e.dispose(),(n=this.deferred)==null||n.resolve()})}async showProgress(){await tc(1e3),!(!this.deferred||this.deferred.completed||this.displayInProgress)&&(this.shouldDisplayProgress=!0,await Promise.all([this.showProgressImpl(),this.waitUntilCompleted()]),this.shouldDisplayProgress=!1)}async showProgressImpl(){let e=Zx.notificationsPerExtension.get(this.kernel)||new Set;Zx.notificationsPerExtension.set(this.kernel,e),!e.has(this.extensionId)&&(e.add(this.extensionId),!(!this.notebook||!this.shouldDisplayProgress)&&Gn.window.visibleNotebookEditors.some(t=>t.notebook===this.notebook)&&(this.displayInProgress=!0,await Gn.window.withProgress({location:Gn.ProgressLocation.Notification,title:this.title},async()=>this.waitUntilCompleted()),this.displayInProgress=!1))}async waitUntilCompleted(){let e=this.deferred;for(;e&&!e.completed;)await e.promise,e=this.deferred}};Zx.notificationsPerExtension=new WeakMap;var oj=Zx,sj=class extends Error{constructor(){super(Gn.l10n.t("Access to Jupyter Kernel has been revoked")),this.name="vscode.jupyter.apiAccessRevoked"}},aj=class r extends Lr{constructor(t,n,i,o){super();this.extensionId=t;this.kernel=n;this.execution=i;this._onDidChangeStatus=this._register(new Gn.EventEmitter);this._onDidReceiveDisplayUpdate=this._register(new Gn.EventEmitter);this.progress=this._register(new oj(t,n,o)),this._register(kg(n.onDisposed)(()=>this.progress.dispose())),this.language=n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?Ye:n.kernelConnectionMetadata.kernelSpec.language||Ye,this._register(this.kernel.onStatusChanged(()=>this._onDidChangeStatus.fire(this.kernel.status))),this._register(i.onDidReceiveDisplayUpdate(a=>{var c,d;let l=this.kernel.session,u=Wg(a);(u==null?void 0:u.outputType)==="display_data"&&((c=u==null?void 0:u.transient)!=null&&c.display_id)&&l&&rQ(this.extensionId,l,(d=u==null?void 0:u.transient)==null?void 0:d.display_id)&&this._onDidReceiveDisplayUpdate.fire(a)}));let s=this;this._api=Object.freeze({language:this.language,get status(){return s.kernel.status},onDidChangeStatus:s.onDidChangeStatus.bind(this),get onDidReceiveDisplayUpdate(){if(![Je,oB,cD].includes(t))throw new Error(`Proposed API is not supported for extension ${t}`);return s.onDidReceiveDisplayUpdate.bind(this)},executeCode:(a,l)=>this.executeCode(a,l),executeChatCode:(a,l,u)=>this.executeChatCode(a,l,u)})}get status(){return this.kernel.status}get onDidChangeStatus(){return this._onDidChangeStatus.event}get onDidReceiveDisplayUpdate(){return this._onDidReceiveDisplayUpdate.event}static createApiKernel(t,n,i,o){let s=new r(t,n,i,o);return tt.instance.get(ve).push(s),s._api}async checkAccess(){if(this.extensionId===Je)return;if(this.accessAllowed||(this.accessAllowed=this.doCheckAccess(),this._register(oQ(()=>this.accessAllowed=void 0))),!await this.accessAllowed)throw new sj}async doCheckAccess(){let n=(await sQ(this.extensionId)).accessAllowed;return ne("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:this.extensionId,pemUsed:"getKernel",accessAllowed:n}),n}async*executeCode(t,n){await this.checkAccess();for await(let i of this.executeCodeInternal(t,void 0,n))yield i}async*executeChatCode(t,n,i){if(await this.checkAccess(),!["ms-vscode.dscopilot-agent",Je].includes(this.extensionId.toLowerCase()))throw new Error(`Proposed API is not supported for extension ${this.extensionId}`);if(!jt(this.kernel.kernelConnectionMetadata))throw new Error("Chat code execution is only supported for Python kernels");for await(let s of this.executeCodeInternal(t,n,i))yield s}async*executeCodeInternal(t,n={},i){var m;let o=!1,s={executionCount:this.execution.executionCount,requestSentAfter:0,requestAcknowledgedAfter:0,cancelledAfter:0,duration:0},a={kernelId:"",extensionId:this.extensionId,cancelled:!1,requestSent:!1,requestAcknowledged:!1,cancelledBeforeRequestSent:!1,cancelledBeforeRequestAcknowledged:!1,mimeTypes:"",failed:!1},l=new It,u=new Set;if(JSe(this.extensionId,this.kernel,"executeCode",s.executionCount).catch(E),this.kernel.disposed)throw a.failed=!0,nj(this.kernel,s,a).catch(E),new Error("Kernel is disposed");if(!((m=this.kernel.session)!=null&&m.kernel))throw a.failed=!0,nj(this.kernel,s,a).catch(E),this.kernel.status==="dead"||this.kernel.status==="terminating"?new Error("Kernel is dead or terminating"):new Error("Kernel connection not available to execute 3rd party code");let c=[];c.push({dispose:()=>{s.duration=l.elapsedTime,a.mimeTypes=Array.from(u).join(","),o=!0,nj(this.kernel,s,a).catch(E)}});let d=tt.instance.get(qe).getKernelExecution(this.kernel),f={started:new Gn.EventEmitter,executionAcknowledged:new Gn.EventEmitter};f.started.event(()=>{a.requestSent=!0,s.requestSentAfter=l.elapsedTime,!i.isCancellationRequested&&this.extensionId!==Je&&c.push(this.progress.show())},this,c),f.executionAcknowledged.event(()=>{a.requestAcknowledged=!0,s.requestAcknowledgedAfter=l.elapsedTime},this,c),i.onCancellationRequested(()=>{o||(a.cancelled=!0,s.cancelledAfter=l.elapsedTime,a.cancelledBeforeRequestSent=!a.requestSent,a.cancelledBeforeRequestAcknowledged=!a.requestAcknowledged,w.debug(`Code execution cancelled by extension ${this.extensionId}`))},this,c);try{for await(let g of d.executeCode(t,this.extensionId,f,i))if(gR(this.extensionId,this.kernel.session,g),g.items.forEach(b=>u.add(b.mime)),n&&dQ(g))for await(let b of this.handleChatOutput(g,d,f,u,n,i))yield b;else yield g}finally{Ce(c)}}async*handleChatOutput(t,n,i,o,s={},a){let l=t.items.find(y=>y.mime===hR);if(!l)return;let u=(t.metadata||{}).metadata,c=u.function,d=u.id,f=u.dataIsNone?void 0:new TextDecoder().decode(l.data),m=s[c];if(!m)throw new Error(`Chat Function ${c} not found`);let g=await m(f),b=eQ(d,g);for await(let y of n.executeCode(b,this.extensionId,i,a))if(y.items.forEach(P=>o.add(P.mime)),dQ(y))for await(let P of this.handleChatOutput(y,n,i,o,s,a))yield P;else yield y}};function dQ(r){return r.items.some(e=>e.mime===hR)}async function JSe(r,e,t,n){let i=await Rt(e.id);ne("DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",{executionCount:n},{kernelId:i,pemUsed:t,extensionId:r})}async function nj(r,e,t){t.kernelId=await Rt(r.id),ne("DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",e,t)}function _R(r,e){var i;let t=tt.instance.get(qe),n=(i=tt.instance.get(Nt).getSelected(e.notebook))==null?void 0:i.controller;return aj.createApiKernel(r,e,t.getKernelExecution(e),n)}p();p();var RS=se(ge());p();var UYe=Symbol("IReservedPythonNamedProvider"),WYe=Symbol("IInterpreterPackages"),pQ=Symbol("IWorkspaceInterpreterTracker");var Ml=class{constructor(e){this.workspaceInterpreterTracker=e;Ml.isActiveWorkspaceInterpreter=this.isActiveWorkspaceInterpreterImpl.bind(this)}activate(){var e;(e=this.workspaceInterpreterTracker)==null||e.activate()}isActiveWorkspaceInterpreterImpl(e,t){var n,i;return(i=(n=this.workspaceInterpreterTracker)==null?void 0:n.isActiveWorkspaceInterpreter(e,t))!=null?i:!1}};Ml.isActiveWorkspaceInterpreter=()=>!1,Ml=U([(0,RS.injectable)(),x(0,(0,RS.inject)(pQ)),x(0,(0,RS.optional)())],Ml);async function eP(r,e){if(!r)return;let t=Fa(r),[n,i]=JN.get(t)||[{resourceType:Rl(r),resourceHash:r?await Rt(r.toString()):void 0,kernelSessionId:await Rt(Date.now().toString()),capturedEnvVars:void 0,userExecutedCell:void 0,disableUI:void 0,kernelLanguage:void 0,kernelId:void 0,kernelSpecHash:void 0,isUsingActiveInterpreter:void 0,pythonEnvironmentType:void 0,pythonEnvironmentPath:void 0,pythonEnvironmentVersion:void 0,kernelConnectionType:void 0},{previouslySelectedKernelConnectionId:""}];typeof e.capturedEnvVars=="boolean"&&(n.capturedEnvVars=e.capturedEnvVars),e.userExecutedCell&&(n.userExecutedCell=!0),typeof e.disableUI=="boolean"&&(n.disableUI=e.disableUI);let o=e.kernelConnection;if(o){let s=o.id;i.previouslySelectedKernelConnectionId!==s&&(n.userExecutedCell=e.userExecutedCell,n.disableUI=e.disableUI),i.previouslySelectedKernelConnectionId&&i.previouslySelectedKernelConnectionId!==s&&(n.kernelSessionId=await Rt(Date.now().toString()));let a;switch(o.kind){case"connectToLiveRemoteKernel":a=o.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":a=o.kernelSpec.language;break;case"startUsingPythonInterpreter":a=Ye;break;default:break}let l="kernelSpec"in o&&o.kernelSpec.specFile?Rt(o.kernelSpec.specFile):Promise.resolve("");n.kernelLanguage=a,[n.kernelId,n.kernelSpecHash]=await Promise.all([Rt(o.id),l]),i.previouslySelectedKernelConnectionId=o.id;let u=o.interpreter;if(u){n.isUsingActiveInterpreter=Ml.isActiveWorkspaceInterpreter(r,u),n.pythonEnvironmentType=Jr(u);let[c,d]=await Promise.all([Rt(lt(Oc(u.uri))),Tp(u)]);n.pythonEnvironmentPath=c,F2.set(n.pythonEnvironmentPath,u),d?n.pythonEnvironmentVersion=`${d.major}.${d.minor}.${d.micro}`:n.pythonEnvironmentVersion=void 0,U2(n)}n.kernelConnectionType=n.kernelConnectionType||(o==null?void 0:o.kind)}else i.previouslySelectedKernelConnectionId="";JN.set(t,[n,i])}async function Ol(r,e){await eP(r,{kernelConnection:e,userExecutedCell:!0})}var fQ=new WeakMap,$f;function mQ(r,e){let t=fQ.get(r)||_R(e,r);return fQ.set(r,t),t}function hQ(r){return{async getKernel(e){let t,n=tt.instance.get(qe),i=ER.workspace.notebookDocuments.find(s=>s.uri.toString()===e.toString()),o=n.get(i||e);if(!o||!o.startedAtLeastOnce||!o.userStartedKernel){ne("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:r,pemUsed:"getKernel",accessAllowed:t});return}return r!==Je&&Ol(o.resourceUri,o.kernelConnectionMetadata),mQ(o,r)},get onDidStart(){if(![Je,cD].includes(r))throw new Error(`Proposed API is not supported for extension ${r}`);if(!$f){let e=tt.instance.get(qe),t=tt.instance.get(ve);$f=new ER.EventEmitter,t.push(e.onDidPostInitializeKernel(n=>{$f==null||$f.fire({uri:n.uri,kernel:mQ(n,r)})}),$f,{dispose:()=>$f=void 0})}return $f.event}}}p();p();var CR=Symbol("JupyterServerHelper"),h$e=Symbol("INotebookImporter"),AS=Symbol("INotebookExporter"),gQ=Symbol("IJupyterInterpreterDependencyManager"),g$e=Symbol("INbConvertInterpreterDependencyChecker"),v$e=Symbol("INbConvertExportToPythonService"),wR=Symbol("IJupyterServerProvider"),dr=Symbol("IJupyterServerUriStorage"),xR=Symbol("IJupyterKernelService"),PR=Symbol("IJupyterRequestAgentCreator"),jg=Symbol("IJupyterRequestCreator"),y$e=Symbol("INotebookStarter"),Bg=Symbol("ILiveRemoteKernelConnectionUsageTracker"),DR=Symbol("IJupyterRemoteCachedKernelValidator"),sr=Symbol("IJupyterServerProviderRegistry");function TR(r,e,t,n,i){ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"createJupyterServerCollection"});let s=i.get(sr).createJupyterServerCollection(n,r,Gv(e),t);return{dispose:()=>{s==null||s.dispose()},get id(){return r},set label(l){s.label=Gv(l)},get label(){return s.label},set documentation(l){s.documentation=l},get documentation(){return s.documentation},set commandProvider(l){s.commandProvider=l},get commandProvider(){return s.commandProvider}}}p();var vQ=!1;function yQ(r,e){if(vQ)return;vQ=!0,e.get(gy).setApi(r)}p();var Zf=require("vscode");p();var MS=se(ge());p();var tu=se(ge());p();var zf=class extends ot{constructor(t,n){super("remotejupyterserveruriprovider",n.message||n.toString());this.serverProviderHandle=t;this.originalError=n}};p();var Ms=class extends ot{constructor(e){super("jupyterselfcert",e)}static isSelfCertsError(e){return e.message.indexOf("reason: self signed certificate")>=0}};p();var Zc=class extends ot{constructor(e){super("jupyterselfexpiredcert",e)}static isSelfCertsExpiredError(e){return e.message.indexOf("reason: certificate has expired")>=0}};p();var dn=Symbol("IDataScienceErrorHandler"),_i=class extends ot{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}},eu=class extends Ln{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}};p();var oo=class extends ot{constructor(t,n,i){super("remotejupyterserverconnection",W.remoteJupyterConnectionFailedWithServerWithError(bQ(t),i.message||i.toString()));this.url=t;this.serverProviderHandle=n;this.originalError=i;this.baseUrl=bQ(t)}};function bQ(r){let e=new URL(r);return`${e.protocol}//${e.host}/`}var tP=require("vscode");p();var SQ=require("vscode");var Qf=class r extends oc{constructor(t){super();this.serverSettings=t;this._isDisposing=!1;this.kernelSpecManager=new this.jupyterlab.KernelSpecManager({serverSettings:this.serverSettings}),this.kernelManager=new this.jupyterlab.KernelManager({serverSettings:this.serverSettings}),this.sessionManager=new this.jupyterlab.SessionManager({serverSettings:this.serverSettings,kernelManager:this.kernelManager}),this.contentsManager=new this.jupyterlab.ContentsManager({serverSettings:this.serverSettings})}get jupyterlab(){return this._jupyterlab||(this._jupyterlab=ri()),this._jupyterlab}static create(t){return new r(t)}dispose(){this.isDisposed||this._isDisposing||(this._isDisposing=!0,(async()=>{var t,n,i,o;w.trace("Disposing Jupyter Lab Helper");try{this.contentsManager&&(w.trace("SessionManager - dispose contents manager"),this.contentsManager.dispose()),this.sessionManager&&!this.sessionManager.isDisposed&&(w.trace("ShutdownSessionAndConnection - dispose session manager"),await fo(1e4,this.sessionManager.ready),this.sessionManager.dispose()),(t=this.kernelManager)!=null&&t.isDisposed||(n=this.kernelManager)==null||n.dispose(),(i=this.kernelSpecManager)!=null&&i.isDisposed||(o=this.kernelSpecManager)==null||o.dispose()}catch(s){w.error("Exception on Jupyter Lab Helper shutdown: ",s)}finally{w.trace("Finished disposing Jupyter Lab Helper")}})().catch(E).finally(()=>super.dispose()))}async getRunningSessions(){if(!this.sessionManager)return[];await fo(1e4,this.sessionManager.ready).catch(E),await this.sessionManager.refreshRunning();let t=[],n=this.sessionManager.running(),i=n.next().value;for(;i;)t.push(i),i=n.next().value;return t}async getRunningKernels(){let t=await this.jupyterlab.KernelAPI.listRunning(this.serverSettings),n=new Set;return t.map(i=>{let o=i;return{id:i.id,name:i.name,lastActivityTime:o.last_activity?new Date(Date.parse(o.last_activity.toString())):new Date,numberOfConnections:o.connections?parseInt(o.connections.toString(),10):0}}).filter(i=>n.has(i.id)?!1:(n.add(i.id),!0))}async getKernelSpecs(){var t,n,i;if(!this.serverSettings||!this.sessionManager||!this.contentsManager)throw new zr;try{let o=new It,s=this.kernelSpecManager;if(!s)return w.error(`No SessionManager to enumerate kernelspecs (no specs manager). Returning a default kernel. Specs ${JSON.stringify(((n=(t=this.kernelSpecManager)==null?void 0:t.specs)==null?void 0:n.kernelspecs)||{})}.`),ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsManager"}),[await zx()];let a={wasSessionManagerReady:this.sessionManager.isReady,wasSpecsManagerReady:s.isReady,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:s.isReady,waitedForChangeEvent:!1},l=(f={})=>s.specs&&Object.keys(s.specs.kernelspecs).length?s.specs.kernelspecs:f,u=l();await fo(1e4,this.sessionManager.ready),a.sessionManagerReady=this.sessionManager.isReady,await fo(1e4,s.refreshSpecs()),a.specsManagerReady=s.isReady;let c=!1;if(s&&Object.keys(((i=s.specs)==null?void 0:i.kernelspecs)||{}).length===0){let f=[],m=Re(),g=m.resolve.bind(m);s.specsChanged.connect(g),f.push(new SQ.Disposable(()=>s.specsChanged.disconnect(g)));let b=Promise.all([m.promise,s.ready,s.refreshSpecs(),this.sessionManager.ready]);await fo(1e4,b),a.waitedForChangeEvent=!0,m.completed||(c=!0,ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:s.isReady,reason:s.isReady?this.sessionManager.isReady?"SpecsDidNotChangeInTime":"SessionManagerIsNotReady":"SpecManagerIsNotReady"})),Ce(f)}let d=l(u);if(Object.keys(d||{}).length){let f=[];return Object.entries(d).forEach(([m,g])=>{g&&f.push(new xS(g))}),ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",{duration:o.elapsedTime},a),f}else return w.error(`Jupyter Lab Helper cannot enumerate kernelspecs. Returning a default kernel. Specs ${JSON.stringify(d)}.`),c||ne("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsEventAfterRefresh"}),[await zx()]}catch(o){return w.error("Jupyter Lab Helper:getKernelSpecs failure: ",o),[]}}};var pn=class{constructor(e,t,n,i,o){this.jupyterPickerRegistration=e;this.configService=t;this.errorHandler=n;this.requestAgentCreator=i;this.requestCreator=o}async createConnectionInfo(e){let t=await this.getJupyterServerUri(e);if(!t)throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`);let n={baseUrl:t.connectionInformation.baseUrl.toString(!0),displayName:t.label,token:t.connectionInformation.token||"",authorizationHeader:t.connectionInformation.headers||{},fetch:t.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:t.connectionInformation.WebSocket};return YV(e,n,this.requestCreator,this.requestAgentCreator,this.configService,tP.Uri.file(""))}async validateRemoteUri(e,t,n){let i;if(!t){let s=await this.getJupyterServerUri(e);if(s)t={baseUrl:s.connectionInformation.baseUrl.toString(!0),displayName:s.label,token:s.connectionInformation.token||"",authorizationHeader:s.connectionInformation.headers||{},fetch:s.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:s.connectionInformation.WebSocket};else throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`)}let o=YV(e,t,this.requestCreator,this.requestAgentCreator,this.configService,tP.Uri.file(""));try{i=Qf.create(o.settings),await Promise.all([i.getRunningKernels(),i.getKernelSpecs()])}catch(s){if(Ms.isSelfCertsError(s)){if(!await iR(this.configService,s.message))throw s}else if(Zc.isSelfCertsExpiredError(s)){if(!await oR(this.configService,s.message))throw s}else throw t&&!n&&await this.errorHandler.handleError(new oo(t.baseUrl,e,s)),s}finally{o.dispose(),i&&i.dispose()}}async getJupyterServerUri(e){let t=new tP.CancellationTokenSource;try{let n=this.jupyterPickerRegistration.jupyterCollections.find(l=>l.extensionId===e.extensionId&&l.id===e.id)||await this.jupyterPickerRegistration.activateThirdPartyExtensionAndFindCollection(e.extensionId,e.id);if(!n)return;let i=await Promise.resolve(n.serverProvider.provideJupyterServers(t.token)),o=i==null?void 0:i.find(l=>l.id===e.handle);if(!o&&(i==null?void 0:i.length)===0)try{o=await n.serverProvider.resolveJupyterServer({id:e.handle,label:""},t.token)}catch(l){}if(!o)return;if(o.connectionInformation)return o;let s=await Promise.resolve(n.serverProvider.resolveJupyterServer(o,t.token));if(!(s!=null&&s.connectionInformation))return;let a=Object.assign({},o);return a.connectionInformation=s.connectionInformation,a}catch(n){throw n instanceof ot?n:new zf(e,n)}finally{t.dispose()}}};pn=U([(0,tu.injectable)(),x(0,(0,tu.inject)(sr)),x(1,(0,tu.inject)(Ke)),x(2,(0,tu.inject)(dn)),x(3,(0,tu.inject)(PR)),x(3,(0,tu.optional)()),x(4,(0,tu.inject)(jg))],pn);var Ll=class{constructor(e,t,n){this.serverUriStorage=e;this.jupyterConnection=t;this.serverProviderRegistry=n}async addJupyterServer(e){if(e.extensionId.toLowerCase()!=Zl.toLowerCase())throw new Error("Deprecated API");try{await this.jupyterConnection.validateRemoteUri(e)}catch(t){w.error(`Error in validating the Remote Uri ${e.id}.${e.handle}`,t);return}this.serverProviderRegistry.jupyterCollections.some(t=>t.extensionId===e.extensionId)||await this.serverUriStorage.add(e)}};Ll=U([(0,MS.injectable)(),x(0,(0,MS.inject)(dr)),x(1,(0,MS.inject)(pn)),x(2,(0,MS.inject)(sr))],Ll);p();var _Q=se(ge()),ru=require("vscode");p();var Xf=require("vscode");function Yn(r,e=!1){return typeof r!="object"||!r?!1:!!(r instanceof Xf.CancellationError||e&&(r.message.includes("Canceled")||r.message.includes(Ue.canceled)))}async function Os(r,e,...t){let n;return dD(e)?(t.push(e),n=void 0):n=e,r?r.isCancellationRequested?n:new Promise((i,o)=>{if(r.isCancellationRequested)return i(n);let s=r.onCancellationRequested(()=>{s.dispose(),i(n)});Promise.race(t).then(i,o).finally(()=>s.dispose())}):await Promise.race(t)}async function cs(r,...e){if(!r)return Promise.race(e);if(r.isCancellationRequested)throw new Xf.CancellationError;return new Promise((t,n)=>{if(r.isCancellationRequested)return n(new Xf.CancellationError);let i=r.onCancellationRequested(()=>{i.dispose(),n(new Xf.CancellationError)});Promise.race(e).then(t,n).finally(()=>i.dispose())})}function IQ(...r){let e=new Xf.CancellationTokenSource,t=[];for(let i of r)i&&(i.isCancellationRequested&&e.cancel(),i.onCancellationRequested(()=>e.cancel(),void 0,t));let n=e.dispose.bind(e);return e.dispose=()=>{n(),Ce(t)},e}var Kd;(e=>{function r(t){if(t!=null&&t.isCancellationRequested)throw new Xf.CancellationError}e.throwIfCanceled=r})(Kd||(Kd={}));function EQ(r){let e=new Map,t=(a,l)=>{if(!e.has(a)){let u={id:a,label:l.displayName,connectionInformation:{baseUrl:ru.Uri.parse(l.baseUrl),token:l.token,fetch:l.fetch,headers:l.authorizationHeader,WebSocket:l.WebSocket}};e.set(a,{serverUri:l,server:u})}return e.get(a).server},n=new ru.EventEmitter,i={async provideJupyterServers(a){let l=r.getHandles?await cs(a,r.getHandles()):[];return!l||l.length===0?[]:cs(a,Promise.all(l.map(u=>r.getServerUri(u).then(c=>t(u,c)))))},resolveJupyterServer(a,l){return a},onDidChangeServers:n.event};if(!r.handleQuickPick||!r.getQuickPickEntryItems)return{serverProvider:i};let o=new Map;return{serverProvider:i,commandProvider:{async handleCommand(a,l){let u=o.get(a.label);if(!u||!r.handleQuickPick)return;let c=await cs(l,r.handleQuickPick(u,!0));if(c==="back")return;if(!c)throw new ru.CancellationError;let d=await r.getServerUri(c);return t(c,d)},async provideCommands(a,l){return r.getQuickPickEntryItems?(await cs(l,Promise.resolve(r.getQuickPickEntryItems()))).map(c=>{let d={label:Gv(c.label),canBeAutoSelected:c.default,description:Gv(c.description)};return o.set(d.label,c),d}):[]}}}}var lj=class extends oc{constructor(t,n,i,o){super();this.extensionId=t;this.id=n;this.label=i;this.serverProvider=o;this._onDidChangeProvider=new ru.EventEmitter;this.onDidChangeProvider=this._onDidChangeProvider.event}set commandProvider(t){this._commandProvider=t,this._onDidChangeProvider.fire()}get commandProvider(){return this._commandProvider}},OS=class extends Lr{constructor(){super();this._onDidChangeCollections=new ru.EventEmitter;this._collections=new Map;tt.instance.get(ve).push(this)}get onDidChangeCollections(){return this._onDidChangeCollections.event}get jupyterCollections(){return Array.from(this._collections.values())}async activateThirdPartyExtensionAndFindCollection(t,n){return await this.loadExtension(t,n).catch(E),this.jupyterCollections.find(i=>i.extensionId===t&&i.id===n)}async loadExtension(t,n){if(t===Je)return;let i=ru.extensions.getExtension(t);if(!i)throw new Error(`Extension '${t}' that provides Jupyter Server '${n}' not found`);i.isActive||await i.activate().then(E,E)}createJupyterServerCollection(t,n,i,o){let s=`${t}#${n}`;if(this._collections.has(s)&&t!==Je)throw new Error(`Jupyter Server Provider with id ${s} already exists`);let a=new lj(t,n,i,o);return this._collections.set(s,a),this._onDidChangeCollections.fire({added:[a],removed:[]}),this._register(a.onDidDispose(()=>{this._collections.delete(s),this._onDidChangeCollections.fire({removed:[a],added:[]})},this)),a}};OS=U([(0,_Q.injectable)()],OS);p();var kR=Symbol("IExportedKernelServiceFactory");function GSe(r,e){return new Promise(t=>{e.onDidChange(n=>{for(let i of n.added)Wt(i.connection)&&i.connection.serverProviderHandle.id===r.id&&i.connection.serverProviderHandle.handle===r.handle&&t()})})}function CQ(r,e){let t=e.get(Ba),n=r.id.startsWith("_builtin")?Je:t.determineExtensionFromCallStack().extensionId;if(w.error(`The API registerRemoteServerProvider has being deprecated and will be removed soon, please use createJupyterServerCollection (extension ${n}).`),n.toLowerCase()!=Zl.toLowerCase())throw new Error("Deprecated API");ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"registerRemoteServerProvider"});let{serverProvider:i,commandProvider:o}=EQ(r),s=TR(r.id,r.displayName||r.detail||r.id,i,n,e);return o&&(s.commandProvider=o),{dispose:()=>{s.dispose()}}}function wQ(r){return r.then(()=>void 0).catch(e=>(w.error("Failure during activation.",e),Promise.reject(e)))}function xQ(r){let e=r.get(Ba);return ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:e.determineExtensionFromCallStack().extensionId,pemUsed:"registerRemoteServerProvider"}),r.get(kR).getService()}async function PQ(r,e,t){let n=t.get(Ba);w.error("The API addRemoteJupyterServer has being deprecated and will be removed soon, please use createJupyterServerCollection.");let i=n.determineExtensionFromCallStack().extensionId;if(i.toLowerCase()!=Zl.toLowerCase())throw new Error("Deprecated API");ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:i,pemUsed:"addRemoteJupyterServer"});let o=t.get(Ll),s=t.get(Nt),a=GSe({id:r,handle:e},s);await o.addJupyterServer({id:r,handle:e,extensionId:i}),await a}async function DQ(r,e,t){var u,c,d,f,m,g;let n=t.get(Ba);ne("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n.determineExtensionFromCallStack().extensionId,pemUsed:"openNotebook"});let i=t.get(Nt),o=typeof e=="string"?e:void 0,s=typeof e=="string"?void 0:e,a=o&&((u=i.all.find(b=>b.id===e))==null?void 0:u.id);if(!a&&s&&!rc()&&(a=(c=i.all.find(b=>b.kind==="startUsingPythonInterpreter"&&b.interpreter.id===s.id))==null?void 0:c.id,!a)){let y=await t.get(IR).getKernelConnection(s);a=y&&((d=i.all.find(P=>P.id===(y==null?void 0:y.id)))==null?void 0:d.id)}if(!a)throw new Error(`Kernel ${e} not found.`);let l=((g=(m=(f=Zf.window.activeNotebookEditor)==null?void 0:f.notebook)==null?void 0:m.uri)==null?void 0:g.toString())===r.toString()?Zf.window.activeNotebookEditor:await Zf.window.showNotebookDocument(await Zf.workspace.openNotebookDocument(r));return await Zf.commands.executeCommand("notebook.selectKernel",{notebookEditor:l,id:a,extension:Je}),l.notebook}function TQ(r,e,t,n){let i=t.get(Ba),o={ready:wQ(r),registerPythonApi:s=>yQ(s,t),registerRemoteServerProvider:s=>CQ(s,t),getKernelService:()=>xQ(t),addRemoteJupyterServer:(s,a)=>PQ(s,a,t),openNotebook:async(s,a)=>DQ(s,a,t),createJupyterServerCollection:(s,a,l)=>TR(s,a,l,i.determineExtensionFromCallStack().extensionId,t),get kernels(){return hQ(i.determineExtensionFromCallStack().extensionId)}};return(mn()||n.extensionMode===cj.ExtensionMode.Development||n.extensionMode===cj.ExtensionMode.Test)&&(o.serviceContainer=t,o.serviceManager=e),o}p();var kQ=require("vscode"),NQ={codeLoadingTime:0,endActivateTime:0,startActivateTime:0,totalActivateTime:0,workspaceFolderCount:0};function RQ(r,e){if(!mn())try{r.endActivateTime=e.elapsedTime,r.totalActivateTime=e.elapsedTime,Object.assign(NQ,r),MQ(r),ne("EXTENSION.LOAD",r)}catch(t){w.error("sendStartupTelemetry() failed.",t)}}function AQ(r,e,t){try{let n={};e.endActivateTime=t.elapsedTime,e.totalActivateTime=t.elapsedTime,Object.assign(NQ,e),MQ(e),ne("EXTENSION.LOAD",e,n,r)}catch(n){w.error("sendErrorTelemetry() failed.",n)}}function MQ(r){var t,n;let e=(n=(t=kQ.workspace.workspaceFolders)==null?void 0:t.length)!=null?n:0;r.workspaceFolderCount=e}p();p();var NR=Symbol("IWorkspaceService"),so=Symbol("IDebugManager"),LS=Symbol("IApplicationEnvironment"),CQe=Symbol("IWebviewPanelMessageListener"),wQe=Symbol("IWebviewViewMessageListener"),xQe=Symbol("IWebview"),PQe=Symbol("IWebviewView"),DQe=Symbol("IWebviewPanel"),KS=Symbol("IWebviewPanelProvider"),RR=Symbol("IWebviewViewProvider"),rP=Symbol("IEncryptedStorage");p();var OQ=se(ge());p();var Ei=require("vscode");p();var Fd=require("vscode");var Hg=class Hg{constructor(e){this.jupyterConfig=e}async migrateSettings(){let e=[];for(let t of Object.keys(Hg.migratedSettings))e.push(...this.migrateSetting(t,Hg.migratedSettings[t]));e.push(this.migrateIntellisenseSettings());try{await Promise.all(e)}catch(t){FS(t)}}async migrateIntellisenseSettings(){let e="pythonCompletionTriggerCharacters",t="completionTriggerCharacters",n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t);try{if((n==null?void 0:n.globalValue)===(n==null?void 0:n.defaultValue)||!i||i!=null&&i.globalValue&&i.globalValue[Ye])return;if(typeof(n==null?void 0:n.globalValue)=="string"){let o=i.globalValue||i.defaultValue||{};o[Ye]=n.globalValue.split(""),await this.jupyterConfig.update(t,o,Fd.ConfigurationTarget.Global).then(E,FS)}}finally{n!=null&&n.globalValue&&await this.jupyterConfig.update(e,void 0,Fd.ConfigurationTarget.Global).then(E,FS)}}migrateSetting(e,t){let n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t),o=[];if((n==null?void 0:n.workspaceValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceValue,Fd.ConfigurationTarget.Workspace)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Fd.ConfigurationTarget.Workspace),FS))}if((n==null?void 0:n.workspaceFolderValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceFolderValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceFolderValue,Fd.ConfigurationTarget.WorkspaceFolder)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Fd.ConfigurationTarget.WorkspaceFolder),FS))}if((n==null?void 0:n.globalValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.globalValue)===void 0&&(s=this.jupyterConfig.update(t,n.globalValue,Fd.ConfigurationTarget.Global)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,Fd.ConfigurationTarget.Global),FS))}return o}};Hg.migratedSettings={interactiveWindowMode:"interactiveWindow.creationMode",interactiveWindowViewColumn:"interactiveWindow.viewColumn",splitRunFileIntoCells:"interactiveWindow.splitRunFileIntoCells",interactiveReplNotebook:"interactiveWindow.notebookRepl",sendSelectionToInteractiveWindow:"interactiveWindow.textEditor.executeSelection",normalizeSelectionForInteractiveWindow:"interactiveWindow.textEditor.normalizeSelection",magicCommandsAsComments:"interactiveWindow.textEditor.magicCommandsAsComments",enableAutoMoveToNextCell:"interactiveWindow.textEditor.autoMoveToNextCell",newCellOnRunLast:"interactiveWindow.textEditor.autoAddNewCell",pythonCellFolding:"interactiveWindow.textEditor.cellFolding",enableCellCodeLens:"interactiveWindow.codeLens.enable",addGotoCodeLenses:"interactiveWindow.codeLens.enableGotoCell",codeLenses:"interactiveWindow.codeLens.commands",debugCodeLenses:"interactiveWindow.codeLens.debugCommands","interactiveWindow.codeLes.debugCommands":"interactiveWindow.codeLens.debugCommands",codeRegularExpression:"interactiveWindow.cellMarker.codeRegex",markdownRegularExpression:"interactiveWindow.cellMarker.markdownRegex",decorateCells:"interactiveWindow.cellMarker.decorateCells",defaultCellMarker:"interactiveWindow.cellMarker.default",enableExtendedKernelCompletions:"enableExtendedPythonKernelCompletions"},Hg.fullSettingIds={...Hg.migratedSettings};var nP=Hg;function FS(r){w.warn("Error migrating Jupyter configuration",r)}p();function YSe(r){return(e,t,n)=>{let i=null,o=null;if(typeof n.value=="function"?(i="value",o=n.value):typeof n.get=="function"&&(i="get",o=n.get),!o)throw new Error("not supported");n[i]=r(o,t)}}function AR(r,e,t){return YSe((n,i)=>{let o=`$debounce$${i}`,s=`$debounce$result$${i}`;return function(...a){this[s]||(this[s]=t?t():void 0),clearTimeout(this[o]),e&&(this[s]=e(this[s],...a),a=[this[s]]),this[o]=setTimeout(()=>{n.apply(this,a),this[s]=t?t():void 0},r)}})}var Pa=class Pa{constructor(e,t,n){this._systemVariablesCtor=t;this._type=n;this.allowUnauthorizedRemoteConnection=!1;this.jupyterInterruptTimeout=1e4;this.jupyterLaunchTimeout=6e4;this.jupyterLaunchRetries=3;this.notebookFileRoot="";this.useDefaultConfigForJupyter=!1;this.sendSelectionToInteractiveWindow=!1;this.normalizeSelectionForInteractiveWindow=!0;this.splitRunFileIntoCells=!0;this.markdownRegularExpression="";this.codeRegularExpression="";this.errorBackgroundColor="";this.variableExplorerExclude="";this.decorateCells="currentCell";this.enableCellCodeLens=!1;this.askForLargeDataFrames=!1;this.enableAutoMoveToNextCell=!1;this.askForKernelRestart=!1;this.codeLenses="";this.debugCodeLenses="";this.debugpyDistPath="";this.stopOnFirstLineWhileDebugging=!1;this.magicCommandsAsComments=!1;this.pythonExportMethod="direct";this.stopOnError=!1;this.addGotoCodeLenses=!1;this.runStartupCommands=[];this.debugJustMyCode=!1;this.defaultCellMarker="";this.themeMatplotlibPlots=!1;this.disableJupyterAutoStart=!1;this.enablePythonKernelLogging=!1;this.jupyterCommandLineArguments=[];this.widgetScriptSources=[];this.interactiveWindowMode="multiple";this.pythonCellFolding=!0;this.interactiveWindowViewColumn="secondGroup";this.disableZMQSupport=!1;this.forceIPyKernelDebugger=!1;this.verboseLogging=!1;this.showVariableViewWhenDebugging=!0;this.newCellOnRunLast=!0;this.logKernelOutputSeparately=!1;this.development=!1;this.poetryPath="";this.excludeUserSitePackages=!1;this.enableExtendedPythonKernelCompletions=!1;this.formatStackTraces=!1;this.interactiveReplNotebook=!1;this._changeEmitter=new Ei.EventEmitter;this._disposables=[];this._workspaceRoot=e,this.initialize(),Ei.workspace.isTrusted===!1&&(this.disableJupyterAutoStart=!0)}get onDidChange(){return this._changeEmitter.event}static getInstance(e,t,n){let i=Pa.getSettingsUriAndTarget(e).uri,o=i?i.path:"",s=Pa.jupyterSettings.get(o);return s?s._type==="web"&&n==="node"&&(s._systemVariablesCtor=t,s._type=n):(s=new Pa(i,t,n),Pa.jupyterSettings.set(o,s)),s}static getSettingsUriAndTarget(e){let t=e?Ei.workspace.getWorkspaceFolder(e):void 0,n=t?t.uri:void 0;!n&&Array.isArray(Ei.workspace.workspaceFolders)&&Ei.workspace.workspaceFolders.length>0&&(n=Ei.workspace.workspaceFolders[0].uri);let i=n?Ei.ConfigurationTarget.WorkspaceFolder:Ei.ConfigurationTarget.Global;return{uri:n,target:i}}static dispose(){if(!mn())throw new Error("Dispose can only be called from unit tests");Pa.jupyterSettings.forEach(e=>e&&e.dispose()),Pa.jupyterSettings.clear()}dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}createSystemVariables(e){return new this._systemVariablesCtor(e,this._workspaceRoot)}toJSON(){let e={};return this.getSerializableKeys().forEach(n=>e[n]=this[n]),e}update(e,t){let n=this.createSystemVariables(void 0),i=n.resolveAny(e.get("experiments"));this.experiments?Object.assign(this.experiments,i):this.experiments=i,this.experiments=this.experiments?this.experiments:{enabled:!0,optInto:[],optOutFrom:[]};let o=(a,l)=>{let u=nP.fullSettingIds[a],c=u&&l.get(u)!==void 0?l.get(u):l.get(a),d=n.resolveAny(c);d!==void 0&&(this[a]=d)};this.getSerializableKeys().filter(a=>a!=="experiments"&&a!=="logging"&&a!=="kernelPickerType").forEach(a=>o(a,e)),t&&o("poetryPath",t)}onWorkspaceFoldersChanged(){let e=(Ei.workspace.workspaceFolders||[]).map(i=>i.uri.path),n=Array.from(Pa.jupyterSettings.keys()).filter(i=>e.indexOf(i)<0);if(n.length>0)for(let i of n)Pa.jupyterSettings.delete(i)}initialize(){let e=()=>{let i=Ei.workspace.getConfiguration("jupyter",this._workspaceRoot),o=Ei.workspace.getConfiguration("python",this._workspaceRoot);this.update(i,o),this.debounceChangeNotification()};this._disposables.push(Ei.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this)),this._disposables.push(Ei.workspace.onDidChangeConfiguration(i=>{i.affectsConfiguration("jupyter")&&e(),i.affectsConfiguration("python.poetryPath")&&e()}));let t=Ei.workspace.getConfiguration("jupyter",this._workspaceRoot),n=Ei.workspace.getConfiguration("python",this._workspaceRoot);t&&(this.update(t,n),this.migrateSettings(t).catch(E))}async migrateSettings(e){await new nP(e).migrateSettings()}debounceChangeNotification(){this._changeEmitter.fire()}fireChangeNotification(){this._changeEmitter.fire()}getSerializableKeys(){return Object.getOwnPropertyNames(this).filter(e=>!e.startsWith("_"))}};Pa.jupyterSettings=new Map,U([AR(1)],Pa.prototype,"debounceChangeNotification",1);var US=Pa;p();var nu=require("vscode");p();p();var uj={number:"number",string:"string",undefined:"undefined",object:"object",function:"function"};function dj(r){return Array.isArray?Array.isArray(r):!!(r&&typeof r.length===uj.number&&r.constructor===Array)}function MR(r){return typeof r===uj.string||r instanceof String}function pj(r){return typeof r===uj.object&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}var OR=class{resolve(e){return MR(e)?this.__resolveString(e):dj(e)?this.__resolveArray(e):pj(e)?this.__resolveLiteral(e):e}resolveAny(e){return MR(e)?this.__resolveString(e):dj(e)?this.__resolveAnyArray(e):pj(e)?this.__resolveAnyLiteral(e):e}__resolveString(e){let t=/\$\{(.*?)\}/g;return e.replace(t,(n,i)=>{let o=this[i];return MR(o)?o:n&&(n.indexOf("env.")>0||n.indexOf("env:")>0)?"":n})}__resolveLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolve(i)}),t}__resolveAnyLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolveAny(i)}),t}__resolveArray(e){return e.map(t=>this.__resolveString(t))}__resolveAnyArray(e){return e.map(t=>this.resolveAny(t))}};var LR=class extends OR{constructor(t,n){super();let i=t?nu.workspace.getWorkspaceFolder(t):void 0;this._workspaceFolder=i?i.uri.path:n||"",this._filePath=t?t.path:void 0,nu.window.activeTextEditor&&(this._lineNumber=nu.window.activeTextEditor.selection.anchor.line+1,this._selectedText=nu.window.activeTextEditor.document.getText(new nu.Range(nu.window.activeTextEditor.selection.start,nu.window.activeTextEditor.selection.end)))}get cwd(){return this.workspaceFolder}get workspaceRoot(){return this._workspaceFolder}get workspaceFolder(){return this._workspaceFolder}get file(){return this._filePath}get lineNumber(){return this._lineNumber}get selectedText(){return this._selectedText}};p();var iu=require("vscode");var KR=class{async updateSectionSetting(e,t,n,i,o){let a={uri:i,target:o||iu.ConfigurationTarget.WorkspaceFolder};e==="jupyter"&&o!==iu.ConfigurationTarget.Global&&(a=US.getSettingsUriAndTarget(i));let l=iu.workspace.getConfiguration(e,a.uri),u=l.inspect(t);u!==void 0&&(o===iu.ConfigurationTarget.Global&&u.globalValue===n||o===iu.ConfigurationTarget.Workspace&&u.workspaceValue===n||o===iu.ConfigurationTarget.WorkspaceFolder&&u.workspaceFolderValue===n)||(await l.update(t,n,o),o&&await this.verifySetting(l,o,t,n))}async updateSetting(e,t,n,i){return this.updateSectionSetting("jupyter",e,t,n,i)}async verifySetting(e,t,n,i){if(mn()&&!WE()){let o=0;do{let s=e.inspect(n);if(!s&&i===void 0||s&&i!==void 0&&(t===iu.ConfigurationTarget.Global?s.globalValue:t===iu.ConfigurationTarget.Workspace?s.workspaceValue:s.workspaceFolderValue)===i)break;await new Promise(a=>setTimeout(a,250)),o+=1}while(o<20)}}};var WS=class extends KR{getSettings(e){return US.getInstance(e,LR,"web")}};WS=U([(0,OQ.injectable)()],WS);p();function LQ(r){r.addSingleton(gy,pS),r.addSingleton(vo,Of)}p();p();var nm=se(ge()),eX=require("vscode"),iP=se(ZQ());p();var $R=class{setSharedProperty(e,t){Qb(e,t)}postEvent(e,t){let n={};t.forEach((i,o)=>{n[o]=i}),ne(e,void 0,n)}};p();var Dj=se(require("vscode")),zR=se(ge());var HS=class{constructor(e){this.extensionContext=e}get extensionVersion(){return this.extensionContext.extension.packageJSON.version}};HS=U([(0,zR.injectable)(),x(0,(0,zR.inject)(st))],HS);function Ud(){return Dj.env.appName.indexOf("Insider")>0||Dj.env.appName.indexOf("Code - OSS Dev")>=0?"insiders":"stable"}var vIe="VSCode.ABExp.FeatureData",Tj="vscode",qS=class{constructor(e,t,n){this.configurationService=e;this.appEnvironment=t;this.globalState=n;this._optInto=[];this._optOutFrom=[];this.settings=e.getSettings(void 0);let i=this.settings.experiments.optInto,o=this.settings.experiments.optOutFrom;if(this._optInto=i.filter(l=>!l.endsWith("control")),this._optOutFrom=o.filter(l=>!l.endsWith("control")),!this.enabled)return;let s;Ud()==="insiders"?s=iP.TargetPopulation.Insiders:s=iP.TargetPopulation.Public;let a=new $R;this.experimentationService=(0,iP.getExperimentationService)(Je,this.appEnvironment.extensionVersion,s,a,this.globalState)}get enabled(){return this.settings.experiments.enabled&&!this.settings.experiments.optOutFrom.includes("All")}async activate(){this.experimentationService&&this.enabled&&(await this.experimentationService.initializePromise,this.getFeatures().length===0&&await this.experimentationService.initialFetch,this.logExperiments())}inExperiment(e){return!this.experimentationService||!this.enabled||this._optOutFrom.includes(e.toString())?!1:this._optInto.includes(e.toString())||this._optInto.includes("All")?(this.experimentationService.getTreatmentVariable(Tj,e),!0):e==="DoNotWaitForZmqPortsToBeUsed"&&(Ud()==="insiders"||Fv())||e==="DataViewerContribution"&&(Ud()==="insiders"||Fv())?!0:this.experimentationService.getTreatmentVariable(Tj,e)===!0}async getExperimentValue(e){if(!(!this.experimentationService||!this.enabled||this._optOutFrom.includes(e)))return this.experimentationService.getTreatmentVariable(Tj,e)}getFeatures(){return this.globalState.get(vIe,{features:[]}).features}logExperiments(){let e=eX.workspace.getConfiguration("telemetry"),t=!1;if(e&&e.get("enableTelemetry")===!1&&(w.info("Telemetry is disabled"),t=!0),e&&e.get("telemetryLevel")==="off"&&(w.info("Telemetry level is off"),t=!0),t&&w.info("Experiments are disabled, only manually opted experiments are active."),this._optOutFrom.includes("All"))return;if(this._optInto.includes("All")){w.info(kp.inGroup("All"));return}let n=new Set(this._optInto),i=new Set;this._optOutFrom.filter(o=>o!=="All").forEach(o=>{w.info(kp.notInGroup(o))}),this._optInto.filter(o=>o!=="All").forEach(o=>{i.add(o),w.info(kp.inGroup(o))}),t&&!i.has("DoNotWaitForZmqPortsToBeUsed")&&(Ud()==="insiders"||Fv())&&w.info(kp.inGroup("DoNotWaitForZmqPortsToBeUsed")),t||this.getFeatures().forEach(o=>{o.toLowerCase().startsWith("jupyter")&&!this._optOutFrom.includes(o)&&!this._optInto.includes(o)&&(n.add(o),w.info(kp.inGroup(o)))})}};qS=U([(0,nm.injectable)(),x(0,(0,nm.inject)(Ke)),x(1,(0,nm.inject)(LS)),x(2,(0,nm.inject)(_t)),x(2,(0,nm.named)(rr))],qS);p();var XR=se(ge()),Ls=require("vscode");p();var QR=require("vscode");function JS(r){QR.env.openExternal(typeof r=="string"?QR.Uri.parse(r):r).then(E,E)}var yIe=[{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE",message:cy.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/309",setting:{setting:"formatting.formatOnSave",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE",message:cy.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/313",setting:{setting:"linting.lintOnTextChange",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES",message:cy.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/1704",setting:{setting:"autoComplete.preloadModules"}}],GS=class{constructor(e){this.persistentStateFactory=e;this._onDidChangeFeatures=new Ls.EventEmitter;this.onDidChangeFeatures=this._onDidChangeFeatures.event;this._features={};this.disposables=[];this._updateFeatures(),this.disposables.push(Ls.workspace.onDidChangeConfiguration(()=>{this._updateFeatures()}))}get features(){return this._features}set features(e){this._features=e,this._onDidChangeFeatures.fire()}_updateFeatures(){this.features={}}dispose(){this.disposables.forEach(e=>e.dispose())}initialize(){yIe.forEach(this.registerDeprecation.bind(this))}registerDeprecation(e){Array.isArray(e.commands)&&e.commands.forEach(t=>{this.disposables.push(Ls.commands.registerCommand(t,()=>this.notifyDeprecation(e),this))}),e.setting&&this.checkAndNotifyDeprecatedSetting(e)}async notifyDeprecation(e){let t=this.persistentStateFactory.createGlobalPersistentState(e.doNotDisplayPromptStateKey,!0);if(!t.value)return;let n="Learn more",i="Never show again",o=await Ls.window.showInformationMessage(e.message,n,i);if(o)switch(o){case n:{JS(e.moreInfoUrl);break}case i:{await t.updateValue(!1);break}default:throw new Error("Selected option not supported.")}}checkAndNotifyDeprecatedSetting(e){let t=!1;Array.isArray(Ls.workspace.workspaceFolders)&&Ls.workspace.workspaceFolders.length>0?Ls.workspace.workspaceFolders.forEach(n=>{t||(t=this.isDeprecatedSettingAndValueUsed(Ls.workspace.getConfiguration("jupyter",n.uri),e.setting))}):t=this.isDeprecatedSettingAndValueUsed(Ls.workspace.getConfiguration("jupyter"),e.setting),t&&this.notifyDeprecation(e).catch(n=>w.debug("Jupyter Extension: notifyDeprecation",n))}isDeprecatedSettingAndValueUsed(e,t){if(!e.has(t.setting))return!1;let n=e.get(t.setting);return!Array.isArray(t.values)||t.values.length===0?Array.isArray(n)?n.length>0:!0:!Array.isArray(t.values)||t.values.length===0?n===void 0?!1:Array.isArray(n)?n.length>0:!0:t.values.indexOf(e.get(t.setting))>=0}};GS=U([(0,XR.injectable)(),x(0,(0,XR.inject)(hT))],GS);p();var im=se(ge());var ZR=class{constructor(e,t,n,i){this.storage=e;this.key=t;this.defaultValue=n;this.expiryDurationMs=i}get value(){if(this.expiryDurationMs){let e=this.storage.get(this.key,{data:this.defaultValue});return!e||!e.expiry||e.expiry<Date.now()?this.defaultValue:e.data}else return this.storage.get(this.key,this.defaultValue)}async updateValue(e){this.expiryDurationMs?await this.storage.update(this.key,{data:e,expiry:Date.now()+this.expiryDurationMs}):await this.storage.update(this.key,e)}},YS=class{constructor(e,t){this.globalState=e;this.workspaceState=t}createGlobalPersistentState(e,t,n){return new ZR(this.globalState,e,t,n)}createWorkspacePersistentState(e,t,n){return new ZR(this.workspaceState,e,t,n)}};YS=U([(0,im.injectable)(),x(0,(0,im.inject)(_t)),x(0,(0,im.named)(rr)),x(1,(0,im.inject)(_t)),x(1,(0,im.named)(Is))],YS);p();p();var tX=se(ge());var $S=class{constructor(){this.osType="Unknown"}get tempDir(){}get homeDir(){}get pathVariableName(){return""}get isWindows(){return this.osType==="Windows"}get isMac(){return this.osType==="OSX"}get isLinux(){return this.osType==="Linux"}};$S=U([(0,tX.injectable)()],$S);p();var us=Symbol("IPlatformService"),Pt=Symbol("IFileSystem");function rX(r){r.addSingleton(us,$S)}p();var nX=se(ge()),kj=require("vscode");var zS=class{determineExtensionFromCallStack(e){if(e=e||new Error().stack,e){let t=kj.extensions.getExtension(Je).extensionUri.toString().toLowerCase(),n=e.split(`
`).map(i=>{let o=/\((.*)\)/.exec(i);if(o)return o[1]}).filter(i=>i&&i.toLowerCase().startsWith("http")).filter(i=>i&&!i.toLowerCase().startsWith(t));uK(new Error("Ex")).forEach(i=>{let o=i.getFileName();o&&!o.toLowerCase().startsWith(t)&&n.push(o)});for(let i of n){let o=kj.extensions.all.find(s=>s.id!==Je&&i.startsWith(s.extensionUri.toString()));if(o)return{extensionId:o.id,displayName:o.packageJSON.displayName}}w.error("Unable to determine the caller of the extension API for trace stack.",e)}return{extensionId:uD,displayName:W.unknownPackage}}};zS=U([(0,nX.injectable)()],zS);p();var eA=se(ge()),Nj=require("vscode");var QS=class{constructor(e){this.extensionContext=e;this.testingState=new Map}async store(e,t,n){if(di&&this.extensionContext.extensionMode!==Nj.ExtensionMode.Production){this.testingState.set(`${e}#${t}`,n||"");return}if(n)await this.extensionContext.secrets.store(`${e}.${t}`,n);else try{await this.extensionContext.secrets.delete(`${e}.${t}`)}catch(i){w.error(i)}}async retrieve(e,t){if(di&&this.extensionContext.extensionMode!==Nj.ExtensionMode.Production)return this.testingState.get(`${e}#${t}`);try{return await this.extensionContext.secrets.get(`${e}.${t}`)}catch(n){try{await this.extensionContext.secrets.delete(`${e}.${t}`);return}catch(i){w.error(i)}}}};QS=U([(0,eA.injectable)(),x(0,(0,eA.inject)(st))],QS);p();var iX=se(ge());var XS=class{constructor(){this._list=[]}async dispose(){let e=this._list.map(t=>t.dispose());await Promise.all(e),this._list=[]}push(e){e&&this._list.push(e)}get list(){return this._list}};XS=U([(0,iX.injectable)()],XS);p();var oX=se(ge()),su=require("vscode");var om=class om extends Error{};om.back=new om("back"),om.cancel=new om("cancel"),om.resume=new om("resume");var ze=om,oP=class{constructor(){this.steps=[]}run(e,t){return this.stepThrough(e,t)}async showQuickPick(e){return this.showLazyLoadQuickPick(e).selection}showLazyLoadQuickPick({title:e,step:t,totalSteps:n,items:i,activeItem:o,placeholder:s,buttons:a,shouldResume:l,matchOnDescription:u,matchOnDetail:c,acceptFilterBoxTextAsSelection:d,startBusy:f,stopBusy:m,validate:g,onDidTriggerItemButton:b,onDidTriggerButton:y,supportBackInFirstStep:P,onDidChangeItems:A,ignoreFocusOut:D}){let T=[],K=Re(),L=su.window.createQuickPick();return L.title=e,L.step=t,L.totalSteps=n,L.placeholder=s,L.ignoreFocusOut=D!=null?D:!0,L.items=i,m&&(L.busy=f!=null?f:!1,m(()=>{L.enabled&&(L.busy=!1)},this,T)),A&&(L.keepScrollPosition=!0,A(B=>{L.items=B},this,T)),b&&L.onDidTriggerItemButton(B=>b(B),void 0,T),L.matchOnDescription=u||!1,L.matchOnDetail=c||!1,o?L.activeItems=[o]:L.activeItems=[],L.buttons=[...this.steps.length>1||P?[su.QuickInputButtons.Back]:[],...a||[]],T.push(L.onDidTriggerButton(B=>{B===su.QuickInputButtons.Back?K.reject(ze.back):y?y(B):K.resolve(B)}),L.onDidChangeSelection(async B=>{let N=B.length?B[0].label:"",O=!!N;if(N&&g&&B.length){L.enabled=!1,L.busy=!0;let h=await g(B[0]);h&&(O=!1,await su.window.showErrorMessage(h,{modal:!0})),L.enabled=!0,L.busy=!1}O&&K.resolve(B[0])}),L.onDidHide(()=>{(async()=>{K.reject(l&&await l()?ze.resume:ze.cancel)})().catch(K.reject)})),d&&T.push(L.onDidAccept(async()=>{if(!L.busy){let B=g?await g(L):void 0;B?(L.enabled=!1,L.busy=!0,await su.window.showErrorMessage(B),L.enabled=!0,L.busy=!1):K.resolve(L.value)}})),this.current&&this.current.dispose(),this.current=L,this.current.show(),K.promise.finally(()=>Ce(T)).catch(E),{quickPick:L,selection:K.promise}}async showInputBox({title:e,step:t,totalSteps:n,value:i,prompt:o,validate:s,password:a,buttons:l,shouldResume:u,validationMessage:c}){let d=[];try{return await new Promise((f,m)=>{let g=su.window.createInputBox();g.title=e,g.step=t,g.totalSteps=n,g.password=!!a,g.value=i||"",g.prompt=o,g.validationMessage=c||"",g.ignoreFocusOut=!0,g.validationMessage=c||"",g.buttons=[...this.steps.length>1?[su.QuickInputButtons.Back]:[],...l||[]],d.push(g.onDidTriggerButton(b=>{b===su.QuickInputButtons.Back?m(ze.back):f(b)}),g.onDidAccept(async()=>{let b=g.value;g.enabled=!1,g.busy=!0;let y=await s(b);y?(g.validationMessage=y,g.show()):(g.validationMessage="",f(b)),g.enabled=!0,g.busy=!1}),g.onDidChangeValue(async()=>{g.validationMessage=""}),g.onDidHide(()=>{(async()=>{g.busy||m(u&&await u()?ze.resume:ze.cancel)})().catch(m)})),this.current&&this.current.dispose(),this.current=g,this.current.show()})}finally{d.forEach(f=>f.dispose())}}async stepThrough(e,t){let n=e;for(;n;){this.steps.push(n),this.current&&(this.current.enabled=!1,this.current.busy=!0);try{n=await n(this,t)}catch(i){if(i===ze.back)this.steps.pop(),n=this.steps.pop();else if(i===ze.resume)n=this.steps.pop();else if(i===ze.cancel)n=void 0;else throw i;if(!n)return i}}this.current&&this.current.dispose()}},sX=Symbol("IMultiStepInputFactory"),ZS=class{create(){return new oP}};ZS=U([(0,oX.injectable)()],ZS);p();var aX=se(ge()),Ao=require("vscode");var Wd=class{get activeDebugConsole(){return Ao.debug.activeDebugConsole}get activeDebugSession(){var e;return w.ci(`Getting active debug session, ${(e=Ao.debug.activeDebugSession)==null?void 0:e.name}`),Ao.debug.activeDebugSession}get breakpoints(){return Ao.debug.breakpoints}get onDidChangeActiveDebugSession(){return Ao.debug.onDidChangeActiveDebugSession}get onDidStartDebugSession(){return Ao.debug.onDidStartDebugSession}get onDidReceiveDebugSessionCustomEvent(){return Ao.debug.onDidReceiveDebugSessionCustomEvent}get onDidTerminateDebugSession(){return Ao.debug.onDidTerminateDebugSession}get onDidChangeBreakpoints(){return Ao.debug.onDidChangeBreakpoints}registerDebugConfigurationProvider(e,t){return Ao.debug.registerDebugConfigurationProvider(e,t)}registerDebugAdapterTrackerFactory(e,t){return Ao.debug.registerDebugAdapterTrackerFactory(e,t)}startDebugging(e,t,n){return Ao.debug.startDebugging(e,t,n)}addBreakpoints(e){Ao.debug.addBreakpoints(e)}removeBreakpoints(e){Ao.debug.removeBreakpoints(e)}};Wd.instance=new Wd,Wd=U([(0,aX.injectable)()],Wd);p();var sP=se(ge());var cX=se(tA());var lX="_VSCODE_getDataFrame",rA=cX.default`
                            try:
                                del _VSCODE_getDataFrame
                            except:
                                pass
                            `,au=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetDataFrameInfo(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${lX}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:rA}:{code:`${t}

${i}

${rA}`}}async generateCodeToGetDataFrameRows(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${lX}("rows", ${n}, ${e.variableName}, ${e.startIndex}, ${e.endIndex})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:rA}:{code:`${t}

${i}

${rA}`}}async getContentsOfDataFrameScript(){if(au.contentsOfDataFrameScript)return au.contentsOfDataFrameScript;let e=Fi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","dataframes","vscodeDataFrame.py"),t=await this.fs.readFile(e);return au.contentsOfDataFrameScript=t,t}};au=U([(0,sP.injectable)(),x(0,(0,sP.inject)(Pt)),x(1,(0,sP.inject)(st))],au);p();var aP=se(ge());var Mj=se(tA());var Aj="_VSCODE_getVariable",eI=Mj.default`
                            try:
                                del _VSCODE_getVariable
                            except:
                                pass
                            `,Ks=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetVariableInfo(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${Aj}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:eI}:{code:`${t}

${i}

${eI}`}}async generateCodeToGetVariableProperties(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${Aj}("properties", ${n}, ${e.variableName}, ${e.stringifiedAttributeNameList})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:eI}:{code:`${t}

${i}

${eI}`}}async generateCodeToGetAllVariableDescriptions(e){let t=await this.getContentsOfVariablesScript();return e?t=t+`

return _VSCODE_getAllChildrenDescriptions('${e.root}', ${JSON.stringify(e.propertyChain)}, ${e.startIndex})`:t=t+`

variables= %who_ls
return _VSCODE_getVariableDescriptions(variables)`,t}async generateCodeToGetVariableTypes(e){let n=`${await this.getContentsOfScript()}

_VSCODE_rwho_ls = %who_ls
`,i=e.isDebugging?"True":"False",o=Mj.default`
        try:
            del _VSCODE_rwho_ls
        except:
            pass
        `,s=`${Aj}("types", ${i}, _VSCODE_rwho_ls)`;return e.isDebugging?{initializeCode:n,code:s,cleanupCode:`${eI}
${o}`}:{code:`${n}${s}

${eI}
${o}`}}async generateCodeToGetVariableValueSummary(e){let t=await this.getContentsOfVariablesScript();return t=t+`

variables= %who_ls
return _VSCODE_getVariableSummary(${e})`,t}async getContentsOfScript(){if(Ks.contentsOfScript)return Ks.contentsOfScript;let e=Fi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariableInfo.py"),t=await this.fs.readFile(e);return Ks.contentsOfScript=t,t}async getContentsOfVariablesScript(){if(Ks.contentsOfVariablesScript)return Ks.contentsOfVariablesScript;let e=Fi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariablesForProvider.py"),t=await this.fs.readFile(e);return Ks.contentsOfVariablesScript=t,t}};Ks=U([(0,aP.injectable)(),x(0,(0,aP.inject)(Pt)),x(1,(0,aP.inject)(st))],Ks);p();var nA=Symbol("IExtensionActivationManager"),Ve=Symbol("IExtensionSyncActivationService");p();var lP=require("vscode");var lu=se(ge());var uX=["currentServerHash","connectToLocalKernelsOnly","JUPYTER_LOCAL_KERNELSPECS","JUPYTER_LOCAL_KERNELSPECS_V1","JUPYTER_LOCAL_KERNELSPECS_V2","JUPYTER_LOCAL_KERNELSPECS_V3","JUPYTER_REMOTE_KERNELSPECS","JUPYTER_REMOTE_KERNELSPECS_V1","JUPYTER_REMOTE_KERNELSPECS_V2","JUPYTER_REMOTE_KERNELSPECS_V3","JUPYTER_LOCAL_KERNELSPECS_V4","JUPYTER_REMOTE_KERNELSPECS_V4-","LOCAL_KERNEL_SPECS_CACHE_KEY_V_2022_10","LOCAL_KERNEL_PYTHON_AND_RELATED_SPECS_CACHE_KEY_V_2022_10","user-jupyter-server-uri-list-v2","REGISTRATION_ID_EXTENSION_OWNER_MEMENTO_KEY","jupyter.jupyterServer.uriList"],tI=class{constructor(e,t,n,i){this.globalState=e;this.crypto=t;this.workspaceState=n;this.extensionContext=i}activate(){this.removeOldCachedItems().then(E,E)}async removeOldCachedItems(){await Promise.all([await this.getUriAccountKey()].concat(uX).filter(t=>this.globalState.get(t,void 0)!==void 0).map(t=>this.globalState.update(t,void 0).then(E,E)));let e=this.workspaceState.keys().filter(t=>t.startsWith("LAST_EXECUTED_CELL_")&&!t.startsWith("LAST_EXECUTED_CELL_V2_"));await Promise.all(e.map(t=>this.workspaceState.update(t,void 0))),await Promise.all(uX.map(t=>this.globalState.keys().filter(n=>n.startsWith(t)).map(n=>this.globalState.update(n,void 0).then(E,E))).flat()),await this.extensionContext.secrets.delete(`${ui.JupyterServerRemoteLaunchService}.remote-uri-list`).then(E,E)}async getUriAccountKey(){let e=aS();return e?this.crypto.createHash(lt(e),"SHA-512"):lP.workspace.workspaceFile?this.crypto.createHash(lt(lP.workspace.workspaceFile),"SHA-512"):lP.env.machineId}};tI=U([(0,lu.injectable)(),x(0,(0,lu.inject)(_t)),x(0,(0,lu.named)(rr)),x(1,(0,lu.inject)(uy)),x(2,(0,lu.inject)(_t)),x(2,(0,lu.named)(Is)),x(3,(0,lu.inject)(st))],tI);function dX(r){r.addSingletonInstance(V7,!1),r.addSingleton(dy,qS),r.addSingleton(gT,GS),r.addSingleton(hT,YS),r.addSingleton(Ba,zS),r.addSingleton(uy,sy),r.addSingleton(rP,QS),r.addSingleton(so,Wd),r.addSingleton(Wu,XS),r.addSingleton(sX,ZS),r.addSingleton(my,au),r.addSingleton(fy,Ks),r.addSingleton(Ve,tI),rX(r)}p();p();var iA=se(ge()),Vd=require("vscode");var jd=class{constructor(e){this.disposables=[];this._onDidChange=new Vd.EventEmitter;e.push(this),_n()||Vd.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("jupyter.kernels.excludePythonEnvironments")&&this._onDidChange.fire()},this,this.disposables)}get onDidChange(){return this._onDidChange.event}dispose(){this._onDidChange.dispose(),Ce(this.disposables)}isPythonEnvironmentExcluded(e){if(_n())return!1;let t=this.getExcludedPythonEnvironments(),n=SIe(e,t),i="uri"in e?e.uri:e.executable.uri;return n&&(ne("DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER"),w.debug(`Python Env hidden via filter: ${Ee(i)}`)),n}getExcludedPythonEnvironments(){if(!Vd.workspace.workspaceFolders||Vd.workspace.workspaceFolders.length===0)return Vd.workspace.getConfiguration("jupyter",void 0).get("kernels.excludePythonEnvironments",[]);let e=[];return Vd.workspace.workspaceFolders.forEach(t=>{e.push(...Vd.workspace.getConfiguration("jupyter",t.uri).get("kernels.excludePythonEnvironments",[]))}),e}};jd=U([(0,iA.injectable)(),x(0,(0,iA.inject)(ve))],jd);function SIe(r,e){var o;let t="uri"in r?r.envPath:(o=r.environment)==null?void 0:o.folderUri,n="uri"in r?r.uri:r.executable.uri;return!n&&!t?!1:e.some(s=>{let a=Ee(s.trim()).toLowerCase().replace(/\\/g,"/");if(s=s.trim().toLowerCase().replace(/\\/g,"/"),s.length===0||a.length===0)return!1;let l=Ee(n).toLowerCase().replace(/\\/g,"/"),u=n?n.fsPath.toLowerCase().replace(/\\/g,"/"):"";if(s===l||a===l||s===u||a===u)return!0;let c=Ee(t||"").toLowerCase().replace(/\\/g,"/"),d=Ee(t||"").toLowerCase().replace(/\\/g,"/");return s===c||a===c||s===d||a===d})}p();var pX=se(ge()),ao=require("vscode");var rI=class{activate(){this.migrateFilters().catch(E)}async migrateFilters(){let e=Array.isArray(ao.workspace.workspaceFolders)?ao.workspace.workspaceFolders:[];await this.migrateWorkspaceFilters(ao.workspace.getConfiguration("jupyter",void 0),ao.ConfigurationTarget.Global),e.length===0?await this.migrateWorkspaceFilters(ao.workspace.getConfiguration("jupyter",void 0),ao.ConfigurationTarget.Global):e.length===1?await this.migrateWorkspaceFilters(ao.workspace.getConfiguration("jupyter",e[0].uri),ao.ConfigurationTarget.WorkspaceFolder):(await this.migrateWorkspaceFilters(ao.workspace.getConfiguration("jupyter",void 0),ao.ConfigurationTarget.Workspace),await Promise.all(e.map(t=>this.migrateWorkspaceFilters(ao.workspace.getConfiguration("jupyter",t.uri),ao.ConfigurationTarget.WorkspaceFolder))))}async migrateWorkspaceFilters(e,t){let n=e.inspect("kernels.filter"),i=[];switch(t){case ao.ConfigurationTarget.Global:i=(n==null?void 0:n.globalValue)||[];break;case ao.ConfigurationTarget.Workspace:i=(n==null?void 0:n.workspaceValue)||[];break;default:i=(n==null?void 0:n.workspaceFolderValue)||[]}let o=i.filter(s=>s.type==="pythonEnvironment").map(s=>s.path);i.length&&await e.update("kernels.filter",void 0,t),o.length&&await e.update("kernels.excludePythonEnvironments",Array.from(new Set(o)),t)}};rI=U([(0,pX.injectable)()],rI);p();var oA=se(ge());var Oj=require("vscode");var nI=class{constructor(e){this.disposables=e}activate(){this.disposables.push(Oj.commands.registerCommand("jupyter.filterKernels",()=>Oj.commands.executeCommand("workbench.action.openSettings","jupyter.kernels.excludePythonEnvironments").then(E,E),this))}};nI=U([(0,oA.injectable)(),x(0,(0,oA.inject)(ve))],nI);function fX(r){r.addSingleton(Ve,rI),r.addSingleton(Ve,nI),r.addSingleton(jd,jd)}p();var yX=se(ge()),iI=require("vscode");p();var hX=new Set;function gX(r){hX.add(r)}function mX(r){try{hX.forEach(e=>e.report(r))}catch(e){w.error("Failed to report progress",e)}}function vX(r){return function(e,t,n){let i=n.value;n.value=async function(...o){return mX({action:r,phase:"started"}),i.apply(this,o).finally(()=>{mX({action:r,phase:"completed"})})}}}p();p();var _Ie={JupyterSessionWaitForIdleSession:W.waitingForJupyterSessionToBeIdle,KernelsGetKernelForRemoteConnection:W.gettingListOfKernelsForRemoteConnection,KernelsGetKernelSpecs:W.gettingListOfKernelSpecs,KernelsRegisterKernel:W.registeringKernel,NotebookConnect:W.connectingToJupyter,NotebookStart:W.startingJupyterNotebook,InstallingMissingDependencies:W.installingMissingDependencies,ExportNotebookToPython:W.exportNotebookToPython,PerformingExport:W.performingExport};function sA(r){return _Ie[r]}var Kl=class{constructor(){this.progressReporters=[];this.actionPhases=new Map;this.currentActions=[];gX(this)}get currentAction(){return this.currentActions.length===0?void 0:this.currentActions[this.currentActions.length-1]}createProgressIndicator(e,t=!1){let n=new iI.CancellationTokenSource,i=Re(),o={location:iI.ProgressLocation.Notification,cancellable:t,title:e};return iI.window.withProgress(o,async(s,a)=>{a.onCancellationRequested(()=>{a.isCancellationRequested&&n.cancel(),i.resolve()}),n.token.onCancellationRequested(()=>{i.resolve()}),this.progressReporters.push(s),await i.promise}).then(E,E),{token:n.token,dispose:()=>i.resolve()}}report(e){if(this.progressReporters.length!==0&&(this.actionPhases.set(e.action,e.phase),e.phase==="started"&&this.currentActions.push(e.action),!!this.currentAction)){for(;this.actionPhases.get(this.currentAction)&&this.actionPhases.get(this.currentAction)!=="started";)this.actionPhases.delete(this.currentAction),this.currentActions.pop();this.updateProgressMessage()}}updateProgressMessage(){if(!this.currentAction||this.progressReporters.length===0)return;let e=sA(this.currentAction);e&&this.progressReporters.forEach(t=>t.report({message:e}))}};Kl=U([(0,yX.injectable)()],Kl);p();var bX=se(ge());var SX=require("vscode");var oI=class extends jN{async computeWorkingDirectory(e){var t;if(e){let n=lt(e);return n.includes(".")?lt(Qv(e)):n}return e=(e?(t=SX.workspace.getWorkspaceFolder(e))==null?void 0:t.uri:void 0)||aS(),e?lt(e):"."}};oI=U([(0,bX.injectable)()],oI);p();var qg=se(ge());var IX=require("vscode");var sI=class{constructor(e,t){this.jupyterOutput=e;this.disposableRegistry=t}register(){this.disposableRegistry.push(IX.commands.registerCommand(le.ViewJupyterOutput,this.viewJupyterOutput,this))}viewJupyterOutput(){this.jupyterOutput.show(!0)}};sI=U([(0,qg.injectable)(),x(0,(0,qg.inject)(Wm)),x(0,(0,qg.named)(Vv)),x(1,(0,qg.inject)(ve))],sI);p();var DX=se(ge()),sm=se(require("vscode"));p();var aI=se(require("vscode")),Lj;(l=>{let r=aI.FileSystemError.FileNotFound().name,e=aI.FileSystemError.FileExists().name,t=aI.FileSystemError.FileIsADirectory().name,n=aI.FileSystemError.FileNotADirectory().name,i=aI.FileSystemError.NoPermissions().name,o=[r,e,t,n,i];function s(u,c){if(o.includes(u.name))return u.name===c}function a(u){return s(u,r)}l.isFileNotFound=a})(Lj||(Lj={}));function EIe(r,e){let t=r.code;if(t)return t===e}function _X(r){let e=Lj.isFileNotFound(r);return e!==void 0?e:EIe(r,"ENOENT")}p();var xX=se(wX()),PX=require("vscode"),cu=class{constructor(e=xX.fetch){this.fetchImplementation=e;this.requestOptions={};let t=PX.workspace.getConfiguration("http").get("proxy","");t&&(this.requestOptions={headers:{proxy:t}})}async downloadFile(e){return this.fetchImplementation(e,this.requestOptions)}async exists(e){try{return(await this.downloadFile(e)).status===200}catch(t){return w.debug(`HttpClient - Failure checking for file ${e}: ${t}`),!1}}};var cI=class{constructor(){this.vscfs=sm.workspace.fs}arePathsSame(e,t){return Xs(e,t)}async getFiles(e){return(await this.vscfs.readDirectory(e)).filter(n=>n[1]===sm.FileType.File).map(n=>sm.Uri.file(n[0]))}async copy(e,t,n){await this.vscfs.copy(e,t,n)}async createDirectory(e){await this.vscfs.createDirectory(e)}async delete(e){await this.vscfs.delete(e)}async readFile(e){let t=await this.vscfs.readFile(e);return new TextDecoder().decode(t)}async stat(e){return this.vscfs.stat(e)}async writeFile(e,t){return this.vscfs.writeFile(e,typeof t=="string"?new TextEncoder().encode(t):t)}async exists(e,t){if(e.scheme.toLowerCase()==="http"||e.scheme.toLowerCase()==="https")return new cu().exists(e.toString());let n;try{n=await this.stat(e)}catch(i){return _X(i)||w.error(`stat() failed for "${e}"`,i),!1}return t===void 0?!0:t===sm.FileType.Unknown?n.type===sm.FileType.Unknown:(n.type&t)===t}async getFileHash(e){let t=await this.stat(e),n=`${t.ctime}-${t.mtime}`;return ja(n,"SHA-512")}};cI=U([(0,DX.injectable)()],cI);p();var lA=se(ge()),uu=require("vscode");var Kt=class{constructor(e){this.kernelResourceProgressReporter=new Map;e.push(this),Kt.instance=this}activate(){}dispose(){Ce(Array.from(Kt.disposables))}static createProgressReporter(e,t,n){if(!Kt.instance)return new uu.Disposable(E);let i=e?Fa(e):"";return Kt.instance.kernelResourceProgressReporter.has(i)?Kt.reportProgress(e,t):Kt.createProgressReporterInternal(i,t,n)}static wrapAndReportProgress(e,t,n){let i=e?Fa(e):"";if(!Kt.instance)return n();let o=Kt.reportProgressInternal(i,t);return n().finally(()=>o==null?void 0:o.dispose())}static reportProgress(e,t){let n=sA(t)||t,i=e?Fa(e):"";return n?Kt.reportProgressInternal(i,n||""):new uu.Disposable(()=>E)}static reportProgressInternal(e,t){if(!Kt.instance)return new uu.Disposable(E);let n=Kt.instance.kernelResourceProgressReporter.get(e);if(n||(n={title:t,pendingProgress:[],progressList:[],dispose:E},Kt.instance.kernelResourceProgressReporter.set(e,n)),n.reporter)n.progressList.push(t),n.reporter.report({message:t});else{if(n.progressList.includes(t))return new uu.Disposable(E);n.pendingProgress.push(t)}return{dispose:()=>{try{if(!n)return;let i=n.progressList.findIndex(o=>o===t);if(i>=0&&n.progressList.splice(i),n.progressList.length>0){let o=n.progressList[n.progressList.length-1];n.reporter&&n.reporter.report({message:o===n.title&&n.reporter?"":o})}else Kt.instance.kernelResourceProgressReporter.delete(e),n.dispose()}catch(i){w.error(`Failed to dispose Progress reporter for ${e}`,i)}}}}static createProgressReporterInternal(e,t,n){let i=Re(),o=new uu.Disposable(()=>i.resolve()),s=Kt.instance.kernelResourceProgressReporter.get(e)||{title:t,pendingProgress:[],progressList:[],tokenSources:[],dispose:()=>{o.dispose()}},a=!1,l=()=>{a||(a=!0,uu.window.withProgress({location:uu.ProgressLocation.Notification,title:t},async(u,c)=>{let d=Kt.instance.kernelResourceProgressReporter.get(e);if(d){for(d.reporter=u;d.pendingProgress.length>0;){let f=d.pendingProgress.shift();f===t?d.progressList.push(f):f!==t&&f&&(d.progressList.push(f),u.report({message:f}))}await Os(c,i.promise),Kt.instance.kernelResourceProgressReporter.get(e)===d&&Kt.instance.kernelResourceProgressReporter.delete(e),Kt.disposables.delete(o)}}).then(E,E))};return Kt.instance.kernelResourceProgressReporter.set(e,{...s,dispose:()=>o.dispose(),show:l}),Kt.disposables.add(o),s.pendingProgress.push(t),n||l(),{dispose:()=>o.dispose(),show:l}}};Kt.disposables=new Set,Kt=U([(0,lA.injectable)(),x(0,(0,lA.inject)(ve))],Kt);p();var pI=se(ge()),cA=require("vscode");p();var TX=require("vscode");var uI=class{constructor(e,t,n,i=[]){this.fs=e;this.disposableRegistry=t;this.options=n;this.loadFailedEmitter=new TX.EventEmitter;let o={enableScripts:!0,localResourceRoots:[this.options.rootPath,this.options.cwd,...i]};n.webviewHost?(this.webviewHost=n.webviewHost,this.webviewHost.webview.options=o):this.webviewHost=this.createWebview(o),this.loadPromise=this.load()}get loadFailed(){return this.loadFailedEmitter.event}asWebviewUri(e){var t;if(!((t=this.webviewHost)!=null&&t.webview))throw new Error("WebView not initialized, too early to get a Uri");return this.webviewHost.webview.asWebviewUri(e)}postMessage(e){var t,n;(t=this.webviewHost)!=null&&t.webview&&((n=this.webviewHost)==null||n.webview.postMessage(e))}async generateLocalReactHtml(){var o;if(!((o=this.webviewHost)!=null&&o.webview))throw new Error("WebView not initialized, too early to get a Uri");let e=this.webviewHost.webview.asWebviewUri(this.options.cwd).toString(),t=this.options.scripts.map(s=>this.webviewHost.webview.asWebviewUri(s)),n=this.webviewHost.webview.asWebviewUri(this.options.rootPath).toString(),i="false";return`<!doctype html>
        <html lang="en">
            <head>
                <meta charset="utf-8">
                <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
                <meta http-equiv="Content-Security-Policy" content="img-src 'self' data: https: http: blob: ${this.webviewHost.webview.cspSource}; default-src 'unsafe-inline' 'unsafe-eval' data: https: http: blob: ${this.webviewHost.webview.cspSource};">
                <meta name="theme-color" content="#000000">
                <meta name="theme" content="${nt.GeneratedThemeName}"/>
                <title>VS Code Python React UI</title>
                <base href="${e}${e.endsWith("/")?"":"/"}"/>
                </head>
            <body>
                <noscript>You need to enable JavaScript to run this app.</noscript>
                <div id="root"></div>
                <script type="text/javascript">
                    // Public path that will be used by webpack.
                    window.__PVSC_Public_Path = "${n}/";
                    function resolvePath(relativePath) {
                        if (relativePath && relativePath[0] == '.' && relativePath[1] != '.') {
                            return "${e}" + relativePath.substring(1);
                        }

                        return "${e}" + relativePath;
                    }
                    function forceTestMiddleware() {
                        return ${i};
                    }
                <\/script>
                ${t.map(s=>`<script type="text/javascript" src="${s}"><\/script>`).join(`
`)}
            </body>
        </html>`}async load(){var e;try{(e=this.webviewHost)!=null&&e.webview&&((await Promise.all(this.options.scripts.map(n=>this.fs.exists(n)))).every(n=>n===!0)?(this.webviewHost.webview.html=await this.generateLocalReactHtml(),this.postLoad(this.webviewHost)):this.webviewHost.webview.html=W.badWebPanelFormatString(this.options.scripts.join(", ")))}catch(t){w.error(`Error Loading WebviewPanel: ${t}`),this.loadFailedEmitter.fire()}}};var Kj=class extends uI{get panel(){return this.webviewHost}get panelOptions(){return this.options}constructor(e,t,n,i=[]){super(e,t,n,i)}async show(e){await this.loadPromise,this.panel&&(e?this.panel.visible||this.panel.reveal(this.panel.viewColumn,e):this.panel.active||this.panel.reveal(this.panel.viewColumn,e))}close(){this.panel&&this.panel.dispose()}get viewColumn(){var e;return(e=this.panel)==null?void 0:e.viewColumn}isVisible(){return this.panel?this.panel.visible:!1}isActive(){return this.panel?this.panel.active:!1}setTitle(e){this.panelOptions.title=e,this.panel&&(this.panel.title=e)}createWebview(e){return cA.window.createWebviewPanel(this.panelOptions.title.toLowerCase().replace(" ",""),this.panelOptions.title,{viewColumn:this.panelOptions.viewColumn,preserveFocus:!0},{retainContextWhenHidden:!0,enableFindWidget:!0,...e})}postLoad(e){this.disposableRegistry.push(e.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose()})),this.disposableRegistry.push(e.webview.onDidReceiveMessage(t=>{this.panelOptions.listener.onMessage(t.type,t.payload)})),this.disposableRegistry.push(e.onDidChangeViewState(t=>{this.panelOptions.listener.onChangeViewState(this)})),this.panelOptions.listener.onChangeViewState(this)}},dI=class{constructor(e,t,n){this.disposableRegistry=e;this.fs=t;this.context=n}async create(e){let t=[cA.Uri.file(qE(this.context.extensionPath,"temp"))];return Array.isArray(e.additionalPaths)&&t.push(...e.additionalPaths),new Kj(this.fs,this.disposableRegistry,e,t)}};dI=U([(0,pI.injectable)(),x(0,(0,pI.inject)(ve)),x(1,(0,pI.inject)(Pt)),x(2,(0,pI.inject)(st))],dI);p();var cP=se(ge()),kX=require("vscode");var Fj=class extends uI{constructor(t,n,i,o=[]){super(t,n,i,o);this.panelOptions=i;this._onDidChangeVisibility=new kX.EventEmitter}get visible(){return this.webviewHost?this.webviewHost.visible:!1}get onDidChangeVisibility(){return this._onDidChangeVisibility.event}createWebview(t){throw new Error("Webview Views must be passed in an initial view")}postLoad(t){this.disposableRegistry.push(t.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose()})),this.disposableRegistry.push(t.webview.onDidReceiveMessage(n=>{this.panelOptions.listener.onMessage(n.type,n.payload)})),this.disposableRegistry.push(t.onDidChangeVisibility(()=>{this._onDidChangeVisibility.fire()})),this._onDidChangeVisibility.fire()}},fI=class{constructor(e,t){this.disposableRegistry=e;this.fs=t}async create(e){return new Fj(this.fs,this.disposableRegistry,e)}};fI=U([(0,cP.injectable)(),x(0,(0,cP.inject)(ve)),x(1,(0,cP.inject)(Pt))],fI);function NX(r){r.addSingleton(Pt,cI),r.addSingleton(NR,oI),r.addSingleton(LS,HS),r.addSingleton(Ke,WS),r.addSingleton(py,sI),r.addSingleton(Kl,Kl),dX(r),LQ(r),fX(r),r.addSingleton(Ve,Kt),r.addSingleton(Ve,Ml),r.add(RR,fI),r.add(KS,dI)}p();p();var tit=Symbol("IKernelLauncher"),Hd=Symbol("IRawNotebookSupportedService"),RX=Symbol("IRawKernelSessionFactory");p();var uP=se(ge()),Uj=require("vscode");p();var uA=require("vscode");var Rr;(n=>{let r=Mu(new uA.EventEmitter);n.onDidChangeNotebookCellExecutionState=r.event;function t(i,o,s){if(o!==1||!s){r.fire({cell:i,state:o});return}let a=Mu(uA.workspace.onDidChangeNotebookDocument(l=>{var c,d;if(l.notebook!==i.notebook)return;let u=l.cellChanges.find(f=>f.cell===i);((d=(c=u==null?void 0:u.cell)==null?void 0:c.executionSummary)==null?void 0:d.executionOrder)===s&&(a.dispose(),r.fire({cell:i,state:1}))}))}n.changeCellState=t})(Rr||(Rr={}));var Jg=class{constructor(e,t){this.disposableRegistry=e;this.kernelProvider=t;this.lastExecutedCellPerKernel=new WeakMap;this.kernelsStartedSuccessfully=new WeakSet}activate(){this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this,this.disposableRegistry),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry)}onDidStartKernel(e){this.kernelsStartedSuccessfully.add(e),Rr.onDidChangeNotebookCellExecutionState(t=>{t.cell.notebook===e.notebook&&this.kernelProvider.get(t.cell.notebook)===e&&this.lastExecutedCellPerKernel.set(e,t.cell)})}async onKernelStatusChanged({kernel:e}){this.kernelsStartedSuccessfully.has(e)&&(e.disposed||e.disposing||!e.session||(e.session.kind==="localRaw"&&e.status==="dead"&&(Uj.window.showErrorMessage(W.kernelDiedWithoutError(ut(e.kernelConnectionMetadata))).then(E,E),await this.endCellAndDisplayErrorsInCell(e)),e.session.kind!=="localRaw"&&e.status==="autorestarting"&&(Uj.window.showErrorMessage(W.kernelDiedWithoutErrorAndAutoRestarting(ut(e.kernelConnectionMetadata))).then(E,E),await this.endCellAndDisplayErrorsInCell(e))))}async endCellAndDisplayErrorsInCell(e){let t=this.lastExecutedCellPerKernel.get(e);if(Br(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),!!t)return Od(t,e.controller,W.kernelCrashedDueToCodeInCurrentOrPreviousCell,!1)}};U([hn()],Jg.prototype,"onKernelStatusChanged",1),Jg=U([(0,uP.injectable)(),x(0,(0,uP.inject)(ve)),x(1,(0,uP.inject)(qe))],Jg);p();p();var KX=se(ge());p();var Da=se(ge());p();var am=class extends ot{constructor(e){super("jupyterinstall",e)}};var Ar=require("vscode");p();var dA=class extends _i{constructor(e){super("timeout",W.rawKernelStartFailedDueToTimeout(ut(e)),e)}};p();var mI=class extends eu{constructor(t,n,i,o){super(t,i,o);this.stdErr=n}};p();var pA=class extends _i{constructor(e){super("timeout",W.rawKernelStartFailedDueToTimeoutWaitingForPort(ut(e)),e)}};p();var hI=class extends _i{constructor(t=-1,n,i){super("kerneldied",W.kernelDied(n.trim()),i);this.exitCode=t;this.stdErr=n}};p();p();var jit=Symbol("IModuleInstaller"),Bit=Symbol("IPythonInstallation"),Hit=Symbol("IInstallationChannelManager"),qit=Symbol("IProductService"),Jit=Symbol("IProductPathService");var Git=Symbol("IInstaller");function Wj(r){switch(r){case 18:return"jupyter";case 20:return"notebook";case 23:return"pandas";case 19:return"ipykernel";case 22:return"nbconvert";case 21:return"kernelspec";case 27:return"pip";case 28:return"ensurepip";default:throw new Error(`Product ${r} cannot be installed as a Python Module.`)}}p();var Ci=new Map;Ci.set(18,"jupyter");Ci.set(20,"notebook");Ci.set(19,"ipykernel");Ci.set(22,"nbconvert");Ci.set(21,"kernelspec");Ci.set(23,"pandas");Ci.set(27,"pip");Ci.set(28,"ensurepip");p();var dP=class extends _i{constructor(t,n){super("noipykernel",W.kernelInvalid(ut(n)),n);this.reason=t}};p();var Fl=class extends eu{constructor(e){super(W.kernelDiedWithoutError(ut(e)),void 0,e)}};p();var AX=require("vscode"),hr=class{constructor(e){this._event=new AX.EventEmitter;this._disableUI=e}get disableUI(){return this._disableUI}set disableUI(e){let t=this._disableUI!==e;this._disableUI=e,t&&this._event.fire()}get onDidChangeDisableUI(){return this._event.event}dispose(){this._event.dispose()}};p();var mA=class extends ot{constructor(e){super("jupyterexpiredcert",e)}};p();var lm=class extends ot{constructor(t){super("invalidremotejupyterserverurihandle","Server handle not in list of known handles");this.serverProviderHandle=t}};p();var cm=Symbol("IInterpreterService");p();var hA=class extends ot{constructor(t,n,i){super("windowsLongPathNotEnabled",i);this.product=t;this.interpreter=n;this.originalMessage=i}};p();var pP=class extends ot{constructor(t,n,i){super("jupyternotebooknotinstalled",t+(n?`
${n}`:""));this.interpreter=i}};p();var MX=new Map;function gA(r,e){MX.set(Vt(r),e)}function gI(r,e,t){let n=e.jupyterCollections.find(i=>i.extensionId===r.extensionId&&i.id===r.id);return MX.get(Vt(r))||(n==null?void 0:n.label)||t||`${r.id}:${r.handle}`}var yI=class{constructor(e,t,n,i,o,s,a){this.dependencyManager=e;this.configuration=t;this.kernelDependency=n;this.serverUriStorage=i;this.jupyterUriProviderRegistration=o;this.fs=s;this.interpreterService=a;this.handledErrors=new WeakSet;this.handledKernelErrors=new WeakSet}async handleError(e){var t;if(w.warn("DataScience Error",e),e=Ln.unwrap(e),!this.handledErrors.has(e)){if(this.handledErrors.add(e),e instanceof am)await((t=this.dependencyManager)==null?void 0:t.installMissingDependencies(e));else if(e instanceof Ms)await iR(this.configuration,e.message);else if(e instanceof mA)await oR(this.configuration,e.message);else if(!Yn(e))if(e instanceof dA||e instanceof pA)Ar.window.showErrorMessage(e.message).then(E,E);else if(e instanceof mI||e instanceof hI||e instanceof pP||e instanceof Ap)Ar.window.showErrorMessage(vI(e)).then(E,E);else if(e instanceof oo&&_n())Ar.window.showErrorMessage(W.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl)).then(E,E);else if(e instanceof oo){let n=await this.handleJupyterServerConnectionError(e,void 0);Ar.window.showErrorMessage(n).then(E,E)}else if(e instanceof zf){let n=await this.handleJupyterServerUriProviderError(e,void 0);Ar.window.showErrorMessage(n).then(E,E)}else{let n=LX(e.message||e.toString());Ar.window.showErrorMessage(n).then(E,E)}}}async getErrorMessageForDisplayInCell(e,t,n){var i;if(e=Ln.unwrap(e),Yn(e)||w.error("Error in execution (get message for cell)",e),e instanceof Fl)return"";if(e instanceof dP)return Vj(e.kernelConnectionMetadata)||e.message;if(e instanceof am)return xIe(e)||e.message;if(e instanceof oo&&!_n())return e.message;if(e instanceof oo&&_n())return W.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl);if(Yn(e))return"";if(e instanceof hA){let o=typeof e.product=="string"?e.product:Ci.get(e.product)||`${e.product}`,s=Ku(e.interpreter)||e.interpreter.id||"",a=Hi(e.interpreter),l=Ee(a==null?void 0:a.executable.uri),u=s?` ${s} (${l})`:l;return W.packageNotInstalledWindowsLongPathNotEnabledError(o,u)}else{if((e instanceof mI||e instanceof hI)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&!await this.fs.exists(e.kernelConnectionMetadata.interpreter.uri))return W.failedToStartKernelDueToMissingPythonEnv(Ku(e.kernelConnectionMetadata.interpreter)||Ss(e.kernelConnectionMetadata.interpreter)||Ee(e.kernelConnectionMetadata.interpreter.uri));if((e instanceof mI||e instanceof hI)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(e.kernelConnectionMetadata,void 0,!0))return Vj(e.kernelConnectionMetadata)||e.message;if(e instanceof _i||e instanceof eu){let[o,s]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(n),tK(e.kernelConnectionMetadata.interpreter)]),a=Vm(Ar.workspace.workspaceFolders||[],e,ut(e.kernelConnectionMetadata),s,o.map(l=>l.uri));if(a){if(a.reason==="moduleNotFound"&&["ipykernel_launcher","ipykernel"].includes(a.moduleName))return Vj(e.kernelConnectionMetadata)||e.message;let l=[a.message];return a.moreInfoLink&&l.push(Ue.clickHereForMoreInfoWithHtml(a.moreInfoLink)),zt(e.kernelConnectionMetadata)&&a.reason==="moduleNotFound"&&!["ipykernel_launcher","ipykernel"].includes(a.moduleName)&&await this.addErrorMessageIfPythonArePossiblyOverridingPythonModules(l,n),l.join(`
`)}}else{if(e instanceof oo)return this.handleJupyterServerConnectionError(e,t);if(e instanceof zf)return this.handleJupyterServerUriProviderError(e,t);if(e instanceof lm){let o=((i=Ar.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:i.packageJSON.displayName)||e.serverProviderHandle.extensionId;return vI(W.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(o),t)}}}return vI(e,t)}async handleJupyterServerUriProviderError(e,t){var o;let n=await gI(e.serverProviderHandle,this.jupyterUriProviderRegistration),i=((o=e.originalError)==null?void 0:o.message)||e.message;return vI(W.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerConnectionError(e,t){let n=await gI(e.serverProviderHandle,this.jupyterUriProviderRegistration,e.baseUrl),i=e.originalError.message||"";return vI(W.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerProviderConnectionError(e,t){let n=new Ar.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i&&(i.find(o=>o.id===e.handle)||await this.serverUriStorage.remove(e).catch(E)),!0}catch(i){return!1}finally{n.dispose()}}async handleKernelError(e,t,n,i,o){var s,a;if(Yn(e)||w.warn(`Kernel Error, context = ${t}`,e),e=Ln.unwrap(e),Yn(e))return this.sendKernelTelemetry(e,t,i,"cancelled"),1;if(e instanceof dP)if(w.warn(`Jupyter Kernel Dependency Error, reason=${e.reason}`,e),this.sendKernelTelemetry(e,t,i,e.category),e.reason===4&&this.kernelDependency){let l=new Ar.CancellationTokenSource;try{let u=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new hr(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:u})}finally{l.dispose()}}else return e.reason;else{if((t==="start"||t==="restart")&&e instanceof am)return this.sendKernelTelemetry(e,t,i,e.category),(this.dependencyManager?await this.dependencyManager.installMissingDependencies(e):2)===0?0:1;if(e instanceof oo||e instanceof zf||e instanceof lm){this.sendKernelTelemetry(e,t,i,e.category);let l=e instanceof lm?"":e instanceof oo?e.originalError.message||"":((s=e.originalError)==null?void 0:s.message)||e.message,u=e.serverProviderHandle.extensionId,c=e.serverProviderHandle.id,d=this.jupyterUriProviderRegistration.jupyterCollections.find(P=>P.extensionId===u&&P.id==c);if(!d||await this.handleJupyterServerProviderConnectionError(e.serverProviderHandle,d))return 3;let f=e instanceof oo?e.baseUrl:"",m=gI(e.serverProviderHandle,this.jupyterUriProviderRegistration,f),g=e instanceof lm?((a=Ar.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:a.packageJSON.displayName)||e.serverProviderHandle.extensionId:"",b=o==="jupyterExtension"?[W.selectDifferentKernel]:[];switch(await Ar.window.showErrorMessage(e instanceof lm?W.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(g):W.remoteJupyterConnectionFailedWithServer(m),{detail:l,modal:!0},W.removeRemoteJupyterConnectionButtonText,W.changeRemoteJupyterConnectionButtonText,...b)){case W.removeRemoteJupyterConnectionButtonText:return await this.serverUriStorage.remove(e.serverProviderHandle).catch(E),1;case W.changeRemoteJupyterConnectionButtonText:return 1;case W.selectDifferentKernel:return 3}return 1}else if(e instanceof Ms){this.sendKernelTelemetry(e,t,i,e.category);let l=W.jupyterSelfCertEnable,u=W.jupyterSelfCertClose;return Ar.window.showErrorMessage(W.jupyterSelfCertFail(e.message),l,u).then(c=>{c===l?(ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),this.configuration.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,Ar.ConfigurationTarget.Workspace).catch(E)):c===u&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE")}).then(E,E),2}else{if((t==="start"||t==="restart")&&n.kind==="startUsingPythonInterpreter"&&this.interpreterService&&!await this.fs.exists(n.interpreter.uri))return this.sendKernelTelemetry(e,t,i,"pythonEnvironmentMissing"),Ar.window.showErrorMessage(W.failedToStartKernelDueToMissingPythonEnv(Ku(n.interpreter)||Ss(n.interpreter)||Ee(n.interpreter.uri))).then(E,E),this.interpreterService.refreshInterpreters(!0).catch(E),2;if((t==="start"||t==="restart")&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(n,void 0,!0)){this.sendKernelTelemetry(e,t,i,"noipykernel");let l=new Ar.CancellationTokenSource;try{let u=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new hr(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:u})}finally{l.dispose()}}else{let[l,u]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(i),tK(n.interpreter)]),c=Vm(Ar.workspace.workspaceFolders||[],e,ut(n),u,l.map(d=>d.uri));return this.sendKernelTelemetry(e,t,i,c==null?void 0:c.reason),c?this.showMessageWithMoreInfo(c.message,c==null?void 0:c.moreInfoLink).catch(E):this.showMessageWithMoreInfo(vI(e,t)).catch(E),2}}}}sendKernelTelemetry(e,t,n,i){this.handledKernelErrors.has(e)||(this.handledKernelErrors.add(e),t==="start"&&Br(n,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:!1,failureCategory:i},e))}async showMessageWithMoreInfo(e,t){e.includes(le.ViewJupyterOutput)||(e=`${e} 
${W.viewJupyterLogForFurtherInfo}`);let n=t?[Ue.learnMore]:[];await Ar.window.showErrorMessage(e,...n).then(i=>{i===Ue.learnMore&&t&&Ar.env.openExternal(Ar.Uri.parse(t))})}};yI=U([x(0,(0,Da.inject)(gQ)),x(0,(0,Da.optional)()),x(1,(0,Da.inject)(Ke)),x(2,(0,Da.inject)(CS)),x(2,(0,Da.optional)()),x(3,(0,Da.inject)(dr)),x(4,(0,Da.inject)(sr)),x(5,(0,Da.inject)(Pt)),x(6,(0,Da.inject)(cm)),x(6,(0,Da.optional)())],yI);var CIe={restart:W.failedToRestartKernel,start:W.failedToStartKernel,interrupt:W.failedToInterruptKernel,execution:""};function vI(r,e){r=typeof r=="string"?r:Ln.unwrap(r);let t=e?CIe[e]:"",n="";return r instanceof pP?n=W.jupyterNotebookNotInstalledOrNotFound(r.interpreter):r instanceof ot?n=i8(r.stdErr)||r.stdErr||r.message:n=typeof r=="string"?r:r.message,LX(t,n)}function wIe(r){var t,n;return((n=(t=new RegExp(/\[([^\[]+)\]\((.*)\)/).exec(r))==null?void 0:t.length)!=null?n:0)>0}function LX(r="",e=""){r&&e.startsWith(r.substring(0,r.length-1))&&(r="");let t=[r,e].map(n=>n.trim()).filter(n=>n.length>0).join(` 
`);return!wIe(t)&&t.length&&t.indexOf("command:jupyter.viewOutput")===-1?`${t.endsWith(".")?t:t+"."} 
${W.viewJupyterLogForFurtherInfo}`:t}function Vj(r){var a,l,u,c;if(r.kind==="connectToLiveRemoteKernel"||r.kind==="startUsingRemoteKernelSpec"||!r.interpreter)return;let e=Ku(r.interpreter)||lt(r.interpreter.uri),t=Ci.get(19),n=Wj(19),i=`${uL(lt(r.interpreter.uri))} -m pip install ${n} -U --force-reinstall`;if(r.interpreter&&Jr(r.interpreter)==="Conda"){let d=Hi(r.interpreter);(a=d==null?void 0:d.environment)!=null&&a.name?i=`conda install -n ${(l=d==null?void 0:d.environment)==null?void 0:l.name} ${n} --update-deps --force-reinstall`:(u=d==null?void 0:d.environment)!=null&&u.folderUri&&(i=`conda install -p ${lt((c=d==null?void 0:d.environment)==null?void 0:c.folderUri)} ${n} --update-deps --force-reinstall`)}else r.interpreter&&Jr(r.interpreter)==="Unknown"&&(i=`${uL(lt(r.interpreter.uri))} -m pip install ${n} -U --user --force-reinstall`);let o=W.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter(e,Ci.get(19)),s=W.installPackageInstructions(t,i);return o+`
`+s}function xIe(r){let e=`${Ci.get(18)} ${Ue.and} ${Ci.get(20)}`,t=[18,20].map(Wj).join(" "),n=`python -m pip install ${t} -U
or
conda install ${t} -U`,i=W.installPackageInstructions(e,n);return r.message+`
`+i+`
`+Ue.clickHereForMoreInfoWithHtml("https://aka.ms/installJupyterForVSCode")}var bI=class extends yI{async addErrorMessageIfPythonArePossiblyOverridingPythonModules(e,t){}async getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(e){return[]}};bI=U([(0,KX.injectable)()],bI);p();var FX=se(ge());var Gg=class{async ensureKernelIsUsable(e,t,n,i,o){w.debug("Check if a kernel is usable")}};U([x(1,oK("id")),x(2,oK("disableUI")),x(3,U7())],Gg.prototype,"ensureKernelIsUsable",1),Gg=U([(0,FX.injectable)()],Gg);p();var fP=se(ge());var UX=require("vscode");var SI=class{constructor(e,t){this.liveKernelConnectionTracker=e;this.providerRegistration=t}async isValid(e){if(!this.liveKernelConnectionTracker.wasKernelUsed(e))return!1;let t=await this.providerRegistration.jupyterCollections.find(i=>i.extensionId===e.serverProviderHandle.extensionId&&i.id===e.serverProviderHandle.id);if(!t)return w.warn(`Extension ${e.serverProviderHandle.extensionId} may have been uninstalled for provider ${e.serverProviderHandle.id}, handle ${e.serverProviderHandle.handle}`),!1;let n=new UX.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i?i.map(o=>o.id).includes(e.serverProviderHandle.handle)?!0:(w.warn(`Hiding remote kernel ${e.id} for ${t.id} as the remote Jupyter Server ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}:${e.serverProviderHandle.handle} is no longer available`),!1):!1}catch(i){return w.warn(`Failed to fetch remote servers from ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}`,i),!1}finally{n.dispose()}}};SI=U([(0,fP.injectable)(),x(0,(0,fP.inject)(Bg)),x(1,(0,fP.inject)(sr))],SI);p();var WX=se(ge());var II=class{async getOrStartServer(e){throw new Error("Invalid Operation in Web")}};II=U([(0,WX.injectable)()],II);p();var du=require("vscode"),Yg=se(ge());var _I=class extends Lr{constructor(t,n){super();this._onDidLoad=this._register(new du.EventEmitter);this._onDidChangeUri=this._register(new du.EventEmitter);this._onDidRemoveUris=this._register(new du.EventEmitter);this._onDidAddUri=this._register(new du.EventEmitter);this._all=[];n.push(this),this.newStorage=this._register(new jj(t))}get onDidLoad(){return this._onDidLoad.event}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}get all(){return this.updateStore(),this._all}hookupStorageEvents(){this.storageEventsHooked||(this.storageEventsHooked=!0,this._register(this.newStorage.onDidAdd(t=>this._onDidAddUri.fire(t),this)),this._register(this.newStorage.onDidChange(t=>this._onDidChangeUri.fire(t),this)),this._register(this.newStorage.onDidRemove(t=>this._onDidRemoveUris.fire(t),this)))}updateStore(){this.hookupStorageEvents();let t=this._all;return this._all=this.newStorage.getAll(),(t.length!==this._all.length||JSON.stringify(this._all)!==JSON.stringify(t))&&this._onDidLoad.fire(),this._all}async clear(){this.hookupStorageEvents(),await this.newStorage.clear(),this._all=[],this._onDidLoad.fire()}async add(t,n){var o;this.hookupStorageEvents(),w.ci(`setUri: ${t.id}.${t.handle}`);let i={time:(o=n==null?void 0:n.time)!=null?o:Date.now(),displayName:"",provider:t};await this.newStorage.add(i),this.updateStore()}async update(t){this.hookupStorageEvents(),await this.newStorage.update(t),this.updateStore()}async remove(t){this.hookupStorageEvents(),await this.newStorage.remove(t),this.updateStore()}};_I=U([(0,Yg.injectable)(),x(0,(0,Yg.inject)(_t)),x(0,(0,Yg.named)(rr)),x(1,(0,Yg.inject)(ve))],_I);var jj=class{constructor(e){this.memento=e;this._onDidChangeUri=new du.EventEmitter;this._onDidRemoveUris=new du.EventEmitter;this._onDidAddUri=new du.EventEmitter;this.updatePromise=Promise.resolve();this.mementoKey=`MEMENTO_KEY_FOR_STORING_USED_JUPYTER_PROVIDERS_${du.env.machineId}`}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}dispose(){this._onDidAddUri.dispose(),this._onDidChangeUri.dispose(),this._onDidRemoveUris.dispose()}async add(e){return this.updatePromise=this.updatePromise.then(async()=>{let t=this.getAll(),n=t.find(a=>Vt(a.provider)===Vt(e.provider)),o=[{displayName:e.displayName||(n==null?void 0:n.displayName)||Vt(e.provider),serverHandle:e.provider,time:e.time}].concat(t.sort((a,l)=>l.time-a.time).filter(a=>Vt(a.provider)!==Vt(e.provider)).map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}))),s=o.splice(ui.JupyterServerUriListMax);if(await this.memento.update(this.mementoKey,o),n||this._onDidAddUri.fire(e),s.length){let a=s.map(l=>({provider:l.serverHandle,time:l.time,displayName:l.displayName||""}));this._onDidRemoveUris.fire(a.map(l=>l.provider))}this._onDidChangeUri.fire()}).catch(E)}async update(e){let n=this.getAll().find(o=>o.provider.id===e.id&&o.provider.handle===e.handle),i={provider:e,time:Date.now(),displayName:(n==null?void 0:n.displayName)||""};await this.add(i)}async remove(e){await(this.updatePromise=this.updatePromise.then(async()=>{let t=!1;try{let n=this.getAll();if(n.length===0)return;let i=n.filter(s=>s.provider.id!==e.id||s.provider.handle!==e.handle),o=n.filter(s=>s.provider.id===e.id&&s.provider.handle===e.handle);if(i.length===0)await this.clear();else if(o.length){let s=i.map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}));t=!0,await this.memento.update(this.mementoKey,s),this._onDidRemoveUris.fire(o.map(a=>a.provider))}}finally{t||this._onDidRemoveUris.fire([e])}}).catch(t=>w.error(`Failed to remove Server handle ${JSON.stringify(e)}`,t)))}getAll(){let e=this.memento.get(this.mementoKey,[]),t=[];return e.forEach(async n=>{let i=Vt(n.serverHandle),o={time:n.time,displayName:n.displayName||i,provider:n.serverHandle};t.push(o)}),t}async clear(){let e=this.getAll();await this.memento.update(this.mementoKey,[]),e.length&&this._onDidRemoveUris.fire(e.map(t=>t.provider))}};p();var um=se(ge());var vA="removeKernelUrisAndSessionsUsedByResources",EI=class{constructor(e,t,n){this.disposables=e;this.uriStorage=t;this.memento=n;this.usedRemoteKernelServerIdsAndSessions={}}activate(){this.usedRemoteKernelServerIdsAndSessions=this.memento.get(vA,{}),this.uriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}wasKernelUsed(e){let t=Vt(e.serverProviderHandle);return t in this.usedRemoteKernelServerIdsAndSessions&&typeof e.kernelModel.id=="string"&&e.kernelModel.id in this.usedRemoteKernelServerIdsAndSessions[t]}trackKernelIdAsUsed(e,t,n){let i=Vt(t);this.usedRemoteKernelServerIdsAndSessions[i]=this.usedRemoteKernelServerIdsAndSessions[i]||{},this.usedRemoteKernelServerIdsAndSessions[i][n]=this.usedRemoteKernelServerIdsAndSessions[i][n]||[];let o=this.usedRemoteKernelServerIdsAndSessions[i][n];o.includes(e.toString())||(o.push(e.toString()),this.memento.update(vA,this.usedRemoteKernelServerIdsAndSessions).then(E,E))}trackKernelIdAsNotUsed(e,t,n){let i=Vt(t);if(!(i in this.usedRemoteKernelServerIdsAndSessions)||!(n in this.usedRemoteKernelServerIdsAndSessions[i]))return;let o=this.usedRemoteKernelServerIdsAndSessions[i][n];!Array.isArray(o)||!o.includes(e.toString())||(o.splice(o.indexOf(e.toString()),1),o.length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i][n],Object.keys(this.usedRemoteKernelServerIdsAndSessions[i]).length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i],this.memento.update(vA,this.usedRemoteKernelServerIdsAndSessions).then(E,E))}onDidRemoveServers(e){e.forEach(t=>{let n=Vt(t);delete this.usedRemoteKernelServerIdsAndSessions[n],this.memento.update(vA,this.usedRemoteKernelServerIdsAndSessions).then(E,E)})}};EI=U([(0,um.injectable)(),x(0,(0,um.inject)(ve)),x(1,(0,um.inject)(dr)),x(2,(0,um.inject)(_t)),x(2,(0,um.named)(rr))],EI);p();var HX=se(ge()),qX=se(jX());p();var BX=require("vscode");function Bj(r){return class extends r{constructor(...n){super(...n);this._onAnyMessage=new BX.EventEmitter;this.onAnyMessage=this._onAnyMessage.event;this.msgChain=Promise.resolve(),this.sendChain=Promise.resolve(),this.receiveHooks=[],this.sendHooks=[]}patchSuperEmit(n){super.emit=n}send(n,i){this.sendHooks?this.sendChain=this.sendChain.then(()=>Promise.all(this.sendHooks.map(o=>o(n,i)))).then(()=>super.send(n,i)):super.send(n,i)}handleEvent(n,i,...o){return i==="message"&&this.receiveHooks.length?(this.msgChain=this.msgChain.then(()=>Promise.all(this.receiveHooks.map(s=>s(o[0])))).then(()=>n(i,...o)).catch(s=>w.error(`Exception while handling messages: ${s}`)),!0):n(i,...o)}emit(n,...i){if(n==="unexpected-response"&&i.length===2){let o=i[1];w.error(`Error in websocket: (${o==null?void 0:o.statusCode}) ${o==null?void 0:o.statusMessage}, ${o==null?void 0:o.path}, Headers = ${JSON.stringify(o==null?void 0:o.headers)}`)}return n==="error"&&w.error("Error in websocket",i.length?i[0]:void 0),this.handleEvent((o,...s)=>super.emit(o,...s),n,...i)}addReceiveHook(n){this.receiveHooks.push(n)}removeReceiveHook(n){this.receiveHooks=this.receiveHooks.filter(i=>i!==n)}addSendHook(n){this.sendHooks.push(n)}removeSendHook(n){this.sendHooks=this.sendHooks.filter(i=>i!==n)}}}p();var Mo=new Map;var wI=class{getRequestCtor(e,t,n){class i extends Request{constructor(s,a){super(s,a);let l=this.headers;if(n){let u=n();Object.keys(u).forEach(f=>l.append(f,u[f].toString())),l.set("Content-Type","application/json");let d=l.append.bind(l);l.append=(f,m)=>{f.toLowerCase()!=="authorization"&&d(f,m)}}e&&this.headers.append("Cookie",e)}}return i}wrapWebSocketCtor(e){class t extends Bj(e){constructor(o,s){super(o,s);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let a,l=/.*\/kernels\/(.*)\/.*/.exec(o);l&&l.length>1&&(this.kernelId=l[1]),this.kernelId?(Mo.set(this.kernelId,this),this.onclose=()=>{a&&this.timer!==a&&clearInterval(a),Mo.get(this.kernelId)===this&&Mo.delete(this.kernelId)}):w.error("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener&&this.addEventListener("open",this.boundOpenHandler)}openHandler(){let o=this.onmessage;this.onmessage=s=>{this.handleEvent((a,...l)=>{let u={data:l[0],type:a.toString(),target:this};return o(u),!0},"message",s.data)},this.removeEventListener("open",this.boundOpenHandler)}}return t}getWebsocketCtor(e,t,n){class i extends Bj(qX.default){constructor(a,l){super(a,l);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let u,c=/.*\/kernels\/(.*)\/.*/.exec(a);c&&c.length>1&&(this.kernelId=c[1]),this.kernelId?(Mo.set(this.kernelId,this),this.onclose=()=>{u&&this.timer!==u&&clearInterval(u),Mo.get(this.kernelId)===this&&Mo.delete(this.kernelId)}):w.error("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener("open",this.boundOpenHandler)}openHandler(){let a=this.onmessage;this.onmessage=l=>{this.handleEvent((u,...c)=>{let d={data:c[0],type:u.toString(),target:this};return a(d),!0},"message",l.data)},this.removeEventListener("open",this.boundOpenHandler)}}return i}getFetchMethod(){return fetch}getHeadersCtor(){return Headers}getRequestInit(){return{cache:"no-store"}}};wI=U([(0,HX.injectable)()],wI);p();var Us=se(ge());p();var Fs=require("vscode");p();var PIe=["/bin/sh","/bin/bash","/bin/zsh"];function JX(r,e){let t=(r.argv||[]).some(n=>(n=n.toLowerCase(),PIe.some(i=>n.includes(i))));ne("DATASCIENCE.KERNEL_SPEC_LANGUAGE",void 0,{language:r.language,kind:e,usesShell:t})}p();p();var xI="remoteKernelSpecCache.json";var DIe=2e3,bA=class extends oc{constructor(t,n,i,o,s,a,l,u,c,d){super();this.id=t;this.displayName=n;this.env=i;this.cachedRemoteKernelValidator=o;this.kernelProvider=a;this.serverProviderHandle=l;this.jupyterConnection=u;this.fs=c;this.context=d;this._status="idle";this._onDidChangeStatus=new Fs.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.promiseMonitor=new Zb;this.kernelIdsToHide=new Set;this.kind="remote";this.cache=[];this._onDidChangeKernels=new Fs.EventEmitter;this.onDidChangeKernels=this._onDidChangeKernels.event;this._onDidChange=new Fs.EventEmitter;this.onDidChange=this._onDidChange.event;this.cacheFile=Fs.Uri.joinPath(d.globalStorageUri,xI),this.cacheKey=Vt(l),this._register(s.registerKernelFinder(this)),this._register(this._onDidChangeKernels.event(()=>this._onDidChange.fire(),this)),this._register(this._onDidChangeKernels),this._register(this._onDidChange),this._register(this._onDidChangeStatus),this._register(this.promiseMonitor)}get status(){return this._status}set status(t){this._status!==t&&(this._status=t,this._onDidChangeStatus.fire())}get lastError(){return this._lastError}get kernels(){return this.cache}get items(){return this.kernels}get title(){return this.displayName}dispose(){var t,n;super.dispose(),(t=this._cacheUpdateCancelTokenSource)==null||t.dispose(),(n=this.kernelDisposeDelayTimer)==null||n.dispose()}async activate(){this.promiseMonitor.onStateChange(()=>{this.status=this.promiseMonitor.isComplete?"idle":"discovering"}),this.loadCache().then(E,E),this._register(this.kernelProvider.onDidStartKernel(t=>{Wt(t.kernelConnectionMetadata)&&this.updateCache().then(E,E)},this)),this._register(this.kernelProvider.onDidDisposeKernel(t=>{var n;if(t&&Wt(t.kernelConnectionMetadata)){(n=this.kernelDisposeDelayTimer)==null||n.dispose();let i=setTimeout(()=>{this.updateCache().then(E,E)},DIe);return this.kernelDisposeDelayTimer=new Fs.Disposable(()=>clearTimeout(i)),i}},this))}async refresh(){await this.loadCache(!0,!0)}getListOfKernelsWithCachedConnection(t,n=!1){return(!this.cachedConnection||n)&&(this.cachedConnection=this.getRemoteConnectionInfo(t)),this.cachedConnection.then(i=>i?(this.cachedConnection=Promise.resolve(i),this.listKernelsFromConnection(i)):Promise.resolve([])).catch(i=>this.isDisposed?Promise.reject(i):n?(this.cachedConnection=void 0,Promise.reject(i)):this.getListOfKernelsWithCachedConnection(t,!0))}async loadCache(t=!1,n=!1){w.ci(`Remote Kernel Finder load cache Server: ${this.id}`);let i=(async()=>{let o=t?[]:await this.getFromCache(),s=[];if(!t&&Array.isArray(o)&&o.length>0)s=o,this.updateCache().then(E,E),this.loadCache(!0).then(E,E);else try{s=await this.getListOfKernelsWithCachedConnection(n),this._lastError=void 0}catch(a){a instanceof Fs.CancellationError||(w.error("UniversalRemoteKernelFinder: Failed to get kernels without cache",a),this._lastError=a,this._onDidChange.fire())}await this.writeToCache(s)})();this.promiseMonitor.push(i),await i}async updateCache(){let t=(async()=>{var o;let n=[];(o=this._cacheUpdateCancelTokenSource)==null||o.dispose();let i=new Fs.CancellationTokenSource;this._cacheUpdateCancelTokenSource=i;try{n=await this.getListOfKernelsWithCachedConnection(!1)}catch(s){w.warn(`Could not fetch kernels from the ${this.kind} server, falling back to cache: ${s}`),n=await this.getFromCache(i.token),n=n.filter(a=>a.kind==="connectToLiveRemoteKernel")}i.token.isCancellationRequested||await this.writeToCache(n)})();this.promiseMonitor.push(t),await t}async getRemoteConnectionInfo(t=!0){let n=[];return t&&n.push(Kt.createProgressReporter(void 0,W.connectingToJupyter)),this.jupyterConnection.createConnectionInfo(this.serverProviderHandle).finally(()=>Ce(n))}async getFromCache(t){try{if(t!=null&&t.isCancellationRequested)throw new Fs.CancellationError;let n=this.cache;(!n||n.length===0)&&(n=await this.getCacheContents());let i=[],o=Promise.all(n.map(async s=>{await this.isValidCachedKernel(s)&&i.push(s)}));return await Os(t,o),i}catch(n){w.error("UniversalRemoteKernelFinder: Failed to get from cache",n)}return[]}async getCacheContents(){try{let t=await this.fs.readFile(this.cacheFile),n=JSON.parse(t);if(n.extensionVersion!==this.env.extensionVersion)return[];let i=n.data[this.cacheKey]||[];return Array.isArray(i)?i.map(o=>Qc.fromJSON(o)):[]}catch(t){return[]}}async listKernelsFromConnection(t){let n=[];try{let i=Qf.create(t.settings);n.push({dispose:()=>Ag(i)});let[o,s,a,l]=await Promise.all([i.getRunningKernels(),i.getKernelSpecs(),i.getRunningSessions(),Rz(t.serverProviderHandle)]),u=s.map(f=>(JX(f,"remote"),qx.create({kernelSpec:f,id:mR(f,void 0,l),baseUrl:t.baseUrl,serverProviderHandle:t.serverProviderHandle})));return[...a.map(f=>{var D,T;let m=f.kernel,g=m.last_activity?new Date(Date.parse(m.last_activity.toString())):new Date,b=m.connections?parseInt(m.connections.toString(),10):0,y=o.find(K=>{var L;return K.id===((L=f.kernel)==null?void 0:L.id)})||{},P=s.find(K=>{var L;return K.name===((L=f.kernel)==null?void 0:L.name)})||{};return Hx.create({kernelModel:{...f.kernel,...P,...y,name:((D=f.kernel)==null?void 0:D.name)||"",lastActivityTime:g,numberOfConnections:b,model:f},baseUrl:t.baseUrl,id:((T=f.kernel)==null?void 0:T.id)||"",serverProviderHandle:t.serverProviderHandle})}).filter(f=>!this.kernelIdsToHide.has(f.kernelModel.id||"")),...u]}catch(i){throw w.error(`Error fetching kernels from ${t.baseUrl} (${t.displayName}):`,i),i}finally{await Promise.all(n.map(i=>i.dispose().catch(E)))}}async writeToCache(t){try{w.trace(`UniversalRemoteKernelFinder: Writing ${t.length} remote kernel connection metadata to cache`);let n=this.cache,i=new Map(n.map(f=>[f.id,f])),o=new Map(t.map(f=>[f.id,f])),s=t.filter(f=>!i.has(f.id)),a=t.filter(f=>i.has(f.id)&&!gB(f,i.get(f.id))),l=n.filter(f=>!o.has(f.id)),u=this.cacheKey;this.cache=n.filter(f=>o.has(f.id)).concat(s),this.cache.forEach(f=>{let m=o.get(f.id);f!==m&&m.kind==="connectToLiveRemoteKernel"&&f.kind==="connectToLiveRemoteKernel"&&f.updateModel(m.kernelModel)});let c=t.map(f=>f.toJSON()),d={extensionVersion:this.env.extensionVersion,data:{}};try{let f=await this.fs.readFile(this.cacheFile),m=JSON.parse(f);m.extensionVersion===this.env.extensionVersion&&(d=m)}catch(f){}d.data[u]=c,await this.fs.createDirectory(this.context.globalStorageUri).then(()=>this.fs.writeFile(this.cacheFile,JSON.stringify(d))).catch(f=>{w.error("Failed to cache the remote kernels.",f)}),(s.length||a.length||l.length)&&this._onDidChangeKernels.fire({removed:l})}catch(n){w.error("UniversalRemoteKernelFinder: Failed to write to cache",n)}}async isValidCachedKernel(t){switch(t.kind){case"startUsingRemoteKernelSpec":return!1;case"connectToLiveRemoteKernel":return this.cachedRemoteKernelValidator.isValid(t)}}};var SA=require("vscode");var qd=class{constructor(e,t,n,i,o,s,a,l,u,c){this.serverUriStorage=e;this.env=t;this.cachedRemoteKernelValidator=n;this.kernelFinder=i;this.kernelProvider=o;this.jupyterConnection=s;this.disposables=a;this.fs=l;this.context=u;this.jupyterServerProviderRegistry=c;this.serverFinderMapping=new Map;this.handledProviders=new WeakSet;this.mappedProviders=new WeakSet;this.mappedServers=new Set}activate(){this.serverUriStorage.onDidAdd(e=>this.validateAndCreateFinder(e),this,this.disposables),this.serverUriStorage.onDidChange(this.buildListOfFinders,this,this.disposables),this.serverUriStorage.onDidLoad(this.handleProviderChanges,this,this.disposables),this.serverUriStorage.onDidLoad(this.buildListOfFinders,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderHandleChanges,this,this.disposables),this.serverUriStorage.onDidRemove(this.urisRemoved,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderChanges,this,this.disposables),this.buildListOfFinders(),this.handleProviderChanges().catch(E)}buildListOfFinders(){this.serverUriStorage.all.map(e=>this.validateAndCreateFinder(e).catch(E))}handleProviderHandleChanges(){this.jupyterServerProviderRegistry.jupyterCollections.forEach(e=>{this.handledProviders.has(e)||(this.handledProviders.add(e),e.serverProvider.onDidChangeServers&&e.serverProvider.onDidChangeServers(this.buildListOfFinders,this,this.disposables))}),this.buildListOfFinders()}async handleProviderChanges(){if(!this.serverUriStorage.all.length)return;let e=new SA.CancellationTokenSource;this.disposables.push(e),await Promise.all(this.jupyterServerProviderRegistry.jupyterCollections.map(t=>{let n=t.serverProvider;if(!(!n||this.mappedProviders.has(n)))return this.mappedProviders.add(n),n!=null&&n.onDidChangeServers&&(n==null||n.onDidChangeServers(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables)),this.serverUriStorage.onDidLoad(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables),this.lookForServersInCollectionAndRemoveOldServers(t).catch(E)})),e.dispose()}async lookForServersInCollectionAndRemoveOldServers(e){if(!this.serverUriStorage.all.length)return;let t=new Set(this.serverUriStorage.all.map(o=>Vt(o.provider))),n=e.serverProvider;if(!n)return;let i=new SA.CancellationTokenSource;try{let o=await Promise.resolve(n.provideJupyterServers(i.token)),s=new Set;(o||[]).forEach(a=>{let l={extensionId:e.extensionId,handle:a.id,id:e.id},u=Vt(l);s.add(u),gA(l,a.label),!(this.mappedServers.has(u)||!t.has(u))&&(this.mappedServers.add(u),this.createRemoteKernelFinder(l,a.label))}),this.serverFinderMapping.forEach((a,l)=>{a.serverProviderHandle.extensionId===e.extensionId&&a.serverProviderHandle.id===e.id&&!s.has(Vt(a.serverProviderHandle))&&(a.dispose(),this.serverFinderMapping.delete(l))})}catch(o){w.error(`Failed to get servers for Collection ${e.id} in ${e.extensionId}`,o)}finally{i.dispose()}}async validateAndCreateFinder(e){let t=Vt(e.provider);if(this.serverFinderMapping.has(t))return;let n=new SA.CancellationTokenSource,i=async()=>{var u;let s=this.jupyterServerProviderRegistry.jupyterCollections.find(c=>c.extensionId===e.provider.extensionId&&c.id===e.provider.id);if(!s||!s.serverProvider)return;let a=await Promise.resolve(s.serverProvider.provideJupyterServers(n.token)),l=(u=a==null?void 0:a.find(c=>c.id===e.provider.handle))==null?void 0:u.label;l&&this.createRemoteKernelFinder(e.provider,l)},o=async()=>{var a;let s=await((a=this.jupyterServerProviderRegistry.jupyterCollections.find(l=>l.extensionId===e.provider.extensionId&&l.extensionId===Zl&&l.id===e.provider.id))==null?void 0:a.label);s&&this.createRemoteKernelFinder(e.provider,s)};await Promise.all([i().catch(E),o().catch(E)]),n.dispose()}getOrCreateRemoteKernelFinder(e,t){let n=Vt(e);if(!this.serverFinderMapping.has(n)){let i=new bA(`remote-${n}`,t,this.env,this.cachedRemoteKernelValidator,this.kernelFinder,this.kernelProvider,e,this.jupyterConnection,this.fs,this.context);this.disposables.push(i),this.serverFinderMapping.set(n,i),i.activate().then(E,E)}return this.serverFinderMapping.get(n)}createRemoteKernelFinder(e,t){this.getOrCreateRemoteKernelFinder(e,t)}urisRemoved(e){e.forEach(t=>{let n=Vt(t),i=this.serverFinderMapping.get(n);i&&i.dispose(),this.serverFinderMapping.delete(n)})}dispose(){this.serverFinderMapping.forEach(e=>e.dispose())}};U([hn("Handle Jupyter Provider Changes")],qd.prototype,"handleProviderChanges",1),U([hn("Check Servers in Jupyter Server Provider")],qd.prototype,"lookForServersInCollectionAndRemoveOldServers",1),U([hn("Failed to create a Remote Kernel Finder")],qd.prototype,"validateAndCreateFinder",1),qd=U([(0,Us.injectable)(),x(0,(0,Us.inject)(dr)),x(1,(0,Us.inject)(LS)),x(2,(0,Us.inject)(DR)),x(3,(0,Us.inject)(oi)),x(4,(0,Us.inject)(qe)),x(5,(0,Us.inject)(pn)),x(6,(0,Us.inject)(ve)),x(7,(0,Us.inject)(Pt)),x(8,(0,Us.inject)(st)),x(9,(0,Us.inject)(sr))],qd);p();var dm=se(ge());p();var kA=require("vscode");var NA=se($g());var pu=se(ge());p();var IA=class extends ot{constructor(t){super("localjupyterserverconnection",W.jupyterNotebookFailure(t.message||t.toString()));this.originalError=t}};p();function ZX(r){if(mn()){let e=r;if(e&&e._futures){let t=e._futures;t.forEach&&t.forEach(n=>{n._status!==void 0&&(n._status|=4)})}e&&e._reconnectLimit&&(e._reconnectLimit=0)}}var PI=class extends Ln{constructor(e){super(e.message,e)}};p();var gP=require("vscode");p();var zg=class extends _i{constructor(e){super("invalidkernel",W.kernelInvalid(ut(e)),e)}};p();var _A=class extends _i{constructor(e){super("timeout",W.jupyterLaunchTimedOut,e)}};async function EA(r,e,t,n,i){var a;if(!t.kernel)throw new zg(r);let o=Kt.reportProgress(e,W.waitingForJupyterSessionToBeIdle),s=[];o&&s.push(o);try{w.trace(`Waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`);let l=Re();i.onCancellationRequested(()=>l.reject(new gP.CancellationError),void 0,s);let u=(m,g)=>{w.trace(`Got status ${g} in waitForIdleOnSession`),g=="idle"&&l.resolve(g)};(a=t.kernel.statusChanged)==null||a.connect(u),s.push(new gP.Disposable(()=>zs(()=>{var m,g;return(g=(m=t.kernel)==null?void 0:m.statusChanged)==null?void 0:g.disconnect(u)}))),t.kernel.status=="idle"&&l.resolve(t.kernel.status);let c=Re(),d=()=>c.resolve("");t.disposed.connect(d,c),s.push(new gP.Disposable(()=>zs(()=>t.disposed.disconnect(d,c)))),c.promise.catch(E),l.promise.catch(E);let f=await fo(n,"",l.promise,c.promise);if(t.isDisposed)throw w.error("Session disposed while waiting for session to be idle."),new zg(r);if(w.trace(`Finished waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),f=="idle")return;throw w.error(`Shutting down after failing to wait for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),new _A(r)}catch(l){throw w.ci("Error waiting for idle",l),l}finally{Ce(s)}}p();var TA=require("vscode");p();p();p();var CA;(function(r){function e(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var v=B.length;if(v===0)return-1;O<0?O=Math.max(0,O+v):O=Math.min(O,v-1),h<0?h=Math.max(0,h+v):h=Math.min(h,v-1);var C;h<O?C=h+1+(v-O):C=h-O+1;for(var k=0;k<C;++k){var H=(O+k)%v;if(B[H]===N)return H}return-1}r.firstIndexOf=e;function t(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var v=B.length;if(v===0)return-1;O<0?O=Math.max(0,O+v):O=Math.min(O,v-1),h<0?h=Math.max(0,h+v):h=Math.min(h,v-1);var C;O<h?C=O+1+(v-h):C=O-h+1;for(var k=0;k<C;++k){var H=(O-k+v)%v;if(B[H]===N)return H}return-1}r.lastIndexOf=t;function n(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var v=B.length;if(v===0)return-1;O<0?O=Math.max(0,O+v):O=Math.min(O,v-1),h<0?h=Math.max(0,h+v):h=Math.min(h,v-1);var C;h<O?C=h+1+(v-O):C=h-O+1;for(var k=0;k<C;++k){var H=(O+k)%v;if(N(B[H],H))return H}return-1}r.findFirstIndex=n;function i(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var v=B.length;if(v===0)return-1;O<0?O=Math.max(0,O+v):O=Math.min(O,v-1),h<0?h=Math.max(0,h+v):h=Math.min(h,v-1);var C;O<h?C=O+1+(v-h):C=O-h+1;for(var k=0;k<C;++k){var H=(O-k+v)%v;if(N(B[H],H))return H}return-1}r.findLastIndex=i;function o(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var v=n(B,N,O,h);return v!==-1?B[v]:void 0}r.findFirstValue=o;function s(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var v=i(B,N,O,h);return v!==-1?B[v]:void 0}r.findLastValue=s;function a(B,N,O,h,v){h===void 0&&(h=0),v===void 0&&(v=-1);var C=B.length;if(C===0)return 0;h<0?h=Math.max(0,h+C):h=Math.min(h,C-1),v<0?v=Math.max(0,v+C):v=Math.min(v,C-1);for(var k=h,H=v-h+1;H>0;){var Y=H>>1,Z=k+Y;O(B[Z],N)<0?(k=Z+1,H-=Y+1):H=Y}return k}r.lowerBound=a;function l(B,N,O,h,v){h===void 0&&(h=0),v===void 0&&(v=-1);var C=B.length;if(C===0)return 0;h<0?h=Math.max(0,h+C):h=Math.min(h,C-1),v<0?v=Math.max(0,v+C):v=Math.min(v,C-1);for(var k=h,H=v-h+1;H>0;){var Y=H>>1,Z=k+Y;O(B[Z],N)>0?H=Y:(k=Z+1,H-=Y+1)}return k}r.upperBound=l;function u(B,N,O){if(B===N)return!0;if(B.length!==N.length)return!1;for(var h=0,v=B.length;h<v;++h)if(O?!O(B[h],N[h]):B[h]!==N[h])return!1;return!0}r.shallowEqual=u;function c(B,N){N===void 0&&(N={});var O=N.start,h=N.stop,v=N.step;if(v===void 0&&(v=1),v===0)throw new Error("Slice `step` cannot be zero.");var C=B.length;O===void 0?O=v<0?C-1:0:O<0?O=Math.max(O+C,v<0?-1:0):O>=C&&(O=v<0?C-1:C),h===void 0?h=v<0?-1:C:h<0?h=Math.max(h+C,v<0?-1:0):h>=C&&(h=v<0?C-1:C);var k;v<0&&h>=O||v>0&&O>=h?k=0:v<0?k=Math.floor((h-O+1)/v+1):k=Math.floor((h-O-1)/v+1);for(var H=[],Y=0;Y<k;++Y)H[Y]=B[O+Y*v];return H}r.slice=c;function d(B,N,O){var h=B.length;if(!(h<=1)&&(N<0?N=Math.max(0,N+h):N=Math.min(N,h-1),O<0?O=Math.max(0,O+h):O=Math.min(O,h-1),N!==O)){for(var v=B[N],C=N<O?1:-1,k=N;k!==O;k+=C)B[k]=B[k+C];B[O]=v}}r.move=d;function f(B,N,O){N===void 0&&(N=0),O===void 0&&(O=-1);var h=B.length;if(!(h<=1))for(N<0?N=Math.max(0,N+h):N=Math.min(N,h-1),O<0?O=Math.max(0,O+h):O=Math.min(O,h-1);N<O;){var v=B[N],C=B[O];B[N++]=C,B[O--]=v}}r.reverse=f;function m(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var v=B.length;if(!(v<=1)&&(O<0?O=Math.max(0,O+v):O=Math.min(O,v-1),h<0?h=Math.max(0,h+v):h=Math.min(h,v-1),!(O>=h))){var C=h-O+1;if(N>0?N=N%C:N<0&&(N=(N%C+C)%C),N!==0){var k=O+N;f(B,O,k-1),f(B,k,h),f(B,O,h)}}}r.rotate=m;function g(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var v=B.length;if(v!==0){O<0?O=Math.max(0,O+v):O=Math.min(O,v-1),h<0?h=Math.max(0,h+v):h=Math.min(h,v-1);var C;h<O?C=h+1+(v-O):C=h-O+1;for(var k=0;k<C;++k)B[(O+k)%v]=N}}r.fill=g;function b(B,N,O){var h=B.length;N<0?N=Math.max(0,N+h):N=Math.min(N,h);for(var v=h;v>N;--v)B[v]=B[v-1];B[N]=O}r.insert=b;function y(B,N){var O=B.length;if(N<0&&(N+=O),!(N<0||N>=O)){for(var h=B[N],v=N+1;v<O;++v)B[v-1]=B[v];return B.length=O-1,h}}r.removeAt=y;function P(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var v=e(B,N,O,h);return v!==-1&&y(B,v),v}r.removeFirstOf=P;function A(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var v=t(B,N,O,h);return v!==-1&&y(B,v),v}r.removeLastOf=A;function D(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var v=B.length;if(v===0)return 0;O<0?O=Math.max(0,O+v):O=Math.min(O,v-1),h<0?h=Math.max(0,h+v):h=Math.min(h,v-1);for(var C=0,k=0;k<v;++k)O<=h&&k>=O&&k<=h&&B[k]===N||h<O&&(k<=h||k>=O)&&B[k]===N?C++:C>0&&(B[k-C]=B[k]);return C>0&&(B.length=v-C),C}r.removeAllOf=D;function T(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var v,C=n(B,N,O,h);return C!==-1&&(v=y(B,C)),{index:C,value:v}}r.removeFirstWhere=T;function K(B,N,O,h){O===void 0&&(O=-1),h===void 0&&(h=0);var v,C=i(B,N,O,h);return C!==-1&&(v=y(B,C)),{index:C,value:v}}r.removeLastWhere=K;function L(B,N,O,h){O===void 0&&(O=0),h===void 0&&(h=-1);var v=B.length;if(v===0)return 0;O<0?O=Math.max(0,O+v):O=Math.min(O,v-1),h<0?h=Math.max(0,h+v):h=Math.min(h,v-1);for(var C=0,k=0;k<v;++k)O<=h&&k>=O&&k<=h&&N(B[k],k)||h<O&&(k<=h||k>=O)&&N(B[k],k)?C++:C>0&&(B[k-C]=B[k]);return C>0&&(B.length=v-C),C}r.removeAllWhere=L})(CA||(CA={}));function tZ(r){var e;return typeof r.iter=="function"?e=r.iter():e=new AIe(r),e}function wA(r,e){for(var t=0,n=tZ(r),i;(i=n.next())!==void 0;)if(e(i,t++)===!1)return}var AIe=function(){function r(e){this._index=0,this._source=e}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._source.length))return this._source[this._index++]},r}(),rct=function(){function r(e,t){t===void 0&&(t=Object.keys(e)),this._index=0,this._source=e,this._keys=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source,this._keys);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._keys.length)){var e=this._keys[this._index++];return e in this._source?e:this.next()}},r}(),nct=function(){function r(e,t){t===void 0&&(t=Object.keys(e)),this._index=0,this._source=e,this._keys=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source,this._keys);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._keys.length)){var e=this._keys[this._index++];return e in this._source?this._source[e]:this.next()}},r}(),ict=function(){function r(e,t){t===void 0&&(t=Object.keys(e)),this._index=0,this._source=e,this._keys=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source,this._keys);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._keys.length)){var e=this._keys[this._index++];return e in this._source?[e,this._source[e]]:this.next()}},r}(),oct=function(){function r(e){this._fn=e}return r.prototype.iter=function(){return this},r.prototype.clone=function(){throw new Error("An `FnIterator` cannot be cloned.")},r.prototype.next=function(){return this._fn.call(void 0)},r}();var sct=function(){function r(e){this._cloned=!1,this._source=e,this._active=void 0}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source.clone());return e._active=this._active&&this._active.clone(),e._cloned=!0,this._cloned=!0,e},r.prototype.next=function(){if(this._active===void 0){var e=this._source.next();if(e===void 0)return;this._active=this._cloned?e.clone():e}var t=this._active.next();return t!==void 0?t:(this._active=void 0,this.next())},r}();var act=function(){function r(){}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r},r.prototype.next=function(){},r}();var lct=function(){function r(e,t){this._source=e,this._index=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.clone(),this._index)},r.prototype.next=function(){var e=this._source.next();if(e!==void 0)return[this._index++,e]},r}();var cct=function(){function r(e,t){this._index=0,this._source=e,this._fn=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source.clone(),this._fn);return e._index=this._index,e},r.prototype.next=function(){for(var e=this._fn,t=this._source,n;(n=t.next())!==void 0;)if(e(n,this._index++))return n},r}();function rZ(r,e){for(var t=0,n=tZ(r),i;(i=n.next())!==void 0;)if(e(i,t++))return i}var uct=function(){function r(e,t){this._index=0,this._source=e,this._fn=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source.clone(),this._fn);return e._index=this._index,e},r.prototype.next=function(){var e=this._source.next();if(e!==void 0)return this._fn.call(void 0,e,this._index++)},r}();var dct=function(){function r(e,t,n){this._index=0,this._start=e,this._stop=t,this._step=n,this._length=Gj.rangeLength(e,t,n)}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._start,this._stop,this._step);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index>=this._length))return this._start+this._step*this._index++},r}(),Gj;(function(r){function e(t,n,i){return i===0?1/0:t>n&&i>0||t<n&&i<0?0:Math.ceil((n-t)/i)}r.rangeLength=e})(Gj||(Gj={}));var pct=function(){function r(e,t){this._value=e,this._count=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._value,this._count)},r.prototype.next=function(){if(!(this._count<=0))return this._count--,this._value},r}();var fct=function(){function r(e){this._source=e,this._index=e.length-1}return r.prototype.iter=function(){return this},r.prototype.clone=function(){var e=new r(this._source);return e._index=this._index,e},r.prototype.next=function(){if(!(this._index<0||this._index>=this._source.length))return this._source[this._index--]},r}();var mct=function(){function r(e,t){this._source=e,this._step=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.clone(),this._step)},r.prototype.next=function(){for(var e=this._source.next(),t=this._step-1;t>0;--t)this._source.next();return e},r}(),eZ;(function(r){function e(s,a,l){l===void 0&&(l=0);for(var u=new Array(a.length),c=0,d=l,f=a.length;c<f;++c,++d){if(d=s.indexOf(a[c],d),d===-1)return null;u[c]=d}return u}r.findIndices=e;function t(s,a,l){l===void 0&&(l=0);var u=e(s,a,l);if(!u)return null;for(var c=0,d=0,f=u.length;d<f;++d){var m=u[d]-l;c+=m*m}return{score:c,indices:u}}r.matchSumOfSquares=t;function n(s,a,l){l===void 0&&(l=0);var u=e(s,a,l);if(!u)return null;for(var c=0,d=l-1,f=0,m=u.length;f<m;++f){var g=u[f];c+=g-d-1,d=g}return{score:c,indices:u}}r.matchSumOfDeltas=n;function i(s,a,l){for(var u=[],c=0,d=0,f=a.length;c<f;){for(var m=a[c],g=a[c];++c<f&&a[c]===g+1;)g++;d<m&&u.push(s.slice(d,m)),m<g+1&&u.push(l(s.slice(m,g+1))),d=g+1}return d<s.length&&u.push(s.slice(d)),u}r.highlight=i;function o(s,a){return s<a?-1:s>a?1:0}r.cmp=o})(eZ||(eZ={}));var hct=function(){function r(e,t){this._source=e,this._count=t}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.clone(),this._count)},r.prototype.next=function(){if(!(this._count<=0)){var e=this._source.next();if(e!==void 0)return this._count--,e}},r}();var gct=function(){function r(e){this._source=e}return r.prototype.iter=function(){return this},r.prototype.clone=function(){return new r(this._source.map(function(e){return e.clone()}))},r.prototype.next=function(){for(var e=new Array(this._source.length),t=0,n=this._source.length;t<n;++t){var i=this._source[t].next();if(i===void 0)return;e[t]=i}return e},r}();p();var xA=function(){function r(e){this._pid=Qg.nextPID(),this.name=e.name,this._create=e.create,this._coerce=e.coerce||null,this._compare=e.compare||null,this._changed=e.changed||null}return r.prototype.get=function(e){var t,n=Qg.ensureMap(e);return this._pid in n?t=n[this._pid]:t=n[this._pid]=this._createValue(e),t},r.prototype.set=function(e,t){var n,i=Qg.ensureMap(e);this._pid in i?n=i[this._pid]:n=i[this._pid]=this._createValue(e);var o=this._coerceValue(e,t);this._maybeNotify(e,n,i[this._pid]=o)},r.prototype.coerce=function(e){var t,n=Qg.ensureMap(e);this._pid in n?t=n[this._pid]:t=n[this._pid]=this._createValue(e);var i=this._coerceValue(e,t);this._maybeNotify(e,t,n[this._pid]=i)},r.prototype._createValue=function(e){var t=this._create;return t(e)},r.prototype._coerceValue=function(e,t){var n=this._coerce;return n?n(e,t):t},r.prototype._compareValue=function(e,t){var n=this._compare;return n?n(e,t):e===t},r.prototype._maybeNotify=function(e,t,n){var i=this._changed;i&&!this._compareValue(t,n)&&i(e,t,n)},r}();(function(r){function e(t){Qg.ownerData.delete(t)}r.clearData=e})(xA||(xA={}));var Qg;(function(r){r.ownerData=new WeakMap,r.nextPID=function(){var t=0;return function(){var n=Math.random(),i=(""+n).slice(2);return"pid-"+i+"-"+t++}}();function e(t){var n=r.ownerData.get(t);return n||(n=Object.create(null),r.ownerData.set(t,n),n)}r.ensureMap=e})(Qg||(Qg={}));var Ws=function(){function r(e){this._blockedCount=0,this.sender=e}return r.prototype.block=function(e){this._blockedCount++;try{e()}finally{this._blockedCount--}},r.prototype.connect=function(e,t){return ds.connect(this,e,t)},r.prototype.disconnect=function(e,t){return ds.disconnect(this,e,t)},r.prototype.emit=function(e){this._blockedCount||ds.emit(this,e)},r}();(function(r){function e(u,c){var d=ds.blockedProperty;d.set(u,d.get(u)+1);try{c()}finally{d.set(u,d.get(u)-1)}}r.blockAll=e;function t(u,c){ds.disconnectBetween(u,c)}r.disconnectBetween=t;function n(u){ds.disconnectSender(u)}r.disconnectSender=n;function i(u){ds.disconnectReceiver(u)}r.disconnectReceiver=i;function o(u){ds.disconnectAll(u)}r.disconnectAll=o;function s(u){ds.disconnectAll(u)}r.clearData=s;function a(){return ds.exceptionHandler}r.getExceptionHandler=a;function l(u){var c=ds.exceptionHandler;return ds.exceptionHandler=u,c}r.setExceptionHandler=l})(Ws||(Ws={}));var ds;(function(r){r.exceptionHandler=function(A){console.error(A)};function e(A,D,T){T=T||void 0;var K=l.get(A.sender);if(K||(K=[],l.set(A.sender,K)),f(K,A,D,T))return!1;var L=T||D,B=u.get(L);B||(B=[],u.set(L,B));var N={signal:A,slot:D,thisArg:T};return K.push(N),B.push(N),!0}r.connect=e;function t(A,D,T){T=T||void 0;var K=l.get(A.sender);if(!K||K.length===0)return!1;var L=f(K,A,D,T);if(!L)return!1;var B=T||D,N=u.get(B);return L.signal=null,g(K),g(N),!0}r.disconnect=t;function n(A,D){var T=l.get(A);if(!(!T||T.length===0)){var K=u.get(D);!K||K.length===0||(wA(K,function(L){L.signal&&L.signal.sender===A&&(L.signal=null)}),g(T),g(K))}}r.disconnectBetween=n;function i(A){var D=l.get(A);!D||D.length===0||(wA(D,function(T){if(T.signal){var K=T.thisArg||T.slot;T.signal=null,g(u.get(K))}}),g(D))}r.disconnectSender=i;function o(A){var D=u.get(A);!D||D.length===0||(wA(D,function(T){if(T.signal){var K=T.signal.sender;T.signal=null,g(l.get(K))}}),g(D))}r.disconnectReceiver=o;function s(A){i(A),o(A)}r.disconnectAll=s;function a(A,D){if(!(r.blockedProperty.get(A.sender)>0)){var T=l.get(A.sender);if(!(!T||T.length===0))for(var K=0,L=T.length;K<L;++K){var B=T[K];B.signal===A&&m(B,D)}}}r.emit=a;var l=new WeakMap,u=new WeakMap,c=new Set,d=function(){var A=typeof requestAnimationFrame=="function";return A?requestAnimationFrame:setImmediate}();function f(A,D,T,K){return rZ(A,function(L){return L.signal===D&&L.slot===T&&L.thisArg===K})}function m(A,D){var T=A.signal,K=A.slot,L=A.thisArg;try{K.call(L,T.sender,D)}catch(B){r.exceptionHandler(B)}}function g(A){c.size===0&&d(b),c.add(A)}function b(){c.forEach(y),c.clear()}function y(A){CA.removeAllWhere(A,P)}function P(A){return A.signal===null}r.blockedProperty=new xA({name:"blocked",create:function(){return 0}})})(ds||(ds={}));var Yj=require("vscode");var PA=class extends oc{constructor(t,n){super();this.kind=t;this.session=n;this.propertyChanged=new Ws(this);this.kernelChanged=new Ws(this);this.statusChanged=new Ws(this);this.connectionStatusChanged=new Ws(this);this.iopubMessage=new Ws(this);this.unhandledMessage=new Ws(this);this.anyMessage=new Ws(this);this.pendingInput=new Ws(this);this.disposed=new Ws(this);this.didShutdown=this._register(new Yj.EventEmitter);this._onDidKernelSocketChange=this._register(new Yj.EventEmitter);n.propertyChanged.connect(this.onPropertyChanged,this),n.kernelChanged.connect(this.onKernelChanged,this),n.statusChanged.connect(this.onStatusChanged,this),n.connectionStatusChanged.connect(this.onConnectionStatusChanged,this),n.iopubMessage.connect(this.onIOPubMessage,this),n.unhandledMessage.connect(this.onUnhandledMessage,this),n.pendingInput.connect(this.onPendingInput,this),n.anyMessage.connect(this.onAnyMessage,this),this._register({dispose:()=>{this.session.propertyChanged.disconnect(this.onPropertyChanged,this),this.session.kernelChanged.disconnect(this.onKernelChanged,this),this.session.statusChanged.disconnect(this.onStatusChanged,this),this.session.connectionStatusChanged.disconnect(this.onConnectionStatusChanged,this),this.session.iopubMessage.disconnect(this.onIOPubMessage,this),this.session.unhandledMessage.disconnect(this.onUnhandledMessage,this),this.session.pendingInput.disconnect(this.onPendingInput,this),this.session.anyMessage.disconnect(this.onAnyMessage,this)}})}get id(){return this.session.id}get path(){return this.session.path}get name(){return this.session.name}get type(){return this.session.type}get serverSettings(){return this.session.serverSettings}get model(){return this.session.model}get kernel(){return this.isDisposed||!this.session.kernel?null:this.session.kernel}get onDidShutdown(){return this.didShutdown.event}get kernelId(){var t,n;return((n=(t=this.session)==null?void 0:t.kernel)==null?void 0:n.id)||""}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}dispose(){this.isDisposed||(super.dispose(),this.statusChanged.emit("dead"),this.disposed.emit(),Ws.disconnectAll(this))}async restart(){var t,n,i;await((t=this.session.kernel)==null?void 0:t.restart()),this.initializeKernelSocket(),w.info(`Restarted ${(i=(n=this.session)==null?void 0:n.kernel)==null?void 0:i.id}`)}initializeKernelSocket(){var n,i,o,s,a,l;if(!this.session.kernel)throw new Error("Kernel not initialized in Session");let t={kernel:this.session.kernel,options:{clientId:this.session.kernel.clientId,id:this.session.kernel.id,model:{...this.session.kernel.model},userName:this.session.kernel.username},socket:Mo.get(this.session.kernel.id)};JSON.stringify((n=this.previousKernelSocketInformation)==null?void 0:n.kernel.model)===JSON.stringify(t.kernel.model)&&((i=this.previousKernelSocketInformation)==null?void 0:i.kernel)===t.kernel&&((o=this.previousKernelSocketInformation)==null?void 0:o.kernel.id)===t.kernel.id&&((s=this.previousKernelSocketInformation)==null?void 0:s.socket)===t.socket||(this.previousKernelSocketInformation=t,(a=this.session.kernel)==null||a.connectionStatusChanged.disconnect(this.onKernelConnectionStatusHandler,this),(l=this.session.kernel)==null||l.connectionStatusChanged.connect(this.onKernelConnectionStatusHandler,this),this._onDidKernelSocketChange.fire())}onPropertyChanged(t,n){this.propertyChanged.emit(n)}onKernelChanged(t,n){this.kernelChanged.emit(n)}onStatusChanged(t,n){this.statusChanged.emit(n);let i=this.status;w.ci(`Server Status = ${i}`)}onConnectionStatusChanged(t,n){this.connectionStatusChanged.emit(n)}onIOPubMessage(t,n){this.iopubMessage.emit(n)}onUnhandledMessage(t,n){w.warn(`Unhandled message found: ${n.header.msg_type}`),this.unhandledMessage.emit(n)}onAnyMessage(t,n){this.anyMessage.emit(n)}onPendingInput(t,n){this.pendingInput.emit(n)}setPath(t){return this.session.setPath(t)}setName(t){return this.session.setName(t)}setType(t){return this.session.setType(t)}changeKernel(t){return this.session.changeKernel(t)}onKernelConnectionStatusHandler(t,n){w.ci(`Server Kernel Status = ${n}`)}};var DA=class extends PA{constructor(t,n,i,o,s){super(zt(i)?"localJupyter":"remoteJupyter",t);this.resource=n;this.kernelConnectionMetadata=i;this.kernelService=o;this.creator=s;this.isShuttingDown=!1;this.initializeKernelSocket()}get status(){var t,n;return this.isDisposed?"dead":(t=this.session)!=null&&t.kernel?this.session.kernel.status:(w.ci(`Kernel status not started because real session is ${this.session?"defined":"undefined"} & real kernel is ${(n=this.session)!=null&&n.kernel?"defined":"undefined"}`),"unknown")}dispose(){var t,n;(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!1).finally(()=>super.dispose())}async waitForIdle(t,n){try{await EA(this.kernelConnectionMetadata,this.resource,this.session,t,n)}catch(i){throw w.ci("Error waiting for idle",i),await this.shutdown().catch(E),i}}async restart(){let t=[],n=new TA.CancellationTokenSource;this.restartToken=n;let i=new hr(!1);t.push(i),t.push(n);try{await this.validateLocalKernelDependencies(n.token,i),await super.restart()}finally{Ce(t)}}async validateLocalKernelDependencies(t,n){var i;if(!(!((i=this.kernelConnectionMetadata)!=null&&i.interpreter)||!zt(this.kernelConnectionMetadata)||!this.kernelService)){if(t.isCancellationRequested)throw new TA.CancellationError;await this.kernelService.ensureKernelIsUsable(this.resource,this.kernelConnectionMetadata,n,t,this.creator==="3rdPartyExtension")}}async shutdown(){var t,n;return(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!0)}async shutdownImplementation(t){var o;if(this.isDisposed||this.isShuttingDown)return;this.isShuttingDown=!0;let n=(new Error().stack||"").split(`
`).filter(s=>s.includes(Je));w.trace(`Shutdown session - current session, called from 
 ${n.map(s=>`    ${s}`).join(`
`)}`);let i=`${(o=this.session.kernel)==null?void 0:o.id}, ${this.kernelConnectionMetadata.id}`;w.debug(`shutdownSession ${i} - start`);try{if(t||this.canShutdownSession())try{w.debug(`Session can be shutdown ${this.kernelConnectionMetadata.id}`),ZX(this.session.kernel),this.session.isDisposed||await fo(1e3,this.session.shutdown().catch(E))}catch(s){try{this.session.isDisposed||this.session.dispose()}catch(a){w.warn("Failures in disposing the session",a)}}finally{this.didShutdown.fire()}else w.debug(`Session cannot be shutdown ${this.kernelConnectionMetadata.id}`);try{this.session.isDisposed||this.session.dispose()}catch(s){w.warn("Failures in disposing the session",s)}super.dispose(),w.trace("Shutdown session -- complete")}catch(s){w.warn("Failures in disposing the session",s)}w.debug(`shutdownSession ${i} - shutdown complete`)}canShutdownSession(){return zt(this.kernelConnectionMetadata)?!0:this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?!1:this.resource&&Rl(this.resource)==="interactive"?!0:!(this.resource&&Rl(this.resource)==="notebook"&&Wt(this.kernelConnectionMetadata))}};var Jd=class{constructor(e,t,n,i,o){this.jupyterNotebookProvider=e;this.jupyterConnection=t;this.asyncDisposables=n;this.kernelService=i;this.configService=o}async create(e){let t=[],n,i=()=>{e.ui.disableUI||n||(n=Kt.createProgressReporter(e.resource,Wt(e.kernelConnection)?W.connectingToJupyter:W.startingJupyter),t.push(n))};e.ui.disableUI&&e.ui.onDidChangeDisableUI(i,this,t),i();let o,s=[],a=this.configService.getSettings(e.resource).jupyterLaunchTimeout;try{o=Wt(e.kernelConnection)?await cs(e.token,this.jupyterConnection.createConnectionInfo(e.kernelConnection.serverProviderHandle)):await this.jupyterNotebookProvider.getOrStartServer({resource:e.resource,token:e.token,ui:e.ui}),await cs(e.token,this.validateLocalKernelDependencies(e));let l=Qf.create(o.settings);this.asyncDisposables.push({dispose:()=>Ag(l)}),s.push(l),await cs(e.token,this.validateRemoteServer(e,l));let u=await this.connectToOrCreateSession({...e,contentsManager:l.contentsManager,sessionManager:l.sessionManager,kernelManager:l.kernelManager,kernelSpecManager:l.kernelSpecManager,idleTimeout:a,connection:o});e.token.isCancellationRequested&&(await u.shutdown().catch(E),zs(()=>u.dispose())),Kd.throwIfCanceled(e.token),w.info(`Started session for kernel ${e.kernelConnection.kind}:${e.kernelConnection.id}`);let c=new DA(u,e.resource,e.kernelConnection,this.kernelService,e.creator),d=u.disposed,f=()=>{l.dispose(),d.disconnect(f)};this.asyncDisposables.push({dispose:()=>c.shutdown().finally(()=>c.dispose())}),u.disposed.connect(f);let m=c.onDidDispose(f);return this.asyncDisposables.push(m),c}catch(l){throw Ce(s),Wt(e.kernelConnection)?o?Ms.isSelfCertsError(l)?new Ms(o.baseUrl):Zc.isSelfCertsExpiredError(l)?new Zc(o.baseUrl):new oo(o.baseUrl,e.kernelConnection.serverProviderHandle,l):l:l instanceof ot?l:new IA(l)}finally{Ce(t)}}async validateRemoteServer(e,t){if(t.isDisposed)throw new zr;if(!zt(e.kernelConnection))try{await Promise.all([t.getRunningKernels(),t.getKernelSpecs()])}catch(n){throw w.error("Failed to fetch running kernels from remote server, connection may be outdated or remote server may be unreachable",n),new oo(e.kernelConnection.baseUrl,e.kernelConnection.serverProviderHandle,n)}}async validateLocalKernelDependencies(e){var t;if(e.token.isCancellationRequested)throw new kA.CancellationError;(t=e.kernelConnection)!=null&&t.interpreter&&zt(e.kernelConnection)&&this.kernelService&&await this.kernelService.ensureKernelIsUsable(e.resource,e.kernelConnection,e.ui,e.token,e.creator==="3rdPartyExtension")}async connectToOrCreateSession(e){var n;if(e.token.isCancellationRequested)throw new kA.CancellationError;let t;try{if(e.kernelConnection&&e.kernelConnection.kind==="connectToLiveRemoteKernel"&&e.kernelConnection.kernelModel.id&&e.kernelConnection.kernelModel.model){if(!e.kernelConnection.kernelModel.model)throw new Error("Kernel model not defined when connecting to an existing session");t=e.sessionManager.connectTo({...e.kernelConnection.kernelModel,model:e.kernelConnection.kernelModel.model}),await cs(e.token,pD(async()=>{var i;return((i=t.kernel)==null?void 0:i.connectionStatus)==="connected"||e.token.isCancellationRequested},e.idleTimeout,100))}else w.trace(`createNewKernelSession ${(n=e.kernelConnection)==null?void 0:n.id}`),t=await this.createNewSession(e),await EA(e.kernelConnection,e.resource,t,e.idleTimeout,e.token).catch(E);if(e.token.isCancellationRequested)throw new kA.CancellationError;return t}catch(i){let o=e.ui.disableUI?w.debug:w.error;throw i instanceof ot?(o("Failed to change kernel, re-throwing",i),i):(o("Failed to change kernel",i),new zg(e.kernelConnection))}}async createNewSession(e){var a,l,u,c,d,f;let t=(e.connection,e.resource,void 0),n=t==null?void 0:t.path,i=(c=(u=Jz(e.kernelConnection))!=null?u:(l=(a=e.kernelSpecManager)==null?void 0:a.specs)==null?void 0:l.default)!=null?c:"",o;if(t!=null&&t.name)o=t.name;else{let m=e.resource?zv(e.resource):"";o=`${e.resource?mi(e.resource,m):""}-${(0,NA.default)()}${m}`}let s={path:n||LIe(e.resource),kernel:{name:i},name:o,type:(((d=e.resource)==null?void 0:d.path)||"").toLowerCase().endsWith(".ipynb")?"notebook":"console"};try{let m=await cs(e.token,e.sessionManager.startNew(s,{kernelConnectionOptions:{handleComms:!0}}));if(!m.kernel)throw new PI(new Error("No kernel created"));return w.info(W.createdNewKernel(e.connection.baseUrl,((f=m==null?void 0:m.kernel)==null?void 0:f.id)||"")),m}catch(m){throw m instanceof PI?m:new PI(m)}}};Jd=U([(0,pu.injectable)(),x(0,(0,pu.inject)(wR)),x(1,(0,pu.inject)(pn)),x(2,(0,pu.inject)(Wu)),x(3,(0,pu.inject)(xR)),x(3,(0,pu.optional)()),x(4,(0,pu.inject)(Ke))],Jd);function OIe(){return`${Gf}${(0,NA.default)()}`}function LIe(r){let e=`${OIe()}${(0,NA.default)()}.ipynb`;return r?`${mi(r,".ipynb")}${e}`:`${W.defaultNotebookName}${e}`}var DI=class{constructor(e,t,n){this.rawKernelSupported=e;this.newRawKernelSessionFactory=t;this.newJupyterSessionFactory=n}async create(e){let t=e.kernelConnection;return this.rawKernelSupported.isSupported&&zt(t)&&this.newRawKernelSessionFactory?this.newRawKernelSessionFactory.create({...e,kernelConnection:t}):this.newJupyterSessionFactory.create(e)}};DI=U([(0,dm.injectable)(),x(0,(0,dm.inject)(Hd)),x(1,(0,dm.inject)(RX)),x(1,(0,dm.optional)()),x(2,(0,dm.inject)(Jd))],DI);p();var vP=Symbol("RemoteKernelFinderController");function nZ(r,e){r.addSingleton(Ll,Ll),r.addSingleton(xR,Gg),r.addSingleton(dr,_I),r.addSingleton(Gx,DI),r.addSingleton(Jd,Jd),r.addSingleton(wR,II),r.addSingleton(jg,wI),r.addSingleton(pn,pn),r.addSingleton(Bg,EI),r.addBinding(Bg,Ve),r.addSingleton(DR,SI),r.addSingleton(dn,bI),r.addSingleton(vP,qd),r.addBinding(vP,Ve),r.addSingleton(sr,OS)}var yZ=se(ge());p();var fn=se(ge());p();var ai=require("vscode");var RA=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.executions=new WeakMap;this.kernelsByNotebook=new WeakMap;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new ai.EventEmitter;this._onDidStartKernel=new ai.EventEmitter;this._onDidCreateKernel=new ai.EventEmitter;this._onDidDisposeKernel=new ai.EventEmitter;this._onKernelStatusChanged=new ai.EventEmitter;this._onDidPostInitializeKernel=new ai.EventEmitter;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),ai.workspace.onDidCloseNotebookDocument(n=>this.disposeOldKernel(n,"notebookClosed"),this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel),t.push(this._onDidPostInitializeKernel)}get kernels(){let e=new Set;return ai.workspace.notebookDocuments.forEach(t=>{let n=this.get(t);n&&e.add(n)}),Array.from(e)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get onDidPostInitializeKernel(){return this._onDidPostInitializeKernel.event}get(e){var t,n;if(pi(e)){let i=ai.workspace.notebookDocuments.find(o=>o.uri.toString()===e.toString());return i?this.get(i):void 0}else return typeof e=="string"?(t=this.kernelsById.get(e))==null?void 0:t.kernel:(n=this.kernelsByNotebook.get(e))==null?void 0:n.kernel}getKernelExecution(e){return this.executions.get(e)}getInternal(e){return this.kernelsByNotebook.get(e)}async dispose(){w.ci("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByNotebook.set(e,{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e){e.onDisposed(()=>{this.get(e.notebook)===e&&(this.kernelsByNotebook.delete(e.notebook),this.kernelsById.delete(e.id),w.debug(`Kernel got disposed, hence there is no longer a kernel associated with ${Ee(e.uri)}`)),this.pendingDisposables.delete(e)},this,this.disposables)}disposeOldKernel(e,t){let n=this.kernelsByNotebook.get(e);n&&(w.debug(`Disposing kernel associated with ${Ee(e.uri)}, isClosed=${e.isClosed}, reason = ${t}`),this.kernelsById.delete(n.kernel.id),this.pendingDisposables.add(n.kernel),n.kernel.dispose().catch(i=>w.warn("Failed to dispose old kernel",i)).finally(()=>this.pendingDisposables.delete(n.kernel)).catch(E)),this.kernelsByNotebook.delete(e)}handleServerRemoval(e){ai.workspace.notebookDocuments.forEach(t=>{let n=this.kernelsByNotebook.get(t);if(n){let i=n.options.metadata;(i.kind==="connectToLiveRemoteKernel"||i.kind==="startUsingRemoteKernelSpec")&&e.find(s=>s.id===i.serverProviderHandle.id&&s.handle===i.serverProviderHandle.handle)&&(this.kernelsByNotebook.delete(t),this.kernelsById.delete(n.kernel.id))}})}},AA=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.kernelsByUri=new Map;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new ai.EventEmitter;this._onDidStartKernel=new ai.EventEmitter;this._onDidCreateKernel=new ai.EventEmitter;this._onDidDisposeKernel=new ai.EventEmitter;this._onDidPostInitializeKernel=new ai.EventEmitter;this._onKernelStatusChanged=new ai.EventEmitter;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),ai.workspace.onDidCloseNotebookDocument(n=>{w.debug(`Notebook document ${Ee(n.uri)} got closed`),this.disposeOldKernel(n.uri)},this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel),t.push(this._onDidPostInitializeKernel)}get kernels(){return Array.from(this.kernelsByUri.values()).map(e=>e.kernel)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get onDidPostInitializeKernel(){return this._onDidPostInitializeKernel.event}get(e){var t,n;return((t=this.kernelsByUri.get(e.toString()))==null?void 0:t.kernel)||((n=this.kernelsById.get(e.toString()))==null?void 0:n.kernel)}getInternal(e){return this.kernelsByUri.get(e.toString())}async dispose(){w.ci("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByUri.set(e.toString(),{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e,t){t.onDisposed(()=>{this.get(e)===t&&(this.kernelsByUri.delete(e.toString()),this.kernelsById.delete(t.id),w.debug(`Kernel got disposed, hence there is no longer a kernel associated with ${Ee(e)}`)),this.pendingDisposables.delete(t)},this,this.disposables)}disposeOldKernel(e){let t=this.kernelsByUri.get(e.toString());t&&(w.ci(`Disposing kernel associated with ${Ee(e)}`),this.kernelsById.delete(t.kernel.id),this.pendingDisposables.add(t.kernel),t.kernel.dispose().catch(n=>w.warn("Failed to dispose old kernel",n)).finally(()=>this.pendingDisposables.delete(t.kernel)).catch(E)),this.kernelsByUri.delete(e.toString())}};p();var zj=se($g()),Tr=require("vscode");var sZ=se(tA());p();var $j="KERNEL_INFO",KIe=1e3*60*60*24*2;async function oZ(r,e,t){var a;let n=[],i={banner:"",help_links:[],implementation:"",implementation_version:"",language_info:{name:"",version:""},protocol_version:"",status:"ok"};if(!r.kernel)return;(a=r.kernel)!=null&&a.info&&(n.push(r.kernel.info),r.kernel.info.then(l=>iZ(t,e,l)).catch(E));let o=r.kernel.requestKernelInfo().then(l=>l==null?void 0:l.content);if(n.push(o),o.then(l=>iZ(t,e,l)).catch(E),e.kind==="connectToLiveRemoteKernel"){let l=FIe(t,e);l?n.push(Promise.resolve(l)):n.push(tc(5e3).then(()=>i))}let s=await Promise.race(n);return s===i?w.warn("Failed to Kernel info in a timely manner, defaulting to empty info!"):w.trace("Got Kernel info"),s}async function iZ(r,e,t){if(!t||!Wt(e))return;let n=r.get($j,[]).filter(i=>Date.now()-i.age<KIe).filter(i=>i.id!==e.id);n.push({id:e.id,age:Date.now(),info:t}),await r.update($j,n)}function FIe(r,e){var t;if(Wt(e))return(t=r.get($j,[]).find(n=>n.id===e.id))==null?void 0:t.info}p();var MA=class extends _i{constructor(e){super("kernelpromisetimeout",W.interruptingKernelFailed,e)}};var OA="e976ee50-99ed-4aba-9b6b-9dcd5634d07d:IPyWidgets:";function yP(r){let e=typeof r=="string"?r:"";return typeof r!="string"&&"content"in r&&"code"in r.content&&typeof r.content.code=="string"&&(e=r.content.code),!e.includes(OA)}function UA(r){var e,t,n,i;return r.status==="dead"||r.status==="terminating"&&!r.disposed&&!r.disposing||!r.disposed&&!r.disposing&&(((e=r.session)==null?void 0:e.status)=="unknown"||((n=(t=r.session)==null?void 0:t.kernel)==null?void 0:n.status)=="unknown")&&(((i=r.session.kernel)==null?void 0:i.isDisposed)||r.session.isDisposed)}function aZ(r){var e,t;return r.status==="dead"||r.status==="terminating"&&!r.isDisposed||!r.isDisposed&&(r.status=="unknown"||((e=r.kernel)==null?void 0:e.status)=="unknown")&&(((t=r.kernel)==null?void 0:t.isDisposed)||r.isDisposed)}var LA=class{constructor(e,t,n,i,o,s,a,l,u){this.id=e;this.uri=t;this.resourceUri=n;this.kernelConnectionMetadata=i;this.sessionCreator=o;this.kernelSettings=s;this.startupCodeProviders=a;this._creator=l;this.workspaceMemento=u;this.disposables=[];this._onIPyWidgetVersionResolved=new Tr.EventEmitter;this._onDidKernelSocketChange=new Tr.EventEmitter;this._onStatusChanged=new Tr.EventEmitter;this._onRestarted=new Tr.EventEmitter;this._onStarted=new Tr.EventEmitter;this._onPostInitialized=new Tr.EventEmitter;this._onDisposed=new Tr.EventEmitter;this.hookedSessionForEvents=new WeakSet;this.hooks=new Map;this.startCancellation=new Tr.CancellationTokenSource;this.startupUI=new hr(!0);this.disposables.push(this._onStatusChanged),this.disposables.push(this._onRestarted),this.disposables.push(this._onStarted),this.disposables.push(this._onDisposed),this.disposables.push(this._onIPyWidgetVersionResolved),this.disposables.push(this._onDidKernelSocketChange),eP(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,disableUI:this.startupUI.disableUI}).catch(E),this.startupUI.onDidChangeDisableUI(()=>{this.startupUI.disableUI||eP(this.resourceUri,{disableUI:!1}).catch(E)},this.disposables)}get ipywidgetsVersion(){return this._ipywidgetsVersion}get onIPyWidgetVersionResolved(){return this._onIPyWidgetVersionResolved.event}get onStatusChanged(){return this._onStatusChanged.event}get onRestarted(){return this._onRestarted.event}get onStarted(){return this._onStarted.event}get onPostInitialized(){return this._onPostInitialized.event}get onDisposed(){return this._onDisposed.event}get creator(){return this._creator}get startedAtLeastOnce(){return this._startedAtLeastOnce}get userStartedKernel(){return!this.startupUI.disableUI}get info(){return this._info}get status(){var e,t;return this._jupyterSessionPromise&&!this._session?"starting":(t=(e=this._session)==null?void 0:e.status)!=null?t:this.isKernelDead?"dead":"unknown"}get disposed(){var e;return this._disposed===!0||((e=this._session)==null?void 0:e.isDisposed)===!0}get disposing(){return this._disposing===!0}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}get session(){return this._session}get restarting(){return this._restartPromise||Promise.resolve()}addHook(e,t,n,i){let o=this.hooks.get(e)||new Set;this.hooks.set(e,o),t=n?t.bind(n):t,o.add(t);let s={dispose:()=>{o.delete(t)}};return i&&i.push(s),s}async start(e){return this.startCancellation.token.isCancellationRequested&&(this.startCancellation.dispose(),this.startCancellation=new Tr.CancellationTokenSource),this.startJupyterSession(e).then(t=>(!(e!=null&&e.disableUI)&&!this._postInitializedOnStart&&(this._onPostInitialized.fire(),this._postInitializedOnStart=!0),t))}async interrupt(){let e=Promise.all(Array.from(this.hooks.get("willInterrupt")||new Set).map(n=>n()));w.info(`Interrupt requested ${Ee(this.resourceUri||this.uri)}`);let t;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;w.info("Interrupt kernel execution"),n?(t=this._interruptPromise?await this._interruptPromise:await(this._interruptPromise=this.interruptExecution(n,e)),this._interruptPromise=void 0):(w.info("No kernel session to interrupt"),this._interruptPromise=void 0,t="success")}finally{await Promise.all(Array.from(this.hooks.get("interruptCompleted")||new Set).map(n=>n())).catch(E)}if(w.info(`Interrupt requested & sent for ${Ee(this.uri)} in notebookEditor.`),t==="timeout"){let n=W.restartKernelAfterInterruptMessage(ut(this.kernelConnectionMetadata)),i=W.restartKernelMessageYes;await Tr.window.showInformationMessage(n,{modal:!0},i)===i&&await this.restart()}}async dispose(){if(w.info(`Dispose Kernel '${Ee(this.uri)}' associated with '${Ee(this.resourceUri)}'`),this._disposing=!0,this.disposingPromise)return this.disposingPromise;this._ignoreJupyterSessionDisposedErrors=!0,this.startCancellation.cancel();let e=async()=>{let t=[];t.push(Promise.all(Array.from(this.hooks.get("willCancel")||new Set).map(n=>n())).then(E).catch(E)),this._session=this._session?this._session:this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0,this._jupyterSessionPromise=void 0,this._session&&(t.push(Ag(this._session,this.disposables)),this._session=void 0),this._disposed=!0,this._onDisposed.fire(),this._onStatusChanged.fire("dead");try{await Promise.all(t)}finally{this.startCancellation.dispose(),Ce(this.disposables)}};this.disposingPromise=e(),await this.disposingPromise}async restart(){try{let e=Rl(this.resourceUri);w.info(`Restart requested ${Ee(this.uri)}`),await Promise.all(Array.from(this.hooks.get("willRestart")||new Set).map(n=>n(this._jupyterSessionPromise))),this.startCancellation.cancel(),this.startCancellation.dispose();let t=new It;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;n?(this._restartPromise||(this._restartPromise=n.restart(),this._restartPromise.finally(()=>this._restartPromise=void 0).catch(E)),await this._restartPromise,this.startCancellation=new Tr.CancellationTokenSource):await this.start(new hr(!1)),Br(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},{resourceType:e})}catch(n){w.error(`Restart failed ${Ee(this.uri)}`,n),this._ignoreJupyterSessionDisposedErrors=!0;let i=this._session;throw this._session=void 0,this._jupyterSessionPromise=void 0,Br(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},void 0,n),i&&await Ag(i,this.disposables),this._ignoreJupyterSessionDisposedErrors=!1,n}await this.initializeAfterStart(this._session),this._onRestarted.fire(),this._onPostInitialized.fire()}catch(e){throw w.error(`Failed to restart kernel ${Ee(this.uri)}`,e),e}finally{Promise.all(Array.from(this.hooks.get("restartCompleted")||new Set).map(e=>e())).catch(E)}}async startJupyterSession(e=new hr(!1)){if(this._startedAtLeastOnce=!0,e.disableUI||(this.startupUI.disableUI=!1),e.onDidChangeDisableUI(()=>{!e.disableUI&&this.startupUI.disableUI&&(this.startupUI.disableUI=!1)},this.disposables),this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||Ol(this.resourceUri,this.kernelConnectionMetadata).catch(E)},this,this.disposables),this.disposing)throw new Tr.CancellationError;if(Kd.throwIfCanceled(this.startCancellation.token),!this._jupyterSessionPromise){let t=new It;this._jupyterSessionPromise=this.createJupyterSession();try{let n=await this._jupyterSessionPromise;return Br(this.resourceUri,"DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",{duration:t.elapsedTime}),n}catch(n){throw w.ci(`Failed to create Jupyter Session in Kernel.startNotebook for ${Ee(this.uri)}`),this.startCancellation.cancel(),this._jupyterSessionPromise=void 0,n}}return this._jupyterSessionPromise}async interruptExecution(e,t){let n=Re(),i=new It,o=[],s=u=>{(u==="restarting"||u==="autorestarting")&&(w.warn("Kernel restarting during interrupt"),n.resolve(!0))},a=(u,c)=>s(c);return e.statusChanged.connect(a),o.push(new Tr.Disposable(()=>zs(()=>e.statusChanged.disconnect(a)))),e&&e.kernel&&(w.info(`Interrupting kernel: ${e.kernel.name}`),await Hv(this.kernelSettings.interruptTimeout,new MA(this.kernelConnectionMetadata),e.kernel.interrupt()).catch(u=>{w.warn(`Error during interrupt: ${u}`),n.resolve(!0)})),(async()=>{let u=Re();this.status==="busy"&&(this.onDisposed(()=>u.resolve("dead"),this,o),this.onStatusChanged(()=>this.status==="dead"?u.resolve("dead"):void 0,this,o));try{return await fo(this.kernelSettings.interruptTimeout,"timeout",t.then(()=>"success"),n.promise.then(()=>"restart"),u.promise)}catch(c){if(n.completed)return"restart";throw Br(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},void 0,c),c}finally{Ce(o)}})().then(u=>(Br(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},{result:u}),u))}async createJupyterSession(){var i;let e=Tr.workspace.notebookDocuments.find(o=>o.uri.toString()===this.uri.toString()),t=e?(i=Uc(e))==null?void 0:i.jupyterSessionTelemetry():void 0;if(await eP(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,userExecutedCell:!this.startupUI.disableUI}),t==null||t.stop(),this.disposing)throw new Tr.CancellationError;Kd.throwIfCanceled(this.startCancellation.token);let n=[];try{w.info(`Starting Kernel ${WIe(this,this.startupUI)}`),this.createProgressIndicator(n),this.isKernelDead=!1,this._onStatusChanged.fire("starting");let o=await this.sessionCreator.create({resource:this.resourceUri,ui:this.startupUI,kernelConnection:this.kernelConnectionMetadata,token:this.startCancellation.token,creator:this.creator});if(this.disposing)throw new Tr.CancellationError;if(Kd.throwIfCanceled(this.startCancellation.token),await this.initializeAfterStart(o),this.disposing)throw new Tr.CancellationError;return this.sendKernelStartedTelemetry(),this._session=o,this._onStarted.fire(),w.info("Kernel successfully started"),o}catch(o){if(this.startupUI.disableUI?w.trace(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,o):!this.startCancellation.token&&!Yn(o)&&w.error(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,o),Kd.throwIfCanceled(this.startCancellation.token),o instanceof Ap)throw o;let s=W.sessionStartFailedWithKernel(ut(this.kernelConnectionMetadata));throw Ln.from(s+" "+("message"in o?o.message:o.toString()),o)}finally{Ce(n)}}sendKernelStartedTelemetry(){this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent&&this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent===this.startupUI.disableUI||this.startTelemetrySent&&!this.startupUI.disableUI||(this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent=this.startupUI.disableUI===!0,this.startTelemetrySent=!0,Br(this.resourceUri,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:this.startupUI.disableUI}))}createProgressIndicator(e){let t=Kt.createProgressReporter(this.resourceUri,W.connectingToKernel(ut(this.kernelConnectionMetadata)),this.startupUI.disableUI);e.push(t),this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||t.show&&t.show()},this,e)}async initializeAfterStart(e){var o;let t=Tr.workspace.notebookDocuments.find(s=>s.uri.toString()===this.uri.toString()),n=Uc(t),i=t?n==null?void 0:n.postKernelStartup():void 0;try{if(await Promise.all(Array.from(this.hooks.get("didStart")||new Set).map(l=>l(e,this.startCancellation.token).catch(E))),w.trace(`Started running kernel initialization for ${Ee(this.uri)}`),!e){w.trace("Not running kernel initialization");return}if(!this.hookedSessionForEvents.has(e)){this.hookedSessionForEvents.add(e),e.onDidKernelSocketChange(u=>this._onDidKernelSocketChange.fire(u)),e.onDidDispose(()=>{if(w.ci(`Kernel got disposed as a result of session.onDisposed (1) ${Ee(this.resourceUri||this.uri)}`),!this._ignoreJupyterSessionDisposedErrors){w.info(`Kernel got disposed as a result of session.onDisposed ${Ee(this.resourceUri||this.uri)} & _ignoreJupyterSessionDisposedErrors = false.`);let u=this._session===e;this._jupyterSessionPromise=void 0,this._session=void 0,u&&(this.isKernelDead=!0,this._onStatusChanged.fire("dead"))}});let l=(u,c)=>this._onStatusChanged.fire(c);e.statusChanged.connect(l),this.disposables.push(new Tr.Disposable(()=>zs(()=>e.statusChanged.disconnect(l))))}if((o=e.kernel)==null||o.registerCommTarget(nt.DefaultCommTarget,E),this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel")this.determineVersionOfIPyWidgets(e).catch(l=>w.error("Failed to determine IPyWidget version",l)),this.gatherInternalStartupCode().then(l=>this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"})).catch(l=>w.error("Failed to execute internal startup code",l));else{await this.determineVersionOfIPyWidgets(e);let l=await this.gatherInternalStartupCode();await this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"}),await this.executeSilently(e,this.getUserStartupCommands(),{traceErrors:!1})}i==null||i.stop();let s=n==null?void 0:n.kernelInfo();try{w.debug("Requesting Kernel info"),this._info=await oZ(e,this.kernelConnectionMetadata,this.workspaceMemento)}catch(l){w.warn("Failed to request KernelInfo",l)}s==null||s.stop();let a=n==null?void 0:n.kernelIdle();this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&(w.trace("End running kernel initialization, now waiting for idle"),await e.waitForIdle(this.kernelSettings.launchTimeout,this.startCancellation.token),w.trace("End running kernel initialization, session is idle")),a==null||a.stop()}finally{i==null||i.stop()}}async determineVersionOfIPyWidgets(e){var n;if(!jt(this.kernelConnectionMetadata)){this._ipywidgetsVersion==VE,this._onIPyWidgetVersionResolved.fire(VE);return}let t=async()=>{let i=sZ.default`
        try:
            import ipywidgets as _VSCODE_ipywidgets
            print("${OA}" + _VSCODE_ipywidgets.__version__)
            del _VSCODE_ipywidgets
        except:
            pass
        `,o=await this.executeSilently(e,[i]).catch(s=>w.error("Failed to determine version of IPyWidgets",s));if(Array.isArray(o)){let s=o.some(u=>{var c;return(c=u.text||"")==null?void 0:c.toString().includes(`${OA}8.`)}),a=o.some(u=>{var c;return(c=u.text||"")==null?void 0:c.toString().includes(`${OA}7.`)}),l=this._ipywidgetsVersion=a?7:s?8:void 0;w.trace(`Determined IPyWidgets Version as ${l}`),this._ipywidgetsVersion==l,this._onIPyWidgetVersionResolved.fire(l)}else w.warn("Failed to determine IPyKernel Version",JSON.stringify(o))};if(await t(),!this._ipywidgetsVersion&&((n=this.session)!=null&&n.kernel)){let i=(o,s)=>{var l;if(s.direction==="send")return;let a=s.msg;a.content&&"data"in a.content&&a.content.data&&(a.content.data[po]||"target_name"in a.content&&a.content.target_name===nt.DefaultCommTarget)&&(this._ipywidgetsVersion||(t().catch(E),(l=this.session)!=null&&l.kernel&&this.session.kernel.anyMessage.disconnect(i,this)))};this.session.kernel.anyMessage.connect(i,this)}}async gatherInternalStartupCode(){let e=[],t=await Promise.all(this.startupCodeProviders.sort((n,i)=>i.priority-n.priority).map(n=>n.getCode(this)));for(let n of t)e.push(...n);if(jt(this.kernelConnectionMetadata)&&this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"){let n=lt(this.resourceUri);n&&e.push(`__vsc_ipynb_file__ = "${n.replace(/\\/g,"\\\\")}"`),this.kernelSettings.enableExtendedPythonKernelCompletions||e.push(KE.DisableJedi),e.push(...UIe(this.getMatplotLibInitializeCode(),"Failed to initialize matplotlib startup code. Matplotlib might be missing."))}return e}getMatplotLibInitializeCode(){let e=[];if(this.kernelSettings.themeMatplotlibPlots){w.ci(`Initialize config for plots for ${Ee(this.resourceUri||this.uri)}`);let t=KE.MatplotLibInit;w.trace(`Initialize matplotlib for ${Ee(this.resourceUri||this.uri)}`),e.push(...at(t,{trim:!1}));let n=Tr.window.activeColorTheme.kind===Tr.ColorThemeKind.Dark;e.push(n?"matplotlib.style.use('dark_background')":`matplotlib.rcParams.update(${nt.MatplotLibDefaultParams})`)}return e}getUserStartupCommands(){let e=this.kernelSettings.runStartupCommands;if(Array.isArray(e)&&(e=e.join(`
`)),e){let t=e.replace(/\\n/g,`
`);return at(t,{trim:!1})}return[]}async executeSilently(e,t,n){if(t.join("").trim().length!==0){if(!e.kernel){w.trace(`Not executing startup as there is no session, code: ${t}`);return}return Mi(e.kernel,t.join(`
`),n)}}},KA=class extends LA{get creator(){return"3rdPartyExtension"}constructor(e,t,n,i,o,s,a){super(`3rdPartyKernel_${(0,zj.default)()}`,e,t,n,i,o,s,"3rdPartyExtension",a)}},FA=class extends LA{constructor(t,n,i,o,s,a,l,u){super((0,zj.default)(),n.uri,t,i,o,s,l,"jupyterExtension",u);this.notebook=n;this.controller=a}get creator(){return"jupyterExtension"}};function UIe(r,e){return!r||r.length===0||(r=r.map(t=>`    ${t}`),r.unshift("try:"),r.push("except:",`    print('${e}')`)),r}function WIe(r,e){let t=r.kernelConnectionMetadata.interpreter,n=[];if(t){n.push(`Python Path: ${Ee(t.uri)}`),n.push(t?Jr(t):"");let i=Fu(t);i&&n.push(`${i.major}.${i.minor}.${i.micro}`)}else(r.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||r.kernelConnectionMetadata.kind==="startUsingRemoteKernelSpec")&&n.push(r.kernelConnectionMetadata.kernelSpec.display_name);return`(${n.filter(i=>i).join(", ")}) for '${Ee(r.uri)}' (disableUI=${e.disableUI})`}p();function Qj(r,e){return{get enableExtendedPythonKernelCompletions(){return r.getSettings(e).enableExtendedPythonKernelCompletions},get interruptTimeout(){return r.getSettings(e).jupyterInterruptTimeout},get launchTimeout(){return r.getSettings(e).jupyterLaunchTimeout},get runStartupCommands(){return r.getSettings(e).runStartupCommands},get themeMatplotlibPlots(){return r.getSettings(e).themeMatplotlibPlots}}}p();var Xg=require("vscode");p();var Zj=require("vscode");p();var Xj=se(zV()),kr=require("vscode");p();var WA=se(ge()),lZ=require("vscode");var rn=class{static dispose(){Ce(rn.disposables)}constructor(e){e.push({dispose:()=>{rn.dispose()}})}activate(){lZ.workspace.onDidChangeNotebookDocument(e=>{mr(e.notebook)&&e.cellChanges.filter(t=>{var n;return((n=t.outputs)==null?void 0:n.length)===0}).map(t=>{var i;let n=rn.cellToDisplayIdMapping.get(t.cell);n&&(rn.cellToDisplayIdMapping.delete(t.cell),(i=rn.displayIdCellOutputMappingPerDocument.get(e.notebook))==null||i.delete(n))})})}static trackOutputByDisplayId(e,t,n,i){let o=rn.displayIdCellOutputMappingPerDocument.get(e.notebook);o||(o=new Map,rn.displayIdCellOutputMappingPerDocument.set(e.notebook,o)),o.set(t,{outputContainer:n,cell:e,outputItems:i}),rn.cellToDisplayIdMapping.set(e,t)}static getMappedOutput(e,t){let n=rn.displayIdCellOutputMappingPerDocument.get(e);if(!n)return;let i=n.get(t);return i!=null&&i.cell.document.isClosed?void 0:i}};rn.displayIdCellOutputMappingPerDocument=new WeakMap,rn.cellToDisplayIdMapping=new WeakMap,rn.disposables=[],rn=U([(0,WA.injectable)(),x(0,(0,WA.inject)(ve))],rn);var TI=new WeakMap;function Gd(r){if(r.parent_header&&"msg_id"in r.parent_header)return r.parent_header.msg_id}var fu=class fu{constructor(e,t,n,i,o,s,a,l){this.cell=e;this.controller=t;this.context=n;this.formatters=i;this.kernel=o;this.request=s;this._onErrorHandlingIOPubMessage=new kr.EventEmitter;this.onErrorHandlingExecuteRequestIOPubMessage=this._onErrorHandlingIOPubMessage.event;this.outputsAreSpecificToAWidget=[];this.commIdsMappedToParentWidgetModel=new Map;this.disposables=[];this.prompts=new Set;this.ownedCommIds=new Set;this.commIdsMappedToWidgetOutputModels=new Set;this.ownedRequestMsgIds=new Set;this._completed=Re();this.gotIdleIOPubStatus=!1;this.gotShellReply=!1;this.streamsReAttachedToExecutingCell=!1;this._completed.promise.catch(E),this.executeRequestMessageId=l,this.ownedRequestMsgIds.add(l),kr.workspace.onDidChangeNotebookDocument(u=>{var d;if(!mr(u.notebook))return;let c=u.cellChanges.find(({cell:f})=>f===this.cell);c&&((d=c.outputs)==null?void 0:d.length)===0&&(this.clearLastUsedStreamOutput(),this.cellHasErrorsInOutput=!1)},this,this.disposables),this.execution=a,this.kernel.anyMessage.connect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.connect(this.onKernelIOPubMessage,this),s&&(s.onIOPub=()=>{this.cell.document.isClosed&&!this.completedExecution&&s.dispose()},s.onReply=u=>{if(this.cell.document.isClosed){s.dispose();return}this.handleReply(u)},s.onStdin=this.handleInputRequest.bind(this),s.done.finally(()=>{this.completedExecution=!0,this.endCellExecution()}).catch(E))}get hasErrorOutput(){return this.cellHasErrorsInOutput===!0}get completed(){return this._completed.promise}dispose(){this.disposed||(this.disposed=!0,it(this.cell,"Execution Message Handler disposed"),Ce(this.disposables),this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this.kernel.anyMessage.disconnect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.disconnect(this.onKernelIOPubMessage,this),this._onErrorHandlingIOPubMessage.dispose())}endCellExecution(){this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this._completed.resolve()}onKernelAnyMessage(e,{direction:t,msg:n}){if(this.cell.document.isClosed)return this.endCellExecution();let i=ri();if(!this.request&&t==="recv"){let o=Gd(n);i.KernelMessage.isStatusMsg(n)&&n.content.execution_state==="idle"&&o===this.executeRequestMessageId&&(this.gotIdleIOPubStatus=!0),n.channel==="shell"&&o===this.executeRequestMessageId&&(this.gotShellReply=!0);let s=i.KernelMessage.isStatusMsg(n)&&n.content.execution_state!=="idle"&&o!==this.executeRequestMessageId;typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type;let a=o?o!==this.executeRequestMessageId&&!s:!1,l=typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type==="interrupt_request",u=this.gotIdleIOPubStatus&&this.gotShellReply,c=["kernel_info_reply","execute_input","execute_reply"],d="msg_type"in n&&typeof n.msg_type=="string"&&c.includes(n.msg_type);if(!this.completedExecution&&u)return this.completedExecution=!0,this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endCellExecution();if(!this.completedExecution&&(d||a)){this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=setTimeout(()=>(this.completedExecution=!0,this.endAbnormallyTimeout=void 0,this.endCellExecution()),l?1e3:100),this.disposables.push(new kr.Disposable(()=>{clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=void 0}));return}}t!=="send"||!this.completedExecution||i.KernelMessage.isCommMsgMsg(n)&&this.ownedCommIds.has(n.content.comm_id)&&this.ownedRequestMsgIds.add(n.header.msg_id)}onKernelIOPubMessage(e,t){if(this.cell.document.isClosed)return this.endCellExecution();if(!(!t.parent_header||!("msg_id"in t.parent_header)||!this.ownedRequestMsgIds.has(t.parent_header.msg_id)||t.channel!=="iopub"))try{this.handleIOPub(t)}catch(n){w.error("Failed to handle iopub message as a result of some comm message",t,n),!this.completedExecution&&!this.cell.document.isClosed&&this._onErrorHandlingIOPubMessage.fire(n)}}clearLastUsedStreamOutput(){this.lastUsedStreamOutput=void 0}createTemporaryTask(){var t,n;if(this.cell.document.isClosed)return;let e=TI.get(this.cell.notebook);return e||(this.previousResultsToRestore={...this.cell.executionSummary||{}},this.temporaryExecution=io.getOrCreate(this.cell,this.controller),(t=this.temporaryExecution)==null||t.start(),(n=this.previousResultsToRestore)!=null&&n.executionOrder&&this.temporaryExecution&&(this.temporaryExecution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution)}endTemporaryTask(){var e,t,n;(e=this.previousResultsToRestore)!=null&&e.executionOrder&&this.execution&&(this.execution.executionOrder=this.previousResultsToRestore.executionOrder),this.previousResultsToRestore&&this.temporaryExecution?(this.previousResultsToRestore.executionOrder&&(this.temporaryExecution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution.end(this.previousResultsToRestore.success,(t=this.previousResultsToRestore.timing)==null?void 0:t.endTime)):(n=this.temporaryExecution)==null||n.end(void 0),this.previousResultsToRestore=void 0,this.temporaryExecution=void 0}handleIOPub(e){var n;this.startTime||(this.startTime=new Date().getTime(),(n=this.execution)==null||n.start(this.startTime),w.debug(`Kernel acknowledged execution of cell ${this.cell.index} @ ${this.startTime}`));let t=ri();if(t.KernelMessage.isCommOpenMsg(e))this.handleCommOpen(e);else if(t.KernelMessage.isExecuteResultMsg(e))this.handleExecuteResult(e);else if(t.KernelMessage.isExecuteInputMsg(e))this.handleExecuteInput(e);else if(t.KernelMessage.isStatusMsg(e)){let i=e;this.handleStatusMessage(i)}else t.KernelMessage.isStreamMsg(e)?this.handleStreamMessage(e):t.KernelMessage.isDisplayDataMsg(e)?this.handleDisplayData(e):t.KernelMessage.isUpdateDisplayDataMsg(e)?this.handleUpdateDisplayDataMessage(e):t.KernelMessage.isClearOutputMsg(e)?this.handleClearOutput(e):t.KernelMessage.isErrorMsg(e)?this.handleError(e):t.KernelMessage.isCommOpenMsg(e)||(t.KernelMessage.isCommMsgMsg(e)?this.handleCommMsg(e):t.KernelMessage.isCommCloseMsg(e)||w.warn(`Unknown message ${e.header.msg_type} : hasData=${"data"in e.content}`));"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleCommOpen(e){var n;this.ownedCommIds.add(e.content.comm_id);let t=((n=e.content.data)==null?void 0:n.state)||void 0;e.content.target_name===nt.DefaultCommTarget&&t&&t._model_module==="@jupyter-widgets/output"&&this.commIdsMappedToWidgetOutputModels.add(e.content.comm_id)}handleCommMsg(e){let t=e.content.data;if(!(!t||t.method!=="update"||typeof t.state!="object")){if("msg_id"in t.state&&typeof t.state.msg_id=="string"){let n="msg_id"in e.parent_header?e.parent_header:void 0;(this.ownedRequestMsgIds.has(e.content.comm_id)||n&&this.ownedRequestMsgIds.has(n.msg_id))&&(t.state.msg_id?this.outputsAreSpecificToAWidget.push({handlingCommId:e.content.comm_id,msgIdsToSwallow:t.state.msg_id}):this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId===e.content.comm_id&&this.outputsAreSpecificToAWidget.pop())}else if("children"in t.state&&Array.isArray(t.state.children)&&this.ownedCommIds.has(e.content.comm_id)){let n="IPY_MODEL_";t.state.children.forEach(i=>{if(typeof i!="string")return w.warn("Came across a comm update message a child that isn't a string",i);if(!i.startsWith(n))return w.warn(`Came across a comm update message a child that start start with ${n}`,i);let o=i.substring(n.length);this.ownedCommIds.add(o),this.commIdsMappedToParentWidgetModel.set(o,e.content.comm_id)})}}}clearOutputIfNecessary(e){return this.clearOutputOnNextUpdateToOutput?(it(this.cell,"Clear cell output"),this.clearLastUsedStreamOutput(),e==null||e.clearOutput().then(E,E),this.clearOutputOnNextUpdateToOutput=!1,{previousValueOfClearOutputOnNextUpdateToOutput:!0}):{previousValueOfClearOutputOnNextUpdateToOutput:!1}}addToCellData(e,t){var l,u;if(e.data&&typeof e.data=="object"&&po in e.data){let c=e.data[po];if(c&&this.context.extensionMode===kr.ExtensionMode.Test&&(c._vsc_test_cellIndex=this.cell.index),c&&"model_id"in c){let d=fu.modelIdsOwnedByCells.get(this.cell)||new Set;d.add(c.model_id),fu.modelIdsOwnedByCells.set(this.cell,d)}}let n=ls(e),i="transient"in e&&typeof e.transient=="object"&&e.transient&&"display_id"in e.transient&&typeof((l=e.transient)==null?void 0:l.display_id)=="string"?(u=e.transient)==null?void 0:u.display_id:void 0;if(this.cell.document.isClosed)return;it(this.cell,()=>`Update output with mimes ${n.items.map(c=>c.mime).toString()}`);let o=this.execution||this.createTemporaryTask();this.clearOutputIfNecessary(o),i&&rn.trackOutputByDisplayId(this.cell,i,n,n.items),this.clearLastUsedStreamOutput(),it(this.cell,"Append output in addToCellData");let s=!0,a=Gd(t);if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a&&n.items.every(c=>this.canMimeTypeBeRenderedByWidgetManager(c)))s=!1;else if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a){let c=this.updateJupyterOutputWidgetWithOutput({commId:this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId,outputToAppend:n},o);c!=null&&c.outputAdded&&(s=!1)}s&&(o==null||o.appendOutput([n]).then(E,E)),this.endTemporaryTask()}canMimeTypeBeRenderedByWidgetManager(e){let t=e.mime;if(t=="application/vnd.code.notebook.stderr"||t=="application/vnd.code.notebook.stdout"||t=="application/vnd.code.notebook.error")return!0;if(t===po){let n=JSON.parse(new TextDecoder().decode(e.data));return!(typeof n.model_id=="string"&&this.commIdsMappedToWidgetOutputModels.has(n.model_id))}return!t.startsWith("application/vnd")}updateJupyterOutputWidgetWithOutput(e,t){let n=this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId:void 0,i="commId"in e?e.commId:n;if(!i)return;let o="outputToAppend"in e?e.outputToAppend:void 0,s=this.commIdsMappedToParentWidgetModel.get(i)||i,a=this.cell.notebook.getCells().find(y=>{var P;return(P=fu.modelIdsOwnedByCells.get(y))==null?void 0:P.has(s)});if(!a){w.warn(`Unable to find a cell that owns the model ${s}`);return}let l=a.outputs.find(y=>y.items.find(P=>{if(P.mime!==po)return!1;try{return JSON.parse(new TextDecoder().decode(P.data)).model_id===s}catch(A){w.warn("Failed to deserialize the widget data",A)}return!1}));if(!l)return;let u=fu.outputsOwnedByWidgetModel.get(s)||new Set,d=("clearOutput"in e?e.clearOutput:!1)||(this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput===!0:!1);this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!1);let f=a.outputs.slice().filter(y=>d?!u.has(y.id):!0),m=f.slice(0,f.indexOf(l)+1),g=f.slice(f.indexOf(l)+1);fu.outputsOwnedByWidgetModel.set(s,u),o&&u.add(o.id);let b=o?m.concat(o).concat(g):m.concat(g);return g.length===0&&o?t==null||t.appendOutput(o,a).then(E,E):d&&!o&&g.length===0||t==null||t.replaceOutput(b,a).then(E,E),{outputAdded:!0}}async handleInputRequest(e){if(e.content&&"prompt"in e.content){let t=new kr.CancellationTokenSource;this.prompts.add(t);let n=e.content.password!==null&&e.content.password;await kr.window.showInputBox({prompt:e.content.prompt?e.content.prompt.toString():"",ignoreFocusOut:!0,password:n},t.token).then(i=>{this.kernel.sendInputReply({value:i||"",status:"ok"},e.header)},E),this.prompts.delete(t)}}handleExecuteResult(e){this.addToCellData({output_type:"execute_result",data:e.content.data,metadata:e.content.metadata,transient:e.content.transient,execution_count:e.content.execution_count},e)}handleExecuteReply(e){let t=e.content;t.payload&&t.payload.forEach(n=>{n.source&&n.source==="set_next_input"&&"text"in n&&"replace"in n&&this.handleSetNextInput(n),n.data&&n.data.hasOwnProperty("text/plain")&&this.addToCellData({output_type:"stream",text:n.data["text/plain"].toString(),name:"stdout",metadata:{},execution_count:t.execution_count},e)})}handleSetNextInput(e){let t=new kr.WorkspaceEdit;if(e.replace)t.replace(this.cell.document.uri,new kr.Range(this.cell.document.lineAt(0).range.start,this.cell.document.lineAt(this.cell.document.lineCount-1).range.end),e.text);else{it(this.cell,"Create new cell after current");let n=new kr.NotebookCellData(kr.NotebookCellKind.Code,e.text,this.cell.document.languageId);n.outputs=[],n.metadata={};let i=kr.NotebookEdit.insertCells(this.cell.index+1,[n]);t.set(this.cell.notebook.uri,[i])}kr.workspace.applyEdit(t).then(E,E)}handleExecuteInput(e){e.content.execution_count&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleStatusMessage(e){it(this.cell,`Kernel switching to ${e.content.execution_state}`)}handleStreamMessage(e){var o;if(Gd(e)&&this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow==Gd(e))return;it(this.cell,`Update streamed output, new output '${e.content.text.substring(0,100)}'`);let t=this.execution||this.createTemporaryTask(),n=e.content.name==="stdout"?kr.NotebookCellOutputItem.stdout("").mime:kr.NotebookCellOutputItem.stderr("").mime;!this.request&&!this.streamsReAttachedToExecutingCell&&!this.lastUsedStreamOutput&&this.cell.outputs.length&&this.cell.outputs[this.cell.outputs.length-1].items.length>=1&&this.cell.outputs[this.cell.outputs.length-1].items.every(s=>s.mime===n)&&(this.lastUsedStreamOutput={output:this.cell.outputs[0],stream:e.content.name}),this.streamsReAttachedToExecutingCell=!0;let{previousValueOfClearOutputOnNextUpdateToOutput:i}=this.clearOutputIfNecessary(t);if(((o=this.lastUsedStreamOutput)==null?void 0:o.stream)===e.content.name){let s=ls({output_type:"stream",name:e.content.name,text:e.content.text});it(this.cell,`Append output items '${e.content.text.substring(0,100)}`),t==null||t.appendOutputItems(s.items,this.lastUsedStreamOutput.output).then(E,E)}else if(i){let s=Fc(e.content.text),a=ls({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},it(this.cell,`Replace output with '${s.substring(0,100)}'`),t==null||t.replaceOutput([a]).then(E,E)}else{let s=rY(Fc(e.content.text)),a=ls({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},it(this.cell,`Append new output '${s.substring(0,100)}'`),t==null||t.appendOutput([a]).then(E,E)}this.endTemporaryTask()}handleDisplayData(e){let t={output_type:"display_data",data:Yx(e.content.data),metadata:e.content.metadata,transient:e.content.transient};this.addToCellData(t,e)}handleClearOutput(e){if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===Gd(e)){if(e.content.wait)this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!0);else{let t=this.execution||this.createTemporaryTask();this.updateJupyterOutputWidgetWithOutput({clearOutput:!0},t),this.endTemporaryTask()}return}if(e.content.wait)this.clearOutputOnNextUpdateToOutput=!0;else{let t=this.execution||this.createTemporaryTask();this.clearLastUsedStreamOutput(),t==null||t.clearOutput().then(E,E),this.endTemporaryTask()}}handleError(e){let t=e.content.traceback;w.ci(`Traceback for error ${t}`),this.formatters.forEach(i=>{t=i.format(this.cell,t)}),w.ci(`Traceback for error after formatting ${t}`);let n={output_type:"error",ename:e.content.ename,evalue:e.content.evalue,traceback:t};if(this.cell.notebook.notebookType!=="interactive"){let i=io.get(this.cell);i&&e.content.ename!=="KeyboardInterrupt"&&(i.errorInfo={name:e.content.ename,message:e.content.evalue,location:Hz(e.content.traceback,this.cell),uri:this.cell.document.uri,stack:e.content.traceback.join(`
`)})}this.addToCellData(n,e),this.cellHasErrorsInOutput=!0}handleReply(e){ri().KernelMessage.isExecuteReplyMsg(e)&&(this.handleExecuteReply(e),"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count))}handleUpdateDisplayDataMessage(e){let t=e.content.transient.display_id;if(!t){w.warn("Update display data message received, but no display id",e.content);return}let n=rn.getMappedOutput(this.cell.notebook,t);if(!n){w.trace("Update display data message received, but no output found to update",e.content);return}if(n.cell.document.isClosed){w.warn("Update display data message received, but output cell is closed",e.content);return}let i=ZV(new kr.NotebookCellOutput(n.outputItems,n.outputContainer.metadata)),o=ls({...i,data:e.content.data,metadata:e.content.metadata});if(n.outputItems.length===0&&o.items.length===0){w.trace("Update display data message received, but no output to update",e.content);return}let s=!1;if(n.outputItems.length===o.items.length){let l=!0;if((0,Xj.default)(n.outputContainer.metadata||{},o.metadata||{})||(s=!0,l=!1),l){for(let u=0;u<n.outputItems.length;u++)if(!(0,Xj.default)(n.outputItems[u],o.items[u])){l=!1;break}}if(l){w.trace("Update display data message received, but no output to update (data is the same)",e.content);return}}let a=this.execution||this.createTemporaryTask();if(it(this.cell,`Replace output items in display data ${o.items.length}`),s){let l=n.cell.outputs.map(u=>{let c=ZV(u);return c.output_type==="display_data"&&"transient"in c&&c.transient&&typeof c.transient=="object"&&"display_id"in c.transient&&typeof c.transient.display_id=="string"&&c.transient.display_id===t?o:u});a==null||a.replaceOutput(l,n.cell).then(E,E),rn.trackOutputByDisplayId(n.cell,t,o,o.items)}else a==null||a.replaceOutputItems(o.items,n.outputContainer).then(E,E),rn.trackOutputByDisplayId(n.cell,t,n.outputContainer,o.items);this.endTemporaryTask()}};fu.modelIdsOwnedByCells=new WeakMap,fu.outputsOwnedByWidgetModel=new Map,U([hn()],fu.prototype,"handleReply",1);var bP=fu;p();var Yd=class extends Error{constructor(t){super(t.evalue||t.ename);this.ename=t.ename,this.evalue=t.evalue,this.traceback=t.traceback}};var VA=class{constructor(e,t){this.controller=e;this.requestListener=t}create(e,t,n,i){return e9.fromCell(e,t,n,this.controller,this.requestListener,i)}},e9=class r{constructor(e,t,n,i,o,s){this.cell=e;this.codeOverride=t;this.kernelConnection=n;this.controller=i;this.requestListener=o;this.resumeExecution=s;this.type="cell";this._result=Re();this.cancelHandled=!1;this.disposables=[];if(Zj.workspace.onDidCloseTextDocument(a=>{var l;if(a===this.cell.document){w.info(`Disposing request as the cell (${this.cell.index}) was deleted ${Ee(this.cell.notebook.uri)}`);try{(l=this.request)==null||l.dispose()}catch(u){w.error(`Error during cell execution dispose: ${u}`)}this.started&&!this._completed&&this.completedDueToCancellation()}},this,this.disposables),this.canExecuteCell())this.execution=io.getOrCreate(e,this.controller,!(s!=null&&s.msg_id)),Jf.setCellState(e,2);else{let a=io.get(e);a&&(a.start(),a.end(void 0))}}get result(){return this._result.promise}get executionOrder(){return this._executionOrder}static fromCell(e,t,n,i,o,s){return new r(e,t,n,i,o,s)}async start(e){var t,n,i,o;if(this.session=e,(t=this.resumeExecution)!=null&&t.msg_id)return this.resume(e,this.resumeExecution);if(this.cancelHandled){it(this.cell,"Not starting as it was cancelled");return}if(it(this.cell,"Start execution"),w.ci(`Cell Exec contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return e.kind==="remoteJupyter"&&e.status==="unknown"&&(!e.kernel||e.kernel.isDisposed||e.isDisposed)?((i=this.execution)==null||i.start(),(o=this.execution)==null||o.clearOutput().then(E,E),this.completedWithErrors(new zr),this.result):this.started?(it(this.cell,"Cell has already been started yet CellExecution.Start invoked again"),w.error(`Cell has already been started yet CellExecution.Start invoked again ${this.cell.index}`),this.result):(this.started=!0,TI.set(this.cell.notebook,this.execution),Jf.setCellState(this.cell,3),this.execute(this.codeOverride||this.cell.document.getText().replace(/\r\n/g,`
`),e).catch(s=>this.completedWithErrors(s)).catch(E),this.result)}async resume(e,t){var n,i;if(this.cancelHandled){it(this.cell,"Not resuming as it was cancelled");return}if(!e.kernel)throw new Error("Kernel not available to resume execution");if(it(this.cell,"Start resuming execution"),w.ci(`Cell Exec (resuming) contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return this.started?(w.error(`Cell has already been started yet CellExecution.resume invoked again ${this.cell.index}`),this.result):(this.started=!0,TI.set(this.cell.notebook,this.execution),(i=this.execution)==null||i.start(t.startTime),t.executionCount&&this.execution&&(this.execution.executionOrder=t.executionCount),Jf.setCellState(this.cell,3),this.cellExecutionHandler=this.requestListener.registerListenerForResumingExecution(this.cell,{kernel:e.kernel,cellExecution:this.execution,msg_id:t.msg_id}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(o=>{w.error(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,o),this.completedWithErrors(o.error)},this,this.disposables),this.cellExecutionHandler.completed.finally(()=>this.completedSuccessfully()).catch(E),this.result)}async cancel(e=!1){var t;if(!this.cancelHandled){if(this.cancelRequested=!0,this.started&&!e&&((t=this.execution)!=null&&t.started)){it(this.cell,"Cell is already running, waiting for it to finish or kernel to start"),await this.result.catch(E);return}this.cancelHandled||this._completed||(it(this.cell,"Execution cancelled"),this.cancelHandled=!0,this.completedDueToCancellation(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,it(this.cell,"Execution disposed"),Ce(this.disposables))}completedWithErrors(e,t,n=!0){var i,o;if(!this.cancelHandled){if(!this.disposed&&!this.cancelRequested?w.warn("Cell completed with errors",e):w.warn(`Cell completed with errors (${this.disposed?"disposed":"cancelled"})`),it(this.cell,"Completed with errors"),n){let s,a;if(e&&!(e instanceof ot)&&((i=e.message)!=null&&i.includes("Canceled future for execute_request message before replies were done"))&&this.session&&aZ(this.session)&&(e=new zr),e)if(!(e instanceof ot))s=e.message||e.name||e.stack;else{let l=Vm(Zj.workspace.workspaceFolders||[],e,ut(this.kernelConnection),I7(this.kernelConnection.interpreter));s=l==null?void 0:l.message}a=by(s||""),a&&((o=this.execution)==null||o.appendOutput(a).then(E,E))}this.endCellTask("failed",t),it(this.cell,"Completed with errors, & resolving"),this._result.reject(e)}}get isEmptyCodeCell(){return this.cell.document.getText().trim().length===0}completedSuccessfully(e){it(this.cell,"Completed successfully");let t="success";this.endCellTask("success",e),it(this.cell,`Completed successfully & resolving with status = ${t}`),this._result.resolve()}endCellTask(e,t=new Date().getTime()){var n,i,o,s,a;if(!this._completed){if(this._completed=!0,this.isEmptyCodeCell)this.execution&&(this.execution.executionOrder=void 0),(n=this.execution)==null||n.end(void 0);else if(e==="success"||e==="failed")this.endTime=t,(i=this.execution)==null||i.end(e==="success",this.endTime);else{try{(o=this.request)==null||o.dispose()}catch(l){}(s=this.execution)==null||s.end(void 0)}TI.get(this.cell.notebook)===this.execution&&TI.set(this.cell.notebook,void 0),this._executionOrder=(a=this.execution)==null?void 0:a.executionOrder,Jf.setCellState(this.cell,1),this.execution=void 0}}completedDueToCancellation(){it(this.cell,"Completed due to cancellation"),this.endCellTask("cancelled"),it(this.cell,"Cell cancelled & resolving"),this._result.resolve()}canExecuteCell(){return this.cell.document.languageId==="raw"?!1:!this.cell.document.isClosed}async execute(e,t){var o,s,a,l;if(!t.kernel)throw new Error("No kernel available to execute code");if(it(this.cell,"Send code for execution"),e.trim().length===0||this.cell.document.isClosed)return e.trim().length===0&&((s=this.execution)==null||s.start((o=this.resumeExecution)==null?void 0:o.startTime),(l=(a=this.execution)==null?void 0:a.clearOutput())==null||l.then(E,E)),it(this.cell,"Empty cell execution"),this.completedSuccessfully();let n={cellId:this.cell.document.uri.toString(),...Mf(this.cell).metadata},i=t.kernel;try{Rr.changeCellState(this.cell,3),w.trace(`Cell Index:${this.cell.index} sent to kernel`),this.request=i.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!0},!1,n),this.request.done.then(E,E)}catch(u){return w.error(`Cell execution failed without request, for cell Index ${this.cell.index}`,u),this.completedWithErrors(u)}this.cellExecutionHandler=this.requestListener.registerListenerForExecution(this.cell,{kernel:i,cellExecution:this.execution,request:this.request}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(u=>{w.error(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,u),this.completedWithErrors(u.error)},this,this.disposables);try{it(this.cell,"Wait for jupyter execution");let u=await this.request.done,c=new Date().getTime();it(this.cell,"Jupyter execution completed"),u.content.status==="error"?this.completedWithErrors(new Yd(u.content),c,!1):this.completedSuccessfully(c),it(this.cell,"Executed successfully in executeCell")}catch(u){if(this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&w.error("Error in waiting for cell to complete",u),it(this.cell,"Some other execution error"),u&&u instanceof Error&&Yn(u,!0)?this.completedWithErrors({message:u.message}):this.completedWithErrors(u)}}};p();var cZ=require("vscode");var jA=class{constructor(e,t,n,i){this.controller=e;this.context=t;this.formatters=n;this.notebook=i;this.disposables=[];this.messageHandlers=new WeakMap;cZ.workspace.onDidChangeNotebookDocument(o=>{o.notebook===this.notebook&&o.contentChanges.forEach(s=>s.removedCells.forEach(a=>{var l;return(l=this.messageHandlers.get(a))==null?void 0:l.dispose()}))},this,this.disposables)}dispose(){Ce(this.disposables),this.notebook&&this.notebook.getCells().forEach(e=>{var t;return(t=this.messageHandlers.get(e))==null?void 0:t.dispose()})}registerListenerForExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new bP(e,this.controller,this.context,this.formatters,t.kernel,t.request,t.cellExecution,t.request.msg.header.msg_id);return this.messageHandlers.set(e,n),n}registerListenerForResumingExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new bP(e,this.controller,this.context,this.formatters,t.kernel,void 0,t.cellExecution,t.msg_id);return this.messageHandlers.set(e,n),n}};p();p();var BA=require("vscode");function mu(r,e,t){r!==Je&&w.trace(`Execution Id:${e}. ${t}.`)}var uZ=new Map,kI=class r{constructor(e,t){this.code=e;this.extensionId=t;this.type="code";this._onDidEmitOutput=new BA.EventEmitter;this.onDidEmitOutput=this._onDidEmitOutput.event;this._onRequestSent=new BA.EventEmitter;this.onRequestSent=this._onRequestSent.event;this._onRequestAcknowledge=new BA.EventEmitter;this.onRequestAcknowledged=this._onRequestAcknowledge.event;this._done=Re();this.cancelHandled=!1;this.disposables=[];let n=uZ.get(t)||0;n+=1,uZ.set(t,n),this.executionId=`${t}-${n}`,this.disposables.push(this._onDidEmitOutput)}get done(){return this._done.promise}get result(){return this._done.promise}static fromCode(e,t){return new r(e,t)}async start(e){if(this.session=e,this.cancelHandled){mu(this.extensionId,this.executionId,"Not starting as it was cancelled");return}if(mu(this.extensionId,this.executionId,"Start Code execution"),w.ci(`Code Exec contents ${this.code.substring(0,50)}...`),!e.kernel||e.kernel.isDisposed||e.isDisposed){this._done.reject(new zr);return}if(this.started)return mu(this.extensionId,this.executionId,"Code has already been started yet CodeExecution.Start invoked again"),w.error(`Code has already been started yet CodeExecution.Start invoked again ${this.executionId}`),this.done;await this.execute(this.code.replace(/\r\n/g,`
`),e).catch(E)}async cancel(){var e,t,n;if(!(this.cancelHandled||this._completed)){if(this.cancelRequested=!0,this.started){mu(this.extensionId,this.executionId,"Code is already running, interrupting and waiting for it to finish or kernel to start");let i=(e=this.session)==null?void 0:e.kernel;i&&this.extensionId!==Je&&await i.interrupt().catch(E),(t=this.request)==null||t.dispose(),await((n=this.request)==null?void 0:n.done.catch(E))}this.cancelHandled||this._completed||(mu(this.extensionId,this.executionId,"Execution cancelled"),this.cancelHandled=!0,this._done.resolve(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,this._completed||mu(this.extensionId,this.executionId,"Execution disposed"),Ce(this.disposables))}async execute(e,t){if(!t.kernel){let i=new Error("No kernel available to execute code");throw this._done.resolve(),i}mu(this.extensionId,this.executionId,"Send code for execution");let n=t.kernel;try{this.started=!0,this._onRequestSent.fire(),mu(this.extensionId,this.executionId,"Execution Request Sent to Kernel"),this.request=Xz(n,e,()=>this._onRequestAcknowledge.fire(),i=>this._onDidEmitOutput.fire(i)),this.request.done.then(E,E)}catch(i){w.error(`Code execution failed without request, for exec ${this.executionId}`,i),this._completed=!0,this._done.reject(i);return}try{let i=await this.request.done;this._completed=!0,i.content.status==="error"?(mu(this.extensionId,this.executionId,"Executed with errors"),this._done.reject(new Yd(i.content))):(mu(this.extensionId,this.executionId,"Executed successfully"),this._done.resolve())}catch(i){if(this._completed=!0,this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&w.error(`Error in waiting for code ${this.executionId} to complete`,i),this._done.reject(i)}}};var HA=class{constructor(e,t,n,i){this.session=e;this.executionFactory=t;this.metadata=n;this.resourceUri=i;this.queueOfItemsToExecute=[];this.cancelledOrCompletedWithErrors=!1;this.startedRunningCells=!1;this.disposables=[]}get queueOfCellsToExecute(){return this.queueOfItemsToExecute.filter(e=>e.type==="cell").map(e=>e)}get isEmpty(){return this.queueOfItemsToExecute.length===0}get failed(){return this.cancelledOrCompletedWithErrors}get queue(){return this.queueOfCellsToExecute.map(e=>e.cell)}dispose(){var e;this.disposables.forEach(t=>t.dispose()),(e=this.lastCellExecution)==null||e.dispose()}queueCell(e,t){this.enqueue({cell:e,codeOverride:t})}queueCode(e,t,n){return this.enqueue({code:e,extensionId:t,token:n})}enqueue(e){let t;if("cell"in e){let{cell:n,codeOverride:i}=e,o=this.queueOfCellsToExecute.find(a=>a.cell===n);if(o)return it(n,"Use existing cell execution"),o;let s=this.executionFactory.create(n,i,this.metadata);t=s,this.disposables.push(s),this.queueOfItemsToExecute.push(s),it(n,"User queued cell for execution")}else{let{code:n,extensionId:i,token:o}=e,s=kI.fromCode(n,i);t=s,this.disposables.push(s),this.queueOfItemsToExecute.push(s),this.disposables.push(kg(o.onCancellationRequested)(()=>s.cancel()))}return this.startExecutingCells(),t}resumeCell(e,t){if(this.queueOfCellsToExecute.find(o=>o.cell===e)){it(e,"Use existing cell execution");return}let i=this.executionFactory.create(e,"",this.metadata,t);this.disposables.push(i),this.queueOfItemsToExecute.push(i),it(e,"User queued cell for execution"),this.startExecutingCells()}async cancel(e){var t;this.cancelledOrCompletedWithErrors=!0,w.debug("Cancel pending cells"),await Promise.all(this.queueOfItemsToExecute.map(n=>n.cancel(e))),(t=this.lastCellExecution)==null||t.dispose(),this.queueOfItemsToExecute.splice(0,this.queueOfItemsToExecute.length)}async cancelQueuedCells(){var e,t;this.cancelledOrCompletedWithErrors=!0,w.debug("Cancel pending cells"),await Promise.all(this.queueOfCellsToExecute.map(n=>n.cancel())),((e=this.lastCellExecution)==null?void 0:e.type)==="cell"&&((t=this.lastCellExecution)==null||t.dispose()),this.queueOfItemsToExecute.push(...this.queueOfItemsToExecute.filter(n=>n.type==="code"))}async waitForCompletion(e){let t=e?this.queueOfCellsToExecute.filter(n=>e===n.cell):this.queueOfItemsToExecute;await Promise.all(t.map(n=>n.result))}startExecutingCells(){this.startedRunningCells||this.start().catch(E),this.startedRunningCells=!0}async start(){try{await this.executeQueuedCells()}catch(e){w.error("Failed to execute cells in CellExecutionQueue",e),this.cancelledOrCompletedWithErrors=!0,await this.cancelQueuedCells()}}async executeQueuedCells(){var n,i,o;let e,t=await this.session;for(this.queueOfItemsToExecute.forEach(s=>s.type==="cell"&&it(s.cell,"Ready to execute"));this.queueOfItemsToExecute.length;){(n=this.lastCellExecution)==null||n.dispose();let s=this.queueOfItemsToExecute[0];this.lastCellExecution=s,s.type==="cell"&&it(s.cell,"Before Execute individual cell");let a=!0;try{s.type==="cell"&&s.cell.notebook.isClosed?e=!0:s.type==="cell"&&this.cancelledOrCompletedWithErrors||(a=await s.start(t).then(()=>!0).catch(()=>!1))}finally{s.type==="cell"&&it(s.cell,`After Execute individual cell ${a}`);let u=this.queueOfItemsToExecute.indexOf(s);u>=0&&this.queueOfItemsToExecute.splice(u,1),s.type==="cell"&&Rr.changeCellState(s.cell,1,s.executionOrder)}let l=!1;if(s.type==="cell"&&((o=(i=Mf(s.cell).metadata)==null?void 0:i.tags)!=null&&o.includes("raises-exception"))&&(l=!0),e||this.cancelledOrCompletedWithErrors||!a&&!l){this.cancelledOrCompletedWithErrors=!0;let u=[];if(this.cancelledOrCompletedWithErrors&&u.push("cancellation or failure in execution"),e&&u.push("Notebook being closed"),typeof a=="number"&&!a&&u.push("failure in cell execution"),u.length===0&&u.push("an unknown reason"),this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length===this.queueOfItemsToExecute.length){w.warn(`Cancel all remaining cells due to ${u.join(" or ")}`),await this.cancel();break}else if(this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length!==this.queueOfItemsToExecute.length)w.warn(`Cancel all remaining cells due to ${u.join(" or ")}`),await this.cancelQueuedCells();else if(e){w.warn(`Cancel all remaining cells due to ${u.join(" or ")}`),await this.cancel();break}}if(t.status==="dead"||t.status==="terminating"){this.cancelledOrCompletedWithErrors=!0,w.warn("Cancel all remaining cells due to dead kernel"),await this.cancel();break}}}};var qA=class{constructor(e,t,n,i){this.kernel=e;this.notebook=i;this.disposables=[];this._visibleExecutionCount=0;this.documentExecutions=new WeakMap;this._onDidReceiveDisplayUpdate=new Xg.EventEmitter;this.onDidReceiveDisplayUpdate=this._onDidReceiveDisplayUpdate.event;this.hookedSesions=new WeakSet;let o=new jA(e.controller,t,n,i);this.disposables.push(o),this.executionFactory=new VA(e.controller,o),Rr.onDidChangeNotebookCellExecutionState(s=>{var a;s.cell.notebook===e.notebook&&s.state===1&&((a=s.cell.executionSummary)!=null&&a.executionOrder)&&(this._visibleExecutionCount=Math.max(this._visibleExecutionCount,s.cell.executionSummary.executionOrder))}),e.onRestarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.onStarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.addHook("willInterrupt",this.onWillInterrupt,this,this.disposables),e.addHook("willCancel",this.onWillCancel,this,this.disposables),e.addHook("willRestart",s=>this.onWillRestart(s),this,this.disposables),e.onStatusChanged(this.hookupIOPubHandler,this,this.disposables),e.onRestarted(this.hookupIOPubHandler,this,this.disposables),this.hookupIOPubHandler()}get executionCount(){return this._visibleExecutionCount}hookupIOPubHandler(){let e=this.kernel.session;if(!e||this.hookedSesions.has(e))return;this.hookedSesions.add(e);let t=(n,i)=>{var l;if(i.header.msg_type!=="update_display_data"&&i.header.msg_type!=="display_data")return;let o=i,s=(l=o.content.transient)==null?void 0:l.display_id;if(!s||!tQ(e,s))return;let a=ls({output_type:"display_data",data:o.content.data,metadata:o.content.metadata,transient:o.content.transient});this._onDidReceiveDisplayUpdate.fire(a)};e.iopubMessage.connect(t),this.disposables.push({dispose:()=>{e==null||e.iopubMessage.disconnect(t)}})}get pendingCells(){var e;return((e=this.documentExecutions.get(this.notebook))==null?void 0:e.queue)||[]}async resumeCellExecution(e,t){if(it(e,`NotebookKernelExecution.resumeCellExecution (start), ${Ee(e.notebook.uri)}`),e.kind==Xg.NotebookCellKind.Markup)return;Br(this.kernel.resourceUri,"DATASCIENCE.RESUME_EXECUTE_CELL");let n=this.kernel.start(new hr(!1)),i=this.getOrCreateCellExecutionQueue(e.notebook,n);i.resumeCell(e,t);let o=await i.waitForCompletion(e).then(()=>!0).catch(()=>!1);it(e,`NotebookKernelExecution.resumeCellExecution (completed), ${Ee(e.notebook.uri)}`),w.trace(`Cell ${e.index} executed ${o?"successfully":"with an error"}`)}async executeCell(e,t){it(e,`NotebookKernelExecution.executeCell (1), ${Ee(e.notebook.uri)}`);let n=new It;if(e.kind==Xg.NotebookCellKind.Markup)return;it(e,`NotebookKernelExecution.executeCell (2), ${Ee(e.notebook.uri)}`);let i=this.kernel.restarting.then(()=>this.kernel.start(new hr(!1)));it(e,`NotebookKernelExecution.executeCell (3), ${Ee(e.notebook.uri)}`);let o=this.getOrCreateCellExecutionQueue(e.notebook,i);o.queueCell(e,t);let s=!0;try{it(e,`NotebookKernelExecution.executeCell (4), ${Ee(e.notebook.uri)}`),await o.waitForCompletion(e)}catch(a){throw s=!1,a}finally{it(e,`NotebookKernelExecution.executeCell completed (5), ${Ee(e.notebook.uri)}`),w.trace(`Cell ${e.index} executed ${s?"successfully":"with an error"}`),Br(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CELL",{duration:n.elapsedTime})}}async*executeCode(e,t,n,i){let o=new It,s=this.kernel.restarting.then(()=>this.kernel.start(new hr(!1))),a=this.getOrCreateCellExecutionQueue(this.notebook,s),l;t===Je?(l=kI.fromCode(e,t),s.then(g=>l.start(g))):l=a.queueCode(e,t,i),t!==Je&&w.trace(`Queue code ${l.executionId} from ${t} after ${o.elapsedTime}ms:
${e}`);let u=!1,c=[];l.result.finally(()=>{u=!0,!i.isCancellationRequested&&w.debug(`Execution of code ${l.executionId} completed in ${o.elapsedTime}ms`),t!==Je&&Br(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CODE",{duration:o.elapsedTime},{extensionId:t}),Ce(c)}).catch(E);let d=Au(l.result),f=[],m=Re();for(c.push(l.onRequestSent(()=>n.started.fire())),c.push(l.onRequestAcknowledged(()=>n.executionAcknowledged.fire())),l.onDidEmitOutput(g=>{f.push(g),m.resolve(),m=Re()},this,c),i.onCancellationRequested(()=>{u||w.debug(`Code execution cancelled by extension ${t}`)},this,c);;){await Promise.race([m.promise,d.promise]),u&&(m=Re());let g=this.kernel.session;for(;f.length;){let b=f.shift();g&&gR(t,g,b),yield b}if(d.completed)break}}executeHidden(e){return this.kernel.start().then(n=>n.kernel?Mi(n.kernel,e):Promise.reject(new zr))}async onWillInterrupt(){let e=this.documentExecutions.get(this.notebook);!e&&this.kernel.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||(w.info("Interrupt kernel execution"),e&&(await e.cancel(),await e.waitForCompletion().catch(E)))}async onWillCancel(){let e=this.documentExecutions.get(this.notebook);e&&await e.cancel(!0)}async onWillRestart(e){let t=this.documentExecutions.get(this.notebook),n=e?await e.catch(()=>{}):void 0,i=t?t.cancel(!0).then(()=>t.waitForCompletion().catch(E)):Promise.resolve();n||(w.info("No kernel session to interrupt"),await i)}getOrCreateCellExecutionQueue(e,t){let n=this.documentExecutions.get(e);if(n&&!n.isEmpty&&!n.failed)return n;let i=new HA(t,this.executionFactory,this.kernel.kernelConnectionMetadata,this.kernel.resourceUri);return this.disposables.push(i),Xg.workspace.onDidCloseNotebookDocument(async o=>{o===e&&(w.debug(`Cancel executions after closing notebook ${Ee(o.uri)}`),(!i.failed||!i.isEmpty)&&await i.cancel(!0))},this,this.disposables),this.documentExecutions.set(e,i),i}};var NI=class extends RA{constructor(t,n,i,o,s,a,l,u,c){super(t,n);this.sessionCreator=i;this.configService=o;this.context=s;this.formatters=l;this.startupCodeProviders=u;this.workspaceStorage=c;n.push(a.onDidRemove(this.handleServerRemoval.bind(this)))}getOrCreate(t,n){var u;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;i&&w.trace(`Kernel for ${Ee(t.uri)} with id ${i.options.metadata.id} is being replaced with ${n.metadata.id}`),this.disposeOldKernel(t,"createNewKernel");let o=(t==null?void 0:t.notebookType)===vr?n.resourceUri:t.uri,s=Qj(this.configService,o),a=t.uri.path.endsWith(".interactive")||(u=n.resourceUri)!=null&&u.path.endsWith(".interactive")?vr:bt,l=new FA(o,t,n.metadata,this.sessionCreator,s,n.controller,this.startupCodeProviders.getProviders(a),this.workspaceStorage);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onPostInitialized(()=>this._onDidPostInitializeKernel.fire(l),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(c=>this._onKernelStatusChanged.fire({kernel:l,status:c}),this,this.disposables),this.executions.set(l,new qA(l,this.context,this.formatters,t)),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(l),l}};NI=U([(0,fn.injectable)(),x(0,(0,fn.inject)(Wu)),x(1,(0,fn.inject)(ve)),x(2,(0,fn.inject)(Gx)),x(3,(0,fn.inject)(Ke)),x(4,(0,fn.inject)(st)),x(5,(0,fn.inject)(dr)),x(6,(0,fn.multiInject)(wS)),x(7,(0,fn.inject)(Md)),x(8,(0,fn.inject)(_t)),x(8,(0,fn.named)(Is))],NI);var RI=class extends AA{constructor(t,n,i,o,s,a){super(t,n);this.sessionCreator=i;this.configService=o;this.startupCodeProviders=s;this.workspaceStorage=a}getOrCreate(t,n){var u;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;this.disposeOldKernel(t);let o=t,s=Qj(this.configService,o),a=t.path.endsWith(".interactive")||(u=n.resourceUri)!=null&&u.path.endsWith(".interactive")?vr:bt,l=new KA(t,o,n.metadata,this.sessionCreator,s,this.startupCodeProviders.getProviders(a),this.workspaceStorage);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onPostInitialized(()=>this._onDidPostInitializeKernel.fire(l),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(c=>this._onKernelStatusChanged.fire({kernel:l,status:c}),this,this.disposables),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(t,l),l}};RI=U([(0,fn.injectable)(),x(0,(0,fn.inject)(Wu)),x(1,(0,fn.inject)(ve)),x(2,(0,fn.inject)(Gx)),x(3,(0,fn.inject)(Ke)),x(4,(0,fn.inject)(Md)),x(5,(0,fn.inject)(_t)),x(5,(0,fn.named)(Is))],RI);p();var JA=se(ge()),MI=require("vscode");var AI=class extends Lr{constructor(t){super();this._onDidChangeRegistrations=this._register(new MI.EventEmitter);this.onDidChangeRegistrations=this._onDidChangeRegistrations.event;this._finders=[];this.connectionFinderMapping=new Map;this._onDidChangeKernels=this._register(new MI.EventEmitter);this.onDidChangeKernels=this._onDidChangeKernels.event;this._status="idle";this._onDidChangeStatus=this._register(new MI.EventEmitter);t.push(this),this._register(this._onDidChangeStatus),this._register(this._onDidChangeRegistrations)}get status(){return this._status}set status(t){this._status!=t&&(this._status=t,this._onDidChangeStatus.fire())}get onDidChangeStatus(){return this._onDidChangeStatus.event}registerKernelFinder(t){this._finders.push(t);let n=()=>{this.status=this._finders.every(s=>s.status==="idle")?"idle":"discovering"};n();let i=this._register(new En),o=()=>{let s=this._finders.findIndex(a=>a===t);s>=0&&this._finders.splice(s,1),i.dispose(),n(),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[],removed:[t]})};return i.add(t.onDidChangeStatus(n,this)),i.add(t.onDidChangeKernels(()=>this._onDidChangeKernels.fire())),i.add(t.onDidDispose(()=>o())),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[t],removed:[]}),new MI.Disposable(()=>o())}get kernels(){let t=[];this.connectionFinderMapping.clear();let n=new Set;this._finders.filter(o=>o.kind==="localPythonEnvironment").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.add(s.kernelSpec.specFile),t.push(s),this.connectionFinderMapping.set(s.id,o)})}),this._finders.filter(o=>o.kind==="localKernelSpec").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.has(s.kernelSpec.specFile)||(t.push(s),this.connectionFinderMapping.set(s.id,o))})});let i=this._finders.filter(o=>o.kind==="remote");for(let o of i){let s=o.kernels;s.forEach(a=>{this.connectionFinderMapping.set(a.id,o)}),t.push(...s)}return t}getFinderForConnection(t){return this.connectionFinderMapping.get(t.id)}get registered(){return this._finders}};AI=U([(0,JA.injectable)(),x(0,(0,JA.inject)(ve))],AI);p();var Zg=se(ge());var t9="Active_Kernel_Id_List",VIe=100,Vs=class{constructor(e,t){this.globalMemento=e;this.crypto=t}async getPreferredRemoteKernelId(e){let t=this.globalMemento.get(t9,[]);if(t.length){let n=e.uri,i=await this.crypto.createHash(n.toString()),o=t.find(s=>s.fileHash===i);return w.trace(`Preferred Remote kernel for ${Ee(n)} is ${o==null?void 0:o.kernelId}`),o==null?void 0:o.kernelId}}async clearPreferredRemoteKernelId(e){await this.updatePreferredRemoteKernelIdInternal(e)}async storePreferredRemoteKernelId(e,t){await this.updatePreferredRemoteKernelIdInternal(e,t)}async updatePreferredRemoteKernelIdInternal(e,t){let n=!1,i=JSON.parse(JSON.stringify(this.globalMemento.get(t9,[]))),o=await this.crypto.createHash(e.toString()),s=i.findIndex(a=>a.fileHash===o);for(s>=0&&(n=!0,i.splice(s,1)),t&&(n=!0,i.push({fileHash:o,kernelId:t}),w.trace(`Storing Preferred remote kernel for ${Ee(e)} is ${t}`));i.length>VIe;)n=!0,i.shift();n&&await this.globalMemento.update(t9,i)}};Vs=U([(0,Zg.injectable)(),x(0,(0,Zg.inject)(_t)),x(0,(0,Zg.named)(rr)),x(1,(0,Zg.inject)(uy))],Vs);p();var Oi=Symbol("IJupyterVariables"),GA=Symbol("IKernelVariableRequester"),YA=Symbol("IJupyterVariablesProvider");p();var zd=se(ge()),dZ=require("vscode");var ev=class{constructor(e,t,n){this.kernelVariables=t;this.debuggerVariables=n;this.refreshEventEmitter=new dZ.EventEmitter;e.push(n.refreshRequired(this.fireRefresh.bind(this))),e.push(t.refreshRequired(this.fireRefresh.bind(this)))}get refreshRequired(){return this.refreshEventEmitter.event}getAllVariableDiscriptions(e,t,n,i){return this.variableHandler.getAllVariableDiscriptions(e,t,n,i)}async getVariables(e,t){return this.variableHandler.getVariables(e,t)}async getFullVariable(e,t){return this.variableHandler.getFullVariable(e,t)}async getMatchingVariable(e,t,n){return this.variableHandler.getMatchingVariable(e,t,n)}async getDataFrameInfo(e,t,n,i){return this.variableHandler.getDataFrameInfo(e,t,n,i)}async getVariableValueSummary(e,t,n){return this.variableHandler.getVariableValueSummary(e,t,n)}async getDataFrameRows(e,t,n,i,o){return this.variableHandler.getDataFrameRows(e,t,n,i,o)}get variableHandler(){return this.debuggerVariables.active?this.debuggerVariables:this.kernelVariables}fireRefresh(){this.refreshEventEmitter.fire()}};U([Dr("DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME")],ev.prototype,"getVariables",1),ev=U([(0,zd.injectable)(),x(0,(0,zd.inject)(ve)),x(1,(0,zd.inject)(Oi)),x(1,(0,zd.named)(nt.KERNEL_VARIABLES)),x(2,(0,zd.inject)(Oi)),x(2,(0,zd.named)(nt.DEBUGGER_VARIABLES))],ev);p();var tv=se(ge()),Qd=require("vscode");var OI=class{constructor(e,t,n,i){this.disposableRegistry=e;this.kernelProvider=t;this.serverUriStorage=n;this.jupyterUriProviderRegistration=i;this.kernelsStartedSuccessfully=new WeakSet;this.kernelDisposables=new WeakMap;this.kernelConnectionToKernelMapping=new WeakMap;this.kernelsRestarting=new WeakSet;this.kernelReconnectProgress=new WeakMap;this.lastExecutedCellPerKernel=new WeakMap}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry),this.disposableRegistry.push(this.kernelProvider.onDidDisposeKernel(e=>{var t,n;(t=this.kernelDisposables.get(e))==null||t.dispose(),this.kernelDisposables.delete(e),(n=this.kernelReconnectProgress.get(e))==null||n.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(this.kernelProvider.onDidRestartKernel(e=>{var t;(t=this.kernelReconnectProgress.get(e))==null||t.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(Rr.onDidChangeNotebookCellExecutionState(e=>{if(!mr(e.cell.notebook)||e.state!==1)return;let t=this.kernelProvider.get(e.cell.notebook);!t||this.lastExecutedCellPerKernel.get(t)!==e.cell||this.lastExecutedCellPerKernel.delete(t)}))}getKernelSpecificDisposables(e){let t=this.kernelDisposables.get(e)||new En;return this.disposableRegistry.push(t),this.kernelDisposables.set(e,t),t}onDidStartKernel(e){var n,i,o;if(this.kernelsStartedSuccessfully.has(e)||!((n=e.session)!=null&&n.kernel))return;let t=this.getKernelSpecificDisposables(e);t.add(Rr.onDidChangeNotebookCellExecutionState(s=>{s.cell.notebook===e.notebook&&this.kernelProvider.get(s.cell.notebook)===e&&s.state===3&&this.lastExecutedCellPerKernel.set(e,s.cell)},this)),this.kernelsStartedSuccessfully.add(e),this.kernelConnectionToKernelMapping.set(e.session.kernel,e),(o=(i=e.session)==null?void 0:i.kernel)==null||o.connectionStatusChanged.connect(this.onKernelStatusChanged,this),t.add(e.addHook("willRestart",async()=>{var s;(s=this.kernelReconnectProgress.get(e))==null||s.dispose(),this.kernelReconnectProgress.delete(e),this.kernelsRestarting.add(e)},this)),t.add(e.onRestarted(()=>this.kernelsRestarting.delete(e),this))}onKernelStatusChanged(e,t){var i,o,s,a;let n=this.kernelConnectionToKernelMapping.get(e);if(n&&!this.kernelsRestarting.has(n))switch(t){case"connected":{(i=this.kernelReconnectProgress.get(n))==null||i.dispose(),this.kernelReconnectProgress.delete(n);return}case"disconnected":{this.kernelReconnectProgress.has(n)&&((o=this.kernelReconnectProgress.get(n))==null||o.dispose(),this.kernelReconnectProgress.delete(n),(s=this.onKernelDisconnected(n))==null||s.catch(E));return}case"connecting":this.kernelReconnectProgress.has(n)||(a=this.onKernelConnecting(n))==null||a.catch(E);return;default:return}}async onKernelConnecting(e){let t=this.getKernelSpecificDisposables(e),n=Re(),i=new Qd.Disposable(()=>n.resolve());if(this.kernelReconnectProgress.set(e,i),Wt(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata))return;let o=W.automaticallyReconnectingToAKernelProgressMessage(ut(e.kernelConnectionMetadata));Qd.window.withProgress({location:Qd.ProgressLocation.Notification,title:o},async()=>n.promise).then(E,E),t.add(i)}async onKernelDisconnected(e){var n;if(e.disposed||e.disposing||(Br(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),Wt(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata)))return;let t=zt(e.kernelConnectionMetadata)?W.kernelDisconnected(ut(e.kernelConnectionMetadata)):W.remoteJupyterConnectionFailedWithServer(e.kernelConnectionMetadata.baseUrl);Qd.window.showErrorMessage(t).then(E,E);try{let i=this.lastExecutedCellPerKernel.get(e);if(!i||i.document.isClosed||i.notebook.isClosed||((n=i.executionSummary)==null?void 0:n.success)===!1)return;await Od(i,e.controller,t,!1)}finally{await e.dispose()}}async handleRemoteServerShutdown(e,t){var o;let n=this.jupyterUriProviderRegistration.jupyterCollections.find(s=>s.extensionId===t.serverProviderHandle.extensionId&&s.id===t.serverProviderHandle.id);if(!n)return!1;let i=new Qd.CancellationTokenSource;try{return(await Promise.resolve(n.serverProvider.provideJupyterServers(i.token))||[]).map(l=>l.id).includes(t.serverProviderHandle.handle)?!1:(await this.serverUriStorage.remove(t.serverProviderHandle),(o=this.kernelReconnectProgress.get(e))==null||o.dispose(),this.kernelReconnectProgress.delete(e),!0)}catch(s){return!1}finally{i.dispose()}}};OI=U([(0,tv.injectable)(),x(0,(0,tv.inject)(ve)),x(1,(0,tv.inject)(qe)),x(2,(0,tv.inject)(dr)),x(3,(0,tv.inject)(sr))],OI);p();var pZ=se(ge());var LI=class{isTrusted(e){return!0}};LI=U([(0,pZ.injectable)()],LI);p();var KI=Symbol("ITrustedKernelPaths");p();var SP=se(ge());var fZ=require("vscode");var FI=class{constructor(e,t){this.kernelProvider=e;this.disposables=[];this.restartProgress=new WeakMap;this.interruptProgress=new WeakMap;t.push(this)}dispose(){Ce(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.kernelProvider.onDidDisposeKernel(e=>{var t,n;(t=this.restartProgress.get(e))==null||t.dispose(),(n=this.interruptProgress.get(e))==null||n.dispose()},this,this.disposables)}onDidCreateKernel(e){e.addHook("willRestart",async()=>{var n;(n=this.restartProgress.get(e))==null||n.dispose();let t=Kt.createProgressReporter(e.resourceUri,W.restartingKernelStatus(`: ${ut(e.kernelConnectionMetadata)}`));this.restartProgress.set(e,t)},this,this.disposables),e.addHook("restartCompleted",async()=>{var t,n;(t=this.restartProgress.get(e))==null||t.dispose(),(n=this.interruptProgress.get(e))==null||n.dispose()},this,this.disposables),e.addHook("willInterrupt",async()=>{let t=new En,n=setTimeout(()=>{t.isDisposed||t.add(Kt.createProgressReporter(e.resourceUri,W.interruptKernelStatus(ut(e.kernelConnectionMetadata))))},1e3);t.add(new fZ.Disposable(()=>clearTimeout(n))),this.interruptProgress.set(e,t)},this,this.disposables),e.addHook("interruptCompleted",async()=>{var t;return(t=this.interruptProgress.get(e))==null?void 0:t.dispose()},this,this.disposables)}};FI=U([(0,SP.injectable)(),x(0,(0,SP.inject)(qe)),x(1,(0,SP.inject)(ve))],FI);p();var IP=se(ge()),r9=require("vscode");var UI=class{constructor(e,t){this.kernelFinder=t;this.disposables=[];e.push(this)}dispose(){Ce(this.disposables)}activate(){this.startRefresh()}startRefresh(){if(!this.refreshedOnceBefore){if(this.kernelFinder.status==="discovering")return this.displayProgressIndicator();this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="discovering"&&this.displayProgressIndicator()},this,this.disposables)}}displayProgressIndicator(){let e=Date.now().toString();w.debug(`Start refreshing Kernel Picker (${e})`);let t=r9.notebooks.createNotebookControllerDetectionTask(bt),n=r9.notebooks.createNotebookControllerDetectionTask(vr);this.disposables.push(t),this.disposables.push(n),this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="idle"&&(w.debug(`End refreshing Kernel Picker (${e})`),t.dispose(),n.dispose())},this,this.disposables)}};UI=U([(0,IP.injectable)(),x(0,(0,IP.inject)(ve)),x(1,(0,IP.inject)(oi))],UI);p();var VI=se(ge());var jIe=1e3,WI=class{constructor(e,t,n){this.serverStorage=e;this.kernelProvider=t;this.disposables=[];this.timeouts=new Set;this.kernelSpecificUpdates=new WeakMap;n.push(this)}dispose(){Ce(this.disposables),Ce(Array.from(this.timeouts.values()))}activate(){this.disposables.push(Rr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this))}onDidChangeNotebookCellExecutionState(e){let t=this.kernelProvider.get(e.cell.notebook);if(!t)return;let n=t.kernelConnectionMetadata;if(!Wt(n))return;let i=this.kernelSpecificUpdates.get(t)||new ec(jIe);this.kernelSpecificUpdates.set(t,i),i.trigger(()=>{t.disposed||t.disposing||this.serverStorage.update(n.serverProviderHandle).catch(E)})}};WI=U([(0,VI.injectable)(),x(0,(0,VI.inject)(dr)),x(1,(0,VI.inject)(qe)),x(2,(0,VI.inject)(ve))],WI);p();var mZ=se(ge());var jI=class{async installMissingDependencies(e){return 1}async areDependenciesInstalled(e,t,n){return!1}};jI=U([(0,mZ.injectable)()],jI);p();var hZ=se(ge());var BI=class{constructor(){this.providers=new Map}getProviders(e){return(this.providers.get(e)||[]).slice()}register(e,t){this.providers.set(t,this.providers.get(t)||[]),this.providers.get(t).push(e)}};BI=U([(0,hZ.injectable)()],BI);p();var rv=se(ge());var vZ=require("vscode");var gZ=1e3*60*60*24*2,Ul=class extends Lr{constructor(t,n,i,o){super();this.serverStorage=n;this.context=i;this.fs=o;this.executedCells=new WeakMap;this.chainedPromises=Promise.resolve();i.globalStorageUri,t.push(this),this.storageFile=vZ.Uri.joinPath(this.context.globalStorageUri,"lastExecutedRemoteCell.json")}activate(){this._register(this.serverStorage.onDidRemove(this.onDidRemoveServers,this))}async getLastTrackedCellExecution(t,n){var s;if(t.isUntitled||!Wt(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;if(this.staleState&&this.staleState[t.uri.toString()])return this.staleState[t.uri.toString()];let i=await this.getStorageFile(),o={};try{let a=await this.fs.readFile(i);o=JSON.parse(a.toString()),this.staleState=o}catch(a){return}return o[t.uri.toString()]}trackCellExecution(t,n){if(!Wt(n.kernelConnectionMetadata)||t.document.isUntitled)return;this.executedCells.delete(t);let i=[],o=(a,l)=>{var u,c;if(l.direction==="send"){let d=l.msg;if(d.header.msg_type==="execute_request"&&d.metadata&&typeof d.metadata=="object"&&d.metadata&&"cellId"in d.metadata&&typeof d.metadata.cellId=="string"&&d.metadata.cellId===t.document.uri.toString()){let f=d.header.msg_id;this.executedCells.set(t,{msg_id:f,kernelId:((c=(u=n.session)==null?void 0:u.kernel)==null?void 0:c.id)||"",cellIndex:t.index})}}else if(l.direction==="recv"){let d=l.msg,f=this.executedCells.get(t);if(f!=null&&f.msg_id&&Gd(d)===f.msg_id){if(!f.startTime){f.startTime=new Date().getTime();try{f.startTime=new Date(d.header.date).getTime()}catch(m){}this.executedCells.set(t,f)}"execution_count"in d.content&&typeof d.content.execution_count=="number"&&!f.executionCount&&f.executionCount!==d.content.execution_count&&(f.executionCount=d.content.execution_count,this.executedCells.set(t,f),this.trackLastExecution(t,n,f),Ce(i))}}},s=()=>{let a=n.session;a&&(a.anyMessage.connect(o),i.push({dispose:()=>zs(()=>{var l;return(l=a.anyMessage)==null?void 0:l.disconnect(o)})}))};n.onStarted(()=>s(),i),n.session&&s()}deleteTrackedCellExecution(t,n){var i;t.notebook.isUntitled||!Wt(n.kernelConnectionMetadata)||!((i=n.session)!=null&&i.id)||(this.chainedPromises=this.chainedPromises.finally(async()=>{let o={};try{let a=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));o=JSON.parse(a.toString())}catch(a){return}let s=t.notebook.uri.toString();o[s].cellIndex===t.index&&(delete o[s],this.staleState=o,await this.fs.writeFile(this.storageFile,JSON.stringify(o)))}))}getStorageFile(){return this.ensureStorageExistsPromise=this.ensureStorageExistsPromise||(async()=>(await this.fs.createDirectory(this.context.globalStorageUri),this.storageFile))(),this.ensureStorageExistsPromise}trackLastExecution(t,n,i){var s,a,l,u;if(!i.executionCount||!i.msg_id||!i.startTime||!Wt(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;let o={cellIndex:t.index,executionCount:i.executionCount,kernelId:((l=(a=n.session)==null?void 0:a.kernel)==null?void 0:l.id)||"",msg_id:i.msg_id,serverId:Vt(n.kernelConnectionMetadata.serverProviderHandle),sessionId:(u=n.session)==null?void 0:u.id,startTime:i.startTime};this.chainedPromises=this.chainedPromises.finally(async()=>{let c={};try{let f=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));c=JSON.parse(f.toString())}catch(f){}let d=t.notebook.uri.toString();c[d]=o,this.removeOldItems(c),this.staleState=c,await this.fs.writeFile(this.storageFile,JSON.stringify(c))})}onDidRemoveServers(t){t.length!==0&&(this.chainedPromises=this.chainedPromises.finally(async()=>{await this.getStorageFile();let n={};try{let s=await this.fs.readFile(this.storageFile);n=JSON.parse(s.toString())}catch(s){}let i=!1,o=new Set(t.map(s=>Vt(s)));Object.keys(n).forEach(s=>{let a=n[s];(o.has(a.serverId)||Date.now()-a.startTime>gZ)&&(delete n[s],i=!0)}),i&&(this.removeOldItems(n),this.staleState=n,await this.fs.writeFile(this.storageFile,JSON.stringify(n)))}))}removeOldItems(t){Object.keys(t).forEach(n=>{let i=t[n];i&&Date.now()-i.startTime>gZ&&delete t[n]})}};Ul=U([(0,rv.injectable)(),x(0,(0,rv.inject)(ve)),x(1,(0,rv.inject)(dr)),x(2,(0,rv.inject)(st)),x(3,(0,rv.inject)(Pt))],Ul);p();var qI=se(ge());var _P=require("vscode");var HI=class{constructor(e,t,n){this.serverUriStorage=e;this.registrations=t;this.disposables=n}activate(){this.disposables.push(_P.commands.registerCommand(le.ClearSavedJupyterUris,async()=>{await this.serverUriStorage.clear().catch(E),await Promise.all(this.registrations.jupyterCollections.filter(e=>e.id.startsWith("_builtin")||e.extensionId===Je).map(async e=>{if(!e.serverProvider||!e.serverProvider.removeJupyterServer)return;let t=new _P.CancellationTokenSource,n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await Promise.all((n||[]).map(i=>e.serverProvider.removeJupyterServer(i).catch(E)))})).catch(E),await _P.commands.executeCommand("dataScience.ClearUserProviderJupyterServerCache").then(E,E)},this))}};HI=U([(0,qI.injectable)(),x(0,(0,qI.inject)(dr)),x(1,(0,qI.inject)(sr)),x(2,(0,qI.inject)(ve))],HI);p();var $A=se(ge());var JI=class{constructor(e){this.registry=e;this.priority=0}activate(){this.registry.register(this,bt),this.registry.register(this,vr)}async getCode(e){return jt(e.kernelConnectionMetadata)?[Zz]:[]}};JI=U([(0,$A.injectable)(),x(0,(0,$A.inject)(Md))],JI);var EP=class{constructor(){this.isSupported=!1}};EP=U([(0,yZ.injectable)()],EP);function bZ(r,e){r.addSingleton(Hd,EP),Qb("isInsiderExtension",Fv()?"true":"false");let t=r.get(vo);Qb("isPythonExtensionInstalled",t.isPythonExtensionInstalled?"true":"false");let n=r.get(Hd);Qb("rawKernelSupported",n.isSupported?"true":"false"),r.addSingleton(Md,BI),r.addSingleton(Oi,ev,nt.ALL_VARIABLES),r.addSingleton(Ve,Jg),r.addSingleton(Ve,UI),r.addSingleton(Ve,FI),r.addSingleton(Ve,OI),r.addSingleton(Ve,WI),r.addSingleton(qe,NI),r.addSingleton(KI,LI),r.addSingleton(Ug,RI),r.addSingleton(Vs,Vs),r.addSingleton(oi,AI),r.addSingleton(CS,jI),r.addSingleton(Ve,HI),r.addSingleton(Ul,Ul),r.addBinding(Ul,Ve),nZ(r,e),r.addSingleton(Ve,rn),r.addSingleton(Ve,JI)}p();p();var GI=se(ge()),iv=require("vscode");var nv=class{constructor(e,t,n){this.disposables=e;this.controllerRegistration=t;this.preferredRemoteKernelIdProvider=n}activate(){iv.workspace.onDidOpenNotebookDocument(this.onDidOpenNotebook,this,this.disposables),iv.workspace.notebookDocuments.forEach(e=>this.onDidOpenNotebook(e))}async onDidOpenNotebook(e){if(!mr(e))return;let t=await this.preferredRemoteKernelIdProvider.getPreferredRemoteKernelId(e);if(!t)return;let n=()=>{let o=this.controllerRegistration.getSelected(e),s=this.controllerRegistration.registered.find(a=>a.id===t);return s&&(o==null?void 0:o.id)!==s.id?(this.switchKernel(e,s.connection).catch(E),!0):!1};if(n())return;let i=this.controllerRegistration.onDidChange(o=>{o.added.length&&n()&&i.dispose()},this,this.disposables);this.controllerRegistration.onControllerSelected(o=>{o.notebook===e&&i.dispose()},this,this.disposables)}async switchKernel(e,t){w.debug(`Using notebook.selectKernel to force remote kernel for ${Ee(e.uri)} to ${t.id}`),await iv.commands.executeCommand("notebook.selectKernel",{id:t.id,extension:Je}),await pD(async()=>{var i;if(((i=iv.window.activeNotebookEditor)==null?void 0:i.notebook)===e){let o=this.controllerRegistration.getSelected(e);if((o==null?void 0:o.connection.id)===t.id)return o.restoreConnection(e).catch(E),!0}return!1},2e3,100)?w.debug(`Successfully switched remote kernel for ${Ee(e.uri)} to ${t.id}`):w.warn(`Failed to switch remote kernel for ${Ee(e.uri)} to ${t.id}`)}};U([hn()],nv.prototype,"onDidOpenNotebook",1),nv=U([(0,GI.injectable)(),x(0,(0,GI.inject)(ve)),x(1,(0,GI.inject)(Nt)),x(2,(0,GI.inject)(Vs))],nv);p();var YI=se(ge()),fm=require("vscode");p();var SZ=Symbol("IServiceManager"),Nr=Symbol("IServiceContainer");p();var fs=require("vscode");p();function hu(r){if(typeof r!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof r}\``);var e=_Z();let t=e;return t.default&&(t=t.default),r.replace(t(),"")}p();p();var wP=se(ge()),xZ=require("vscode");p();var o9=se($g()),EZ=require("vscode");p();function n9(r){if(!r||!Array.isArray(r)||r.length===0)return;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=Array.apply(null,new Uint8Array(n.buffer));e.push({...n,byteLength:n.byteLength,byteOffset:n.byteOffset,buffer:i})}else e.push([...new Uint8Array(n)])}return e}function i9(r){if(!Array.isArray(r)||r.length===0)return r;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=new Uint8Array(n.buffer).buffer,o=new DataView(i,n.byteOffset,n.byteLength);e.push(o)}else{let i=new Uint8Array(n).buffer;e.push(i)}}return e}var CP=new WeakMap;function CZ(r,e){let t=CP.get(r);t&&(t.targets.add(e),t.registerCommTarget(e))}function wZ(r,e){var t,n,i;(i=(n=(t=CP.get(r))==null?void 0:t.targets)==null?void 0:n.delete)==null||i.call(n,e)}var zA=class{constructor(e,t){this.kernelProvider=e;this.document=t;this.commTargetsRegistered=new Set;this.pendingTargetNames=new Set;this._postMessageEmitter=new EZ.EventEmitter;this.messageHooks=new Map;this.pendingHookRemovals=new Map;this.messageHookRequests=new Map;this.disposables=[];this.disposed=!1;this.pendingMessages=[];this.subscribedToKernelSocket=!1;this.waitingMessageIds=new Map;this.outputWidgetIds=new Set;this.isUsingIPyWidgets=!1;this.kernelSocketHandlers=new WeakMap;this.pendingTargetNames.add("jupyter.widget"),e.onDidStartKernel(i=>{i.notebook===t&&this.initialize()},this,this.disposables),this.mirrorSend=this.mirrorSend.bind(this),this.onKernelSocketMessage=this.onKernelSocketMessage.bind(this);let n=z2();this.deserialize=n.deserialize}get postMessage(){return this._postMessageEmitter.event}dispose(){for(this.disposed=!0;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}receiveMessage(e){switch(e.message){case"IPyWidgets_logMessage":{let t=e.payload;t.category==="error"?w.error(`Widget Error: ${t.message}`):w.trace(`Widget Message: ${t.message}`);break}case"IPyWidgets_Ready":this.sendKernelOptions(),this.initialize();break;case"IPyWidgets_msg":this.sendRawPayloadToKernelSocket(e.payload);break;case"IPyWidgets_binary_msg":this.sendRawPayloadToKernelSocket(i9(e.payload)[0]);break;case"IPyWidgets_msg_received":this.onKernelSocketResponse(e.payload);break;case"IPyWidgets_registerCommTarget":this.registerCommTarget(e.payload);break;case"IPyWidgets_RegisterMessageHook":this.registerMessageHook(e.payload);break;case"IPyWidgets_RemoveMessageHook":this.possiblyRemoveMessageHook(e.payload);break;case"IPyWidgets_MessageHookResult":this.handleMessageHookResponse(e.payload);break;case"IPyWidgets_iopub_msg_handled":this.iopubMessageHandled(e.payload);break;default:break}}sendRawPayloadToKernelSocket(e){this.pendingMessages.push(e),this.sendPendingMessages()}registerCommTarget(e){this.pendingTargetNames.add(e),this.initialize()}initialize(){this.jupyterLab||(this.jupyterLab=ri());let e=this.getKernel();e&&(this.subscribeToKernelSocket(e),this.registerCommTargets(e))}raisePostMessage(e,t){this._postMessageEmitter.fire({message:e,payload:t})}subscribeToKernelSocket(e){var n;if(this.subscribedToKernelSocket||!e.session)return;this.subscribedToKernelSocket=!0,this.subscribeToKernelSocketImpl(e);let t=(n=e.session.kernel)==null?void 0:n.id;e.session.onDidKernelSocketChange(()=>{var i,o;this.subscribeToKernelSocketImpl(e,t),t=((o=(i=e.session)==null?void 0:i.kernel)==null?void 0:o.id)||""})}subscribeToKernelSocketImpl(e,t){var l,u,c,d,f;let n=t?Mo.get(t):void 0,i=n?this.kernelSocketHandlers.get(n):void 0;if(i!=null&&i.receiveHook&&(n==null||n.removeReceiveHook(i.receiveHook)),i!=null&&i.sendHook&&(n==null||n.removeSendHook(i.sendHook)),this.kernelWasConnectedAtLeastOnce){for(;this.pendingMessages.length;)this.pendingMessages.shift();this.waitingMessageIds.forEach(m=>m.resultPromise.resolve()),this.waitingMessageIds.clear(),this.messageHookRequests.forEach(m=>m.resolve(!1)),this.messageHookRequests.clear(),this.messageHooks.clear(),this.sendRestartKernel()}if(!((u=(l=e.session)==null?void 0:l.kernel)!=null&&u.id)||!Mo.get((d=(c=e.session)==null?void 0:c.kernel)==null?void 0:d.id))return;CP.has(e.session.kernel)||CP.set(e.session.kernel,{targets:new Set,registerCommTarget:m=>{this.raisePostMessage("IPyWidgets_registerCommTarget",m)}}),this.kernelWasConnectedAtLeastOnce=!0;let o=(f=e.session.kernel)==null?void 0:f.id,s=o?Mo.get(o):void 0,a=(s==null?void 0:s.protocol)||"";if(s){let m=this.onKernelSocketMessage.bind(this,a),g=this.mirrorSend.bind(this,a);s.addReceiveHook(m),s.addSendHook(g),this.kernelSocketHandlers.set(s,{receiveHook:m,sendHook:g})}this.sendKernelOptions(a),this.registerCommTargets(e),this.sendPendingMessages(a)}sendKernelOptions(e=""){var n,i,o;let t=(i=(n=this.kernel)==null?void 0:n.session)==null?void 0:i.kernel;t&&(e||(e=((o=Mo.get(t.id))==null?void 0:o.protocol)||""),this.raisePostMessage("IPyWidgets_kernelOptions",{id:t.id,clientId:t.clientId||"",userName:t.username||"",model:t.model||{id:"",name:""},protocol:e}))}async mirrorSend(e,t,n){if(typeof t=="string"&&t.includes("shell")&&t.includes("execute_request")){let i=typeof t=="string"?JSON.parse(t):this.deserialize(t);if(i.channel==="shell"&&i.header.msg_type==="execute_request"){if(!yP(i))return;let o=this.mirrorExecuteRequest(i);this.isUsingIPyWidgets&&await o}}else if(typeof t!="string")try{let i=this.deserialize(t,e);if(i.channel==="shell"&&i.header.msg_type==="execute_request"){if(!yP(i))return;let o=this.mirrorExecuteRequest(i);this.isUsingIPyWidgets&&await o}}catch(i){w.error("Failed to mirror message to kernel",i)}}sendRestartKernel(){this.raisePostMessage("IPyWidgets_onRestartKernel",void 0)}mirrorExecuteRequest(e){let t=Re();return this.waitingMessageIds.set(e.header.msg_id,{startTime:Date.now(),resultPromise:t}),this.raisePostMessage("IPyWidgets_mirror_execute",{id:e.header.msg_id,msg:e}),t.promise}messageNeedsFullHandle(e){var t,n,i,o;return e.channel==="iopub"&&((t=e.header)==null?void 0:t.msg_type)==="comm_msg"&&((i=(n=e.content)==null?void 0:n.data)==null?void 0:i.method)==="update"&&this.outputWidgetIds.has((o=e.content)==null?void 0:o.comm_id)}iopubMessageHandled(e){let t=e.id;this.fullHandleMessage&&this.fullHandleMessage.id===t&&(this.fullHandleMessage.promise.resolve(),this.fullHandleMessage=void 0)}async onKernelSocketMessage(e,t){var s,a,l,u,c,d,f,m,g;let n=(0,o9.default)(),i=Re();if(this.waitingMessageIds.set(n,{startTime:Date.now(),resultPromise:i}),typeof t=="string")yP(t)&&this.raisePostMessage("IPyWidgets_msg",{id:n,data:t});else{let b=n9([t]),y=i9(b);console.error(b,y),this.raisePostMessage("IPyWidgets_binary_msg",{id:n,data:n9([t])})}if(typeof t!="string"||t.includes(po)||t.includes(nt.DefaultCommTarget)||t.includes("comm_open")||t.includes("comm_close")||t.includes("comm_msg")){let b=this.deserialize(t,e);if(!yP(b))return;b&&b.content&&b.content.data&&(b.content.data[po]||b.content.target_name===nt.DefaultCommTarget)&&(this.isUsingIPyWidgets=!0);let y=((s=b.header)==null?void 0:s.msg_type)==="comm_open"&&((u=(l=(a=b.content)==null?void 0:a.data)==null?void 0:l.state)==null?void 0:u._model_module)==="@jupyter-widgets/output"&&((f=(d=(c=b.content)==null?void 0:c.data)==null?void 0:d.state)==null?void 0:f._model_name)==="OutputModel",P=((m=b.header)==null?void 0:m.msg_type)==="comm_close"&&this.outputWidgetIds.has((g=b.content)==null?void 0:g.comm_id);y?this.outputWidgetIds.add(b.content.comm_id):P?this.outputWidgetIds.delete(b.content.comm_id):this.messageNeedsFullHandle(b)&&(this.fullHandleMessage={id:b.header.msg_id,promise:Re()},await i.promise,await this.fullHandleMessage.promise.promise,this.fullHandleMessage=void 0)}}onKernelSocketResponse(e){let t=this.waitingMessageIds.get(e.id);t&&(this.waitingMessageIds.delete(e.id),t.resultPromise.resolve())}sendPendingMessages(e=""){var t,n,i,o;if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel)for(e||(e=((i=Mo.get(this.kernel.session.kernel.id))==null?void 0:i.protocol)||"");this.pendingMessages.length;)try{let s=this.pendingMessages[0],a=typeof s=="string"?JSON.parse(s):this.deserialize(s,e);(o=a.buffers)!=null&&o.length&&(a.buffers=a.buffers.map(l=>l instanceof DataView?l.buffer:l)),a.channel==="control"?this.kernel.session.kernel.sendControlMessage(a):this.kernel.session.kernel.sendShellMessage(a),this.pendingMessages.shift()}catch(s){w.error("Failed to send message to Kernel",s);return}}registerCommTargets(e){var t,n,i;for(;this.pendingTargetNames.size>0;){let s=Array.from([...this.pendingTargetNames.values()]).shift();if(s){if(this.commTargetsRegistered.has(s))return;w.trace(`Registering commtarget ${s}`),this.commTargetsRegistered.add(s),this.pendingTargetNames.delete(s),(t=e.session)!=null&&t.kernel&&s!==nt.DefaultCommTarget&&!((i=(n=CP.get(e.session.kernel))==null?void 0:n.targets)!=null&&i.has(s))&&e.session.kernel.registerCommTarget(s,E)}}}getKernel(){var e,t;return this.document&&!((e=this.kernel)!=null&&e.session)&&(this.kernel=this.kernelProvider.get(this.document),(t=this.kernel)==null||t.onDisposed(()=>this.kernel=void 0)),this.kernel&&!this.kernelRestartHandlerAttached&&(this.kernelRestartHandlerAttached=!0,this.disposables.push(this.kernel.onRestarted(this.handleKernelRestarts,this))),this.kernel}async handleKernelRestarts(){var e;this.disposed||this.commTargetsRegistered.size===0||!((e=this.kernel)!=null&&e.session)||(Array.from(this.commTargetsRegistered.keys()).forEach(t=>{this.commTargetsRegistered.delete(t),this.pendingTargetNames.add(t)}),this.subscribeToKernelSocket(this.kernel),this.registerCommTargets(this.kernel))}registerMessageHook(e){var t,n;try{if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&!this.messageHooks.has(e)){let i=this.messageHookCallback.bind(this);this.messageHooks.set(e,i),this.kernel.session.kernel.registerMessageHook(e,i)}}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e,type:"IPyWidgets_RegisterMessageHook"})}}possiblyRemoveMessageHook(e){try{e.lastHookedMsgId?this.pendingHookRemovals.set(e.lastHookedMsgId,e.hookMsgId):this.removeMessageHook(e.hookMsgId)}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e.hookMsgId,type:"IPyWidgets_RemoveMessageHook"})}}removeMessageHook(e){var t,n;if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&this.messageHooks.has(e)){let i=this.messageHooks.get(e);this.messageHooks.delete(e),this.kernel.session.kernel.removeMessageHook(e,i)}}async messageHookCallback(e){let t=Re(),n=(0,o9.default)(),i=e.parent_header.msg_id;if(this.messageHooks.has(i)?(this.messageHookRequests.set(n,t),this.raisePostMessage("IPyWidgets_MessageHookCall",{requestId:n,parentId:i,msg:e})):t.resolve(!0),this.pendingHookRemovals.has(e.header.msg_id)){let o=this.pendingHookRemovals.get(e.header.msg_id);this.pendingHookRemovals.delete(e.header.msg_id),this.removeMessageHook(o)}return t.promise}handleMessageHookResponse(e){let t=this.messageHookRequests.get(e.requestId);t&&(this.messageHookRequests.delete(e.requestId),t.resolve(e.msgType.includes("comm")?!0:e.result))}};var s9=class{constructor(e,t){this.baseMulticaster=e;this.oldMessages=t;this._postMessageEmitter=new xZ.EventEmitter;this.disposables=[];e.postMessage(this.raisePostMessage,this,this.disposables)}get postMessage(){return this._postMessageEmitter.event}dispose(){for(;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}initialize(){return this.baseMulticaster.initialize()}receiveMessage(e){this.baseMulticaster.receiveMessage(e)}raisePostMessage(e){this.oldMessages.forEach(t=>{this._postMessageEmitter.fire(t)}),this.oldMessages=[],this._postMessageEmitter.fire(e)}},Xd=class{constructor(e,t){this.kernelProvider=t;this.messageDispatchers=new WeakMap;this.messagesPerNotebook=new WeakMap;this.disposed=!1;this.disposables=[];e.push(this),t.onDidDisposeKernel(this.trackDisposingOfKernels,this,e)}dispose(){var e;for(this.disposed=!0;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}create(e){let t=this.messageDispatchers.get(e);t||(t=new zA(this.kernelProvider,e),this.messageDispatchers.set(e,t),this.disposables.push(t.postMessage(o=>this.onMessage(o,e),this)));let n=[];e&&this.messagesPerNotebook.get(e)&&(n=this.messagesPerNotebook.get(e)||[]);let i=new s9(t,n);return this.disposables.push(i),i}trackDisposingOfKernels(e){if(this.disposed)return;let t=e.notebook,n=this.messageDispatchers.get(t);this.messageDispatchers.delete(t),n==null||n.dispose()}onMessage(e,t){t&&(this.messagesPerNotebook.set(t,this.messagesPerNotebook.get(t)||[]),(e.message==="IPyWidgets_kernelOptions"||e.message==="IPyWidgets_registerCommTarget")&&this.messagesPerNotebook.get(t).push(e))}};Xd=U([(0,wP.injectable)(),x(0,(0,wP.inject)(ve)),x(1,(0,wP.inject)(qe))],Xd);p();var TZ=require("vscode");p();var PZ=require("vscode");var ov=class ov extends Lr{constructor(t,n,i,o,s,a){super();this.kernel=t;this.localResourceUriConverter=n;this.configurationSettings=i;this.sourceProviderFactory=o;this.isWebViewOnline=s;this.cdnScriptProvider=a;this.id="all";this.scriptProviders=this.sourceProviderFactory.getProviders(this.kernel,this.localResourceUriConverter),this.scriptProviders.forEach(l=>this._register(l)),this.monitorKernel()}get configuredScriptSources(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}async getBaseUrl(){let t=this.scriptProviders.find(n=>n.getBaseUrl);if(t)return t.getBaseUrl()}async getWidgetScriptSources(){let t=[];return await Promise.all(this.scriptProviders.map(async n=>{n.getWidgetScriptSources&&t.push(...await n.getWidgetScriptSources())})),t}async getWidgetScriptSource(t,n){let i=await this.isWebViewOnline,o=this.scriptProviders.slice(),s={moduleName:t};for(;o.length;){let a=o.shift();if(!a)continue;let l=await a.getWidgetScriptSource(t,n,i);if(l.scriptUri){s=l;break}else w.warn(`Widget Script Source not found for ${t}@${n} from ${a.id}`)}return this.sendTelemetryForWidgetModule(t,n,"",s.source).catch(E),s.scriptUri?w.trace(`Script source for Widget ${t}@${n} was found from source ${s.source} and ${s.scriptUri}`):w.error(`Script source for Widget ${t}@${n} not found in ${this.scriptProviders.map(a=>a.id).join(", ")}`),s}async sendTelemetryForWidgetModule(t,n,i,o){let s=`${t}.${t}@${n}`;if(ov.trackedWidgetModuleNames.has(s))return;ov.trackedWidgetModuleNames.add(s);let a=t.toLowerCase().startsWith("@jupyter-widgets"),l=o==="cdn"||a||await this.cdnScriptProvider.isOnCDN(t),u=l?t.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0,c=l?i.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0;ne("DS_INTERNAL.IPYWIDGET_USED_BY_USER",void 0,{hashedName:await Rt(t),moduleName:u,modelName:c,source:o,moduleVersion:l?n:void 0,cdnSearched:this.configuredScriptSources.length>0})}monitorKernel(){this.hookKernelEvents(),this._register(this.kernel.onStarted(this.hookKernelEvents,this)),this._register(this.kernel.onRestarted(this.hookKernelEvents,this)),this._register(this.kernel.onDidKernelSocketChange(()=>this.hookKernelEvents(),this))}hookKernelEvents(){var n;let t=(n=this.kernel.session)==null?void 0:n.kernel;t&&(t.anyMessage.connect(this.onAnyMessage,this),this._register(new PZ.Disposable(()=>t.anyMessage.disconnect(this.onAnyMessage,this))))}onAnyMessage(t,n){var i,o,s,a;if(n.direction==="recv"&&n.msg.header.msg_type==="comm_open"){let u=n.msg.content.data;(i=u.state)!=null&&i._model_module&&u.state._model_name&&this.sendTelemetryForWidgetModule((o=u.state)==null?void 0:o._model_module,((s=u.state)==null?void 0:s._model_module_version)||"",(a=u.state)==null?void 0:a._model_name).catch(E)}}};ov.trackedWidgetModuleNames=new Set,U([hn()],ov.prototype,"sendTelemetryForWidgetModule",1),U([hn()],ov.prototype,"onAnyMessage",1);var XA=ov;p();var ZA=class{constructor(e,t){this.isWebExtension=e;this.converter=t}async asWebviewUri(e){return this.isWebExtension?e:this.converter(e)}};p();var a9=class{constructor(e,t){this.uri=e;this.value=t}};function HIe(r){return Array.isArray(r)}var qIe,sv=class sv{constructor(e,t){this[qIe]="ResourceMap";if(e instanceof sv)this.map=new Map(e.map),this.toKey=t!=null?t:sv.defaultToKey;else if(HIe(e)){this.map=new Map,this.toKey=t!=null?t:sv.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e!=null?e:sv.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new a9(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t!="undefined"&&(e=e.bind(t));for(let[,n]of this.map)e(n.value,n.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(qIe=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}};sv.defaultToKey=e=>e.toString();var gu=sv,JIe,eM=class{constructor(e,t){this[JIe]="ResourceSet";!e||typeof e=="function"?this._map=new gu(e):(this._map=new gu(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(JIe=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}};var GIe,DZ=class{constructor(){this[GIe]="LinkedMap";this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.key,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.value,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:[n.key,n.value],done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}[(GIe=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}};var tM=class{constructor(e,t,n,i,o,s){this.document=e;this.kernelProvider=t;this.configurationSettings=i;this.sourceProviderFactory=o;this.cdnScriptProvider=s;this.postEmitter=new TZ.EventEmitter;this.disposables=[];this.isWebViewOnline=Re();this.widgetSources=new Map;this.pendingModuleRequests=new Map;this.uriTranslationRequests=new gu;this.uriConverter=new ZA(_n(),a=>(this.uriTranslationRequests.has(a)||this.uriTranslationRequests.set(a,Re()),this.postEmitter.fire({message:"ConvertUriForUseInWebViewRequest",payload:a}),this.uriTranslationRequests.get(a).promise)),this.isWebViewOnline.promise.catch(E),n.push(this),this.kernelProvider.onDidStartKernel(a=>{a.notebook===this.document&&this.initialize()},this,this.disposables)}get postMessage(){return this.postEmitter.event}dispose(){var e;for(;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}onMessage(e,t){if(e==="ConvertUriForUseInWebViewResponse"){let n=t;n&&this.uriTranslationRequests.has(n.request)&&this.uriTranslationRequests.get(n.request).resolve(n.response)}else if(e==="IPyWidgets_Ready")this.sendBaseUrl(),this.sendWidgetScriptSources().catch(E);else if(e==="IPyWidgets_IsOnline"){let n=t.isOnline;this.isWebViewOnline.resolve(n)}else e==="IPyWidgets_WidgetScriptSourceRequest"&&t&&this.onRequestWidgetScript(t).catch(E)}initialize(){var e;this.jupyterLab||(this.jupyterLab=ri()),this.kernel||(this.kernel=this.kernelProvider.get(this.document)),(e=this.kernel)!=null&&e.session&&(this.scriptProvider&&!this.scriptProvider.isDisposed||(this.scriptProvider=new XA(this.kernel,this.uriConverter,this.configurationSettings,this.sourceProviderFactory,this.isWebViewOnline.promise,this.cdnScriptProvider),this.kernel.onDisposed(()=>this.dispose()),this.handlePendingRequests(),this.sendBaseUrl(),w.trace("IPyWidgetScriptSource.initialize")))}sendBaseUrl(){this.scriptProvider&&this.scriptProvider.getBaseUrl().then(e=>{e&&this.postEmitter.fire({message:"IPyWidgets_BaseUrl_Response",payload:e.toString()})}).catch(e=>w.error("Failed to get baseUrl",e))}async sendWidgetScriptSources(){if(this.scriptProvider&&!this.allWidgetScriptsSent)try{(await this.scriptProvider.getWidgetScriptSources()).forEach(t=>{var n;((n=this.widgetSources.get(t.moduleName))==null?void 0:n.source)!=="cdn"&&this.widgetSources.set(t.moduleName,t),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:t})})}catch(e){w.warn("Failed to fetch script sources",e)}finally{this.allWidgetScriptsSent=!0}}async onRequestWidgetScript(e){let{moduleName:t,moduleVersion:n,requestId:i}=e;if(w.trace(`\x1B[32mFetch Script for ${JSON.stringify(e)}`),await this.sendWidgetSource(t,n,i).catch(o=>w.error("Failed to send widget sources upon ready",o)),this.scriptProvider&&!this.allWidgetScriptsSent)try{await this.sendWidgetScriptSources()}finally{this.sendWidgetSource(t,n,i).catch(o=>w.error("Failed to send widget sources upon ready",o))}}async sendWidgetSource(e,t="*",n){var o;if(!e||e.startsWith("@jupyter"))return;if(!this.kernel||!this.scriptProvider){this.pendingModuleRequests.set(e,{moduleVersion:t,requestId:n});return}let i={moduleName:e,requestId:n};try{w.trace(`\x1B[32mFetch Script for ${e}`),i=await this.scriptProvider.getWidgetScriptSource(e,t),((o=this.widgetSources.get(i.moduleName))==null?void 0:o.source)!=="cdn"&&this.widgetSources.set(i.moduleName,i)}catch(s){w.error("Failed to get widget source due to an error",s),ne("DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED")}finally{w.trace(`\x1B[32mScript for ${e}, is ${i.scriptUri} from ${i.source}`),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:i})}}handlePendingRequests(){let e=Array.from(this.pendingModuleRequests.keys());for(;e.length;){let t=e.shift();if(t){let{moduleVersion:n,requestId:i}=this.pendingModuleRequests.get(t);this.pendingModuleRequests.delete(t),this.sendWidgetSource(t,n,i).catch(o=>w.error(`Failed to send WidgetScript for ${t}`,o))}}}};p();var nM=Symbol("IWidgetScriptSourceProviderFactory"),kZ=Symbol("INbExtensionsPathProvider"),iM=Symbol("IIPyWidgetScriptManagerFactory"),sbt=Symbol("IIPyWidgetScriptManager");p();var av=se(ge()),ps=require("vscode");var AZ="https://unpkg.com/",c9="https://cdn.jsdelivr.net/npm/",oM="IPYWidgetCDNConfigured",NZ="IPYWidgetNotFoundOnCDN",RZ="IPYWidgetNoNetWorkAccess";function YIe(r,e,t){let n=e,i="index",o=e.indexOf("/");return o!==-1&&e[0]==="@"&&(o=e.indexOf("/",o+1)),o!==-1&&(i=e.substr(o+1),n=e.substr(0,o)),r===c9&&(t.startsWith("^")&&(t=t.slice(1)),i.endsWith(".js")||(i=i.concat(".js"))),`${r}${n}@${t}/dist/${i}`}function $Ie(r){switch(r){case"unpkg.com":return AZ;case"jsdelivr.com":return c9;default:break}}var Wl=class{constructor(e,t){this.globalMemento=e;this.configurationSettings=t;this.id="cdn";this.cache=new Map;this.isOnCDNCache=new Map;this.notifiedUserAboutWidgetScriptNotFound=new Set}get cdnProviders(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}dispose(){this.cache.clear()}async isOnCDN(e){let t=`MODULE_VERSION_ON_CDN_${e}`;if(this.isOnCDNCache.has(t))return this.isOnCDNCache.get(t);if(this.globalMemento.get(t,!1))return!0;let n=(async()=>{let i=new cu,o=Au(i.exists(`${AZ}${e}`)),s=Au(i.exists(`${c9}${e}`));return await Promise.race([o.promise,s.promise]),o.value||s.value?!0:(await Promise.all([o.promise,s.promise]),!!(o.value||s.value))})();return n.then(i=>{if(i)return this.globalMemento.update(t,!0)}).then(E,E),this.isOnCDNCache.set(t,n),n}async getWidgetScriptSource(e,t,n){if(n===!1)return w.ci(`Webview is offline, cannot use CDN for ${e}`),this.warnIfNoAccessToInternetFromWebView(e).catch(E),{moduleName:e};if(this.cdnProviders.length===0&&this.globalMemento.get(oM,!1))return w.ci("No CDN providers and user configured CDN"),{moduleName:e};let i=this.getModuleKey(e,t);return this.cache.get(i)||this.cache.set(i,this.getWidgetScriptSourceImplementation(e,t)),this.cache.get(i)}async generateDownloadUri(e,t,n){let i=$Ie(n);if(i)return YIe(i,e,t)}getModuleKey(e,t){return`${e}${t}`}async getWidgetScriptSourceImplementation(e,t){if(w.trace(`\x1B[32mSearching for Widget Script ${e}#${t} using cdns ${this.cdnProviders.join(" ")}`),await this.configureWidgets(),this.cdnProviders.length===0)return{moduleName:e};let i=(await Promise.all(this.cdnProviders.map(o=>this.getValidUri(e,t,o)))).find(o=>o);return i?(w.trace(`\x1B[32mWidget Script ${e}#${t} found at URI: ${i}`),{moduleName:e,scriptUri:i,source:"cdn"}):(w.error(`Widget Script ${e}#${t} was not found on on any cdn`),this.handleWidgetSourceNotFound(e,t).catch(E),{moduleName:e})}async getValidUri(e,t,n){try{let i=await this.generateDownloadUri(e,t,n),o=new cu;if(i&&await o.exists(i))return i}catch(i){w.trace(`Failed downloading ${e}:${t} from ${n}`);return}}async warnIfNoAccessToInternetFromWebView(e){if(this.globalMemento.get(RZ,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await ps.window.showWarningMessage(W.cdnWidgetScriptNotAccessibleWarningMessage(e,JSON.stringify(this.cdnProviders)),Ue.ok,Ue.doNotShowAgain,Ue.moreInfo)){case Ue.doNotShowAgain:return this.globalMemento.update(RZ,!0);case Ue.moreInfo:return ps.env.openExternal(ps.Uri.parse("https://aka.ms/PVSCIPyWidgets"));default:}}async configureWidgets(){if(this.cdnProviders.length!==0||this.globalMemento.get(oM,!1))return;if(this.configurationPromise)return this.configurationPromise.promise;this.configurationPromise=Re(),ne("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN");let e=await ps.window.showInformationMessage(W.useCDNForWidgetsNoInformation,{modal:!0},Ue.ok,Ue.doNotShowAgain,Ue.moreInfo),t="dismissed";switch(e){case Ue.ok:{t="ok",await Promise.all([this.updateScriptSources(["jsdelivr.com","unpkg.com"]),this.globalMemento.update(oM,!0)]);break}case Ue.doNotShowAgain:{t="doNotShowAgain",await Promise.all([this.updateScriptSources([]),this.globalMemento.update(oM,!0)]);break}case Ue.moreInfo:{ps.env.openExternal(ps.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break}default:t=e===Ue.cancel?"cancel":"dismissed";break}ne("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",void 0,{selection:t}),this.configurationPromise.resolve()}async updateScriptSources(e){let t="widgetScriptSources";await this.configurationSettings.updateSetting(t,e,void 0,ps.ConfigurationTarget.Global)}async handleWidgetSourceNotFound(e,t){if(this.globalMemento.get(NZ,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await ps.window.showWarningMessage(W.widgetScriptNotFoundOnCDNWidgetMightNotWork(e,t,JSON.stringify(this.cdnProviders)),Ue.ok,Ue.doNotShowAgain,Ue.reportThisIssue)){case Ue.doNotShowAgain:return this.globalMemento.update(NZ,!0);case Ue.reportThisIssue:return ps.env.openExternal(ps.Uri.parse("https://aka.ms/CreatePVSCDataScienceIssue"));default:}}};Wl=U([(0,av.injectable)(),x(0,(0,av.inject)(_t)),x(0,(0,av.named)(rr)),x(1,(0,av.inject)(Ke))],Wl);var xP=class{constructor(e,t){this.document=e;this.serviceContainer=t;this.cachedMessages=[];this.postEmitter=new fs.EventEmitter;this.attachedWebviews=new WeakSet;this.modulesForWhichWeHaveDisplayedWidgetErrorMessage=new Set;this.queuedMessages=[];this.disposables=this.serviceContainer.get(ve),this.jupyterOutput=this.serviceContainer.get(Wm,Vv),this.configService=this.serviceContainer.get(Ke),this.initialize()}get postMessage(){return this.listeningToPostMessageEvent=!0,this.postEmitter.event}dispose(){var e,t;this.cachedMessages=[],(e=this.ipyWidgetMessageDispatcher)==null||e.dispose(),(t=this.ipyWidgetScriptSource)==null||t.dispose()}attach(e){if(this.attachedWebviews.has(e))return;this.attachedWebviews.add(e),this.postMessage(i=>{if(w.ci(`\x1B[32mWidget Coordinator sent ${i.message}`),i.message==="ConvertUriForUseInWebViewRequest")this.onMessage(e,"ConvertUriForUseInWebViewResponse",{request:i.payload,response:e.asWebviewUri(i.payload)});else{if(!this.readyMessageReceived){this.queuedMessages.push({type:i.message,payload:i.payload});return}this.sendPendingWebViewMessages(e),e.postMessage({type:i.message,payload:i.payload}).then(E,E)}},this,this.disposables);let t=Re(),n=async()=>{let i=new It;if(!t.completed){let s=[],a=this.serviceContainer.get(qe),l=Re();a.get(this.document)?l.resolve(a.get(this.document)):a.onDidCreateKernel(c=>{c.notebook===this.document&&l.resolve(c)},this,s);let u=await l.promise;u&&(jt(u.kernelConnectionMetadata)?u.ipywidgetsVersion?t.completed||t.resolve(u.ipywidgetsVersion):u.onIPyWidgetVersionResolved(()=>{u.ipywidgetsVersion&&(t.completed||t.resolve(u.ipywidgetsVersion),Ce(s))},this,s):t.completed||t.resolve(VE)),s.length&&this.disposables.push(...s)}let o=await t.promise;w.trace(`Version of IPyWidgets ${o} determined after ${i.elapsedTime/1e3}s`),e.postMessage({type:"IPyWidgets_Reply_Widget_Version",payload:o}).then(E,E)};e.onDidReceiveMessage(async i=>{w.ci(`\x1B[32mWidget Coordinator received ${i.type}`),this.onMessage(e,i.type,i.payload),i.type==="IPyWidgets_Request_Widget_Version"&&await n(),i.type==="IPyWidgets_Window_Alert"&&fs.window.showInformationMessage(i.message),i.type==="IPyWidgets_Window_Open"&&fs.env.openExternal(fs.Uri.parse(i.url)),i.type==="IPyWidgets_Ready"&&(w.trace("Web view is ready to receive widget messages"),this.readyMessageReceived=!0,this.sendPendingWebViewMessages(e))},this,this.disposables),e.postMessage({type:"IPyWidgets_IsReadyRequest",payload:void 0}).then(E,E),n().catch(E)}onMessage(e,t,n){t==="ipywidget_load_success"?this.sendLoadSucceededTelemetry(n).catch(E):t==="ipywidget_load_failure"?this.handleWidgetLoadFailure(e,n).catch(E):t==="ipywidget_widget_version_not_supported"?this.sendUnsupportedWidgetVersionFailureTelemetry(n).catch(E):t==="ipywidget_render_failure"?this.sendRenderFailureTelemetry(n):t==="ipywidget_unhandled_kernel_message"&&this.handleUnhandledMessage(n),this.getIPyWidgetMessageDispatcher().receiveMessage({message:t,payload:n}),this.getIPyWidgetScriptSource().onMessage(t,n)}sendPendingWebViewMessages(e){if(this.readyMessageReceived)for(;this.queuedMessages.length;)e.postMessage(this.queuedMessages.shift()).then(E,E)}initialize(){this.getIPyWidgetScriptSource().initialize(),this.getIPyWidgetMessageDispatcher().initialize()}async sendLoadSucceededTelemetry(e){try{ne("DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",0,{moduleHash:await Rt(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}async handleWidgetLoadFailure(e,t){try{let n=t.error.toString(),i=this.configService.getSettings(void 0).widgetScriptSources,o=i.length>0,s=`${t.moduleName}:${t.moduleVersion}`;if(!t.isOnline)n=W.loadClassFailedWithNoInternet(t.moduleName,t.moduleVersion),fs.window.showErrorMessage(n).then(E,E);else if(!o&&!this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.has(s)){this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.add(s);let a=Ue.moreInfo,l=W.enableCDNForWidgetsButton;n=W.enableCDNForWidgetsSetting(t.moduleName,t.moduleVersion),fs.window.showErrorMessage(n,{modal:!0},l,a).then(u=>{switch(u){case a:fs.env.openExternal(fs.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break;case l:this.enableCDNForWidgets(e).catch(E);break;default:break}},E)}w.error(`Widget load failure ${n}`,i,t),ne("DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",0,{isOnline:t.isOnline,moduleHash:await Rt(t.moduleName),moduleVersion:t.moduleVersion,timedout:t.timedout})}catch(n){}}async enableCDNForWidgets(e){await fs.commands.executeCommand(le.EnableLoadingWidgetsFrom3rdPartySource),await e.postMessage({type:"IPyWidgets_AttemptToDownloadFailedWidgetsAgain"})}async sendUnsupportedWidgetVersionFailureTelemetry(e){try{ne("DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",0,{moduleHash:await Rt(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}sendRenderFailureTelemetry(e){try{w.error("Error rendering a widget: ",e),ne("DS_INTERNAL.IPYWIDGET_RENDER_FAILURE")}catch(t){}}handleUnhandledMessage(e){if(e.header.msg_type!=="status")try{if(e.header.msg_type==="error"){let t=e;t.content.traceback=t.content.traceback.map(hu)}w.trace(`Unhandled widget kernel message: ${e.header.msg_type} ${e.content}`),this.jupyterOutput.appendLine(W.unhandledMessage(e.header.msg_type,JSON.stringify(e.content))),ne("DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",void 0,{msg_type:e.header.msg_type})}catch(t){}}getIPyWidgetMessageDispatcher(){return this.ipyWidgetMessageDispatcher||(this.ipyWidgetMessageDispatcher=this.serviceContainer.get(Xd).create(this.document),this.disposables.push(this.ipyWidgetMessageDispatcher.postMessage(this.cacheOrSend,this))),this.ipyWidgetMessageDispatcher}getIPyWidgetScriptSource(){return this.ipyWidgetScriptSource||(this.ipyWidgetScriptSource=new tM(this.document,this.serviceContainer.get(qe),this.serviceContainer.get(ve),this.serviceContainer.get(Ke),this.serviceContainer.get(nM),this.serviceContainer.get(Wl)),this.disposables.push(this.ipyWidgetScriptSource.postMessage(this.cacheOrSend,this))),this.ipyWidgetScriptSource}cacheOrSend(e){if(!this.listeningToPostMessageEvent){w.ci("\x1B[32mQueuing messages (no listeners)"),this.cachedMessages.push(e);return}this.cachedMessages.forEach(t=>this.postEmitter.fire(t)),this.cachedMessages=[],this.postEmitter.fire(e)}};U([hn()],xP.prototype,"enableCDNForWidgets",1);var u9=class{constructor(e,t){this.editor=e;this.pendingMessages=[];this.disposables=[];this._onDidReceiveMessage=new fm.EventEmitter;this.changeController(t)}get controller(){if(!this._controller)throw new Error("No controller defined");return this._controller.controller}changeController(e){var t,n;((t=this._controller)==null?void 0:t.id)!==e.id&&((n=this.controllerMessageHandler)==null||n.dispose(),this._controller=e,this.controllerMessageHandler=e.onDidReceiveMessage(i=>{var o;i.editor===this.editor&&((o=this.controller)==null?void 0:o.id)===e.id&&(this.eventHandlerListening?(this.sendPendingMessages(),this._onDidReceiveMessage.fire(i.message)):this.pendingMessages.push(i.message))},this,this.disposables))}dispose(){Ce(this.disposables)}get onDidReceiveMessage(){return this.eventHandlerListening=!0,setTimeout(()=>this.sendPendingMessages(),0),this._onDidReceiveMessage.event}postMessage(e){return this.controller.postMessage(e,this.editor)}asWebviewUri(e){return this.controller.asWebviewUri(e)}sendPendingMessages(){if(this.pendingMessages.length){let e=this.pendingMessages.shift();for(;e;)this._onDidReceiveMessage.fire(e),e=this.pendingMessages.shift()}}},pm=class{constructor(e,t,n){this.serviceContainer=e;this.disposableRegistry=t;this.controllerManager=n;this.messageCoordinators=new WeakMap;this.notebookDisposables=new WeakMap;this.notebookCommunications=new WeakMap;this.notebookEditors=new WeakMap}activate(){fm.window.onDidChangeVisibleNotebookEditors(this.onDidChangeVisibleNotebookEditors,this,this.disposableRegistry),fm.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebookDocument,this,this.disposableRegistry),this.controllerManager.onControllerSelected(this.onDidSelectController,this,this.disposableRegistry)}onDidSelectController(e){let t=this.messageCoordinators.get(e.notebook);t&&(this.messageCoordinators.delete(e.notebook),fm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>{let i=this.notebookCommunications.get(n);this.notebookCommunications.delete(n),i&&i.controller!==e.controller.controller&&(this.notebookCommunications.delete(n),i&&i.dispose())}),t==null||t.dispose()),fm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>this.initializeNotebookCommunication(n,e.controller))}initializeNotebookCommunication(e,t){if(e.notebook.isClosed||!mr(e.notebook))return;let n=e.notebook;if(!t){w.trace(`No controller, hence notebook communications cannot be initialized for editor ${Ee(e.notebook.uri)}`);return}if(this.notebookCommunications.has(e))return;let i=new u9(e,t);this.addNotebookDisposables(n,[i]),this.notebookCommunications.set(e,i);let o=this.messageCoordinators.get(n);o||(o=new xP(n,this.serviceContainer),this.messageCoordinators.set(n,o)),o.attach(i)}addNotebookDisposables(e,t){let n=this.notebookDisposables.get(e)||[];n.push(...t),this.notebookDisposables.set(e,n)}async onDidChangeVisibleNotebookEditors(e){e.forEach(t=>{let n=this.controllerManager.getSelected(t.notebook);this.initializeNotebookCommunication(t,n)})}onDidCloseNotebookDocument(e){var n;let t=this.notebookEditors.get(e)||[];Ce(this.notebookDisposables.get(e)||[]),t.forEach(i=>{var o;return(o=this.notebookCommunications.get(i))==null?void 0:o.dispose()}),(n=this.messageCoordinators.get(e))==null||n.dispose(),this.messageCoordinators.delete(e)}};pm=U([(0,YI.injectable)(),x(0,(0,YI.inject)(Nr)),x(1,(0,YI.inject)(ve)),x(2,(0,YI.inject)(Nt))],pm);p();var mm=se(ge());var $I=class{constructor(e,t,n,i,o){this.disposables=e;this.kernelProvider=t;this.controllers=n;this.liveKernelTracker=i;this.preferredRemoteKernelIdProvider=o}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables),this.controllers.onControllerSelectionChanged(this.onNotebookControllerSelectionChanged,this,this.disposables)}onNotebookControllerSelectionChanged({selected:e,notebook:t,controller:n}){t.isClosed||(n.connection.kind==="connectToLiveRemoteKernel"&&n.connection.kernelModel.id&&(e?this.liveKernelTracker.trackKernelIdAsUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id):this.liveKernelTracker.trackKernelIdAsNotUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id)),zt(n.connection)&&this.preferredRemoteKernelIdProvider.clearPreferredRemoteKernelId(t.uri).catch(E))}onDidStartKernel(e){if(!e.resourceUri)return;let t=e.resourceUri;if(e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")return;let n=e.kernelConnectionMetadata.serverProviderHandle,i=()=>{var s,a;let o=(a=(s=e.session)==null?void 0:s.kernel)==null?void 0:a.id;!e.disposed&&!e.disposing&&o&&(w.debug(`Updating preferred kernel for remote notebook ${o}`),this.preferredRemoteKernelIdProvider.storePreferredRemoteKernelId(t,o).catch(E),this.liveKernelTracker.trackKernelIdAsUsed(t,n,o))};i(),e.onDidKernelSocketChange(i,this,this.disposables)}};$I=U([(0,mm.injectable)(),x(0,(0,mm.inject)(ve)),x(1,(0,mm.inject)(qe)),x(2,(0,mm.inject)(Nt)),x(3,(0,mm.inject)(Bg)),x(4,(0,mm.inject)(Vs))],$I);p();var cv=se(ge());var MZ=require("vscode");var lv=class{constructor(e,t,n,i){this.disposables=e;this.uriStorage=t;this.controllers=n;this.serverProviderRegistry=i;this.handledServerProviderChanges=new WeakSet}activate(){this.serverProviderRegistry.jupyterCollections.forEach(e=>this.checkExpiredServersInJupyterCollection(e)),this.serverProviderRegistry.onDidChangeCollections(({added:e,removed:t})=>{e.forEach(n=>this.checkExpiredServersInJupyterCollection(n)),t.forEach(n=>this.removeControllersBelongingToDisposedProvider(n.extensionId,n.id))},this,this.disposables)}async checkExpiredServersInJupyterCollection(e){!this.handledServerProviderChanges.has(e.serverProvider)&&e.serverProvider.onDidChangeServers&&(this.handledServerProviderChanges.add(e.serverProvider),e.serverProvider.onDidChangeServers(()=>this.checkExpiredServersInJupyterCollection(e).catch(E),this,this.disposables));let t=new MZ.CancellationTokenSource;this.disposables.push(t);try{let n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await this.removeControllersAndUriStorageBelongingToInvalidServers(e.extensionId,e.id,(n||[]).map(i=>i.id))}finally{t.dispose()}}async removeControllersAndUriStorageBelongingToInvalidServers(e,t,n){let i=this.uriStorage.all;await Promise.all(i.filter(o=>o.provider.extensionId===e&&o.provider.id===t).map(async o=>{n.includes(o.provider.handle)||await this.uriStorage.remove(o.provider)})),this.controllers.registered.forEach(o=>{let s=o.connection;zt(s)||s.serverProviderHandle.extensionId!==e||s.serverProviderHandle.id!==t||n.includes(s.serverProviderHandle.handle)||(w.warn(`Deleting controller ${o.id} as it is associated with a server Id that has been removed`),o.dispose())})}removeControllersBelongingToDisposedProvider(e,t){this.controllers.registered.forEach(n=>{let i=n.connection;zt(i)||i.serverProviderHandle.extensionId!==e||i.serverProviderHandle.id!==t||(w.warn(`Deleting controller ${n.id} as it is associated with a Provider Id that has been removed`),n.dispose())})}};U([hn("Failed to check what servers were shutdown in Controller Watcher")],lv.prototype,"checkExpiredServersInJupyterCollection",1),lv=U([(0,cv.injectable)(),x(0,(0,cv.inject)(ve)),x(1,(0,cv.inject)(dr)),x(2,(0,cv.inject)(Nt)),x(3,(0,cv.inject)(sr))],lv);p();p();var QI=se(ge());p();var OZ=require("vscode");var sM=class{constructor(e,t,n,i,o,s){this.label=e;this._description=t;this.detail=n;this.category=i;this.serverDisplayName=o;this.getDescription=s;this._onDidChange=new OZ.EventEmitter;this.onDidChange=this._onDidChange.event}get description(){var e;return((e=this.getDescription)==null?void 0:e.call(this))||this._description}set description(e){this._description=e}dispose(){this._onDidChange.dispose()}triggerChange(){this._onDidChange.fire(this)}};function LZ(r){switch(r.kind){case"connectToLiveRemoteKernel":return W.kernelCategoryForJupyterSession;case"startUsingRemoteKernelSpec":return W.kernelCategoryForRemoteJupyterKernel;default:return d9(r)}}function d9(r){switch(r.kind){case"startUsingLocalKernelSpec":return W.kernelCategoryForJupyterKernel;case"startUsingPythonInterpreter":{if(Vg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec")return W.kernelCategoryForJupyterKernel;switch(Jr(r.interpreter)){case"Conda":return Dp(r.interpreter)?W.kernelCategoryForCondaWithoutPython:W.kernelCategoryForConda;case"PipEnv":return W.kernelCategoryForPipEnv;case"Poetry":return W.kernelCategoryForPoetry;case"Pyenv":return W.kernelCategoryForPyEnv;case"Venv":case"VirtualEnv":case"VirtualEnvWrapper":return W.kernelCategoryForVirtual;default:return W.kernelCategoryForGlobal}}default:return""}}var zI=class{constructor(e,t,n){this.platform=e;this.jupyterUriProviderRegistration=t;this.disposables=n;this.details=new Map}getDisplayData(e){if(!this.details.get(e.id)){let i=ut(e),o=Gz(e,this.platform);e.kind==="connectToLiveRemoteKernel"&&(o=tj(e));let s=e.kind==="connectToLiveRemoteKernel"?()=>tj(e):void 0,a=d9(e),l=new sM(i,o,"",a,void 0,s);this.disposables.push(l),this.details.set(e.id,l)}let t=this.details.get(e.id);if(this.details.set(e.id,t),e.kind==="connectToLiveRemoteKernel"||e.kind==="startUsingRemoteKernelSpec"){let i=gI(e.serverProviderHandle,this.jupyterUriProviderRegistration,W.kernelDefaultRemoteDisplayName);t.serverDisplayName!==i&&(t.serverDisplayName=i,t.triggerChange())}let n=LZ(e);return t.category!==n&&(t.category=n,t.triggerChange()),t}};zI=U([(0,QI.injectable)(),x(0,(0,QI.inject)(us)),x(1,(0,QI.inject)(sr)),x(2,(0,QI.inject)(ve))],zI);p();var Zd=se(ge()),ZI=require("vscode");p();var hm=se(ge()),UZ=require("vscode");p();var KZ=require("vscode");function aM(r){var e;try{return $z(_a(r))||((e=r.getCells().find(n=>n.kind===KZ.NotebookCellKind.Code))==null?void 0:e.document.languageId)}catch(t){w.warn("Failed to determine language of first cell",t)}}var FZ="DATASCIENCE.LAST_SAVED_CELL_LANGUAGE",js=class{constructor(e,t,n){this.disposables=e;this.globalMemento=t;this.pythonExtensionChecker=n}getPreferredLanguage(e){var i,o;let t=((i=e==null?void 0:e.language_info)==null?void 0:i.name)||((o=e==null?void 0:e.kernelspec)==null?void 0:o.language)||this.lastSavedNotebookCellLanguage,n=this.pythonExtensionChecker.isPythonExtensionInstalled?Ye:"plaintext";return Kc(t||n)}activate(){UZ.workspace.onDidSaveNotebookDocument(this.onDidSaveNotebookDocument,this,this.disposables)}getSupportedLanguages(e){if(jt(e))return cB;{let t=Kc(Xc(e)||"");return t&&dB.includes(t.toLowerCase())?[t,"raw"]:[]}}get lastSavedNotebookCellLanguage(){return this.globalMemento.get(FZ)}async onDidSaveNotebookDocument(e){if(!mr(e))return;let t=aM(e);t&&t!==this.lastSavedNotebookCellLanguage&&await this.globalMemento.update(FZ,t)}};U([hn("Saving last saved cell language")],js.prototype,"onDidSaveNotebookDocument",1),js=U([(0,hm.injectable)(),x(0,(0,hm.inject)(ve)),x(1,(0,hm.inject)(_t)),x(1,(0,hm.named)(rr)),x(2,(0,hm.inject)(vo))],js);p();function WZ(r){let e={kernelSpecCount:0,localKernelSpecCount:0,remoteKernelSpecCount:0,kernelInterpreterCount:0,kernelLiveCount:0};r.forEach(t=>{switch(t.kind){case"connectToLiveRemoteKernel":e.kernelLiveCount+=1;break;case"startUsingRemoteKernelSpec":e.localKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingLocalKernelSpec":e.remoteKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingPythonInterpreter":{e.kernelInterpreterCount+=1;break}default:break}}),ne("DS_INTERNAL.KERNEL_COUNT",{...e})}p();var Qt=require("vscode");p();var vu=require("vscode");p();async function VZ(r,e,t){let n=`${await Xb({uri:t})}#${Ci.get(e)}`;await r.update(n,void 0)}p();var Oo=Symbol("INotebookEditorProvider");p();var jZ=require("vscode");async function BZ(r,e){let t=e==null?void 0:e.findNotebookEditor(r);return t?jZ.commands.executeCommand("notebook.selectKernel",{notebookEditor:t}):(w.error("Unable to select kernel as the Notebook document could not be identified"),!1)}p();var HZ=require("vscode");var lM=class extends eu{constructor(e){super(W.failedToStartAnUntrustedKernelSpec(ut(e),e.kernelSpec.specFile?Ee(HZ.Uri.file(e.kernelSpec.specFile)):""),void 0,e)}};var Hr=class Hr{static async switchController(e,t){let i=t.get(Oo).findNotebookEditor(e),o=t.get(Nt),s,a=Re(),l=o.onControllerSelected(c=>a.resolve(c.controller));return await BZ(e,t.get(Oo))&&i&&(s=await a.promise),l.dispose(),s?{controller:s.controller,metadata:s.connection}:void 0}static async notifyAndRestartDeadKernel(e){let t=await vu.window.showErrorMessage(W.cannotRunCellKernelIsDead(ut(e.kernelConnectionMetadata)),{modal:!0},W.showJupyterLogs,W.restartKernel),n=!1;switch(t){case W.restartKernel:{await e.restart(),n=!0;break}case W.showJupyterLogs:vu.commands.executeCommand(le.ViewJupyterOutput).then(E,E)}return n}static async handleKernelError(e,t,n,i,o,s,a,l){let u=e.get(_t,rr),c=e.get(dn);a.interpreter&&n==="start"&&VZ(u,19,a.interpreter.uri).catch(E);let d=await c.handleKernelError(t,n,a,i,l),f=zt(a),m=e.tryGet(Hd);switch((m==null?void 0:m.isSupported)&&f&&n==="start"&&Br(i,"DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",{reason:d}),o.dispose().catch(E),d){case 1:case 2:throw t;case 3:{let b=await Hr.switchController(i,e);if(!b)throw t;s=b.controller,a=b.metadata;break}}return{controller:s,metadata:a}}static convertContextToFunction(e,t){switch(e){case"start":case"execution":return n=>n.start(t);case"interrupt":return n=>n.interrupt();case"restart":return n=>n.restart()}}static async verifyKernelState(e,t,n,i,o,s,a,l){let u=await i,{kernel:c,deadKernelAction:d}=u;if(UA(c)){if(this.deleteKernelInfo(t,i),d==="deadKernelWasNoRestarted")throw new Fl(c.kernelConnectionMetadata);if(d==="deadKernelWasRestarted")throw new Fl(c.kernelConnectionMetadata);if((l==null?void 0:l.kernelWasRestartedDueToDeadKernel.value)===!0)throw new Fl(c.kernelConnectionMetadata);u.deadKernelAction="deadKernelWasRestarted";let f=Re();return f.resolve(!0),l=l||{kernelWasRestartedDueToDeadKernel:f},Hr.wrapKernelMethod(c.kernelConnectionMetadata,"start",o,e,t,n,a,s,l)}return c}static async wrapKernelMethod(e,t,n,i,o,s,a,l=()=>void 0,u){var m,g,b,y;let c=this.getKernelInfo(o);if(!s.disableUI&&(c!=null&&c.options.disableUI)&&(c.options.disableUI=!1),!s.disableUI&&(c!=null&&c.kernel.resolved)&&((g=(m=c==null?void 0:c.kernel.value)==null?void 0:m.kernel)!=null&&g.disposed||(y=(b=c==null?void 0:c.kernel.value)==null?void 0:b.kernel)!=null&&y.disposing)&&(this.deleteKernelInfo(o),c=void 0),c&&t!=="restart"&&t!=="interrupt")return Hr.verifyKernelState(i,o,s,c.kernel.promise,n,l,a);w.debug(`${t} the kernel, options.disableUI=${s.disableUI} for ${Ee("notebook"in o?o.notebook.uri:o.resource)}`),u=u||{kernelWasRestartedDueToDeadKernel:Re()};let d=Hr.wrapKernelMethodImpl(e,t,i,o,s,n,l,u);u!=null&&u.kernelWasRestartedDueToDeadKernel.resolved&&u.kernelWasRestartedDueToDeadKernel.resolve(!0);let f=Au(d);return f.promise.catch(E),d.then(P=>{P.kernel.onDisposed(()=>{this.deleteKernelInfo(o,f.promise)},void 0,a)}).catch(()=>{this.deleteKernelInfo(o,f.promise)}),this.setKernelInfo(o,f,s),Hr.verifyKernelState(i,o,s,f.promise,n,l,a,u)}static getKernelInfo(e){return"notebook"in e?Hr.connectionsByNotebook.get(e.notebook):Hr.connectionsByUri.get(e.resource.toString())}static setKernelInfo(e,t,n){"notebook"in e?Hr.connectionsByNotebook.set(e.notebook,{kernel:t,options:n}):Hr.connectionsByUri.set(e.resource.toString(),{kernel:t,options:n})}static deleteKernelInfo(e,t){var n,i;if(!t){"notebook"in e?Hr.connectionsByNotebook.delete(e.notebook):Hr.connectionsByUri.delete(e.resource.toString());return}"notebook"in e&&((n=Hr.connectionsByNotebook.get(e.notebook))==null?void 0:n.kernel.promise)===t?Hr.connectionsByNotebook.delete(e.notebook):e.resource&&((i=Hr.connectionsByUri.get(e.resource.toString()))==null?void 0:i.kernel.promise)===t&&Hr.connectionsByUri.delete(e.resource.toString())}static verifyWeCanStartKernel(e,t){if(!zt(e)||!e.kernelSpec.specFile)return;if(!t.get(KI).isTrusted(vu.Uri.file(e.kernelSpec.specFile)))throw new lM(e)}static async wrapKernelMethodImpl(e,t,n,i,o,s,a,l){let u=n.get(qe),c=n.get(Ug),d,f=Hr.convertContextToFunction(t,o),m=t,g="controller"in i?i.controller:void 0;for(t==="start"&&Hr.verifyWeCanStartKernel(e,n);d===void 0;){if("notebook"in i&&i.notebook.isClosed)throw new vu.CancellationError;d="notebook"in i?u.getOrCreate(i.notebook,{metadata:e,controller:g||i.controller,resourceUri:i.resource}):c.getOrCreate(i.resource,{metadata:e,resourceUri:i.resource});let b=!1;try{if(t!=="restart"&&UA(d)&&!o.disableUI){b=!0;let y=await Hr.notifyAndRestartDeadKernel(d);return y&&l&&l.kernelWasRestartedDueToDeadKernel.resolve(!0),{kernel:d,deadKernelAction:y?"deadKernelNeedsToBeRestarted":"deadKernelWasNoRestarted"}}else{if(a(m,d),await f(d),"notebook"in i&&i.notebook.isClosed)throw new vu.CancellationError;UA(d)&&!o.disableUI&&m!=="interrupt"&&await Hr.notifyAndRestartDeadKernel(d)}}catch(y){if(b&&l&&l.kernelWasRestartedDueToDeadKernel.resolve(!0),Yn(y)||w.warn(`Error occurred while trying to ${m} the kernel, options.disableUI=${o.disableUI}`,y),o.disableUI)throw y;if("notebook"in i&&i.notebook.isClosed)throw new vu.CancellationError;let P=await Hr.handleKernelError(n,y,m,i.resource,d,g,e,s);if(g=P.controller,e=P.metadata,f=A=>A.start(o),m="start",s==="3rdPartyExtension")throw y;d=void 0}}return{kernel:d}}static async connectToNotebookKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return Hr.wrapKernelMethod(e,"start",s,t,n,i,o,a)}static async connectToKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return Hr.wrapKernelMethod(e,"start",s,t,n,i,o,a)}};Hr.connectionsByNotebook=new WeakMap,Hr.connectionsByUri=new Map;var Ta=Hr;p();var uv=class{constructor(e){this.controller=e}get id(){return this.controller.id}createNotebookCellExecution(e){return this.controller.createNotebookCellExecution(e)}};p();var uM=require("vscode");var cM=class extends Lr{constructor(t,n,i){super();this.kernel=t;this.controller=n;this.notebook=i}initialize(){let t=this.kernel,n=this.controller,i=this.notebook;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||t.status!=="busy"&&t.status!=="unknown"||!n.createNotebookExecution)return;this._register(uM.workspace.onDidCloseNotebookDocument(s=>{s===i&&this.dispose()},this)),this._register(n.onDidChangeSelectedNotebooks(s=>{s.notebook===i&&s.selected===!1&&this.dispose()},this)),this._register(t.onStatusChanged(s=>{s!=="busy"&&s!=="unknown"&&this.dispose()},this));let o=n.createNotebookExecution(i);o.start(),this._register(new uM.Disposable(()=>o.end()))}};var dM=class r{constructor(e,t,n,i,o,s,a,l,u,c,d){this.kernelConnection=e;this._viewType=n;this.kernelProvider=i;this.context=o;this.languageService=a;this.configuration=l;this.extensionChecker=u;this.serviceContainer=c;this.displayDataProvider=d;this._onNotebookControllerSelectionChanged=new Qt.EventEmitter;this._onConnecting=new Qt.EventEmitter;this.pendingCellAdditions=new WeakMap;this._onDidDispose=new Qt.EventEmitter;this.disposables=[];this.notebookKernels=new WeakMap;this.isDisposed=!1;this.runningCellExecutions=new WeakMap;this.associatedDocuments=new WeakMap;this.restoredConnections=new WeakSet;this.cellQueue=new WeakMap;var f;fY(e.id,(f=e.interpreter)==null?void 0:f.id),s.push(this),this.displayData=this.displayDataProvider.getDisplayData(this.connection),this.controller=Qt.notebooks.createNotebookController(t,n,this.displayData.label,this.handleExecution.bind(this),this.getRendererScripts()),this.displayData.onDidChange(this.updateDisplayData,this,this.disposables),this.updateDisplayData(),this.controller.interruptHandler=this.handleInterrupt.bind(this),this.controller.supportsExecutionOrder=!0,this.controller.supportedLanguages=this.languageService.getSupportedLanguages(e),this.controller.onDidChangeSelectedNotebooks(this.onDidChangeSelectedNotebooks,this,this.disposables),Qt.workspace.onDidCloseNotebookDocument(m=>{this.associatedDocuments.delete(m)},this,this.disposables)}get id(){return this.controller.id}get label(){return this.controller.label}get connection(){return this.kernelConnection}get viewType(){return this._viewType}get onNotebookControllerSelectionChanged(){return this._onNotebookControllerSelectionChanged.event}get onConnecting(){return this._onConnecting.event}get onDidReceiveMessage(){return this.controller.onDidReceiveMessage}get onDidDispose(){return this._onDidDispose.event}isAssociatedWithDocument(e){return this.associatedDocuments.has(e)}static create(e,t,n,i,o,s,a,l,u,c,d,f){let m=new r(e,t,n,i,o,s,a,l,u,c,d);try{m.controller.variableProvider=f}catch(g){w.warn("Failed to attach variable provider",g)}return m}async restoreConnection(e){var c;if(this.restoredConnections.has(e))return;this.restoredConnections.add(e);let t=await this.connectToKernel(e,new hr(!0));if(this.kernelConnection.kind==="connectToLiveRemoteKernel"){let d=new cM(t,this.controller,e);this.disposables.push(d),d.initialize()}let n=this.kernelProvider.getKernelExecution(t),o=await this.serviceContainer.get(Ul).getLastTrackedCellExecution(e,t);if(!((c=t.session)!=null&&c.kernel)||n.pendingCells.length||!o||e.cellCount<o.cellIndex||e.cellAt(o.cellIndex).kind!==Qt.NotebookCellKind.Code)return;Ol(t.resourceUri,t.kernelConnectionMetadata);let s=!1,a=[],l,u=(d,f)=>{if(!(f.direction==="send"||s)&&Gd(f.msg)===o.msg_id){if("msg_type"in f.msg&&f.msg.msg_type==="status"&&"execution_state"in f.msg.content&&f.msg.content.execution_state==="idle")return;s=!0,n.resumeCellExecution(e.cellAt(o.cellIndex),{msg_id:o.msg_id,startTime:o.startTime,executionCount:o.executionCount}).catch(E),Ce(a)}};t.session.kernel.anyMessage.connect(u),l=new Qt.Disposable(()=>{zs(()=>{var d,f;return(f=(d=t.session)==null?void 0:d.kernel)==null?void 0:f.anyMessage.disconnect(u)})}),a.push(l),this.disposables.push(l)}updateConnection(e){e.kind!=="connectToLiveRemoteKernel"&&(this.controller.label=ut(e))}asWebviewUri(e){return this.controller.asWebviewUri(e)}postMessage(e,t){let n=e&&"message"in e?e.message:"";return w.ci(`\x1B[32mPosting message to Notebook UI ${n}`),this.controller.postMessage(e,t)}setPendingCellAddition(e,t){if(this.viewType!==vr)throw new Error("setPendingCellAddition only applies to the Interactive Window");this.pendingCellAdditions.set(e,t)}dispose(){if(this.isDisposed)return;let e=Qt.workspace.notebookDocuments.filter(t=>this.associatedDocuments.has(t)).map(t=>t.uri.toString());w.debug(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""}`),w.ci(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""} called from ${new Error("").stack}`),this.isDisposed=!0,this._onNotebookControllerSelectionChanged.dispose(),this._onConnecting.dispose(),this.controller.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose(),Ce(this.disposables)}updateDisplayData(){this.controller.label=this.displayData.label;let e=this.connection.kind==="connectToLiveRemoteKernel"?"":this.displayData.description;this.controller.description=e,this.displayData.serverDisplayName&&(this.controller.description=e?`${e} (${this.displayData.serverDisplayName})`:this.displayData.serverDisplayName)}async handleExecution(e,t){if(e.length<1)return;let n=Uc(t);n==null||n.cellExecutionCount(e.length);let i=n==null?void 0:n.preExecuteCellTelemetry();if(this.pendingCellAdditions.has(t)&&await this.pendingCellAdditions.get(t),e=e.filter(s=>s.index<0?(w.warn(`Attempting to run a cell with index ${s.index}, kind ${s.kind}, text = ${s.document.getText()}`),!1):!0),!Qt.workspace.isTrusted)return;w.debug(`Handle Execution of Cells ${e.map(s=>s.index)} for ${Ee(t.uri)}`),await Ol(t.uri,this.connection),i==null||i.stop();let o=this.cellQueue.get(t)||[];this.cellQueue.set(t,o.concat(e)),await this.executeQueuedCells(t)}async onDidChangeSelectedNotebooks(e){var n,i;if(w.ci(`NotebookController selection event called for notebook ${e.notebook.uri.toString()} & controller ${this.connection.kind}:${this.id}. Selected ${e.selected} `),this.associatedDocuments.has(e.notebook)&&e.selected)return;if(!e.selected){let o=this.kernelProvider.get(e.notebook);(o==null?void 0:o.kernelConnectionMetadata.id)===this.kernelConnection.id&&(w.info(`Disposing kernel ${this.kernelConnection.id} for notebook ${Ee(e.notebook.uri)} due to selection of another kernel or closing of the notebook`),o.dispose().catch(E)),this.associatedDocuments.delete(e.notebook),this._onNotebookControllerSelectionChanged.fire({controller:this,notebook:e.notebook,selected:e.selected});return}if(!mr(e.notebook)&&e.notebook.notebookType!==vr||!Qt.workspace.isTrusted)return;(i=Uc(e.notebook))==null||i.kernelSelected(this.kernelConnection.id,(n=this.kernelConnection.interpreter)==null?void 0:n.id),zIe(this.kernelConnection);let t=Re();w.ci(`Controller ${this.connection.kind}:${this.id} associated with nb ${Ee(e.notebook.uri)}`),this.associatedDocuments.set(e.notebook,t.promise),await this.onDidSelectController(e.notebook),await this.updateCellLanguages(e.notebook),this._onNotebookControllerSelectionChanged.fire({controller:this,notebook:e.notebook,selected:e.selected}),w.debug("Controller selection change completed"),t.resolve()}async updateCellLanguages(e){let t=this.controller.supportedLanguages;if(!t||(t==null?void 0:t.length)===0)return;let i=jt(this.kernelConnection)?Ye:t[0];await Promise.all(e.getCells().filter(o=>o.kind===Qt.NotebookCellKind.Code).map(async o=>{t.includes(o.document.languageId)||await Qt.languages.setTextDocumentLanguage(o.document,i).then(E,E)}))}getRendererScripts(){return this.context.extensionMode===Qt.ExtensionMode.Development||this.context.extensionMode===Qt.ExtensionMode.Test?[new Qt.NotebookRendererScript(Qt.Uri.joinPath(this.context.extensionUri,"dist","webviews","webview-side","widgetTester","widgetTester.js"))]:[]}handleInterrupt(e){w.debug(`VS Code interrupted kernel for ${Ee(e.uri)}`),e.getCells().forEach(t=>it(t,"Cell cancellation requested")),Qt.commands.executeCommand(le.InterruptKernel,{notebookEditor:{notebookUri:e.uri}}).then(E,t=>w.error("Failed to interrupt",t))}createCellExecutionIfNecessary(e,t){let n=this.runningCellExecutions.get(e.notebook);if(!n||n.cell===e){n==null||n.end(void 0,void 0),n=io.getOrCreate(e,t,!0),this.runningCellExecutions.set(e.notebook,n);let i=n.end.bind(n);n.end=(o,s)=>{this.runningCellExecutions.delete(e.notebook),i(o,s)}}return n}async executeQueuedCells(e){if(!this.cellQueue.has(e))return;let t=(this.cellQueue.get(e)||[]).map(c=>{let d=this.createCellExecutionIfNecessary(c,new uv(this.controller));return{cell:c,exec:d}});this.cellQueue.delete(e);let n=t.length?t[0].cell:void 0;if(!n)return;w.trace(`Execute Notebook ${Ee(e.uri)}. Step 1`);let i="start",o=new uv(this.controller),s=this.serviceContainer.get(Ul),a;try{if(w.trace(`Connect to Kernel ${Ee(e.uri)}. Step 2`),a=await this.connectToKernel(e,new hr(!1)),w.trace(`Connected to Kernel ${Ee(e.uri)}. Step 3`),a.disposing)throw new Qt.CancellationError;a&&a.controller.id!==o.id&&(o=a.controller,t.forEach(c=>c.exec=this.createCellExecutionIfNecessary(c.cell,o))),i="execution",a.controller.id===this.id&&this.updateKernelInfoInNotebookWhenAvailable(a,e)}catch(c){if(c instanceof Yd)return;Yn(c)||w.error("Error in notebook cell execution",c),t.forEach(({cell:m,exec:g})=>{g.start(),g.clearOutput(m).then(E,E)});let d=this.serviceContainer.get(dn);c=Ln.unwrap(c);let f=Yn(c)||c instanceof Fl;await Od(n,o,await d.getErrorMessageForDisplayInCell(c,i,e.uri),f)}if(!a)return;let l=this.kernelProvider.getKernelExecution(a),u=new En;await Promise.all(t.map(async({cell:c})=>{var d;try{let f=(d=Uc(e))==null?void 0:d.executeCell();f&&u.add(new Qt.Disposable(()=>f.stop())),s.trackCellExecution(c,a),w.trace(`executeCell ${c.index}. Step 4`),await l.executeCell(c),OE.isExiting||s.deleteTrackedCellExecution(c,a)}catch(f){if(f instanceof Yd)return;Yn(f)||w.error("Error in cell execution",f);let m=this.serviceContainer.get(dn);f=Ln.unwrap(f);let g=Yn(f)||f instanceof Fl;await Od(c,o,await m.getErrorMessageForDisplayInCell(f,i,e.uri),g)}})).catch(E)}async connectToKernel(e,t){var i;let n=(i=Uc(e))==null?void 0:i.startKernel();return this._onConnecting.fire(),Ta.connectToNotebookKernel(this.kernelConnection,this.serviceContainer,{resource:e.uri,notebook:e,controller:this.controller},t,this.disposables).finally(()=>n==null?void 0:n.stop())}updateKernelInfoInNotebookWhenAvailable(e,t){if(this.notebookKernels.get(t)===e)return;this.notebookKernels.set(t,e);let n=[];Qt.workspace.onDidCloseNotebookDocument(s=>{s===t&&Ce(n)},this,n);let i=e.onDisposed(()=>Ce(n)),o=e.onStatusChanged(async()=>{e.disposed||!e.info||this.associatedDocuments.has(t)&&(await qZ(t,e.kernelConnectionMetadata,e.info),e.info.status==="ok"&&Ce(n))});n.push({dispose:()=>o.dispose()}),n.push({dispose:()=>i==null?void 0:i.dispose()})}async onDidSelectController(e){let t=this.connection,n=this.kernelProvider.get(e);if(n&&Qz(n.kernelConnectionMetadata,t)){w.info("Switch kernel did not change kernel.");return}if(Br(e.uri,"DS_INTERNAL.SWITCH_KERNEL"),n&&Qt.window.visibleNotebookEditors.filter(s=>s.notebook===e).forEach(s=>this.postMessage({message:"IPyWidgets_onKernelChanged",payload:void 0},s)),await qZ(e,t),e.notebookType===vr)return;let i=this.kernelProvider.getOrCreate(e,{metadata:t,controller:this.controller,resourceUri:e.uri});if(w.debug(`KernelProvider switched kernel to id = ${i.kernelConnectionMetadata.id}`),jt(this.kernelConnection)&&!this.extensionChecker.isPythonExtensionInstalled)return;let o=this.serviceContainer.get(KI);!this.configuration.getSettings(void 0).disableJupyterAutoStart&&zt(this.kernelConnection)&&this.kernelConnection.kernelSpec.specFile&&o.isTrusted(Qt.Uri.file(this.kernelConnection.kernelSpec.specFile))&&this.connectToKernel(e,new hr(!0))}};async function qZ(r,e,t){let n=_a(r)||{},{changed:i}=await Bz(n,e,t);i&&await tY(r,n)}async function zIe(r){let e=await Tp(r.interpreter,!0),t=(e==null?void 0:e.major)||0,n=(e==null?void 0:e.minor)||0;!e||t>=4||t<=0||n<=-1||r.kind!=="startUsingLocalKernelSpec"&&r.kind!=="startUsingPythonInterpreter"||(t<3||t===3&&n<=5)&&Qt.window.showWarningMessage(W.warnWhenSelectingKernelWithUnSupportedPythonVersion,Ue.learnMore).then(i=>{if(i===Ue.learnMore)return JS("https://aka.ms/jupyterUnSupportedPythonKernelVersions")},E)}var XI=class{constructor(e,t,n,i,o,s){this.disposables=e;this.pythonEnvFilter=t;this.extensionChecker=n;this.serviceContainer=i;this.serverUriStorage=o;this.kernelFinder=s;this.registeredControllers=new Map;this.changeEmitter=new ZI.EventEmitter;this.registeredMetadatas=new Map;this.selectedEmitter=new ZI.EventEmitter;this.selectionChangedEmitter=new ZI.EventEmitter;this.selectedControllers=new WeakMap;this._activeInterpreterControllerIds=new Set}get onDidChange(){return this.changeEmitter.event}get registered(){return[...this.registeredControllers.values()]}get all(){return this.metadatas}get metadatas(){return[...this.registeredMetadatas.values()]}get onControllerSelected(){return this.selectedEmitter.event}get onControllerSelectionChanged(){return this.selectionChangedEmitter.event}activate(){this.kernelFinder.onDidChangeKernels(()=>this.loadControllers(),this,this.disposables),this.kernelFinder.registered.forEach(e=>this.monitorDeletionOfConnections(e)),this.kernelFinder.onDidChangeRegistrations(e=>e.added.forEach(t=>this.monitorDeletionOfConnections(t)),this,this.disposables),this.pythonEnvFilter.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeUri,this,this.disposables),this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables),this.loadControllers()}loadControllers(){this.controllersPromise=this.loadControllersImpl(),WZ(this.registered.map(e=>e.connection)),w.ci(`Providing notebook controllers with length ${this.registered.length}.`)}get loaded(){return this.controllersPromise}async loadControllersImpl(){let e=this.kernelFinder.kernels;this.createNotebookControllers(e),Array.from(this.registered).filter(n=>{let i=e.some(o=>o.id===n.connection.id)||di&&this._activeInterpreterControllerIds.has(n.id);return!i&&n.connection.kind==="connectToLiveRemoteKernel"?!0:this.canControllerBeDisposed(n)?(i||w.debug(`Controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}' is no longer a valid`),!i):!1}).forEach(n=>{w.warn(`Disposing old controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}'`),n.dispose()})}createNotebookControllers(e){if(e.length!==0)try{this.batchAdd(e,[bt,vr])}catch(t){if(!Yn(t,!0))throw t}}async monitorDeletionOfConnections(e){let t=e.onDidChangeKernels(({removed:n})=>{let i=new Set((n||[]).map(o=>o.id));this.registered.filter(o=>i.has(o.connection.id)).forEach(o=>{w.warn(`Deleting controller ${o.id} as it is associated with a connection that has been deleted ${o.connection.kind}:${o.id}`),o.dispose()})},this,this.disposables);this.kernelFinder.onDidChangeRegistrations(n=>{n.removed.includes(e)&&t.dispose()})}onDidChangeUri(){this.onDidChangeFilter()}async onDidRemoveServers(e){e.forEach(t=>{this.registered.forEach(n=>{Wt(n.connection)&&n.connection.serverProviderHandle.id===t.id&&n.connection.serverProviderHandle.handle===t.handle&&(w.warn(`Deleting controller ${n.id} as it is associated with a connection that has been removed`),n.dispose())})}),this.onDidChangeFilter()}onDidChangeFilter(){this.all.forEach(t=>this.addOrUpdate(t,[bt,vr]))}batchAdd(e,t){let n=[];e.forEach(i=>{let{added:o}=this.addImpl(i,t,!1);n.push(...o)}),n.length&&this.changeEmitter.fire({added:n,removed:[]})}trackActiveInterpreterControllers(e){e.forEach(t=>this._activeInterpreterControllerIds.add(t.id))}canControllerBeDisposed(e){return!this._activeInterpreterControllerIds.has(e.id)&&!this.isControllerAttachedToADocument(e)}getSelected(e){return this.selectedControllers.get(e)}addOrUpdate(e,t){let{added:n,existing:i}=this.addImpl(e,t,!0);return n.concat(i)}addImpl(e,t,n){let i=[],o=[];w.ci(`Create Controller for ${e.kind} and id '${e.id}' for view ${t.join(", ")}`);try{t.map(s=>{let a=this.getControllerId(e,s);return this.registeredMetadatas.set(e.id,e),[a,s]}).filter(([s])=>{let a=this.registeredControllers.get(s);return a?(a.updateConnection(e),o.push(a),w.ci(`Found existing controller '${a.id}', not creating a new one just updating it`),!1):(w.ci(`Existing controller not found for '${s}', hence creating a new one`),!0)}).forEach(([s,a])=>{let l=dM.create(e,s,a,this.serviceContainer.get(qe),this.serviceContainer.get(st),this.disposables,this.serviceContainer.get(js),this.serviceContainer.get(Ke),this.extensionChecker,this.serviceContainer,this.serviceContainer.get(NS),this.serviceContainer.get(YA)),u=[];l.onDidDispose(()=>{w.trace(`Deleting controller '${l.id}' associated with view ${a} from registration as it was disposed`),this.registeredControllers.delete(l.id),u.forEach(c=>c.dispose())},this,this.disposables),this.disposables.push(l),this.registeredControllers.set(l.id,l),i.push(l),l.onNotebookControllerSelectionChanged(c=>{var d;c.selected&&(w.ci(`Controller ${(d=c.controller)==null?void 0:d.id} selected for ${c.notebook.uri.toString()}`),this.selectedControllers.set(c.notebook,c.controller),this.selectedEmitter.fire(c))},this,u),l.onNotebookControllerSelectionChanged(c=>this.selectionChangedEmitter.fire({...c,controller:l}),this,u)}),n&&i.length&&this.changeEmitter.fire({added:i,removed:[]})}catch(s){if(Yn(s,!0))return w.warn(`Cancel creation of notebook controller for ${e.id}`,s),{added:i,existing:o};w.error(`Failed to create notebook controller for ${e.id}`,s)}return{added:i,existing:o}}get(e,t){let n=this.getControllerId(e,t);return this.registeredControllers.get(n)}getControllerId(e,t){return t===bt?e.id:`${e.id}${cQ}`}isControllerAttachedToADocument(e){return ZI.workspace.notebookDocuments.some(t=>e.isAssociatedWithDocument(t))}};XI=U([(0,Zd.injectable)(),x(0,(0,Zd.inject)(ve)),x(1,(0,Zd.inject)(jd)),x(2,(0,Zd.inject)(vo)),x(3,(0,Zd.inject)(Nr)),x(4,(0,Zd.inject)(dr)),x(5,(0,Zd.inject)(oi))],XI);p();p();var gm=se(ge());p();var JZ=require("vscode"),PP=class{constructor(e,t){this.id="remote";if(e.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage of this class, can only be used with remtoe kernels");this.kernelConnection=e.kernelConnectionMetadata,this.scriptManager=t.getOrCreate(e)}dispose(){}async getBaseUrl(){return JZ.Uri.parse(this.kernelConnection.baseUrl)}async getWidgetScriptSource(e){let n=(await this.getWidgetScriptSources()).find(i=>i.moduleName.toLowerCase()===e.toLowerCase());if(!n&&e.includes("/")){let i=await this.getBaseUrl();return{moduleName:e,scriptUri:`${i.toString()}${e}`,source:"remote"}}return n||{moduleName:e}}async getWidgetScriptSources(){let e=await this.scriptManager.getWidgetModuleMappings();return e&&Object.keys(e).length?await Promise.all(Object.keys(e).map(async n=>({moduleName:n,scriptUri:e[n].toString(),source:"remote"}))):[]}};PP.validUrls=new Map;var e_=class{constructor(e,t,n){this.configurationSettings=e;this.globalMemento=t;this.widgetScriptManagerFactory=n}getProviders(e,t){let n=[];switch(n.push(new Wl(this.globalMemento,this.configurationSettings)),e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":n.push(new PP(e,this.widgetScriptManagerFactory));break}return n}};e_=U([(0,gm.injectable)(),x(0,(0,gm.inject)(Ke)),x(1,(0,gm.inject)(_t)),x(1,(0,gm.named)(rr)),x(2,(0,gm.inject)(iM))],e_);p();var pv=se(ge());p();var dv=require("vscode");p();var m9=require("vscode");var oee=se(nee());var iee=["require.config({","requirejs?.config({","window.requirejs?.config({","requirejs.config({",'["require"].config({',"['require'].config({",'["requirejs"].config({',"['requirejs'].config({",'["require"]["config"]({',"['require']['config']({",'["requirejs"]["config"]({',"['requirejs']['config']({"];async function e_e(r,e,t){let n=[...iee],i=await Rt(e),o=0,s;for(;o<=0&&n.length&&(s=n.pop(),!!s);)o=t.indexOf(s);if(o<0){let f=[...iee].map(m=>m.substring(0,m.length-2));for(;o<=0&&f.length&&(s=f.pop(),!!s);)o=t.indexOf(s)}if(o<0){ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigStart"});return}let a=t.indexOf(")",o);if(a<=0||!s){ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigEnd"});return}let l=t.indexOf("{",o),u=t.substring(l,a);u=(0,oee.default)(u,{language:"javascript"}),u=at(u,{trim:!0,removeEmptyEntries:!0}).join("");let c=u.split("{")[u.split("{").length-1].split("}")[0].split(",").map(f=>f.trim()).filter(f=>f.length&&f.includes(":")),d={};if(c.forEach(f=>{let m=f.split(":"),g=jE(m[0].replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim(),b=jE(f.substring(f.indexOf(":")+1).replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim();d[g]=b.startsWith("http")?m9.Uri.parse(b):m9.Uri.joinPath(r,b)}),!d||!Object.keys(d).length){ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"noRequireConfigEntries"});return}return ne("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",{requireEntryPointCount:Object.keys(d).length},{widgetFolderNameHash:i,patternUsedToRegisterRequireConfig:s}),d}var hM=class{constructor(e){this.kernel=e;this.disposables=[];e.onRestarted(this.onKernelRestarted,this,this.disposables)}dispose(){Ce(this.disposables)}async getWidgetModuleMappings(){return this.widgetModuleMappings||(this.widgetModuleMappings=this.getWidgetModuleMappingsImpl()),this.widgetModuleMappings}onKernelRestarted(){this.widgetModuleMappings=void 0}async getConfigFromWidget(e,t,n){let i=await this.getWidgetScriptSource(t);try{let o=await e_e(e,n,i);if(!o){let s=`Failed to extract require.config from widget for ${n} from ${Ee(t)}`;di&&(s+=`with contents ${i}`),w.warn(s)}return o}catch(o){w.error(`Failed to extract require.config entry for ${n} from ${Ee(t)}`,o)}}async getWidgetModuleMappingsImpl(){let e=new It,[t,n]=await Promise.all([this.getWidgetEntryPoints(),this.getNbExtensionsParentPath()]);if(!n)return;let o=(await Promise.all(t.map(s=>this.getConfigFromWidget(n,s.uri,s.widgetFolderName)))).reduce((s,a)=>Object.assign(s||{},a),{});return o&&Object.keys(o).length&&(delete o["jupyter-js-widgets"],delete o["@jupyter-widgets/base"],delete o["@jupyter-widgets/controls"],delete o["@jupyter-widgets/output"]),ne("DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",{duration:e.elapsedTime},{type:zt(this.kernel.kernelConnectionMetadata)?"local":"remote"}),o&&Object.keys(o).length?o:void 0}};var gM=class extends hM{constructor(t,n,i,o){super(t);this.context=n;this.fs=i;this.connection=o;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&t.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage, can only be used for remote kernels");this.kernelConnection=t.kernelConnectionMetadata,this.getWidgetEntryPoints().catch(E)}getBaseUrl(){return this.getNbExtensionsParentPath()}async getNbExtensionsParentPath(){return dv.Uri.parse(this.kernelConnection.baseUrl)}onKernelRestarted(){this.widgetEntryPointsPromise=void 0,super.onKernelRestarted()}async getWidgetEntryPoints(){return this.widgetEntryPointsPromise||(this.widgetEntryPointsPromise=this.getWidgetEntryPointsImpl()),this.widgetEntryPointsPromise}getCodeToExecute(){return this.code||(this.code=this.fs.readFile(dv.Uri.joinPath(this.context.extensionUri,"pythonFiles","printJupyWidgetEntryPoints.py"))),this.code}async getWidgetEntryPointsImpl(){var s;if(!jt(this.kernelConnection))return[];let t=await this.getCodeToExecute();if(!((s=this.kernel.session)!=null&&s.kernel))return w.ci("No Kernel session to get list of widget entry points"),[];let n=[];n.push(Mi(this.kernel.session.kernel,t,{traceErrors:!0,traceErrorsMessage:"Failed to get widget entry points from remote kernel"})),!di&&this.context.extensionMode===dv.ExtensionMode.Production&&n.push(tc(1e4).then(()=>[])),n.forEach(a=>a.catch(E));let i=await Promise.race(n);if(i.length===0)return w.ci("Unable to get widget entry points, no outputs after running the code"),[];let o=i[0];if(o.output_type!=="stream"||o.name!=="stdout")return w.ci("Unable to get widget entry points, no stream/stdout outputs after running the code"),[];try{return w.trace(`Widget Outputs include, ${o.text}`),o.text.trim().substring(1).slice(0,-1).split(",").map(l=>jE(l.trim()).replace(/\\\\/g,"/").replace(/\\/g,"/")).map(l=>({uri:dv.Uri.joinPath(dv.Uri.parse(this.kernelConnection.baseUrl),"nbextensions",l),widgetFolderName:xi(l)}))}catch(a){return w.error(`Failed to parse output to get list of IPyWidgets, output is ${o.text}`,a),[]}}async getWidgetScriptSource(t){let n=this.getWidgetScriptSourceUsingHttpClient(t),i=this.getWidgetScriptSourceUsingFetch(t),o=n.catch(()=>i);return o.catch(s=>{n.catch(a=>w.error(`Failed to download widget script source from ${t.toString(!0)}`,a)),w.error(`Failed to download widget script source from ${t.toString(!0)}`,s)}),o}async getWidgetScriptSourceUsingHttpClient(t){let n=t.toString(!0),o=await new cu().downloadFile(n);if(o.status===200)return o.text();throw new Error(`Error downloading from ${n}: ${o.statusText}`)}async getWidgetScriptSourceUsingFetch(t){let n=await this.connection.createConnectionInfo(this.kernelConnection.serverProviderHandle),i=t.toString(!0),s=await new cu(n.settings.fetch).downloadFile(i);if(s.status===200)return s.text();throw new Error(`Error downloading from ${i} using custom fetch: ${s.statusText}`)}};var t_=class{constructor(e,t,n,i){this.context=e;this.fs=t;this.disposables=n;this.connection=i;this.managers=new WeakMap}getOrCreate(e){if(!this.managers.has(e))if(e.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"||e.kernelConnectionMetadata.kind==="startUsingRemoteKernelSpec"){let t=new gM(e,this.context,this.fs,this.connection);this.managers.set(e,t),e.onDisposed(()=>t.dispose(),this,this.disposables)}else throw new Error("Cannot enumerate Widget Scripts using local kernels on the Web");return this.managers.get(e)}};t_=U([(0,pv.injectable)(),x(0,(0,pv.inject)(st)),x(1,(0,pv.inject)(Pt)),x(2,(0,pv.inject)(ve)),x(3,(0,pv.inject)(pn))],t_);p();var see=se(ge()),aee=require("vscode");var r_=class{async getNbExtensionsParentPath(e){switch(e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":return aee.Uri.parse(e.kernelConnectionMetadata.baseUrl);default:return}}};r_=U([(0,see.injectable)()],r_);p();var vM=se(ge()),Vl=require("vscode");var ka=class{constructor(e){this.disposables=[];e.push(this)}dispose(){Ce(this.disposables)}activate(){let e=new ec(1e3);this.disposables.push(e),Vl.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>this.onDidChangeNotebookDocument(t))},this,this.disposables)}onDidChangeNotebookDocument(e){mr(e.notebook)&&e.cellChanges.some(t=>t.outputs&&t.outputs.some(n=>n.items&&n.items.some(i=>i.mime===po)))&&this.checkRendererExtensionVersion()}checkRendererExtensionVersion(){if(!Vl.workspace.isTrusted)return;let e=Vl.extensions.getExtension(jv);if(!e){this.displayNotInstalledMessage();return}let t=e.packageJSON.version;if(!t){this.displayUpdateMessage();return}let n=t.split("."),i=parseInt(n[0],10),o=parseInt(n[1],10),s=parseInt(n[2],10);(i<1||i===1&&o===0&&s<15)&&this.displayUpdateMessage()}displayNotInstalledMessage(){ka.messageDisplayed||(ka.messageDisplayed=!0,Vl.window.showInformationMessage(W.rendererExtensionRequired,{modal:!0},Ue.bannerLabelYes).then(e=>{e===Ue.bannerLabelYes&&Vl.commands.executeCommand("extension.open",jv).then(E,E)}).then(E,E))}displayUpdateMessage(){ka.messageDisplayed||(ka.messageDisplayed=!0,Vl.window.showInformationMessage(W.rendererExtension1015Required,{modal:!0},Ue.bannerLabelYes).then(e=>{e===Ue.bannerLabelYes&&Vl.commands.executeCommand("extension.open",jv).then(E,E)}).then(E,E))}};ka.messageDisplayed=!1,ka=U([(0,vM.injectable)(),x(0,(0,vM.inject)(ve))],ka);function lee(r,e){r.addSingleton(Xd,Xd),r.addSingleton(nM,e_),r.addSingleton(iM,t_),r.addSingleton(kZ,r_),r.addSingleton(Wl,Wl),r.addSingleton(Ve,ka)}p();var ym=se(ge()),qr=require("vscode");var n_=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.kernelFinder=t;this.notebookEditorProvider=n;this.kernelDependency=i;this.localDisposables=[];this.providerMappings=new Map;this.kernelSpecsSourceRegistered=!1;o.push(this)}dispose(){Ce(this.localDisposables)}activate(){if(!_n()){this.localDisposables.push(qr.notebooks.registerKernelSourceActionProvider(bt,{provideNotebookKernelSourceActions:()=>[{label:W.localPythonEnvironments,documentation:qr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]})),this.localDisposables.push(qr.notebooks.registerKernelSourceActionProvider(vr,{provideNotebookKernelSourceActions:()=>[{label:W.localPythonEnvironments,documentation:qr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]}));let t=[],n=new qr.EventEmitter;this.localDisposables.push(qr.notebooks.registerKernelSourceActionProvider(bt,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t})),this.localDisposables.push(qr.notebooks.registerKernelSourceActionProvider(vr,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t}));let i=()=>{this.kernelSpecsSourceRegistered||this.kernelFinder.kernels.some(o=>Yz(o))&&(this.kernelSpecsSourceRegistered=!0,t=[{label:W.localKernelSpecs,documentation:qr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerJupyterKernels"),command:"jupyter.kernel.selectLocalKernelSpec"}],n.fire())};i(),this.kernelFinder.onDidChangeKernels(()=>i(),this,this.localDisposables),this.localDisposables.push(qr.commands.registerCommand("jupyter.kernel.selectLocalKernelSpec",this.onSelectLocalKernel.bind(this,"localKernelSpec"),this)),this.localDisposables.push(qr.commands.registerCommand("jupyter.kernel.selectLocalPythonEnvironment",this.onSelectLocalKernel.bind(this,"localPythonEnvironment"),this))}this.localDisposables.push(qr.commands.registerCommand("jupyter.kernel.selectJupyterServerKernel",this.onSelectRemoteKernel,this)),tt.instance.get(sr).onDidChangeCollections(this.registerUriCommands,this,this.localDisposables),this.registerUriCommands()}registerUriCommands(){let e=tt.instance.get(sr),t=new Set;e.jupyterCollections.map(n=>{let i=`${n.extensionId}:${n.id}`;if(n.id===sD||(t.add(i),this.providerMappings.has(i)))return;let o=qr.notebooks.registerKernelSourceActionProvider(bt,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]}),s=qr.notebooks.registerKernelSourceActionProvider(vr,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]});this.localDisposables.push(o),this.localDisposables.push(s),this.providerMappings.set(i,{disposables:[o,s],provider:n})}),this.providerMappings.forEach(({disposables:n},i)=>{t.has(i)||(Ce(n),this.providerMappings.delete(i))})}async onSelectLocalKernel(e,t){var n;if(t=t||((n=qr.window.activeNotebookEditor)==null?void 0:n.notebook),!!t)if(e==="localPythonEnvironment"){let o=await tt.instance.get(IR).selectLocalKernel(t);return this.getSelectedController(t,o)}else{let o=await tt.instance.get(uQ).selectLocalKernel(t);return this.getSelectedController(t,o)}}async onSelectRemoteKernel(e,t,n){var l,u,c;if(n=n||((l=qr.window.activeNotebookEditor)==null?void 0:l.notebook),!n&&qr.window.activeTextEditor&&(n=(u=this.notebookEditorProvider.findNotebookEditor(qr.window.activeTextEditor.document.uri))==null?void 0:u.notebook),!n)return;let i=`${e}:${t}`,o=(c=this.providerMappings.get(i))==null?void 0:c.provider;if(!o)return;let a=await tt.instance.get(SR).selectRemoteKernel(n,o);return this.getSelectedController(n,a)}async getSelectedController(e,t){var o;if(!t)return;let n=this.controllerRegistration.addOrUpdate(t,[e.notebookType]);if(!Array.isArray(n)||n.length===0){w.warn(`No controller created for selected kernel connection ${t.kind}:${t.id}`);return}Ol(e.uri,t).finally(()=>Br(e.uri,"DS_INTERNAL.SWITCH_KERNEL",void 0,{newKernelPicker:!0})).catch(E),(o=n.find(s=>s.viewType===e.notebookType))==null||o.controller.updateNotebookAffinity(e,qr.NotebookControllerAffinity.Preferred);let i=n[0];return await this.onControllerSelected(e,i),i.controller.id}async onControllerSelected(e,t){if(uY(e),zt(t.connection)&&jt(t.connection)&&Dp(t.connection.interpreter)&&!_n()){let n=[];try{let i=new qr.CancellationTokenSource;n.push(i);let o=new hr(!1);n.push(o),await this.kernelDependency.installMissingDependencies({resource:e.uri,kernelConnection:t.connection,token:i.token,ui:o,cannotChangeKernels:!0,ignoreCache:!0,installWithoutPrompting:!0})}catch(i){w.error(`Failed to install missing dependencies for Conda kernel ${t.connection.id}`,i)}finally{Ce(n)}}}};n_=U([(0,ym.injectable)(),x(0,(0,ym.inject)(Nt)),x(1,(0,ym.inject)(oi)),x(2,(0,ym.inject)(Oo)),x(3,(0,ym.inject)(CS)),x(4,(0,ym.inject)(ve))],n_);p();var yu=se(ge()),li=require("vscode");p();var Bs=require("vscode");var h9=class{constructor(e){this.label=e}},yM=class extends h9{constructor(t,n){super(t);this.sortKey=n;this.kind=Bs.QuickPickItemKind.Separator}},bM=class extends Lr{constructor(t,n,i,o,s,a){super();this.provider=t;this.createQuickPickItem=n;this.getCategory=i;this.options=o;this.createErrorQuickPickItem=s;this._title=a;this.categories=new Map;this.quickPickItems=[];this.previouslyEnteredValue="";this.commands=new Set;this._placeholder="";this.quickPickItemMap=new WeakSet;this.errorQuickPickItemMap=new WeakSet}set recommended(t){var i;let n=((i=this._recommended)==null?void 0:i.id)!==(t==null?void 0:t.id);this._recommended=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get recommended(){return this._recommended}set placeholder(t){this.quickPick&&(this.quickPick.placeholder=t),this._placeholder=t}get placeholder(){return this._placeholder}set selected(t){let n=this._selected!==t;this._selected=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get selected(){return this._selected}createQuickPick(){let t=[],n={iconPath:new Bs.ThemeIcon("refresh"),tooltip:Ue.refresh},i=this.quickPick=Bs.window.createQuickPick();return t.push(i),this.quickPickItems=[],i.placeholder=this.placeholder,i.matchOnDescription=!0,i.buttons=this.options.supportsBack?[Bs.QuickInputButtons.Back,n]:[n],i.ignoreFocusOut=!0,i.busy=!0,i.value=this.previouslyEnteredValue,i.onDidChangeValue(o=>this.previouslyEnteredValue=o,this,t),i.onDidHide(()=>Ce(t),this,t),i.title=this._title||W.kernelPickerSelectKernelFromRemoteTitleWithoutName,this.provider.then(o=>{this.resolvedProvider=o,this._title||(i.title=W.kernelPickerSelectKernelFromRemoteTitle(o.title)),i.busy=o.status==="discovering",o.onDidChange(()=>this.updateQuickPickItems(i,o),this,t),i.onDidTriggerButton(async a=>{a===n&&(i.busy=!0,await o.refresh().catch(E),this.updateQuickPickItems(i,o),i.busy=!1)},this,t);let s;o.onDidChangeStatus(()=>{switch(s&&clearTimeout(s),o.status){case"discovering":i.busy=!0;break;case"idle":s=setTimeout(()=>i.busy=!1,500),t.push(new Bs.Disposable(()=>s&&clearTimeout(s)));break}},this,t),cee(o.items.map(a=>this.toQuickPickItem(a)),(a,l)=>uee(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{let l=this.connectionToCategory(a[0].item);this.quickPickItems.push(l),a.sort((u,c)=>u.label.localeCompare(c.label)),this.quickPickItems.push(...a),this.categories.set(l,new Set(a))}),this.updateQuickPickItems(i,o)}).catch(o=>w.error(`Failed to get quick pick items for ${i.title}`,o)),t.forEach(o=>this._register(o)),{quickPick:i,disposables:t}}isCommandQuickPickItem(t){return this.commands.has(t)}addCommand(t,n){let i=t;return i.execute=n,this.commands.add(i),this.quickPick&&this.rebuildQuickPickItems(this.quickPick),{dispose:()=>{this.commands.delete(i)}}}async selectItem(t){for(;!t.isCancellationRequested;){let{quickPick:n,disposables:i}=this.createQuickPick();n.show();try{this.previouslySelectedItem=void 0;let o=await new Promise((s,a)=>{n.onDidChangeSelection(l=>{if(l.length){let u=l[0];this.isSelectorQuickPickItem(u)?s(u.item):this.isCommandQuickPickItem(u)?s(u):this.isErrorQuickPickItem(u)}}),n.onDidTriggerButton(l=>l===Bs.QuickInputButtons.Back?s(ze.back):void 0,this,i),n.onDidHide(()=>s(void 0),this,i)});if(t.isCancellationRequested||!o)return;if(o instanceof ze)return o===ze.back?ze.back:void 0;if(o&&"label"in o&&this.isCommandQuickPickItem(o)){this.previouslySelectedItem=o;let s=await o.execute();if(!s||s===ze.back)continue;return s instanceof ze,s}return o||void 0}finally{Ce(i)}}}updateQuickPickItems(t,n){let i=new Map(t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>[a.item.id,a.item])),o=new Map(n.items.map(a=>[a.id,a]));this.quickPickItems=this.quickPickItems.map(a=>{if(this.isSelectorQuickPickItem(a)){let l=i.get(a.item.id);if(l&&l!==a.item)return this.toQuickPickItem(l);let u=o.get(a.item.id);if(u){let c=this.toQuickPickItem(u);if(JSON.stringify({...a,item:""})!==JSON.stringify({...c,item:""}))return this.toQuickPickItem(u)}}return a});let s=n.items.filter(a=>!i.has(a.id)).map(a=>this.toQuickPickItem(a));this.removeOutdatedQuickPickItems(t,n),cee(s,(a,l)=>uee(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{a.sort((c,d)=>c.label.localeCompare(d.label));let l=this.connectionToCategory(a[0].item),u=this.quickPickItems.find(c=>c.kind===Bs.QuickPickItemKind.Separator&&c.label===l.label);if(u){let c=this.quickPickItems.indexOf(u),d=this.categories.get(u),f=new Map(Array.from(d).map(b=>[b.item.id,b])),m=d.size;a.forEach(b=>{let y=f.get(b.item.id);y&&d.delete(y),d.add(b)});let g=Array.from(d);g.sort((b,y)=>b.label.localeCompare(y.label)),this.quickPickItems.splice(c+1,m,...g)}else{let c=this.quickPickItems.filter(m=>m instanceof yM).map((m,g)=>[m,g]);c.push([l,-1]),c.sort((m,g)=>m[0].sortKey.localeCompare(g[0].sortKey));let d=c.findIndex(m=>m[1]===-1),f=0;d>0&&(f=c.length===d+1?this.quickPickItems.length:c[d+1][1]),a.sort((m,g)=>m.label.localeCompare(g.label)),this.quickPickItems.splice(f,0,l,...a),this.categories.set(l,new Set(a))}}),this.rebuildQuickPickItems(t)}rebuildQuickPickItems(t){var d;let n=this.recommended?this.toQuickPickItem(this.recommended):void 0,i=[];n&&i.push({label:W.recommendedItemCategoryInQuickPick,kind:Bs.QuickPickItemKind.Separator},n);let o=n;o=this.selected?this.quickPickItems.filter(f=>this.isSelectorQuickPickItem(f)).map(f=>f).find(f=>{var m;return f.item.id===((m=this.selected)==null?void 0:m.id)}):o;let s=this.quickPickItems.filter(f=>{var m;return!this.isSelectorQuickPickItem(f)||f.item.id!==((m=n==null?void 0:n.item)==null?void 0:m.id)}),a=t.activeItems.length?t.activeItems[0]:void 0;o&&a&&(this.isSelectorQuickPickItem(a)?a.item.id!==o.item.id&&(o=void 0):o=void 0);let l=(d=this.resolvedProvider)!=null&&d.lastError?this.toErrorQuickPickItem(this.resolvedProvider.lastError):void 0,u=[].concat(Array.from(this.commands.values())).concat(i).concat(s).concat(l?[l]:[]),c=o?[o]:t.activeItems.length?[t.activeItems[0]]:[];if(c.length&&!u.includes(c[0])){let f=c[0],m=this.isSelectorQuickPickItem(f)&&u.find(g=>this.isSelectorQuickPickItem(g)&&g.item.id===f.item.id);m?c[0]=m:c.length=0}t.items=u,t.activeItems=c,!t.activeItems.length&&this.previouslySelectedItem&&u.includes(this.previouslySelectedItem)&&(t.activeItems=[this.previouslySelectedItem])}isErrorQuickPickItem(t){return this.errorQuickPickItemMap.has(t)}toErrorQuickPickItem(t){if(!this.createErrorQuickPickItem)return;let n=this.createErrorQuickPickItem(t,this);return this.errorQuickPickItemMap.add(n),n}isSelectorQuickPickItem(t){return this.quickPickItemMap.has(t)}toQuickPickItem(t){let n=this.createQuickPickItem(t,this);return n.item=t,this.quickPickItemMap.add(n),n}removeOutdatedQuickPickItems(t,n){let i=t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>a.item.id),o=new Map(n.items.map(a=>[a.id,a])),s=i.filter(a=>!o.has(a));if(s.length){let a=[];this.categories.forEach((l,u)=>{l.forEach(c=>{s.includes(c.item.id)&&(l.delete(c),a.push(c))}),l.size||(a.push(u),this.categories.delete(u))}),this.quickPickItems=this.quickPickItems.filter(l=>!a.includes(l)),this.rebuildQuickPickItems(t)}}connectionToCategory(t){let n=this.getCategory(t,this);return new yM(n.label,n.sortKey||n.label)}};function cee(r,e){let t=[],n;for(let i of r.slice(0).sort(e))!n||e(n[0],i)!==0?(n=[i],t.push(n)):n.push(i);return t}function uee(r,e){return(r.sortKey||r.label).localeCompare(e.sortKey||e.label,void 0,{sensitivity:"accent"})}p();var SM=require("vscode");p();function dee(r){return Pi()==="Windows"?bs(r).toUpperCase():bs(r)}function pee(r,e){return e.endsWith(Ki)||(e+=Ki),r.endsWith(Ki)||(r+=Ki),dee(r).startsWith(dee(e))}var i_=class{constructor(e){this.jupyterConnection=e;this.disposables=[]}dispose(){Ce(this.disposables)}async findPreferredRemoteKernelConnection(e,t,n){return this.findPreferredRemoteKernelConnectionImpl(e,t,n,!1)}async findPreferredRemoteKernelConnectionImpl(e,t,n,i){var l;let o=await tt.instance.get(Vs).getPreferredRemoteKernelId(e),s=async()=>{let u=t.kernels.find(d=>d.kind==="connectToLiveRemoteKernel"&&d.id===o);if(u)return u;if(t.status==="idle")return;let c=await new Promise(d=>t.onDidChangeKernels(()=>{let f=t.kernels.find(m=>m.kind==="connectToLiveRemoteKernel"&&m.id===o);f&&d(f),(t.status==="idle"||n.isCancellationRequested)&&d(void 0)},this,this.disposables));if(c)return c};if(o){let u=await s();if(u||i)return u}let a=(l=t.kernels.find(u=>Wt(u)))==null?void 0:l.serverProviderHandle;if(a){let u=await this.jupyterConnection.createConnectionInfo(a),c=(e.uri,void 0),d=c&&t.kernels.find(f=>Wt(f)&&f.kind==="connectToLiveRemoteKernel"&&f.kernelModel.model&&f.kernelModel.model.path===c.path&&f.kernelModel.model.name===c.name);if(d)return d}return this.findPreferredKernelSpecConnection(e,t,n,i)}async findPreferredLocalKernelSpecConnection(e,t,n){return this.findPreferredKernelSpecConnection(e,t,n,!1)}async findPreferredKernelSpecConnection(e,t,n,i){var c;let o=_a(e),s=(c=o==null?void 0:o.kernelspec)==null?void 0:c.name,a=()=>{let d=s?t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.name===s):[];if(d.length||i)return d;let f=aM(e);if(f)return t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.language&&(m.kernelSpec.language===f||Kc(m.kernelSpec.language)===Kc(f)))},l=a();if(Array.isArray(l)&&l.length)return i&&l.length>1?void 0:l[0];if(t.status==="idle")return;let u=[];return new Promise(d=>t.onDidChangeKernels(()=>{if(n.isCancellationRequested)return d(void 0);let f=a();if(Array.isArray(f)&&f.length)return i&&f.length>1?d(void 0):d(f[0]);t.status==="idle"&&d(void 0)},this,this.disposables)).finally(()=>Ce(u))}async findPreferredPythonKernelConnection(e,t,n){return this.findPreferredPythonKernelConnectionImpl(e,t,n)}async findPreferredPythonKernelConnectionImpl(e,t,n){t=t||tt.instance.get(oi).registered.find(u=>u.kind==="localPythonEnvironment");let i=tt.instance.get(cm),o=g9(e,t);if(o)return o;let s=await i.getActiveInterpreter(e.uri);if(!s)return;let a=()=>{if(!n.isCancellationRequested)return t.kernels.filter(u=>u.kind==="startUsingPythonInterpreter").map(u=>u).find(u=>u.interpreter.id===s.id)},l=a();if(l)return l;if(t.status==="discovering")return await new Promise(u=>{t.onDidChangeStatus(()=>t.status==="idle"&&u(),this,this.disposables),t.onDidChangeKernels(()=>(g9(e,t)||a())&&u(),this,this.disposables)}),g9(e,t)||a()}};function g9(r,e){var i,o;let t=((i=SM.workspace.getWorkspaceFolder(r.uri))==null?void 0:i.uri)||(((o=SM.workspace.workspaceFolders)==null?void 0:o.length)===1?SM.workspace.workspaceFolders[0].uri:void 0),n=fee(Qv(r.uri),e);if(n)return n;if(t)return fee(t,e)}function fee(r,e){let n=e.kernels.filter(a=>a.kind==="startUsingPythonInterpreter").map(a=>a).filter(a=>{var l,u,c;return pee(((c=(u=(l=Hi(a.interpreter))==null?void 0:l.environment)==null?void 0:u.folderUri)==null?void 0:c.fsPath)||a.interpreter.uri.fsPath,r.fsPath)}),i=n.find(a=>{var l;return Jr(a.interpreter)==="Venv"&&((l=Ss(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(i)return i;let o=n.find(a=>{var l;return Jr(a.interpreter)==="Conda"&&((l=Ss(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(o)return o;let s=n.find(a=>{var l;return((l=Ss(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});return s||(n.length?n[0]:void 0)}function IM(r){return r===Je||r===Wv}var o_=class{constructor(e,t,n,i,o,s,a){this.kernelFinder=e;this.serverUriStorage=t;this.serverSelector=n;this.jupyterConnection=i;this.displayDataProvider=o;this.kernelFinderController=s;this.jupyterServerRegistry=a;this.localDisposables=[]}async selectRemoteKernel(e,t){var o,s,a,l;if(e.notebookType!==bt&&e.notebookType!==vr)return;this.localDisposables.forEach(u=>u.dispose()),this.localDisposables=[],(o=this.cancellationTokenSource)==null||o.cancel(),(s=this.cancellationTokenSource)==null||s.dispose(),this.cancellationTokenSource=new li.CancellationTokenSource;let n=new oP,i={disposables:[],notebook:e};try{if(await n.run(this.getRemoteServersFromProvider.bind(this,t,this.cancellationTokenSource.token),i)===ze.cancel||((a=i.selection)==null?void 0:a.type)==="userPerformedSomeOtherAction")throw new li.CancellationError;if(this.cancellationTokenSource.token.isCancellationRequested){Ce(i.disposables);return}if(((l=i.selection)==null?void 0:l.type)==="connection")return i.selection.connection}finally{Ce(i.disposables)}}async getRemoteServersFromProvider(e,t,n,i){var D;let o=this.kernelFinder.registered.filter(T=>T.kind==="remote"),s=[],a=[],l=[],u=(D=this.jupyterServerRegistry.jupyterCollections.find(T=>T.extensionId===e.extensionId&&T.id===e.id))==null?void 0:D.serverProvider,c=u!=null&&u.provideJupyterServers?Promise.resolve(u.provideJupyterServers.bind(u)(t)).then(T=>T||[]):Promise.resolve([]),d=new Set,f=await c,m=new Set(f.map(T=>T.id));if(o.filter(T=>T.serverProviderHandle.id===e.id).filter(T=>m.has(T.serverProviderHandle.id)).map(T=>{let K=this.serverUriStorage.all.find(L=>Vt(L.provider)===Vt(T.serverProviderHandle));d.add(Vt(T.serverProviderHandle)),l.push({server:T,time:K==null?void 0:K.time})}),l.sort((T,K)=>!T.time&&!K.time?T.server.displayName.localeCompare(K.server.displayName):!T.time&&K.time?1:T.time&&!K.time||(T.time||0)>(K.time||0)?-1:1),l.filter(({time:T})=>(T||0)>0).forEach(({server:T,time:K})=>{s.push({type:"finder",kernelFinderInfo:T,idAndHandle:T.serverProviderHandle,label:T.displayName,description:K?W.jupyterServerLastConnectionForQuickPickDescription(new Date(K)):void 0,buttons:u!=null&&u.removeJupyterServer&&IM(e.extensionId)?[{iconPath:new li.ThemeIcon("close"),tooltip:W.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),l.filter(({time:T})=>!T).forEach(({server:T})=>{s.push({type:"finder",kernelFinderInfo:T,idAndHandle:T.serverProviderHandle,label:T.displayName,buttons:u!=null&&u.removeJupyterServer&&IM(e.extensionId)?[{iconPath:new li.ThemeIcon("close"),tooltip:W.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),f.sort((T,K)=>T.label.localeCompare(K.label)).forEach(T=>{let K=Vt({extensionId:e.extensionId,id:e.id,handle:T.id});d.has(K)||s.push({type:"jupyterServer",label:T.label,idAndHandle:{extensionId:e.extensionId,id:e.id,handle:T.id},server:T,buttons:u!=null&&u.removeJupyterServer&&IM(e.extensionId)?[{iconPath:new li.ThemeIcon("close"),tooltip:W.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),e.commandProvider){let T=(await Promise.resolve(e.commandProvider.provideCommands(void 0,t))||[]).map(K=>({...K,provider:e,type:"uriProviderQuickPick",command:K}));s.length>0&&T.length&&a.push({label:"",kind:li.QuickPickItemKind.Separator}),a.push(...T)}let g=s.concat(a),b=new li.EventEmitter,y=g.length===1&&"command"in g[0]&&g[0].command.canBeAutoSelected?g[0]:void 0;if(u){let T=g.filter(K=>"type"in K);T.length===1&&T.every(K=>K.type!=="uriProviderQuickPick")?y=T[0]:T.every(K=>K.type==="uriProviderQuickPick")&&T.filter(K=>K.picked).length===1&&(y=g.filter(K=>K.picked)[0])}let P,A;if(y)A=y;else{let{quickPick:T,selection:K}=n.showLazyLoadQuickPick({items:g,placeholder:e.extensionId===Je||e.extensionId===Wv?W.enterOrSelectRemoteJupyterPlaceholder:W.selectRemoteJupyterPlaceholder,title:W.quickPickTitleForSelectionOfJupyterServer,supportBackInFirstStep:!0,onDidTriggerItemButton:async L=>{if("type"in L.item&&(L.item.type==="finder"||L.item.type==="jupyterServer")){let B=L.item.idAndHandle.handle,N=f.find(O=>O.id===B);u!=null&&u.removeJupyterServer&&N&&IM(e.extensionId)&&(T.busy=!0,this.serverUriStorage.remove({extensionId:e.extensionId,id:e.id,handle:B}).catch(E),await u.removeJupyterServer(N),T.busy=!1,g.splice(g.indexOf(L.item),1),b.fire(g.concat([])))}},onDidChangeItems:b.event});T.onDidChangeValue(async L=>{var h;if(!((h=e.commandProvider)!=null&&h.provideCommands))return;let B=[];s.length>0&&B.push({label:"",kind:li.QuickPickItemKind.Separator});let O=(await Promise.resolve(e.commandProvider.provideCommands(L,t))||[]).map(v=>({...v,provider:e,type:"uriProviderQuickPick",command:v}));T.items=s.concat(B).concat(O)},this),P=T,A=await K}if(!t.isCancellationRequested&&A&&"type"in A)switch(A.type){case"finder":{let T=await this.selectRemoteKernelFromPicker(i.notebook,Promise.resolve(A.kernelFinderInfo),t).catch(K=>w.error("Failed to select a kernel",K));if(T&&T===ze.back){if(A===y)throw ze.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!T||T instanceof ze)throw new li.CancellationError;i.selection={type:"connection",connection:T};return}case"jupyterServer":{let T=(async()=>{let L={id:e.id,handle:A.server.id,extensionId:e.extensionId};return e.extensionId.toLowerCase()===Zl.toLowerCase()&&await cs(t,this.serverSelector.addJupyterServer(L)),this.kernelFinderController.getOrCreateRemoteKernelFinder(L,A.server.label)})(),K=await this.selectRemoteKernelFromPicker(i.notebook,T,t).catch(L=>w.error("Failed to select a kernel",L));if(K&&K===ze.back){if(A===y)throw ze.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!K||K instanceof ze)throw new li.CancellationError;i.selection={type:"connection",connection:K};return}case"uriProviderQuickPick":{let T=li.notebooks.createNotebookControllerDetectionTask(bt);try{P&&(P.busy=!0);let K=await this.selectRemoteServerFromRemoteKernelFinder(A,i,t);return P&&(P.busy=!1),K}catch(K){if(K===ze.back&&!y)return this.getRemoteServersFromProvider(e,t,n,i);throw K}finally{T.dispose()}}default:break}}async selectRemoteServerFromRemoteKernelFinder(e,t,n){var a;if(!((a=e.provider.commandProvider)!=null&&a.handleCommand)||n.isCancellationRequested)return;let i=await Promise.resolve(e.provider.commandProvider.handleCommand(e.command,n));if(!i)throw ze.back;if(n.isCancellationRequested)throw new li.CancellationError;let o=(async()=>{let l={id:e.provider.id,handle:i.id,extensionId:e.provider.extensionId};return l.extensionId.toLowerCase()===Zl.toLowerCase()&&await cs(n,this.serverSelector.addJupyterServer(l)),this.kernelFinderController.getOrCreateRemoteKernelFinder(l,i.label)})(),s=await this.selectRemoteKernelFromPicker(t.notebook,o,n).catch(l=>w.error("Failed to select a kernel",l));if(s&&s===ze.back)throw ze.back;if(!s||s instanceof ze)throw new li.CancellationError;t.selection={type:"connection",connection:s}}async selectRemoteKernelFromPicker(e,t,n){let i,o=c=>{let d=this.displayDataProvider.getDisplayData(c);return{label:`${c===i?"$(star-full) ":""}${d.label}`,description:d.description,detail:d.detail}},s=c=>({label:this.displayDataProvider.getDisplayData(c).category||"Other"}),a=c=>({label:W.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel,detail:W.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail}),l=new bM(t,o,s,{supportsBack:!0},a),u=new i_(this.jupyterConnection);return t.then(c=>u.findPreferredRemoteKernelConnection(e,c,n)).then(c=>{i=c,(c==null?void 0:c.kind)==="startUsingRemoteKernelSpec"&&(l.recommended=c),l.selected=c}).catch(c=>w.error("Failed to determine preferred remote kernel",c)),l.selectItem(n)}};o_=U([(0,yu.injectable)(),x(0,(0,yu.inject)(oi)),x(1,(0,yu.inject)(dr)),x(2,(0,yu.inject)(Ll)),x(3,(0,yu.inject)(pn)),x(4,(0,yu.inject)(NS)),x(5,(0,yu.inject)(vP)),x(6,(0,yu.inject)(sr))],o_);function mee(r,e){r.addSingleton(Nt,XI),r.addBinding(Nt,Ve),r.addSingleton(NS,zI),r.addSingleton(SR,o_),r.addSingleton(Ve,n_),lee(r,e)}p();var TP=se(ge()),fv=require("vscode");p();var s_=Symbol("IJupyterDebugService"),bm=Symbol("INotebookDebuggingManager");var _M=Symbol("IDebugLocationTrackerFactory"),EM=Symbol("IDebugLocationTracker");var a_=class{constructor(e,t){this.debuggingManager=e;this.disposables=t}activate(){this.disposables.push(fv.commands.registerCommand(le.RunByLine,this.runByLine,this)),this.disposables.push(fv.commands.registerCommand(le.RunByLineNext,this.runByLineNext,this)),this.disposables.push(fv.commands.registerCommand(le.RunByLineStop,this.runByLineStop,this)),this.disposables.push(fv.commands.registerCommand(le.RunAndDebugCell,this.runAndDebugCell,this))}async runByLine(e){ne("DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(0,e)}async runByLineNext(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineNext(e)}async runByLineStop(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineStop(e)}async runAndDebugCell(e){ne("DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(1,e)}getCellFromActiveEditor(){let e=fv.window.activeNotebookEditor;if(e){let t=e.selections[0];if(t)return e.notebook.cellAt(t.start)}}dispose(){this.disposables.forEach(e=>e.dispose())}};a_=U([(0,TP.injectable)(),x(0,(0,TP.inject)(bm)),x(1,(0,TP.inject)(ve))],a_);p();var jl=se(ge());var kP=require("vscode");p();var v9=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]);function wM(r){var e;return{name:(e=r.evaluateName)!=null?e:r.name,type:r.type,count:0,shape:"",size:0,supportsDataExplorer:v9.has(r.type||""),value:r.value,truncated:!0,frameId:r.variablesReference}}function xM(r){let e=r.index,t=r.columns;return{data:r.data.map((o,s)=>{let a={index:e[s]};return t.forEach((l,u)=>{a[l]=o[u]}),a})}}p();var y9=require("vscode"),l_=class{constructor(e){this._sessionId=e;this.topMostFrameId=0;this.sequenceNumbersOfRequestsPendingResponses=new Set;this.waitingForStackTrace=!1;this.debugLocationUpdatedEvent=new y9.EventEmitter;this.sessionEndedEmitter=new y9.EventEmitter;this.DebugLocation=void 0}get sessionId(){return this._sessionId}get sessionEnded(){return this.sessionEndedEmitter.event}get debugLocationUpdated(){return this.debugLocationUpdatedEvent.event}get debugLocation(){return this._debugLocation}onDidSendMessage(e){var t,n;if(this.isResponseForRequestToFetchAllFrames(e)){let i=(t=e.body)==null?void 0:t.stackFrames[0];this.topMostFrameId=i==null?void 0:i.id,this.sequenceNumbersOfRequestsPendingResponses.delete(e.request_seq),this.waitingForStackTrace&&(this.DebugLocation={lineNumber:i==null?void 0:i.line,fileName:this.normalizeFilePath((n=i==null?void 0:i.source)==null?void 0:n.path),column:i.column},this.waitingForStackTrace=!1)}this.isStopEvent(e)&&(this.waitingForStackTrace=!0),this.isContinueEvent(e)&&(this.DebugLocation=void 0,this.waitingForStackTrace=!1)}onWillStopSession(){this.sessionEndedEmitter.fire(this)}onWillReceiveMessage(e){this.isRequestToFetchAllFrames(e)&&this.sequenceNumbersOfRequestsPendingResponses.add(e.seq)}set DebugLocation(e){let t=this._debugLocation;this._debugLocation=e,this._debugLocation!==t&&this.debugLocationUpdatedEvent.fire()}normalizeFilePath(e){return process.platform!=="win32"?e.replace(/\\/g,"/"):e}isStopEvent(e){return e.type==="event"&&e.event==="stopped"}isContinueEvent(e){if(e.type==="event"){if(e.event==="continue")return!0}else if(e.type==="response"&&e.command==="continue")return!0;return!1}isResponseForRequestToFetchAllFrames(e){var t;return e.type==="response"&&e.command==="stackTrace"&&((t=e.body)==null?void 0:t.stackFrames[0])&&this.sequenceNumbersOfRequestsPendingResponses.has(e.request_seq)}isRequestToFetchAllFrames(e){return e.type==="request"&&e.command==="stackTrace"&&(e.arguments.startFrame===0||e.arguments.startFrame===void 0)}};var t_e=new Set(["In","Out","exit","quit"]),PM=100,c_=class extends l_{constructor(t,n,i,o,s,a){super(void 0);this.debugService=t;this.debuggingManager=n;this.configService=i;this.varScriptGenerator=o;this.dfScriptGenerator=s;this.kernelProvider=a;this.refreshEventEmitter=new kP.EventEmitter;this.lastKnownVariables=[];this.importedGetVariableInfoScriptsIntoKernel=new Set;this.watchedNotebooks=new Map;this.debuggingStarted=!1;this.currentVariablesReference=0;this.currentSeqNumsForVariables=new Set;this.debuggingManager.onDoneDebugging(()=>this.refreshEventEmitter.fire(),this)}get refreshRequired(){return this.refreshEventEmitter.event}get active(){return(this.debugService.activeDebugSession!==void 0||this.activeNotebookIsDebugging())&&this.debuggingStarted}getAllVariableDiscriptions(){throw new Error("Method not implemented.")}async getVariables(t,n){n&&this.watchKernel(n);let i=n&&this.kernelProvider.getKernelExecution(n),o={executionCount:i?i.executionCount:t.executionCount,pageStartIndex:0,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(this.active){let s=t.sortColumn,a=(c,d)=>{let f=c[s]?c[s]:"",m=d[s]?d[s]:"";return t.sortAscending?f.localeCompare(m,void 0,{sensitivity:"base"}):m.localeCompare(f,void 0,{sensitivity:"base"})};this.lastKnownVariables.sort(a);let l=t.startIndex?t.startIndex:0,u=t.pageSize?t.pageSize:PM;o.pageStartIndex=l;for(let c=l;c<l+u&&c<this.lastKnownVariables.length;c+=1){let d=this.lastKnownVariables[c].truncated?await this.getFullVariable(this.lastKnownVariables[c]):this.lastKnownVariables[c];this.lastKnownVariables[c]=d,o.pageResponse.push(d)}o.totalCount=this.lastKnownVariables.length}return o}async getMatchingVariable(t,n){if(this.active){let i=this.lastKnownVariables.find(o=>o.name===t);return i&&(n!=null&&n.resourceUri)&&zv(n==null?void 0:n.resourceUri).toLowerCase()===".ipynb"&&ne("DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER"),i}}async getVariableValueSummary(t){}async getDataFrameInfo(t,n,i,o){var m;if(!this.active)return t;o&&(t=await this.getFullVariable(t)),n&&this.watchKernel(n);let s=t.name;i&&(s=`${t.name}${i}`);let{cleanupCode:a,initializeCode:l,code:u}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!0,variableName:s}),c=await this.evaluate({code:u,cleanupCode:a,initializeCode:l,frameId:t.frameId}),d=n==null?void 0:n.notebook,f=d?Zt(d.uri.path):"";return!f&&((m=this.debugLocation)!=null&&m.fileName)&&(f=Zt(this.debugLocation.fileName)),c?{...t,...JSON.parse(c.result),maximumRowChunkSize:PM,fileName:f}:t}async getDataFrameRows(t,n,i,o,s){if(i-n>PM)throw new Error(`Debugger cannot provide more than ${PM} rows at once`);if(!this.debugService.activeDebugSession||t.columns===void 0)return{data:[]};o&&this.watchKernel(o);let a=t.name;s&&(a=`${t.name}${s}`);let{cleanupCode:l,initializeCode:u,code:c}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!0,variableName:a,startIndex:n,endIndex:i}),d=await this.evaluate({code:c,cleanupCode:l,initializeCode:u,frameId:t.frameId});return xM(JSON.parse(d.result))}onWillReceiveMessage(t){super.onWillReceiveMessage(t),t.type==="request"&&t.command==="variables"&&t.arguments&&this.currentVariablesReference===t.arguments.variablesReference&&this.currentSeqNumsForVariables.add(t.seq)}onDidSendMessage(t){var n;if(super.onDidSendMessage(t),t.type==="response"&&t.command==="initialize")this.debuggingStarted=!0;else if(t.type==="event"&&t.event==="stopped"&&this.activeNotebookIsDebugging())this.handleNotebookVariables(t).catch(E);else if(t.type==="response"&&t.command==="scopes"&&t.body&&t.body.scopes){let o=t.body.scopes[0].variablesReference;o!==this.currentVariablesReference&&(this.currentVariablesReference=o,this.currentSeqNumsForVariables.clear())}else if(t.type==="response"&&t.command==="variables"&&t.body)this.currentSeqNumsForVariables.has(t.request_seq)&&this.updateVariables(void 0,t),this.monkeyPatchDataViewableVariables(t);else if(t.type==="event"&&t.event==="terminated"){this.lastKnownVariables=[],this.topMostFrameId=0,this.debuggingStarted=!1,this.refreshEventEmitter.fire();let i=(n=this.debugService.activeDebugSession)==null?void 0:n.id;i&&this.importedGetVariableInfoScriptsIntoKernel.delete(i)}}watchKernel(t){var i;let n=(i=t.notebook)==null?void 0:i.uri.toString();if(n&&!this.watchedNotebooks.has(n)){let o=[];o.push(t.onRestarted(this.resetImport.bind(this,n))),o.push(t.onDisposed(()=>{this.resetImport(n),o.forEach(s=>s.dispose()),this.watchedNotebooks.delete(n)})),this.watchedNotebooks.set(n,o)}}resetImport(t){this.importedGetVariableInfoScriptsIntoKernel.delete(t)}async evaluate({code:t,cleanupCode:n,frameId:i,initializeCode:o}){if(this.debugService.activeDebugSession){i=this.topMostFrameId||i;let s={frameId:i,context:"repl",format:{rawString:!0}};w.debug(`Evaluating in debugger : ${this.debugService.activeDebugSession.id}: ${t}`);try{o&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:o});let a=await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:t});if(a&&a.result!=="None")return a;w.error(`Cannot evaluate ${t}`);return}finally{n&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:n})}}throw Error("Debugger is not active, cannot evaluate.")}async getFullVariable(t){let{initializeCode:n,code:i,cleanupCode:o}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!0,variableName:t.name}),s=await this.evaluate({code:i,initializeCode:n,cleanupCode:o,frameId:t.frameId});return s&&s.result?{...t,truncated:!1,...JSON.parse(s.result)}:t}monkeyPatchDataViewableVariables(t){t.body.variables.forEach(n=>{n.type&&v9.has(n.type)&&n.evaluateName&&(n.__vscodeVariableMenuContext="viewableInDataViewer")})}updateVariables(t,n){var s;let i=this.configService.getSettings(t).variableExplorerExclude?(s=this.configService.getSettings().variableExplorerExclude)==null?void 0:s.split(";"):[],o=n.body.variables.filter(a=>!(!a.name||!a.type||!a.value||i&&i.includes(a.type)||a.name.startsWith("_")||t_e.has(a.name)||a.type==="NoneType"));this.lastKnownVariables=o.map(a=>wM(a)),this.refreshEventEmitter.fire()}activeNotebookIsDebugging(){let t=kP.window.activeNotebookEditor;return!!t&&this.debuggingManager.isDebugging(t.notebook)}async handleNotebookVariables(t){var o;let n=(o=kP.window.activeNotebookEditor)==null?void 0:o.notebook,i=t.body.threadId;if(n){let s=this.debuggingManager.getDebugSession(n);if(s){let a=await s.customRequest("stackTrace",{threadId:i,startFrame:0,levels:1});if(a&&a.stackFrames[0]){let l=a.stackFrames[0],u=this.debuggingManager.getDebugMode(n),c;if(u===0){let d=this.debuggingManager.getDebugCell(n);l.source&&d&&l.source.path===d.document.uri.toString()&&(c=await s.customRequest("scopes",{frameId:l.id}))}else{let d=Zt(n.uri.toString());l.source&&l.source.path&&l.source.path.includes(d)&&(c=await s.customRequest("scopes",{frameId:l.id}))}c&&(c.scopes.forEach(d=>{s.customRequest("variables",{variablesReference:d.variablesReference}).then(E,E)}),this.refreshEventEmitter.fire())}}}}};c_=U([(0,jl.injectable)(),x(0,(0,jl.inject)(s_)),x(0,(0,jl.named)(nt.MULTIPLEXING_DEBUGSERVICE)),x(1,(0,jl.inject)(bm)),x(2,(0,jl.inject)(Ke)),x(3,(0,jl.inject)(fy)),x(4,(0,jl.inject)(my)),x(5,(0,jl.inject)(qe))],c_);p();var ep=se(ge()),Sm=require("vscode");p();var hee=require("vscode"),pr=class{constructor(e){this.name=e}get value(){return this.lastValue}async set(e){this.lastValue!==e&&(this.lastValue=e,await hee.commands.executeCommand("setContext",this.name,this.lastValue))}};p();var Iee=require("vscode");p();var NP=(o=>(o[o.Unknown=0]="Unknown",o[o.Ok=1]="Ok",o[o.Outdated=2]="Outdated",o[o.NotInstalled=3]="NotInstalled",o[o.ControllerNotSelected=4]="ControllerNotSelected",o))(NP||{});async function gee(r){var o,s;let e="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",t=`import builtins
import ipykernel
builtins.print("${e}" + ipykernel.__version__ + "${e}")`,n=await r.executeHidden(t),i=/^(\d+)\.\d+\.\d+$/;for(let a of n){if(a.output_type!=="stream")continue;let l=(s=(o=a.text)==null?void 0:o.toString().trim())!=null?s:"";if(!l.includes(e))continue;let u=l.split(e)[1].trim().match(i);if(u){let c=u[1];return Number(c)>=6?1:2}}return 0}function RP(r){let e=r;if(typeof e.__notebookUri=="undefined"||typeof e.__mode=="undefined"||(e.__mode===1||e.__mode===2||e.__mode===0)&&typeof e.__cellIndex=="undefined")throw new Error("Invalid launch configuration")}function vee(r){if(RP(r),r.__mode!==2)throw new Error("Invalid launch configuration")}function DM(r,e){switch(r.type){case"event":let t=r;switch(t.event){case"output":e(t.body);break;case"loadedSource":e(t.body);break;case"breakpoint":e(t.body.breakpoint);break;default:break}break;case"request":let n=r;switch(n.command){case"setBreakpoints":let o=n.arguments,s=o.breakpoints;if(s&&s.length){let a=s[0].line;s.forEach(u=>{e(u,{...o.source})});let l={source:o.source,line:a};e(l),o.source=l.source}break;case"breakpointLocations":e(n.arguments);break;case"source":e(n.arguments);break;case"gotoTargets":e(n.arguments);break;default:break}break;case"response":let i=r;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(o=>{e(o)});break;case"loadedSources":i.body.sources.forEach(o=>{let s={source:o};e(s),o.path=s.source.path});break;case"scopes":i.body.scopes.forEach(o=>{e(o)});break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;case"setBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;default:break}break}}function yee(r){return/~\d+\\/.test(r)}function bee(r,e){return new RegExp(r.replace(/\\/g,"\\\\").replace(/~\d+\\\\/g,"[^\\\\]+\\\\"),"i").test(e)}async function mv(r,e){let t=`import debugpy
debugpy.debug_this_thread()`;await r.executeHidden(t),await e.dumpAllCells()}function See(r){return!!r.header&&r.header.msg_type==="debug_event"}function AP(r){return r.includes("Frame skipped from debugging during step-in")}function b9(r){return r.event==="debugpyAttach"}var TM=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;ne("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){w.debug(`[Debug-Cell] ${e}: ${t}`)}async willSendEvent(e){return b9(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&AP(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){e.command==="configurationDone"&&(await mv(this.execution,this.debugAdapter),Iee.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(E,E))}};p();var MP=class{constructor(e,t,n,i){this.mode=e;this.debugAdapter=t;this.debugCell=n;this.serviceContainer=i;this.debuggingManager=this.serviceContainer.get(bm)}trace(e,t){w.debug(`[Debug-Restart] ${e}: ${t}`)}error(e,t){w.error(`[Debug-Restart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Handling restart request"),setTimeout(()=>{this.debugAdapter.disconnect().then(()=>(this.trace("restart","doRestart"),this.debuggingManager.tryToStartDebugging(this.mode,this.debugCell,!0))).catch(t=>{this.error("restart",`Error restarting: ${t}`)})},0),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};p();var OP=require("vscode");var kM=class{constructor(e,t,n,i){this.debugAdapter=e;this.debugCell=t;this.execution=n;this.settings=i;ne("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE")}continue(){if(typeof this.lastPausedThreadId!="number"){w.debug("No paused thread, can't do RBL"),this.stop();return}this.debugAdapter.stepIn(this.lastPausedThreadId).then(E,E)}stop(){w.ci("RunbylineController::stop()"),this.execution.executeHidden("pass").then(E,E),this.debugAdapter.disconnect().then(E,E)}getMode(){return this.debugAdapter.getConfiguration().__mode}async willSendEvent(e){return e.event==="stopped"&&(this.lastPausedThreadId=e.body.threadId,await this.handleStoppedEvent(this.lastPausedThreadId))?(this.trace("intercepted","handled stop event"),!0):e.event==="output"&&AP(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){w.ci(`willSendRequest: ${e.command}`),e.command==="configurationDone"&&await this.initializeExecute()}async handleStoppedEvent(e){return await this.shouldStepIn(e)?(this.debugAdapter.stepIn(e).then(E,E),!0):!1}async shouldStepIn(e){var n;let t=await this.debugAdapter.stackTrace({threadId:e,startFrame:0,levels:1});if(t&&t.stackFrames[0]){let i=t.stackFrames[0],o=new OP.Position(i.line,i.column);return(n=this.lastPausePosition)!=null&&n.isEqual(o)?(this.trace("intercept","working around duplicate stop event"),!0):(this.lastPausePosition=o,!!i.source&&i.source.path!==this.debugCell.document.uri.toString())}return!1}trace(e,t){w.debug(`[Debug-RBL] ${e}: ${t}`)}async initializeExecute(){await mv(this.execution,this.debugAdapter);let e=at(this.debugCell.document.getText(),{trim:!1,removeEmptyEntries:!1}),t=[];if(Rg(e,()=>void 0,(n,i)=>{n.trim().length!==0&&t.push(i)}),t.sort(),t.length!==0){let n={line:t[0]+1};await this.debugAdapter.setBreakpoints({source:{name:Zt(this.debugCell.notebook.uri.path),path:this.debugCell.document.uri.toString()},breakpoints:[n],sourceModified:!1}),this.settings.getSettings(this.debugCell.notebook.uri).showVariableViewWhenDebugging&&OP.commands.executeCommand(le.OpenVariableView).then(E,E)}OP.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(E,E)}};p();var u_=class{constructor(e,t,n){this.document=e;this.config=t;this.session=n}};p();var ci=require("vscode");var d_=class{constructor(e,t,n){this.kernelProvider=e;this.controllerRegistration=t;this.serviceContainer=n;this.notebookToDebugger=new Map;this.notebookToDebugAdapter=new Map;this.notebookInProgress=new Set;this.disposables=[];this._doneDebugging=new ci.EventEmitter}activate(){this.disposables.push(ci.debug.onDidTerminateDebugSession(this.endSession.bind(this)),ci.workspace.onDidCloseNotebookDocument(async e=>{let t=this.notebookToDebugger.get(e);t&&(await ci.debug.stopDebugging(t.session),this.onDidStopDebugging(e))}))}getDebugCell(e){var t;return(t=this.notebookToDebugAdapter.get(e))==null?void 0:t.debugCell}get onDoneDebugging(){return this._doneDebugging.event}dispose(){this.disposables.forEach(e=>e.dispose())}isDebugging(e){return this.notebookToDebugger.has(e)}getDebugSession(e){let t=this.notebookToDebugger.get(e);if(t)return t.session}getDebugAdapter(e){return this.notebookToDebugAdapter.get(e)}onDidStopDebugging(e){}async startDebuggingConfig(e,t){w.ci(`Attempting to start debugging with config ${JSON.stringify(e)}`);try{await ci.debug.startDebugging(void 0,e,t)}catch(n){w.error(`Can't start debugging (${n})`),ci.window.showErrorMessage(W.cantStartDebugging).then(E,E)}}trackDebugAdapter(e,t){this.notebookToDebugAdapter.set(e,t),this.disposables.push(t.onDidEndSession(this.endSession.bind(this)))}async endSession(e){w.info(`Ending debug session ${e.id}`),this._doneDebugging.fire();for(let[t,n]of this.notebookToDebugger.entries())if(n&&e.id===n.session.id){this.notebookToDebugger.delete(t),this.notebookToDebugAdapter.delete(t),this.onDidStopDebugging(t);break}}getDebuggerByUri(e){for(let[t,n]of this.notebookToDebugger.entries())if(e===t)return n}async ensureKernelIsRunning(e){let t=this.controllerRegistration.getSelected(e),n=this.kernelProvider.get(e);return t&&(!n||n&&n.status==="unknown")&&(n=await Ta.connectToNotebookKernel(t.connection,this.serviceContainer,{notebook:e,controller:t.controller,resource:e.uri},new hr(!1),this.disposables,"jupyterExtension")),n}findEditorForCell(e){let t=e.notebook.uri.toString();return ci.window.visibleNotebookEditors.find(n=>n.notebook.uri.toString()===t)}async checkIpykernelAndPrompt(e,t=!0){let n=this.findEditorForCell(e);if(!n)return ci.window.showErrorMessage(W.noNotebookToDebug).then(E,E),0;let i=await this.checkForIpykernel6(n.notebook);switch(i){case 3:break;case 2:case 0:{this.promptInstallIpykernel6().then(E,E);break}case 4:if(t)return await ci.commands.executeCommand("notebook.selectKernel",{notebookEditor:n}),await this.checkIpykernelAndPrompt(e,!1)}return i}async checkForIpykernel6(e){var t,n;try{let i=this.kernelProvider.get(e);if(!i){let l=this.controllerRegistration.getSelected(e);if(!l)return 4;i=this.kernelProvider.getOrCreate(e,{metadata:l.connection,controller:l==null?void 0:l.controller,resourceUri:e.uri})}let o=i.kernelConnectionMetadata;if(Wt(o)){if(o.kind==="startUsingRemoteKernelSpec"&&((t=o.kernelSpec.metadata)!=null&&t.debugger))return 1;if(o.kind==="connectToLiveRemoteKernel"&&((n=o.kernelModel.metadata)!=null&&n.debugger))return 1}let s=this.kernelProvider.getKernelExecution(i),a=await gee(s);return ne("DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",void 0,{status:a===1?"installed":"notInstalled"}),a}catch(i){w.error("Debugging: Could not check for ipykernel 6",i)}return 0}async promptInstallIpykernel6(){await ci.window.showInformationMessage(W.needIpykernel6,{modal:!0},W.setup)===W.setup?(ne("DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP"),ci.env.openExternal(ci.Uri.parse("https://github.com/microsoft/vscode-jupyter/wiki/Setting-Up-Run-by-Line-and-Debugging-for-Notebooks"))):ne("DATASCIENCE.DEBUGGING.CLOSED_MODAL")}};p();p();var Bl=require("vscode");p();var NM=class{constructor(e){this.debugAdapter=e}trace(e,t){w.debug(`[Debug-Reset] ${e}: ${t}`)}async willSendRequest(e){e.command==="attach"&&(this.trace("attach","Continuing paused kernel threads if needed"),(await this.debugAdapter.debugInfo()).stoppedThreads.forEach(n=>this.debugAdapter.continueDirect(n)))}};var p_=class{constructor(e,t,n,i,o,s){this.session=e;this.notebookDocument=t;this.jupyterSession=n;this.kernel=i;this.platformService=o;this.debugService=s;this.fileToCell=new Map;this.sendMessage=new Bl.EventEmitter;this.endSession=new Bl.EventEmitter;this.disposables=[];this.delegates=[];this.onDidSendMessage=this.sendMessage.event;this.onDidEndSession=this.endSession.event;this.disconnected=!1;var l;w.ci("Creating kernel debug adapter for debugging notebooks");let a=this.session.configuration;RP(a),this.configuration=a,this.debugCell=t.cellAt(a.__cellIndex),this.addDebuggingDelegates([new NM(this)]),(l=this.jupyterSession.kernel)==null||l.iopubMessage.connect(this.onIOPubMessage,this),this.disposables.push(new Bl.Disposable(()=>{var u;return(u=this.jupyterSession.kernel)==null?void 0:u.iopubMessage.disconnect(this.onIOPubMessage,this)})),this.kernel&&(this.kernel.addHook("willRestart",()=>this.disconnect(),this,this.disposables),this.kernel.addHook("interruptCompleted",()=>this.disconnect(),this,this.disposables),this.disposables.push(this.kernel.onDisposed(()=>{this.disconnected||(Bl.debug.stopDebugging(this.session).then(E,E),this.disconnect().catch(E),ne("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"onKernelDisposed"}))}))),this.disposables.push(Rr.onDidChangeNotebookCellExecutionState(u=>{this.configuration.__cellIndex===u.cell.index&&u.state===1&&!this.disconnected&&(ne("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"normally"}),this.disconnect().catch(E))},this,this.disposables)),this.disposables.push(Bl.workspace.onDidChangeNotebookDocument(u=>{u.contentChanges.forEach(c=>{c.removedCells.forEach(d=>{d===this.debugCell&&this.disconnect().catch(E)})})},this,this.disposables)),this.disposables.push(this.debugService.onDidTerminateDebugSession(u=>{(u===this.session||u===this.session)&&this.disconnect().catch(E)}))}addDebuggingDelegates(e){this.delegates.push(...e)}trace(e,t){w.debug(`[Debug] ${e}: ${t}`)}async onIOPubMessage(e,t){var n,i;if(w.ci(`Debug IO Pub message: ${JSON.stringify(t)}`),See(t)){this.trace("event",JSON.stringify(t));for(let o of(n=this.delegates)!=null?n:[])if(await((i=o==null?void 0:o.willSendEvent)==null?void 0:i.call(o,t.content)))return;this.sendMessage.fire(t.content)}}handleMessage(e){this.handleClientMessageAsync(e).catch(E)}async handleClientMessageAsync(e){var t,n;try{if(w.ci(`KernelDebugAdapter::handleMessage ${JSON.stringify(e,void 0," ")}`),e.type==="request"&&e.command==="setBreakpoints"){let i=e.arguments;if(i.source&&i.source.path&&i.source.path.indexOf("vscode-notebook-cell:")===0){let o=this.notebookDocument.getCells().find(s=>s.document.uri.toString()===i.source.path);o&&await this.dumpCell(o.index)}}if(e.type==="request")for(let i of(t=this.delegates)!=null?t:[]){let o=await((n=i==null?void 0:i.willSendRequest)==null?void 0:n.call(i,e));if(o){this.trace("response",JSON.stringify(o)),this.sendMessage.fire(o);return}}await this.sendMessageToJupyterSession(e)}catch(i){w.error(`KernelDebugAdapter::handleMessage failure: ${i}`)}}getConfiguration(){return this.configuration}stepIn(e){return this.session.customRequest("stepIn",{threadId:e})}async debugInfo(){return await this.session.customRequest("debugInfo")}continueDirect(e){if(!this.jupyterSession.kernel)throw new zr;this.jupyterSession.kernel.requestDebug({seq:0,type:"request",command:"continue",arguments:{threadId:e}})}async disconnect(){var e;if(!this.disconnected){if(this.disconnected=!0,this.debugService.activeDebugSession===this.session||((e=this.debugService.activeDebugSession)==null?void 0:e.id)===this.session.id)try{await Promise.all([this.deleteDumpedFiles().catch(t=>w.warn("Error deleting temporary debug files.",t)),this.session.customRequest("disconnect",{restart:!1})])}catch(t){w.error("Failed to disconnect debug session",t)}this.endSession.fire(this.session)}}dispose(){this.disposables.forEach(e=>e.dispose())}stackTrace(e){return this.session.customRequest("stackTrace",e)}setBreakpoints(e){return this.session.customRequest("setBreakpoints",e)}async dumpAllCells(){await Promise.all(this.notebookDocument.getCells().map(async e=>{e.kind===Bl.NotebookCellKind.Code&&await this.dumpCell(e.index)}))}lookupCellByLongName(e){if(this.platformService.isWindows){e=bs(e);for(let[t,n]of this.fileToCell.entries())if(yee(t)&&bee(t,e))return n}}async sendMessageToJupyterSession(e){if(this.jupyterSession.isDisposed||this.jupyterSession.status==="dead"||!this.jupyterSession.kernel){w.info(`Skipping sending message ${e.type} because session is disposed`);return}if(this.trace("to kernel",JSON.stringify(e)),e.type==="request"){let t=await this.sendRequestToJupyterSession(e);t&&this.sendMessage.fire(t)}else if(e.type==="response"){DM(e,this.translateRealLocationToDebuggerLocation.bind(this));let t=e;return this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command},!0).done}else w.error(`Unknown message type to send ${e.type}`)}async sendRequestToJupyterSession(e){var s,a;if(DM(e,this.translateRealLocationToDebuggerLocation.bind(this)),!this.jupyterSession.kernel)throw new zr;this.trace("to kernel, mapped",JSON.stringify(e));let t=e,o=(await this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command,arguments:t.arguments},!0).done).content;DM(o,this.translateDebuggerLocationToRealLocation.bind(this));for(let l of(s=this.delegates)!=null?s:[])await((a=l==null?void 0:l.willSendResponse)==null?void 0:a.call(l,o));return this.trace("response",JSON.stringify(o)),o}translateDebuggerLocationToRealLocation(e,t){var n,i;if(t=(n=e==null?void 0:e.source)!=null?n:t,t&&t.path){let o=(i=this.fileToCell.get(t.path))!=null?i:this.lookupCellByLongName(t.path);o&&(t.name=Zt(o.path),t.path=o.toString())}}async deleteDumpedFiles(){let e=this.getDumpFilesForDeletion();if(this.jupyterSession.kernel&&e.length){let n=`import os as _VSCODE_os
_VSCODE_fileList = [${e.map(i=>'"'+i.replace(/\\/g,"\\\\")+'"').join(",")}]
for file in _VSCODE_fileList:
    try:
        _VSCODE_os.remove(file)
    except:
        pass
del _VSCODE_fileList
del _VSCODE_os`;await Mi(this.jupyterSession.kernel,n,{traceErrors:!0,traceErrorsMessage:"Error deleting temporary debugging files"})}}};var RM=class extends p_{constructor(){super(...arguments);this.cellToFile=new Map}async dumpCell(t){let n=this.notebookDocument.cellAt(t);try{let i=await this.session.customRequest("dumpCell",{code:n.document.getText().replace(/\r\n/g,`
`)}),o=bs(i.sourcePath);this.fileToCell.set(o,n.document.uri),this.cellToFile.set(n.document.uri.toString(),o)}catch(i){w.error(i)}}translateRealLocationToDebuggerLocation(t){let n=t.source;if(n&&n.path){let i=this.cellToFile.get(n.path);i&&(n.path=i)}}getDumpFilesForDeletion(){return Array.from(this.cellToFile.values())}};var f_=class extends d_{constructor(t,n,i,o,s,a){super(t,n,a);this.configurationService=i;this.platform=o;this.debugService=s;this.notebookToRunByLineController=new Map;this.runByLineCells=new pr(gr.RunByLineCells),this.runByLineDocuments=new pr(gr.RunByLineDocuments),this.debugDocuments=new pr(gr.DebugDocuments)}activate(){super.activate(),this.disposables.push(Sm.debug.registerDebugAdapterDescriptorFactory(aK,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){let n=this.notebookToRunByLineController.get(t);return n==null?void 0:n.getMode()}onDidStopDebugging(t){super.onDidStopDebugging(t),this.notebookToRunByLineController.delete(t),this.updateRunByLineContextKeys(),this.updateDebugContextKey()}updateRunByLineContextKeys(){let t=[],n=[];this.notebookToRunByLineController.forEach(i=>{t.push(i.debugCell.document.uri),n.push(i.debugCell.notebook.uri)}),this.runByLineCells.set(t).catch(E),this.runByLineDocuments.set(n).catch(E)}updateDebugContextKey(){let t=new eM;this.notebookToDebugAdapter.forEach((n,i)=>t.add(i.uri)),this.notebookInProgress.forEach(n=>t.add(n.uri)),this.debugDocuments.set(Array.from(t.values())).catch(E)}async tryToStartDebugging(t,n,i=!1){if(w.info(`Starting debugging with mode ${t}`),!i){let o=await this.checkIpykernelAndPrompt(n);if(o!==1){w.info(`Ipykernel check failed: ${NP[o]}`);return}}(t===0||t===1)&&await this.startDebuggingCell(t,n)}runByLineNext(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&n.debugCell.document.uri.toString()===t.document.uri.toString()&&n.continue()}runByLineStop(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&(ne("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"withKeybinding"}),n.stop())}async startDebuggingCell(t,n){let i=n.notebook,o=this.configurationService.getSettings(i.uri),s={type:aK,name:Zt(i.uri.toString()),request:"attach",justMyCode:t===1?o.debugJustMyCode:!0,__mode:t,__cellIndex:n.index,__notebookUri:i.uri.toString()},a=t===0?{suppressDebugStatusbar:!0,suppressDebugToolbar:!0,suppressDebugView:!0,suppressSaveBeforeStart:!0}:{suppressSaveBeforeStart:!0};return this.startDebuggingConfig(s,a)}async createDebugAdapterDescriptor(t){let n=t.configuration;RP(n);let i=n.__notebookUri,o=Sm.workspace.notebookDocuments.find(s=>s.uri.toString()===i);if(!o){w.info(`Cannot start debugging. Notebook ${i} not found.`);return}if(this.notebookInProgress.has(o)){w.info("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(o)){w.info("Cannot start debugging. Already debugging this notebook document.");return}this.notebookToDebugger.set(o,new u_(o,n,t));try{return this.notebookInProgress.add(o),this.updateDebugContextKey(),await this.doCreateDebugAdapterDescriptor(n,t,o)}finally{this.notebookInProgress.delete(o),this.updateDebugContextKey()}}async doCreateDebugAdapterDescriptor(t,n,i){let o=await this.ensureKernelIsRunning(i);if(o!=null&&o.session){let s=new RM(n,i,o.session,o,this.platform,this.debugService);if(t.__mode===0&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new kM(s,a,this.kernelProvider.getKernelExecution(o),this.configurationService);s.addDebuggingDelegates([l,new MP(0,s,a,this.serviceContainer)]),this.notebookToRunByLineController.set(i,l),this.updateRunByLineContextKeys()}else if(t.__mode===1&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new TM(s,a,this.kernelProvider.getKernelExecution(o));s.addDebuggingDelegates([l,new MP(1,s,a,this.serviceContainer)])}return this.trackDebugAdapter(i,s),this.updateDebugContextKey(),new Sm.DebugAdapterInlineImplementation(s)}else Sm.window.showInformationMessage(W.kernelWasNotStarted).then(E,E)}};f_=U([(0,ep.injectable)(),x(0,(0,ep.inject)(qe)),x(1,(0,ep.inject)(Nt)),x(2,(0,ep.inject)(Ke)),x(3,(0,ep.inject)(us)),x(4,(0,ep.inject)(so)),x(5,(0,ep.inject)(Nr))],f_);p();var LP=se(ge()),_ee=require("vscode");var m_=class{constructor(e,t){this.disposableRegistry=t;this.activeTrackers=new WeakMap;this.activeTrackersById=new Map;this.updatedEmitter=new _ee.EventEmitter;t.push(e.registerDebugAdapterTrackerFactory("python",this))}createDebugAdapterTracker(e){let t=new l_(e.id);return this.activeTrackers.set(e,t),this.activeTrackersById.set(e.id,t),t.sessionEnded(()=>{this.activeTrackers.delete(e),this.activeTrackersById.delete(e.id)},this,this.disposableRegistry),t.debugLocationUpdated(this.onLocationUpdated,this,this.disposableRegistry),this.onLocationUpdated(),t}get updated(){return this.updatedEmitter.event}getLocation(e){let t=this.activeTrackers.get(e)||this.activeTrackersById.get(e.id);if(t)return t.debugLocation}onLocationUpdated(){this.updatedEmitter.fire()}};m_=U([(0,LP.injectable)(),x(0,(0,LP.inject)(so)),x(1,(0,LP.inject)(ve))],m_);p();var bu=se(ge()),hv=require("vscode");var h_=class{constructor(e,t,n){this.vscodeDebugService=t;this.jupyterDebugService=n;this.sessionChangedEvent=new hv.EventEmitter;this.sessionStartedEvent=new hv.EventEmitter;this.sessionTerminatedEvent=new hv.EventEmitter;this.sessionCustomEvent=new hv.EventEmitter;e.push(t.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(t.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(t.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(t.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))),n&&(e.push(n.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(n.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(n.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(n.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))))}get activeDebugSession(){return this.activeService.activeDebugSession}get activeDebugConsole(){return this.activeService.activeDebugConsole}get breakpoints(){return this.activeService.breakpoints}get onDidChangeActiveDebugSession(){return this.sessionChangedEvent.event}get onDidStartDebugSession(){return this.sessionStartedEvent.event}get onDidReceiveDebugSessionCustomEvent(){return this.sessionCustomEvent.event}get onDidTerminateDebugSession(){return this.sessionTerminatedEvent.event}get onDidChangeBreakpoints(){return this.activeService.onDidChangeBreakpoints}get onBreakpointHit(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.onBreakpointHit}startRunByLine(e){if(this.lastStartedService=this.jupyterDebugService,!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.startRunByLine(e)}registerDebugConfigurationProvider(e,t){let n=this.vscodeDebugService.registerDebugConfigurationProvider(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugConfigurationProvider(e,t);return this.combineDisposables(n,i)}return n}registerDebugAdapterTrackerFactory(e,t){let n=this.vscodeDebugService.registerDebugAdapterTrackerFactory(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugAdapterTrackerFactory(e,t);return this.combineDisposables(n,i)}return n}startDebugging(e,t,n){return this.lastStartedService=this.vscodeDebugService,this.vscodeDebugService.startDebugging(e,t,n)}addBreakpoints(e){return this.activeService.addBreakpoints(e)}removeBreakpoints(e){return this.activeService.removeBreakpoints(e)}getStack(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.getStack();throw new Error("Requesting jupyter specific stack when not debugging.")}step(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.step();throw new Error("Requesting jupyter specific step when not debugging.")}continue(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.continue();throw new Error("Requesting jupyter specific step when not debugging.")}requestVariables(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.requestVariables();throw new Error("Requesting jupyter specific variables when not debugging.")}stop(){this.jupyterDebugService&&this.lastStartedService===this.jupyterDebugService?this.jupyterDebugService.stop():hv.commands.executeCommand("workbench.action.debug.stop").then(E,E)}get activeService(){return this.lastStartedService?this.lastStartedService:this.vscodeDebugService}combineDisposables(e,t){return{dispose:()=>{e.dispose(),t.dispose()}}}endedDebugSession(e){this.sessionTerminatedEvent.fire(e),this.lastStartedService=void 0}startedDebugSession(e){this.sessionStartedEvent.fire(e)}changedDebugSession(e){this.sessionChangedEvent.fire(e)}gotCustomEvent(e){this.sessionCustomEvent.fire(e)}};h_=U([(0,bu.injectable)(),x(0,(0,bu.inject)(ve)),x(1,(0,bu.inject)(so)),x(2,(0,bu.optional)()),x(2,(0,bu.inject)(s_)),x(2,(0,bu.named)(nt.RUN_BY_LINE_DEBUGSERVICE))],h_);p();var S9=se($g()),vv=se(ge());p();var g_=Symbol("IFileConverter"),Im=Symbol("IExportBase"),Akt=Symbol("IExport"),_m=Symbol("IExportUtil");function r_e(){return`${Gf}${(0,S9.default)()}`}function n_e(r){let e=`${r_e()}${(0,S9.default)()}.ipynb`;return r?`${mi(r,".ipynb")}${e}`:`${W.defaultNotebookName}${e}`}var gv=class{constructor(e,t,n,i){this.kernelProvider=e;this.fs=t;this.jupyterConnection=n;this.exportUtil=i}async export(e,t,n,i){}async executeCommand(e,t,n,i,o){var A;let s=this.kernelProvider.get(e);if(!s||(s.session||await s.start(new hr(!1)),!((A=s.session)!=null&&A.kernel)))return;let a=s.kernelConnectionMetadata,l=s.resourceUri;if(!Wt(a)||l)return;let u=s.session.kernel,d=(await this.jupyterConnection.createConnectionInfo(a.serverProviderHandle)).settings,f=ri(),m=new f.ContentsManager({serverSettings:d}),g=await this.exportUtil.getContent(e),b="";switch(n){case"html":b=".html";break;case"pdf":b=".pdf";break;case"python":b=".py";break}let y=await this.createBackingFile(l,m);if(!y)return;await m.save(y.filePath,{content:JSON.parse(g),type:"notebook"}).catch(E);let P;try{let D=await this.getCWD(s);P=(await m.newUntitled({type:"file",ext:b})).path;let K=`${D}/${y.filePath}`,L=await Mi(u,`!jupyter nbconvert ${K} --to ${n} --output ${Zt(P)}`),B=this.parseStreamOutput(L);if(this.isExportFailed(B))throw new Error(B||`Failed to export to ${n}`);if(B&&w.debug(B),n==="pdf"){let N=await m.get(P,{type:"file",format:"base64",content:!0}),h=await this.b64toBlob(N.content,"application/pdf").arrayBuffer();await this.fs.writeFile(t,new Uint8Array(h))}else{let N=await m.get(P,{type:"file",format:"text",content:!0});await this.fs.writeFile(t,N.content)}}finally{P&&await m.delete(P),await y.dispose(),await m.delete(y.filePath).catch(E),m.dispose()}}async createBackingFile(e,t){let n,i={type:"notebook"},o=n_e(e);try{n=await t.newUntitled(i);let s=xi(n.path);n=await t.rename(n.path,s.length&&s!=="."?`${s}/${o}`:o)}catch(s){w.error(`Backing file not supported: ${s}`)}if(n){let s=n.path;return{filePath:s,dispose:()=>t.delete(s)}}}async getContents(e,t,n){return await n.get(e,{type:"file",format:t,content:!0})}b64toBlob(e,t){t=t||"";let n=512;e=e.replace(/^[^,]+,/,""),e=e.replace(/\s/g,"");let i=atob(e),o=[];for(let a=0;a<i.length;a+=n){let l=i.slice(a,a+n),u=new Array(l.length);for(let d=0;d<l.length;d++)u[d]=l.charCodeAt(d);let c=new Uint8Array(u);o.push(c)}return new Blob(o,{type:t})}isExportFailed(e){return e?/Traceback \(most recent call last\)/g.exec(e):!0}parseStreamOutput(e){if(e.length===0)return;let t=e[0];return t.name!=="stdout"&&t.output_type!=="stream"?void 0:Fc(t.text).trim()}async getCWD(e){var i;if(!((i=e.session)!=null&&i.kernel))throw new zr;let t=await Mi(e.session.kernel,"import os;os.getcwd();");if(t.length===0)return;let n=t[0];if(n.output_type==="execute_result")return n.data["text/plain"]}};U([vX("PerformingExport")],gv.prototype,"executeCommand",1),gv=U([(0,vv.injectable)(),x(0,(0,vv.inject)(qe)),x(1,(0,vv.inject)(Pt)),x(2,(0,vv.inject)(pn)),x(3,(0,vv.inject)(_m))],gv);p();var Eee=se(ge());p();var v_=require("vscode");p();var KP=require("vscode");var i_e={PDF:["pdf"]},o_e={HTML:["html","htm"]},s_e={Python:["py"]},rp=class{async showDialog(e,t,n){let i={},o;switch(e){case"python":i=s_e,o=".py";break;case"pdf":o=".pdf",i=i_e;break;case"html":o=".html",i=o_e;break;case"ipynb":o=".ipynb";let l=W.exportDialogFilter;i[l]=["ipynb"];break;default:return}let s=n||!t?n||"":`${Zt(t.path,_p(t.path))}${o}`,a={defaultUri:await this.getDefaultUri(t,s),saveLabel:W.exportButtonTitle,filters:i};return KP.window.showSaveDialog(a)}async getDefaultUri(e,t){if(e&&e.scheme==="untitled"&&_n())return;if(!e||e.scheme==="file"||e.scheme==="untitled"||e.scheme==="vscode-interactive"){let i=tt.instance.get(NR);return KP.Uri.file(qE(await i.computeWorkingDirectory(e),t))}let n=qE(xi(e.path),t);return KP.Uri.parse(`${e.scheme}://${n}`).with({authority:e.authority})}};var AM=class{async getContent(e){let t=v_.extensions.getExtension("vscode.ipynb");if(!t)throw new Error("Unable to export notebook as the built-in vscode.ipynb extension is currently unavailable.");t.isActive||await t.activate();let i=e.getCells().map(s=>{let a=new v_.NotebookCellData(s.kind,s.document.getText(),s.document.languageId);return a.metadata=s.metadata,a.mime=s.mime,a.outputs=[...s.outputs],a}),o=new v_.NotebookData(i);return o.metadata=JSON.parse(JSON.stringify(e.metadata)),t.exports.exportNotebook(o)}async getTargetFile(e,t,n){return await new rp().showDialog(e,t,n)}};var y_=class extends AM{};y_=U([(0,Eee.injectable)()],y_);p();var I_=se(ge());p();var UM=se(ge()),WM=require("vscode");p();var np=require("vscode");var MM=class{constructor(){this.fs=tt.instance.get(Pt)}async openFile(e,t,n=!1){if(e==="python")await this.openPythonFile(t,n),ne("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:!0});else{let i=await this.askOpenFile(t,n);ne("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:i})}}async openPythonFile(e,t){let n;if(t)n=await np.window.showTextDocument(e);else{let i=await this.fs.readFile(e);await this.fs.delete(e);let o=await np.workspace.openTextDocument({language:Ye,content:i});n=await np.window.showTextDocument(o)}await n.edit(i=>{i.insert(new np.Position(n.document.lineCount,0),`
`)})}async askOpenFile(e,t){let n=W.openExportFileYes,i=W.openExportFileNo,o=[n,i];return await np.window.showInformationMessage(W.openExportedFileMessage,...o).then(a=>a)===n?(t?np.window.showTextDocument(e).then(E,E):JS(e.toString()),!0):!1}};p();var OM=class{async export(e,t,n,i){await tt.instance.get(Im).executeCommand(e,t,"python",n,i)}};p();var LM=class{async export(e,t,n,i){await tt.instance.get(Im).executeCommand(e,t,"pdf",n,i)}};p();var KM=class{async export(e,t,n,i){await tt.instance.get(Im).executeCommand(e,t,"html",n,i)}};p();var I9=require("vscode");var FM=class{constructor(){this.fs=tt.instance.get(Pt),this.configuration=tt.instance.get(Ke),this.platform=tt.instance.get(us)}async writeFile(e,t){await this.fs.writeFile(e,t)}getEOL(){return this.platform.isWindows?`\r
`:`
`}async export(e,t,n){if(n.isCancellationRequested)return;let i=this.exportDocument(e);await this.writeFile(t,i)}exportDocument(e){return e.getCells().filter(t=>{var n;return!((n=t.metadata)!=null&&n.isInteractiveWindowMessageCell)}).reduce((t,n)=>t+this.exportCell(n),"")}exportCell(e){if(e.document.lineCount){let t=this.cellMarker(e),n=this.getEOL();switch(e.kind){case I9.NotebookCellKind.Code:return`${t}${n}${this.exportCodeCell(e)}${n}${n}`;case I9.NotebookCellKind.Markup:return`${t} [markdown]${n}${this.exportMarkdownCell(e)}${n}${n}`}}return""}exportCodeCell(e){let t=at(e.document.getText(),{trim:!1,removeEmptyEntries:!1}),n=this.configuration.getSettings(e.notebook.uri).pythonExportMethod==="commentMagics";return uS(t,this.getEOL(),n?a_e:void 0).join("")}exportMarkdownCell(e){let t=at(e.document.getText(),{trim:!1,removeEmptyEntries:!1});return uS(t,this.getEOL(),l_e).join("")}cellMarker(e){var n;let t=this.configuration.getSettings(e.notebook.uri);return(n=e.metadata.interactiveWindowCellMarker)!=null?n:t.defaultCellMarker}};function a_e(r){return/^\s*!/.test(r)||/^\s*%/.test(r)?`# ${r}`:r}function l_e(r){return`# ${r}`}var b_=class{constructor(e,t,n){this.exportUtil=e;this.progressReporter=t;this.configuration=n}async importIpynb(e){let t=this.progressReporter.createProgressIndicator(W.importingIpynb,!0);try{let n=await WM.workspace.openNotebookDocument(e);await this.exportImpl("python",n,void 0,t.token)}finally{t.dispose()}}async export(e,t,n,i){let o=this.progressReporter.createProgressIndicator(W.exportingToFormat(e.toString()),!0);try{await this.exportImpl(e,t,n,o.token,i)}finally{o.dispose()}if(o.token.isCancellationRequested){ne("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,cancelled:!0});return}}async exportImpl(e,t,n,i,o){try{let s=await this.exportUtil.getTargetFile(e,t.uri,n);if(!s)return;await this.performExport(e,t,s,i,o)}catch(s){w.error("Export failed",s),ne("DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",void 0,{format:e}),e==="pdf"&&w.error(W.exportToPDFDependencyMessage),this.showExportFailed(W.exportFailedGeneralMessage)}}async performExport(e,t,n,i,o){e==="python"&&this.configuration.getSettings(t.uri).pythonExportMethod!=="nbconvert"?await this.performPlainExport(e,t,n,i):await this.performNbConvertExport(t,e,n,o,i),n&&this.openExportedFile(e,n).catch(E)}async openExportedFile(e,t){await new MM().openFile(e,t,!0).catch(E)}async performPlainExport(e,t,n,i){if(n)switch(e){case"python":await new FM().export(t,n,i);break}return n}async performNbConvertExport(e,t,n,i,o){try{return await this.exportToFormat(e,n,t,i,o)}finally{}}async exportToFormat(e,t,n,i,o){switch(n){case"python":return new OM().export(e,t,i,o);case"pdf":return new LM().export(e,t,i,o);case"html":return new KM().export(e,t,i,o);default:break}}showExportFailed(e){WM.window.showErrorMessage(`${W.failedExportMessage} ${e}`)}};b_=U([x(0,(0,UM.inject)(_m)),x(1,(0,UM.inject)(Kl)),x(2,(0,UM.inject)(Ke))],b_);var S_=class extends b_{constructor(t,n,i){super(t,n,i);this.exportUtil=t}};S_=U([(0,I_.injectable)(),x(0,(0,I_.inject)(_m)),x(1,(0,I_.inject)(Kl)),x(2,(0,I_.inject)(Ke))],S_);p();var UP=se(ge()),yv=require("vscode");p();var FP=require("vscode");var _9=new WeakMap;async function Su(r,e){let t=r;if(r.isClosed)return!0;let n=_9.has(t)?_9.get(t):Promise.resolve(),i=Re(),o=n.finally(async()=>{let s=new FP.WorkspaceEdit,a=e(s);qv(a)&&await a,await FP.workspace.applyEdit(s).then(l=>i.resolve(l),l=>i.reject(l))}).catch(E);return _9.set(t,o),i.promise}var __=class{constructor(e,t){this.disposables=e;this.controllerRegistration=t}activate(){this.controllerRegistration.onControllerSelected(this.onDidChangeNotebookController,this,this.disposables)}async onDidChangeNotebookController(e){let t=e.notebook,n=e.controller.connection;if(!mr(t))return;let i=yv.window.visibleNotebookEditors.find(c=>c.notebook===t);if(!i)return;let o=t.getCells().filter(c=>c.kind===yv.NotebookCellKind.Code&&c.document.getText().trim().length===0),s=t.getCells().filter(c=>c.kind===yv.NotebookCellKind.Code).length;if(o.length===0||o.length!==s)return;let a,l=n.kind;switch(n.kind){case"connectToLiveRemoteKernel":{a=n.kernelModel.language;break}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":{a=n.kernelSpec.language;break}case"startUsingPythonInterpreter":{a=Ye;break}default:{w.error(`Unsupported kernel kind encountered ${l}`);return}}if(!a)return;let u=Kc(a);Su(i.notebook,async()=>{await o.map(async c=>{if(u.toLowerCase()!==c.document.languageId)return yv.languages.setTextDocumentLanguage(c.document,u).then(E,E)})}).then(E,E)}};__=U([(0,UP.injectable)(),x(0,(0,UP.inject)(ve)),x(1,(0,UP.inject)(Nt))],__);p();var Hl=se(ge()),yr=require("vscode");var E_=class{constructor(e,t,n,i,o,s,a,l){this.disposableRegistry=e;this.languageService=t;this.configurationService=n;this.kernelProvider=i;this.controllerRegistration=o;this.errorHandler=s;this.notebookEditorProvider=a;this.serviceContainer=l;this.kernelInterruptedDontAskToRestart=!1;this.pendingRestartInterrupt=new WeakMap}register(){this.disposableRegistry.push(yr.commands.registerCommand(le.NotebookEditorRemoveAllCells,()=>this.removeAllCells())),this.disposableRegistry.push(yr.commands.registerCommand(le.NotebookEditorRunAllCells,()=>this.runAllCells())),this.disposableRegistry.push(yr.commands.registerCommand(le.NotebookEditorAddCellBelow,()=>this.addCellBelow())),this.disposableRegistry.push(yr.commands.registerCommand(le.RestartKernelAndRunUpToSelectedCell,()=>this.restartKernelAndRunUpToSelectedCell())),this.disposableRegistry.push(yr.commands.registerCommand(le.RestartKernel,e=>{var t;return e&&"notebookEditor"in e?this.restartKernel((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(E):this.restartKernel(e).catch(E)})),this.disposableRegistry.push(yr.commands.registerCommand(le.InterruptKernel,e=>{var t;return this.interruptKernel((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)})),this.disposableRegistry.push(yr.commands.registerCommand(le.RestartKernelAndRunAllCells,e=>{var t;e&&"notebookEditor"in e?this.restartKernelAndRunAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(E):this.restartKernelAndRunAllCells(e).catch(E)}))}runAllCells(){yr.window.activeNotebookEditor&&yr.commands.executeCommand("notebook.execute").then(E,E)}addCellBelow(){yr.window.activeNotebookEditor&&yr.commands.executeCommand("notebook.cell.insertCodeCellBelow").then(E,E)}removeAllCells(){var n;let e=(n=yr.window.activeNotebookEditor)==null?void 0:n.notebook;if(!e)return;let t=this.languageService.getPreferredLanguage(_a(e));Su(e,i=>{let o=yr.NotebookEdit.replaceCells(new yr.NotebookRange(0,e.cellCount),[new yr.NotebookCellData(yr.NotebookCellKind.Code,"",t)]);i.set(e.uri,[o])}).then(E,E)}async interruptKernel(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=yr.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;w.debug(`Command interrupted kernel for ${Ee(n.uri)}`);let i=this.kernelProvider.get(n);if(!i){w.info("Interrupt requested & no kernel.");return}await this.wrapKernelMethod("interrupt",i)}async restartKernelAndRunAllCells(e){await this.restartKernel(e),this.runAllCells()}async restartKernelAndRunUpToSelectedCell(){let e=this.notebookEditorProvider.activeNotebookEditor;e&&(await this.restartKernel(e.notebook.uri),yr.commands.executeCommand("notebook.cell.execute",{ranges:[{start:0,end:e.selection.end}],document:e.notebook.uri}).then(E,E))}async restartKernel(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=yr.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;let i=this.kernelProvider.get(n);if(i)if(w.debug(`Restart kernel command handler for ${Ee(n.uri)}`),await this.shouldAskForRestart(n.uri)){let s=W.restartKernelMessage,a=W.restartKernelMessageYes,l=W.restartKernelMessageDontAskAgain,u=await yr.window.showInformationMessage(s,{modal:!0},a,l);u===l?(await this.disableAskForRestart(n.uri),this.wrapKernelMethod("restart",i).catch(E)):u===a&&this.wrapKernelMethod("restart",i).catch(E)}else this.wrapKernelMethod("restart",i).catch(E)}async wrapKernelMethod(e,t){let n=t.notebook,i=this.pendingRestartInterrupt.get(t);if(i)return i;let o=(async()=>{let s=this.kernelProvider.getKernelExecution(t).pendingCells[0],a=this.controllerRegistration.getSelected(n);try{if(!a)throw new Error("No kernel associated with the notebook");await Ta.wrapKernelMethod(a.connection,e,t.creator,this.serviceContainer,{resource:t.resourceUri,notebook:n,controller:a.controller},new hr(!1),this.disposableRegistry)}catch(l){s?await Od(s,t.controller,await this.errorHandler.getErrorMessageForDisplayInCell(l,e,t.resourceUri),!1):yr.window.showErrorMessage(l.toString()).then(E,E)}})();return o.finally(()=>{this.pendingRestartInterrupt.get(t)===o&&this.pendingRestartInterrupt.delete(t)}).catch(E),this.pendingRestartInterrupt.set(t,o),o}async shouldAskForRestart(e){if(this.kernelInterruptedDontAskToRestart)return!1;let t=this.configurationService.getSettings(e);return t&&t.askForKernelRestart===!0}async disableAskForRestart(e){this.configurationService.getSettings(e)&&this.configurationService.updateSetting("askForKernelRestart",!1,void 0,yr.ConfigurationTarget.Global).catch(E)}};E_=U([(0,Hl.injectable)(),x(0,(0,Hl.inject)(ve)),x(1,(0,Hl.inject)(js)),x(2,(0,Hl.inject)(Ke)),x(3,(0,Hl.inject)(qe)),x(4,(0,Hl.inject)(Nt)),x(5,(0,Hl.inject)(dn)),x(6,(0,Hl.inject)(Oo)),x(7,(0,Hl.inject)(Nr))],E_);p();var Cee=se(ge()),Em=require("vscode");var C_=class{constructor(){this.providers=new Set}registerEmbedNotebookProvider(e){this.providers.add(e)}findNotebookEditor(e){var o;let t=e?Fa(e,!0):"false",n=Rl(e)==="notebook"?Em.workspace.notebookDocuments.find(s=>Fa(s.uri,!0)===t):void 0,i=n&&((o=Em.window.activeNotebookEditor)==null?void 0:o.notebook)===n?Em.window.activeNotebookEditor:void 0;if(i)return i;for(let s of this.providers){let a=s.findNotebookEditor(e);if(a)return a}}get activeNotebookEditor(){var e,t;return this.findNotebookEditor((e=Em.window.activeNotebookEditor)==null?void 0:e.notebook.uri)||this.findNotebookEditor((t=Em.window.activeTextEditor)==null?void 0:t.document.uri)}findAssociatedNotebookDocument(e){let t=Pi()==="Windows",n=Em.workspace.notebookDocuments.find(i=>t?i.uri.path.toLowerCase()===e.path.toLowerCase():i.uri.path===e.path);if(n)return n;for(let i of this.providers){let o=i.findAssociatedNotebookDocument(e);if(o)return o}}};C_=U([(0,Cee.injectable)()],C_);p();var VM=se(ge()),x_=require("vscode");var w_=class{constructor(e){this.sentMimeTypes=new Set;this.disposables=[];e.push(this)}activate(){this.isTelemetryDisabled=TN(),x_.workspace.onDidOpenNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),x_.workspace.onDidCloseNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),x_.workspace.onDidSaveNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),Rr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables),this.disposables.push(kN(e=>this.isTelemetryDisabled=e))}dispose(){Ce(this.disposables)}async onDidChangeNotebookCellExecutionState(e){!mr(e.cell.notebook)||this.isTelemetryDisabled||e.state!==1||this.checkCell(e.cell,"onExecution")}onDidOpenCloseDocument(e){!mr(e)||this.isTelemetryDisabled||e.getCells().forEach(t=>this.checkCell(t,"onOpenCloseOrSave"))}checkCell(e,t){if(e.kind===x_.NotebookCellKind.Markup||e.document.languageId==="raw")return;let n=e.notebook.notebookType===bt?"notebook":"interactive";e.outputs.map(i=>i.items.map(o=>o.mime)).flat().map(i=>this.sendTelemetry(i,t,n))}sendTelemetry(e,t,n){let i=`${e}-${t}`;this.sentMimeTypes.has(i)||(this.sentMimeTypes.add(i),e=e.replace(/\//g,"_").replace(/\\/g,"_"),ne("DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",void 0,{mimeType:e,when:t,resourceType:n}))}};w_=U([(0,VM.injectable)(),x(0,(0,VM.inject)(ve))],w_);p();var jM=se(ge());var c_e=/(;32m[ ->]*?)(\d+)(.*)/g,P_=class{constructor(e){this.configurationService=e}format(e,t){return e.notebook.notebookType!==bt?t:t.map(n=>this.modifyTracebackFrameIPython(e,n))}modifyTracebackFrameIPython(e,t){var o;let n=this.configurationService.getSettings(e.document.uri);return((o=n==null?void 0:n.formatStackTraces)!=null?o:!1)&&/^[Cell|Input|File].*?\n.*/.test(t)?this.modifyTracebackFrameIPython8(e,t):t}modifyTracebackFrameIPython8(e,t){t=t.replace(/\u001b\[4\dm/g,""),t=t.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),t=t.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(s,a,l,u)=>(u=u.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${a}${l}${u}
`)),w.ci(`Trace frame to match: ${t}`);let n=(s,a)=>{let l=s.replace(c_e,(c,d,f,m)=>{let g=parseInt(f,10);return`${d}<a href='${e.document.uri.toString()}?line=${g-1}'>${g}</a>${m}`}),u=W.cellAtFormat(lt(e.document.uri),e.index+1);return l.replace(/.*?\n/,`\x1B[1;32m${u}\x1B[0m line \x1B[0;36m${a}
`)},i=/^Input.*?\[.*32mIn\s+\[(\d+).*?0;36m(.*?)\n.*/.exec(t);if(i&&i.length>1)return n(t,i[2]);let o=/Cell.*?\[.*32mIn\s*\[(\d+)\]\,\s+line\s+([(\d+)])(.*?)\n.*/gm.exec(t);return o&&o.length>1?n(t,o[2]):t}};P_=U([(0,jM.injectable)(),x(0,(0,jM.inject)(Ke))],P_);function wee(r,e){mee(r,e),r.addSingleton(Ve,nv),r.addSingleton(Oo,C_),r.addSingleton(Ve,lv),r.addSingleton(wS,P_),r.addSingleton(pm,pm),r.addBinding(pm,Ve),r.addSingleton(Ve,$I),r.addSingleton(py,E_),r.addSingleton(js,js),r.addBinding(js,Ve),r.addSingleton(Ve,__),r.addSingleton(bm,f_,void 0,[Ve]),r.addSingleton(s_,h_,nt.MULTIPLEXING_DEBUGSERVICE),r.addSingleton(EM,m_,void 0,[_M]),r.addSingleton(Oi,c_,nt.DEBUGGER_VARIABLES),r.addSingleton(Ve,a_),r.addSingleton(Ve,w_),r.addSingleton(Im,gv),r.addSingleton(g_,S_),r.addSingleton(_m,y_)}p();p();var Nn=se(ge()),Qe=require("vscode");p();var Cm=Symbol("IDataScienceCodeLensProvider"),BM=Symbol("ICodeWatcher"),HM=Symbol("ICodeLensFactory"),wm=Symbol("ICellRangeCache"),hRt=Symbol("IGeneratedCodeStore"),Na=Symbol("IGeneratedCodeStorageFactory"),D_=Symbol("ICodeGeneratorFactory");p();var xee=Symbol("IInteractiveWindowDebugger"),lo=Symbol("IInteractiveWindowProvider"),qM=Symbol("IInteractiveControllerHelper"),JM=Symbol("IInteractiveWindowDebuggingManager");p();var GM=require("vscode");async function YM(r){let e=await GM.workspace.openNotebookDocument(r);await GM.window.showNotebookDocument(e)}p();var Ra=require("vscode");p();var ms=class{constructor(e){this.codeMatchRegEx=this.createRegExp(e?e.codeRegularExpression:void 0,FE.PythonCellMarker),this.markdownMatchRegEx=this.createRegExp(e?e.markdownRegularExpression:void 0,FE.PythonMarkdownCellMarker),this.codeExecRegEx=new RegExp(`${this.codeMatchRegEx.source}(.*)`),this.markdownExecRegEx=new RegExp(`${this.markdownMatchRegEx.source}(.*)`),this.defaultCellMarker=e!=null&&e.defaultCellMarker?e.defaultCellMarker:"# %%"}isCell(e){return this.isCode(e)||this.isMarkdown(e)}isMarkdown(e){return this.markdownMatchRegEx.test(e.trim())}isCode(e){return this.codeMatchRegEx.test(e.trim())||e.trim()===this.defaultCellMarker}getCellType(e){return this.isMarkdown(e)?"markdown":"code"}isEmptyCell(e){return this.stripFirstMarker(e).trim().length===0}stripFirstMarker(e){let t=at(e,{trim:!1,removeEmptyEntries:!1});return t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0]))?t.slice(1).join(`
`):e}stripFirstMarkerNoConcat(e){return e.length>0&&(this.isCode(e[0])||this.isMarkdown(e[0]))?e.slice(1):e}getFirstMarker(e){let t=at(e,{trim:!1,removeEmptyEntries:!1});if(t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0])))return t[0]}createRegExp(e,t){try{if(e)return new RegExp(e)}catch(n){}return t}};p();var Hs=require("vscode");function Pee(r,e){let t=ut(r);return t?e==1?W.restartingKernelCustomHeader(t):W.startingNewKernelCustomHeader(t):e==1?W.restartingKernelHeader:W.startingNewKernelHeader}function Dee(r,e){let t=ut(r);return e==1?W.restartedKernelHeader(t||""):W.connectedKernelHeader(t||"")}function WP(r){var e;return r.kind===Hs.NotebookCellKind.Markup&&((e=r.metadata)==null?void 0:e.isInteractiveWindowMessageCell)===!0}var $M=class{constructor(e,t,n){this.interactiveWindow=e;this.notebookDocument=t;this.isDeleted=!1;this.sysInfoCellPromise=this.getOrUpdate(n)}async resolveCell(){return await this.sysInfoCellPromise}async getOrUpdate(e){let t=await this.interactiveWindow.getAppendIndex()-1;if(t>=0){let n=this.notebookDocument.cellAt(t);if(WP(n))return this.updateMessage(e)}return this.sysInfoCellPromise=this.createCell(e)}async createCell(e){let t;return await Su(this.notebookDocument,async n=>{let i=new Hs.NotebookCellData(Hs.NotebookCellKind.Markup,e,UE);i.metadata={isInteractiveWindowMessageCell:!0},t=await this.interactiveWindow.getAppendIndex();let o=Hs.NotebookEdit.insertCells(t,[i]);n.set(this.notebookDocument.uri,[o])}),this.notebookDocument.cellAt(t)}async updateMessage(e){let t=await this.sysInfoCellPromise;return await Su(this.notebookDocument,n=>{if(t.index>=0&&!this.isDeleted&&WP(t)){n.replace(t.document.uri,new Hs.Range(0,0,t.document.lineCount,0),e),n.set(this.notebookDocument.uri,[Hs.NotebookEdit.updateCellMetadata(t.index,{isInteractiveWindowMessageCell:!0})]);return}}),t}async deleteCell(){this.isDeleted=!0;let e=await this.sysInfoCellPromise;await Su(this.notebookDocument,t=>{if(e.index>=0&&WP(e)){let n=Hs.NotebookEdit.deleteCells(new Hs.NotebookRange(e.index,e.index+1));t.set(this.notebookDocument.uri,[n]);return}})}};function zM(r){return/^#\s*!/.test(r)?/^#\s*!\s*%%?/.test(r)?r.replace(/^#\s*!\s*/,""):r.replace(/^#\s*/,""):r}function Tee(r,e){let t=e.isCell(r[0])&&r.length>1?r.slice(1):r;return new Ra.NotebookCellData(Ra.NotebookCellKind.Code,t.join(`
`),"python")}function kee(r){return new Ra.NotebookCellData(Ra.NotebookCellKind.Markup,qN(r).join(`
`),"markdown")}function d_e(r,e,t){let n=at(e,{trim:!1}),i=n[0],o=new ms(r);if(o.isMarkdown(i)){let s=-1;return Rg(n,(a,l)=>void 0,(a,l)=>{a&&a.length>0&&s===-1&&(s=t?l:-1)}),s>=0?[kee(n.slice(0,s)),Tee(n.slice(s),o)]:[kee(n)]}else return[Tee(n,o)]}function E9(r,e){let t=new ms(e),n=[];for(let i=0;i<r.lineCount;i+=1){let o=r.lineAt(i);if(t.isCell(o.text)){if(n.length>0){let s=n[n.length-1];s.range=new Ra.Range(s.range.start,r.lineAt(i-1).range.end)}n.push({range:o.range,cell_type:t.getCellType(o.text)})}}if(n.length>=1){let i=r.lineAt(r.lineCount-1),o=n[n.length-1];o.range=new Ra.Range(o.range.start,i.range.end)}return n}function C9(r,e){let t=E9(r,e);return Array.prototype.concat(...t.map(n=>{let i=r.getText(n.range);return d_e(e,i,!1)}))}function Nee(r){return r.getCells().filter(e=>!WP(e)).map(e=>{let t=at(e.document.getText(),{trim:!1,removeEmptyEntries:!1});e.metadata.interactiveWindowCellMarker!==void 0&&t.unshift(e.metadata.interactiveWindowCellMarker+`
`);let n=new Ra.NotebookCellData(e.kind,t.join(`
`),e.kind===Ra.NotebookCellKind.Code?e.document.languageId:"markdown");return e.kind===Ra.NotebookCellKind.Code&&(n.outputs=[...e.outputs]),n.metadata=Mf(e),n})}p();var VP=require("vscode");var w9=class{constructor(e,t,n){this.disposed=!1;this.dispose=()=>{this.disposed||(this.disposed=!0,this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.disposeCallback(),this.deferred.completed||this.deferred.resolve())};this.promise=()=>this.deferred.promise;this.reject=()=>{this.deferred.reject(),this.dispose()};this.deferred=Re(),this.disposeCallback=t,n&&(this.timeout=setTimeout(this.dispose,n))}},QM=class{constructor(){this.statusCount=0;this.incrementCount=()=>{this.statusCount+=1};this.decrementCount=()=>{let e=this.statusCount-1;this.statusCount=Math.max(e,0)}}set(e,t,n){this.incrementCount();let i=new w9(e,()=>this.decrementCount(),t),o={location:n?VP.ProgressLocation.Notification:VP.ProgressLocation.Window,title:e,cancellable:n!==void 0};return VP.window.withProgress(o,(s,a)=>(a&&n&&a.onCancellationRequested(()=>{n(),i.reject()}),i.promise())).then(E,E),i}async waitWithStatus(e,t,n,i){let o=this.set(t,n,i),s;try{s=await e()}finally{o.dispose()}return s}};var hs=class{constructor(e,t,n,i,o,s,a,l,u,c,d,f,m){this.disposables=e;this.jupyterExporter=t;this.jupyterServerHelper=n;this.fileSystem=i;this.configuration=o;this.dataScienceCodeLensProvider=s;this.debugService=a;this.configService=l;this.interactiveWindowProvider=u;this.kernelProvider=c;this.dataScienceErrorHandler=d;this.ipynbProvider=f;this.fileConverter=m;this.statusProvider=new QM,Qe.workspace.isTrusted||Qe.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted(),this.registerCommand(le.InsertCellBelowPosition,this.insertCellBelowPosition),this.registerCommand(le.InsertCellBelow,this.insertCellBelow),this.registerCommand(le.InsertCellAbove,this.insertCellAbove),this.registerCommand(le.DeleteCells,this.deleteCells),this.registerCommand(le.SelectCell,this.selectCell),this.registerCommand(le.SelectCellContents,this.selectCellContents),this.registerCommand(le.ExtendSelectionByCellAbove,this.extendSelectionByCellAbove),this.registerCommand(le.ExtendSelectionByCellBelow,this.extendSelectionByCellBelow),this.registerCommand(le.MoveCellsUp,this.moveCellsUp),this.registerCommand(le.MoveCellsDown,this.moveCellsDown),this.registerCommand(le.ChangeCellToMarkdown,this.changeCellToMarkdown),this.registerCommand(le.ChangeCellToCode,this.changeCellToCode),this.registerCommand(le.GotoNextCellInFile,this.gotoNextCellInFile),this.registerCommand(le.GotoPrevCellInFile,this.gotoPrevCellInFile),this.registerCommand(le.AddCellBelow,this.addCellBelow),this.registerCommand(le.CreateNewNotebook,this.createNewNotebook),this.registerCommand(le.LatestExtension,this.openPythonExtensionPage),this.registerCommand(le.EnableLoadingWidgetsFrom3rdPartySource,this.enableLoadingWidgetScriptsFromThirdParty),this.registerCommand(le.CreateNewInteractive,e=>this.createNewInteractiveWindow(e)),this.registerCommand(le.ImportNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>e?this.importNotebookOnFile(e):this.importNotebook())),this.registerCommand(le.ImportNotebookFile,(e,t="commandpalette")=>this.listenForErrors(()=>e?this.importNotebookOnFile(e):this.importNotebook())),Qe.commands.registerCommand(le.ExportFileAsNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>{if(e)return this.exportFile(e);{let n=Qe.window.activeTextEditor;if(n&&n.document.languageId===Ye)return this.exportFile(n.document.uri)}return Promise.resolve()})),this.registerCommand(le.ExportFileAndOutputAsNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>{if(e)return this.exportFileAndOutput(e);{let n=Qe.window.activeTextEditor;if(n&&n.document.languageId===Ye)return this.exportFileAndOutput(n.document.uri)}return Promise.resolve()})),this.registerCommand(le.ExpandAllCells,async e=>{var t;return this.expandAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(le.CollapseAllCells,async e=>{var t;return this.collapseAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(le.ExportOutputAsNotebook,()=>this.exportCells()),this.registerCommand(le.InteractiveExportAsNotebook,e=>{var t;return this.export((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(le.InteractiveExportAs,e=>{var t;return this.exportAs((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(le.ScrollToCell,(e,t)=>this.scrollToCell(e,t)),this.registerCommand(le.InteractiveClearAll,this.clearAllCellsInInteractiveWindow),this.registerCommand(le.InteractiveGoToCode,this.goToCodeInInteractiveWindow),this.registerCommand(le.InteractiveCopyCell,this.copyCellInInteractiveWindow)}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){Qe.workspace.isTrusted&&(this.registerCommand(le.RunAllCells,this.runAllCells),this.registerCommand(le.RunCell,this.runCell),this.registerCommand(le.RunCurrentCell,this.runCurrentCell),this.registerCommand(le.RunCurrentCellAdvance,this.runCurrentCellAndAdvance),this.registerCommand(le.ExecSelectionInInteractiveWindow,e=>{this.runSelectionOrLine(e).catch(E)}),this.registerCommand(le.RunAllCellsAbove,this.runAllCellsAbove),this.registerCommand(le.RunCellAndAllBelow,this.runCellAndAllBelow),this.registerCommand(le.RunAllCellsAbovePalette,this.runAllCellsAboveFromCursor),this.registerCommand(le.RunCellAndAllBelowPalette,this.runCellAndAllBelowFromCursor),this.registerCommand(le.RunCurrentCellAndAddBelow,this.runCurrentCellAndAddBelow),this.registerCommand(le.DebugCell,this.debugCell),this.registerCommand(le.DebugStepOver,this.debugStepOver),this.registerCommand(le.DebugContinue,this.debugContinue),this.registerCommand(le.DebugStop,this.debugStop),this.registerCommand(le.DebugCurrentCellPalette,this.debugCurrentCellFromCursor),this.registerCommand(le.OpenVariableView,this.openVariableView),this.registerCommand(le.OpenOutlineView,this.openOutlineView),this.registerCommand(le.RunToLine,this.runToLine),this.registerCommand(le.RunFromLine,this.runFromLine),this.registerCommand(le.RunFileInInteractiveWindows,this.runFileInteractive),this.registerCommand(le.DebugFileInInteractiveWindows,this.debugFileInteractive))}registerCommand(e,t){let n=Qe.commands.registerCommand(e,t,this);this.disposables.push(n)}getCodeWatcher(e){if(e&&this.dataScienceCodeLensProvider){let t=Qe.workspace.textDocuments.filter(n=>Xs(n.uri,e));if(t&&t.length===1)return this.dataScienceCodeLensProvider.getCodeWatcher(t[0]);if(t&&t.length>1)throw new Error(W.documentMismatch(lt(e)))}}async enableLoadingWidgetScriptsFromThirdParty(){this.configService.getSettings(void 0).widgetScriptSources.length>0||await this.configService.updateSetting("widgetScriptSources",["jsdelivr.com","unpkg.com"],void 0,Qe.ConfigurationTarget.Global).catch(E)}async runAllCells(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runAllCells()}async runFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runFileInteractive()}async debugFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.debugFileInteractive()}async runCell(e,t,n,i,o){let s=this.getCodeWatcher(e);if(s)return s.runCell(new Qe.Range(t,n,i,o))}async runAllCellsAbove(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runAllCellsAbove(t,n)}}async runCellAndAllBelow(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runCellAndAllBelow(t,n)}}async runToLine(){let e=this.getCurrentCodeWatcher(),t=Qe.window.activeTextEditor;if(e&&t&&t.selection)return e.runToLine(t.selection.start.line)}async runFromLine(){let e=this.getCurrentCodeWatcher(),t=Qe.window.activeTextEditor;if(e&&t&&t.selection)return e.runFromLine(t.selection.start.line)}async runCurrentCell(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCell()}async runCurrentCellAndAdvance(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCellAndAdvance()}async runSelectionOrLine(e){let t=this.getCurrentCodeWatcher();if(t)return t.runSelectionOrLine(Qe.window.activeTextEditor,pi(e)?void 0:e)}async debugCell(e,t,n,i,o){if(e){let s=this.getCodeWatcher(e);if(s)return s.debugCell(new Qe.Range(t,n,i,o))}}async debugStepOver(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&Qe.commands.executeCommand("workbench.action.debug.stepOver").then(E,E)}async debugStop(e){var t;if((t=this.debugService)!=null&&t.activeDebugSession&&this.interactiveWindowProvider){let n=this.interactiveWindowProvider.get(e);if(n&&n.notebookDocument){let i=this.kernelProvider.get(n.notebookDocument);i&&(w.debug(`Interrupt kernel due to debug stop of IW ${e.toString()}`),await i.interrupt())}Qe.commands.executeCommand("workbench.action.debug.stop").then(E,E)}}async debugContinue(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&Qe.commands.executeCommand("workbench.action.debug.continue").then(E,E)}async addCellBelow(){var e;await((e=this.getCurrentCodeWatcher())==null?void 0:e.addEmptyCellToBottom())}async runCurrentCellAndAddBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.runCurrentCellAndAddBelow()}async insertCellBelowPosition(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelowPosition()}async insertCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelow()}async insertCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellAbove()}async deleteCells(){var e;(e=this.getCurrentCodeWatcher())==null||e.deleteCells()}async selectCell(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCell()}async selectCellContents(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCellContents()}async extendSelectionByCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellAbove()}async extendSelectionByCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellBelow()}async moveCellsUp(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsUp()}async moveCellsDown(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsDown()}async changeCellToMarkdown(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToMarkdown()}async changeCellToCode(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToCode()}async gotoNextCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoNextCell()}async gotoPrevCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoPreviousCell()}async runAllCellsAboveFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runAllCellsAbove(e.range.start.line,e.range.start.character)}else return}async runCellAndAllBelowFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runCellAndAllBelow(e.range.start.line,e.range.start.character)}else return}async debugCurrentCellFromCursor(){if(this.getCurrentCodeLens()){let t=this.getCurrentCodeWatcher();if(t)return t.debugCurrentCell()}else return}async createNewNotebook(){Qe.window.showInformationMessage('This command has been deprecated and will eventually be removed, please use ["Create: New Jupyter Notebook"](command:workbench.action.openGlobalKeybindings?%5B%22@command:ipynb.newUntitledIpynb%22%5D) instead.').then(E,E),await Qe.commands.executeCommand("ipynb.newUntitledIpynb")}getCurrentCodeLens(){let e=Qe.window.activeTextEditor,t=this.getCurrentCodeWatcher();if(e&&t)return t.getCodeLenses().find(n=>n.range.end.line>=e.selection.anchor.line&&n.range.start.line<=e.selection.anchor.line)}getCurrentCodeWatcher(){let e=Qe.window.activeTextEditor;if(!(!e||!e.document||!this.dataScienceCodeLensProvider))return this.dataScienceCodeLensProvider.getCodeWatcher(e.document)}openPythonExtensionPage(){Qe.env.openExternal(Qe.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter")).then(E,E)}async openVariableView(){return Qe.commands.executeCommand("jupyterViewVariables.focus")}async openOutlineView(){return Qe.commands.executeCommand("outline.focus")}async listenForErrors(e){let t;try{return t=await e(),t}catch(n){w.error("listenForErrors",n),this.dataScienceErrorHandler.handleError(n).then(E,E)}return t}async exportFile(e){let t=lt(e);if(t&&t.length>0&&this.jupyterExporter){let n=Qe.window.activeTextEditor;if(n&&this.fileSystem.arePathsSame(n.document.uri,e)){let i=C9(n.document,this.configuration.getSettings(n.document.uri));if(i){let o=await new rp().showDialog("ipynb",e);if(await this.waitForStatus(async()=>{var s;if(o){let a=await((s=this.jupyterExporter)==null?void 0:s.serialize(i));await this.fileSystem.writeFile(o,a||"")}},W.exportingFormat,Ee(e)),o&&t){let s=W.exportOpenQuestion1;await Qe.window.showInformationMessage(W.exportDialogComplete(Ee(e)),s)===s&&await YM(o)}}}}}async exportFileAndOutput(e){let t=lt(e);if(t&&t.length>0&&this.jupyterExporter&&this.jupyterServerHelper&&await this.jupyterServerHelper.isJupyterServerSupported()){let n=Qe.window.activeTextEditor;if(n&&n.document&&this.fileSystem.arePathsSame(n.document.uri,e)){let i=C9(n.document,this.configuration.getSettings(n.document.uri));if(i){let o=await new rp().showDialog("ipynb",e);return o?(await this.waitForStatus(async()=>{var s;if(o){let a=await((s=this.jupyterExporter)==null?void 0:s.serialize(i));await this.fileSystem.writeFile(o,a||"")}},W.exportingFormat,Ee(e)),await Qe.workspace.openNotebookDocument(o).then(s=>Qe.window.showNotebookDocument(s)),await Qe.commands.executeCommand("notebook.execute"),o):void 0}}}else this.jupyterServerHelper&&await this.dataScienceErrorHandler.handleError(new am(W.jupyterNotSupported(await this.jupyterServerHelper.getJupyterServerError())))}async expandAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);w.info(`Expanding all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.expandAllCells()}async collapseAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);w.info(`Collapsing all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.collapseAllCells()}exportCells(){var t;let e=(t=this.interactiveWindowProvider)==null?void 0:t.activeWindow;e&&e.export()}exportAs(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.exportAs()}export(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.export()}async createNewInteractiveWindow(e){var t;await((t=this.interactiveWindowProvider)==null?void 0:t.getOrCreate(void 0,e))}waitForStatus(e,t,n,i){let o=t(n||"");return this.statusProvider.waitWithStatus(e,o,void 0,i)}async importNotebook(){let e=W.importDialogFilter,t={};t[e]=["ipynb"];let n=await Qe.window.showOpenDialog({openLabel:W.importDialogTitle,filters:t});n&&n.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(n[0])},W.importingFormat,Ee(n[0]))}async importNotebookOnFile(e){let t=lt(e);t&&t.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(e)},W.importingFormat,Ee(e))}async scrollToCell(e,t){if(t&&e){let n=this.interactiveWindowProvider.getInteractiveWindowsWithSubmitter(e);for(let i=0;i<n.length;i+=1)if(await n[i].hasCell(t)){n[i].scrollToCell(t);break}}}async clearAllCellsInInteractiveWindow(e){var s,a;let t=(a=this.interactiveWindowProvider.getInteractiveWindowWithNotebook((s=e==null?void 0:e.notebookEditor)==null?void 0:s.notebookUri))==null?void 0:a.notebookUri;if(!t)return;let n=Qe.workspace.notebookDocuments.find(l=>l.uri.toString()===t.toString());if(!n)return;let i=new Qe.WorkspaceEdit,o=Qe.NotebookEdit.deleteCells(new Qe.NotebookRange(0,n.cellCount));i.set(n.uri,[o]),await Qe.workspace.applyEdit(i)}async goToCodeInInteractiveWindow(e){var t;if(e&&((t=e.metadata)!=null&&t.interactive)){let n=Qe.Uri.parse(e.metadata.interactive.uristring),i=e.metadata.interactive.lineIndex,o=await Qe.window.showTextDocument(n,{viewColumn:Qe.ViewColumn.One});o&&(o.revealRange(new Qe.Range(i,0,i,0)),o.selection=new Qe.Selection(new Qe.Position(i,0),new Qe.Position(i,0)))}}async copyCellInInteractiveWindow(e){var t;if(e){let n=this.configuration.getSettings(e.notebook.uri),i=[(t=e.metadata.interactiveWindowCellMarker)!=null?t:n.defaultCellMarker,e.document.getText()].join(`
`);await Qe.env.clipboard.writeText(i)}}};U([Tn("DATASCIENCE.DEBUG_STEP_OVER")],hs.prototype,"debugStepOver",1),U([Tn("DATASCIENCE.DEBUG_STOP")],hs.prototype,"debugStop",1),U([Tn("DATASCIENCE.DEBUG_CONTINUE")],hs.prototype,"debugContinue",1),U([Dr("DATASCIENCE.ADD_CELL_BELOW")],hs.prototype,"addCellBelow",1),U([Tn("DATASCIENCE.EXPORT_PYTHON_FILE")],hs.prototype,"exportFile",1),U([Tn("DATASCIENCE.EXPORT_PYTHON_FILE_AND_OUTPUT")],hs.prototype,"exportFileAndOutput",1),U([Tn("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"command"})],hs.prototype,"importNotebook",1),U([Tn("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"file"})],hs.prototype,"importNotebookOnFile",1),hs=U([(0,Nn.injectable)(),x(0,(0,Nn.inject)(ve)),x(1,(0,Nn.inject)(AS)),x(1,(0,Nn.optional)()),x(2,(0,Nn.inject)(CR)),x(2,(0,Nn.optional)()),x(3,(0,Nn.inject)(Pt)),x(4,(0,Nn.inject)(Ke)),x(5,(0,Nn.inject)(Cm)),x(5,(0,Nn.optional)()),x(6,(0,Nn.inject)(so)),x(6,(0,Nn.optional)()),x(7,(0,Nn.inject)(Ke)),x(8,(0,Nn.inject)(lo)),x(9,(0,Nn.inject)(qe)),x(10,(0,Nn.inject)(dn)),x(11,(0,Nn.inject)(Oo)),x(12,(0,Nn.inject)(g_))],hs);p();var ip=se(ge()),xm=require("vscode");p();function ql(r){if(r.metadata.interactive!==void 0)return r.metadata}function Ree(r,e,t){let n=at(r,{trim:!1,removeEmptyEntries:!1}),i=t.stripFirstMarkerNoConcat(n),o=nY(i),s=uS(o,`
`,e.magicCommandsAsComments?zM:void 0);return Yv(s.join(""))}p();var Iu=Symbol("IReplNotebookTrackerService");var p_e=W.runCurrentCellAndAddBelow,f_e=W.addCellBelowCommandTitle,m_e=W.debugCellCommandTitle,h_e=W.debugCellCommandTitle,g_e=W.debugStepOverCommandTitle,v_e=W.debugContinueCommandTitle,y_e=W.debugStopCommandTitle,b_e=W.runCellLensCommandTitle,S_e=W.runAllCellsLensCommandTitle,I_e=W.runAllCellsAboveLensCommandTitle,Aee=W.runCellAndAllBelowLensCommandTitle,__e=W.scrollToCellTitleFormatMessage,T_=class{constructor(e,t,n,i,o,s){this.configService=e;this.generatedCodeStorageFactory=n;this.replTracker=o;this.cellRangeCache=s;this.updateEvent=new xm.EventEmitter;this.notebookData=new Map;this.codeLensCache=new Map;this.totalCodeLensUpdateTimeInMs=0;this.codeLensUpdateCount=0;this.maxCellCount=0;xm.workspace.onDidCloseTextDocument(this.onClosedDocument,this,t),xm.workspace.onDidGrantWorkspaceTrust(()=>this.codeLensCache.clear(),this,t),this.configService.getSettings(void 0).onDidChange(this.onChangedSettings,this,t),Rr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,t),i.onDidDisposeKernel(a=>{this.notebookData.delete(a.notebook.uri.toString())},this,t)}getPerfMeasures(){return{totalCodeLensUpdateTimeInMs:this.totalCodeLensUpdateTimeInMs,codeLensUpdateCount:this.codeLensUpdateCount,maxCellCount:this.maxCellCount}}get updateRequired(){return this.updateEvent.event}createCodeLenses(e){let t=this.getCodeLensCacheData(e);return[...t.documentLenses,...t.gotoCellLens]}getCellRanges(e){return this.getCodeLensCacheData(e).cellRanges}getCodeLensCacheData(e){var l;let t=new It,n=!1,i=e.uri.toString(),o=this.codeLensCache.get(i),s=!1;o||(o={cachedDocumentVersion:void 0,cachedExecutionCounts:new Set,documentLenses:[],cellRanges:[],gotoCellLens:[]},s=!0,this.codeLensCache.set(i,o)),o.cachedDocumentVersion!==e.version&&(o.cellRanges=this.cellRangeCache.getCellRanges(e),o.documentLenses=[],o.gotoCellLens=[],o.cachedDocumentVersion=e.version,s=!0);let a=this.getDocumentExecutionCounts(i);if((a.length!==o.cachedExecutionCounts.size||a.find(u=>!(o!=null&&o.cachedExecutionCounts.has(u))))&&(o.gotoCellLens=[],o.cachedExecutionCounts=new Set(a),s=!0),o.documentLenses.length===0&&s&&o.cellRanges.length){n=!0;let u=this.enumerateCommands(e.uri);w.debug(`CodeLensFactory: Generating new code lenses for version ${e.version} of document ${e.uri} for commands ${u.join(", ")}`);let c=!0;o.cellRanges.forEach(d=>{u.forEach(f=>{let m=this.createCodeLens(e,d,f,c);m&&o.documentLenses.push(m)}),c=!1})}else w.ci(`NOT Generating new code lenses for version ${e.version} of document ${e.uri} - needUpdate: ${s}, cellRanges.length: ${o.cellRanges.length}`);if(s&&o.gotoCellLens.length===0&&o.cellRanges.length&&this.configService.getSettings(e.uri).addGotoCodeLenses){let u=this.generatedCodeStorageFactory.get({fileUri:e.uri}),c=u?(l=u.all.find(d=>d.uri.toString()===e.uri.toString()))==null?void 0:l.generatedCodes:void 0;c&&c.length&&o.cellRanges.forEach(d=>{let f=this.createExecutionLens(e,d.range,c);f&&(o==null||o.gotoCellLens.push(f))})}return n&&(this.totalCodeLensUpdateTimeInMs+=t.elapsedTime,this.codeLensUpdateCount+=1,this.maxCellCount=Math.max(this.maxCellCount,o.cellRanges.length)),o}getDocumentExecutionCounts(e){return[...this.notebookData.values()].map(t=>t.documentExecutionCounts.get(e)).filter(t=>t!==void 0)}onDidChangeNotebookCellExecutionState(e){var i;if(this.replTracker.isForReplEditor(e.cell.notebook)||e.state!==1||!((i=e.cell.executionSummary)!=null&&i.executionOrder))return;let t=ql(e.cell),n=this.notebookData.get(e.cell.notebook.uri.toString());n||(n={cellExecutionCounts:new Map,documentExecutionCounts:new Map},this.notebookData.set(e.cell.notebook.uri.toString(),n)),n!==void 0&&t!==void 0&&(n.cellExecutionCounts.set(t.id,e.cell.executionSummary.executionOrder),n.documentExecutionCounts.set(t.interactive.uristring,e.cell.executionSummary.executionOrder),this.updateEvent.fire())}onClosedDocument(e){this.codeLensCache.delete(e.uri.toString())}onChangedSettings(){this.codeLensCache.clear(),this.cellRangeCache.clear(),this.updateEvent.fire()}enumerateCommands(e){let t,n=this.configService.getSettings(e).codeLenses;n?t=n.split(",").map(s=>s.trim()):t=Ru.DefaultDesignLenses;let i=this.configService.getSettings(e).debugCodeLenses;i?t=t.concat(i.split(",").map(s=>s.trim())):t=t.concat(Ru.DefaultDebuggingLenses);let o=[];return xm.workspace.isTrusted||(o=[...Ru.DebuggerCommands,...Ru.DebuggerCommands,le.RunAllCells,le.RunAllCellsAbove,le.RunAllCellsAbovePalette,le.RunCellAndAllBelowPalette,le.RunCurrentCell,le.RunCurrentCellAdvance,le.RunCurrentCellAndAddBelow,le.RunFileInInteractiveWindows,le.InterruptKernel,le.RunToLine,le.RunCell,le.DebugCell,le.DebugContinue,le.DebugStepOver,le.DebugStop,le.RunCellAndAllBelowPalette]),o&&(t=t.filter(s=>!o.includes(s))),t}createCodeLens(e,t,n,i){let{range:o,cell_type:s}=t;switch(n){case le.RunCurrentCellAndAddBelow:return this.generateCodeLens(o,le.RunCurrentCellAndAddBelow,p_e);case le.AddCellBelow:return this.generateCodeLens(o,le.AddCellBelow,f_e,[e.uri,o.start.line]);case le.DebugCurrentCellPalette:return this.generateCodeLens(o,le.DebugCurrentCellPalette,m_e);case le.DebugCell:if(s!=="code")break;return this.generateCodeLens(o,le.DebugCell,h_e,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case le.DebugStepOver:if(s!=="code")break;return this.generateCodeLens(o,le.DebugStepOver,g_e,[e.uri]);case le.DebugContinue:if(s!=="code")break;return this.generateCodeLens(o,le.DebugContinue,v_e,[e.uri]);case le.DebugStop:if(s!=="code")break;return this.generateCodeLens(o,le.DebugStop,y_e,[e.uri]);case le.RunCurrentCell:case le.RunCell:return this.generateCodeLens(o,le.RunCell,b_e,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case le.RunAllCells:return this.generateCodeLens(o,le.RunAllCells,S_e,[e.uri,o.start.line,o.start.character]);case le.RunAllCellsAbovePalette:case le.RunAllCellsAbove:return i?this.generateCodeLens(o,le.RunCellAndAllBelow,Aee,[e.uri,o.start.line,o.start.character]):this.generateCodeLens(o,le.RunAllCellsAbove,I_e,[e.uri,o.start.line,o.start.character]);case le.RunCellAndAllBelowPalette:case le.RunCellAndAllBelow:return this.generateCodeLens(o,le.RunCellAndAllBelow,Aee,[e.uri,o.start.line,o.start.character]);default:w.warn(`Invalid command for code lens ${n}`);break}}findMatchingCellExecutionCount(e){let t=[...this.notebookData.values()].find(n=>n.cellExecutionCounts.get(e));return t==null?void 0:t.cellExecutionCounts.get(e)}createExecutionLens(e,t,n){if(n){let i=n.filter(o=>o.line-2===t.start.line).sort((o,s)=>o.timestamp-s.timestamp);if(i&&i.length){let o=i[i.length-1],s=this.findMatchingCellExecutionCount(o.id);if(s!==void 0)return this.generateCodeLens(t,le.ScrollToCell,__e(s),[e.uri,o.id])}}}generateCodeLens(e,t,n,i){return new xm.CodeLens(e,E_e(t,n,i))}};T_=U([(0,ip.injectable)(),x(0,(0,ip.inject)(Ke)),x(1,(0,ip.inject)(ve)),x(2,(0,ip.inject)(Na)),x(3,(0,ip.inject)(qe)),x(4,(0,ip.inject)(Iu)),x(5,(0,ip.inject)(wm))],T_);function E_e(r,e,t){return{arguments:t,title:e,command:r}}p();var _u=se(ge()),Jl=se(require("vscode"));var k_=class{constructor(e,t,n,i,o){this.serviceContainer=e;this.debugLocationTracker=t;this.configuration=n;this.debugService=o;this.totalExecutionTimeInMs=0;this.totalGetCodeLensCalls=0;this.activeCodeWatchers=[];this.didChangeCodeLenses=new Jl.EventEmitter;i.push(this),i.push(Jl.workspace.onDidGrantWorkspaceTrust(()=>{this.activeCodeWatchers=Ce(this.activeCodeWatchers),this.didChangeCodeLenses.fire()})),i.push(this.debugService.onDidChangeActiveDebugSession(this.onChangeDebugSession.bind(this))),i.push(Jl.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument.bind(this))),this.debugLocationTracker&&i.push(this.debugLocationTracker.updated(this.onDebugLocationUpdated.bind(this)))}dispose(){this.totalGetCodeLensCalls>0&&ne("DS_INTERNAL.CODE_LENS_ACQ_TIME",{duration:this.totalExecutionTimeInMs/this.totalGetCodeLensCalls}),Ce(this.activeCodeWatchers)}get onDidChangeCodeLenses(){return this.didChangeCodeLenses.event}provideCodeLenses(e,t){return[Xl,Uv].includes(e.uri.scheme)?[]:this.getCodeLensTimed(e)}getCodeWatcher(e){return this.matchWatcher(e.uri)}onDebugLocationUpdated(){this.didChangeCodeLenses.fire()}onChangeDebugSession(e){this.didChangeCodeLenses.fire()}onDidCloseTextDocument(e){let t=this.activeCodeWatchers.findIndex(n=>n.uri&&n.uri.toString()===e.uri.toString());t>=0&&this.activeCodeWatchers.splice(t,1)[0].dispose()}getCodeLensTimed(e){let t=new It,n=this.getCodeLens(e);return this.totalExecutionTimeInMs+=t.elapsedTime,this.totalGetCodeLensCalls+=1,this.configuration.getSettings(e.uri).enableCellCodeLens?this.adjustDebuggingLenses(e,n):[]}adjustDebuggingLenses(e,t){let n=Ru.DebuggerCommands;if(this.debugLocationTracker&&this.debugService.activeDebugSession){let i=this.debugLocationTracker.getLocation(this.debugService.activeDebugSession),o;try{o=i?Jl.Uri.parse(i.fileName):void 0}catch(s){}if(i&&(Xs(Jl.Uri.file(i.fileName),e.uri,!0)||o&&Xs(o,e.uri,!0)))return t.filter(a=>{let l=new Jl.Position(i.lineNumber-1,i.column-1);return a.range.contains(l)}).filter(a=>a.command?n.includes(a.command.command):!1);w.ci(`Detected debugging context because activeDebugSession is name:"${this.debugService.activeDebugSession.name}", type: "${this.debugService.activeDebugSession.type}", but fell through with debugLocation: ${JSON.stringify(i)}, and document.uri: ${e.uri.toString()}`)}else return t.filter(i=>i.command?!n.includes(i.command.command):!1);return[]}getCodeLens(e){let t=this.matchWatcher(e.uri);return t?t.getCodeLenses():(w.debug(`Creating a new watcher for document ${e.uri}`),this.createNewCodeWatcher(e).getCodeLenses())}matchWatcher(e){let t=this.activeCodeWatchers.findIndex(i=>i.uri&&i.uri.toString()==e.toString());if(t>=0)return this.activeCodeWatchers[t];let n=Jl.workspace.textDocuments.filter(i=>i.uri.toString()===e.toString());if(n&&n.length>0)return w.debug(`creating new code watcher with matching document ${e}`),this.createNewCodeWatcher(n[0])}createNewCodeWatcher(e){let t=this.serviceContainer.get(BM);return t.setDocument(e),t.codeLensUpdated(this.onWatcherUpdated.bind(this)),this.activeCodeWatchers.push(t),t}onWatcherUpdated(){this.didChangeCodeLenses.fire()}};k_=U([(0,_u.injectable)(),x(0,(0,_u.inject)(Nr)),x(1,(0,_u.inject)(EM)),x(1,(0,_u.optional)()),x(2,(0,_u.inject)(Ke)),x(3,(0,_u.inject)(ve)),x(4,(0,_u.inject)(so))],k_);p();var op=se(ge()),ke=require("vscode");p();var XM=Symbol("ICodeExecutionHelper");p();var bv=class extends Error{constructor(t){super("Cell failed to execute");this.cell=t}};function C_e(r,e){if(e<=0)throw new RangeError(`Length must be > 0 not ${e}`);return r<0&&(r+=e),r<0?0:r>=e?e-1:r}var tr=class{constructor(e,t,n,i,o,s){this.interactiveWindowProvider=e;this.configService=t;this.executionHelper=n;this.dataScienceErrorHandler=i;this.codeLensFactory=o;this.replTracker=s;this.version=-1;this.codeLenses=[];this.cells=[];this.codeLensUpdatedEvent=new ke.EventEmitter;this.disposables=[this.codeLensUpdatedEvent]}setDocument(e){this.document=e,this.version=e.version,this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.disposables.push(this.codeLensFactory.updateRequired(this.onCodeLensFactoryUpdated.bind(this))),this.disposables.push(ke.workspace.onDidCloseTextDocument(this.onDocumentClosed.bind(this))),this.disposables.push(ke.workspace.onDidCloseNotebookDocument(this.ondidCloseNotebook.bind(this)))}get codeLensUpdated(){return this.codeLensUpdatedEvent.event}get uri(){var e;return(e=this.document)==null?void 0:e.uri}getVersion(){return this.version}getCodeLenses(){let e=this.document;return e&&e.version!=this.version&&(this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.version=e.version),this.codeLenses}async debugCurrentCell(){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(ke.window.activeTextEditor.selection,!1,!0)}dispose(){let e=this.codeLensFactory.getPerfMeasures();e&&e.codeLensUpdateCount>0&&ne("DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",{codeLensUpdateTime:e.totalCodeLensUpdateTimeInMs/e.codeLensUpdateCount,maxCellCount:e.maxCellCount}),Ce(this.disposables)}async runAllCells(e){let t=await this.getActiveInteractiveWindow(),n=this.codeLenses.filter(s=>s.command&&s.command.command===le.RunCell&&s.command.arguments&&s.command.arguments.length>=5),i=n.length,o=Promise.resolve(!0);for(let s of n){let a=new ke.Range(s.command.arguments[1],s.command.arguments[2],s.command.arguments[3],s.command.arguments[4]);if(this.document){i===n.length&&(a=new ke.Range(new ke.Position(0,0),a.end));let l=this.document.getText(a);i-=1,o=this.addCode(t,l,this.document.uri,a.start.line,e)}}if(await o,n.length===0)return this.runFileAsOneCell(e!=null?e:!1)}async runFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells();if(this.document)return this.runFileAsOneCell(!1)}async debugFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells(!0);if(this.document)return this.runFileAsOneCell(!0)}async runAllCellsAbove(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===le.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t);o<0&&(o=i.length);let s=o,a=Promise.resolve(!0);for(let l of i)if(o>0&&this.document){let u=new ke.Range(l.range.start,l.range.end);o===s&&(u=new ke.Range(new ke.Position(0,0),u.end)),o-=1;let c=this.document.getText(u);a=this.addCode(n,c,this.document.uri,l.range.start.line)}else break;await a}async runCellAndAllBelow(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===le.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t),s=o>0?i.length-o:i.length,a=Promise.resolve(!0);for(let l=o;l>=0&&l<i.length;l+=1)if(s>0&&this.document){let u=i[l];s-=1;let c=this.document.getText(u.range);a=this.addCode(n,c,this.document.uri,u.range.start.line)}await a}async runSelectionOrLine(e,t){var n;if(this.document&&e&&Xs(e.document.uri,this.document.uri)){let i=await this.getActiveInteractiveWindow(),o;if(t===void 0||pi(t)?o=this.executionHelper.getSelectedTextToExecute(e):o=t,!o)return;let a=((n=this.configService.getSettings(e.document.uri).normalizeSelectionForInteractiveWindow)!=null?n:!0)?await this.executionHelper.normalizeLines(o):o;if(!a||a.trim().length===0)return;await this.addCode(i,a,this.document.uri,e.selection.start.line)}}async runToLine(e){if(this.document&&e>0){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(e-1),i=this.document.getText(new ke.Range(0,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,0)}}async runFromLine(e){if(this.document&&e<this.document.lineCount){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(this.document.lineCount-1),i=this.document.getText(new ke.Range(e,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,e)}}async runCell(e){if(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document)return;let t=e.contains(ke.window.activeTextEditor.selection.start)&&this.configService.getSettings(ke.window.activeTextEditor.document.uri).enableAutoMoveToNextCell;return this.runMatchingCell(e,t)}async debugCell(e){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(e,!1,!0)}async runCurrentCell(){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(ke.window.activeTextEditor.selection,!1)}async runCurrentCellAndAdvance(){if(!(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document))return this.runMatchingCell(ke.window.activeTextEditor.selection,!0)}async addEmptyCellToBottom(){let e=ke.window.activeTextEditor;e&&this.insertCell(e,e.document.lineCount+1)}async runCurrentCellAndAddBelow(){if(!ke.window.activeTextEditor||!ke.window.activeTextEditor.document)return;let e=ke.window.activeTextEditor,t=new ms(this.configService.getSettings(e.document.uri)),n=0,i=this.getDefaultCellMarker(e.document.uri);e&&e.edit(s=>{let a=!0;for(let l=e.selection.end.line+1;l<e.document.lineCount;l+=1)if(t.isCell(e.document.lineAt(l).text)){a=!1,n=l,s.insert(new ke.Position(l,0),`${i}

`);break}a&&(n=e.document.lineCount,s.insert(new ke.Position(e.document.lineCount,0),`
${i}
`))}).then(E,E);let o=new ke.Position(n+1,0);return this.runMatchingCell(e.selection,!1).then(()=>this.advanceToRange(new ke.Range(o,o)))}insertCellBelowPosition(){let e=ke.window.activeTextEditor;e&&e.selection&&this.insertCell(e,e.selection.end.line+1)}insertCellBelow(){let e=ke.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.end);t?this.insertCell(e,t.range.end.line+1):this.insertCell(e,e.selection.end.line+1)}}insertCellAbove(){let e=ke.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.start);t?this.insertCell(e,t.range.start.line):this.insertCell(e,e.selection.start.line)}}deleteCells(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCells(e.selection);if(!t)return;let n=t[0],i=t[1],o=0,s=0,a=i.range.end.line+1,l=0;n.range.start.line>0&&(o=n.range.start.line-1,s=e.document.lineAt(o).range.end.character,a=i.range.end.line,l=i.range.end.character);let u=new ke.Range(new ke.Position(o,s),new ke.Position(a,l));e.edit(c=>{c.replace(u,""),this.codeLensUpdatedEvent.fire()}).then(E,E)}selectCell(){let e=ke.window.activeTextEditor;if(e&&e.selection){let t=this.getStartEndCells(e.selection);if(t){let n=t[0],i=t[1];e.selection.anchor.isBeforeOrEqual(e.selection.active)?e.selection=new ke.Selection(n.range.start,i.range.end):e.selection=new ke.Selection(i.range.end,n.range.start)}}}selectCellContents(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCellIndex(e.selection);if(!t)return;let n=t[0],i=t[1],o=e.selection.anchor.isBeforeOrEqual(e.selection.active),s=this.cells,a=[];for(let l=n;l<=i;l+=1){let u=s[l],c=u.range.start.line+1,d=0,f=u.range.end.line,m=u.range.end.character;u.range.start.line===u.range.end.line&&(c=u.range.start.line,d=e.document.lineAt(c).range.end.character,f=c,m=d),o?a.push(new ke.Selection(c,d,f,m)):a.push(new ke.Selection(f,m,c,d))}e.selections=a}extendSelectionByCellAbove(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBefore(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],u=o[a];if(!l.range.start.isEqual(t.start)||!u.range.end.isEqual(t.end)){let c;i?s<a?c=new ke.Selection(l.range.start,o[a-1].range.end):c=new ke.Selection(l.range.end,l.range.start):c=new ke.Selection(u.range.end,l.range.start),e.selection=c}else{let c;i&&s<a?(c=o[a-1],e.selection=new ke.Selection(l.range.start,c.range.end)):s>0&&(c=o[s-1],e.selection=new ke.Selection(u.range.end,c.range.start)),c&&e.revealRange(c.range,ke.TextEditorRevealType.Default)}}extendSelectionByCellBelow(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBeforeOrEqual(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],u=o[a];if(!l.range.start.isEqual(t.start)||!u.range.end.isEqual(t.end)){let c;i?c=new ke.Selection(l.range.start,u.range.end):s<a?c=new ke.Selection(o[s+1].range.start,u.range.end):c=new ke.Selection(u.range.start,u.range.end),e.selection=c}else{let c;i||s===a?a<o.length-1&&(c=o[a+1],e.selection=new ke.Selection(l.range.start,c.range.end)):s<a&&(c=o[s+1],e.selection=new ke.Selection(u.range.end,c.range.start)),c&&e.revealRange(c.range,ke.TextEditorRevealType.Default)}}async moveCellsUp(){await this.moveCellsDirection(!0)}async moveCellsDown(){await this.moveCellsDirection(!1)}changeCellToMarkdown(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"markdown"))}changeCellToCode(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"code"))}gotoNextCell(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getNextCellLens(t.start);n&&i&&this.advanceToRange(i.range)}gotoPreviousCell(){let e=ke.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getPreviousCellLens(t.start);n&&i&&this.advanceToRange(i.range)}applyToCells(e){let t=ke.window.activeTextEditor,n=this.getStartEndCellIndex(t==null?void 0:t.selection);if(!t||!n)return;let i=this.cells,o=n[0],s=n[1];for(let a=o;a<=s;a+=1)e(t,i[a],a)}changeCellTo(e,t,n){if(n==="raw")throw Error("Cell Type raw not implemented");if(t.cell_type===n)return;let i=new ms(this.configService.getSettings(e.document.uri)),o=e.document.lineAt(t.range.start.line),s=e.document.getText(o.range),a=this.getDefaultCellMarker(e.document.uri),l=n==="markdown"?i.codeExecRegEx.exec(s):i.markdownExecRegEx.exec(s);if(!l)return;let u=l[l.length-1],c=n==="markdown"?`${a} [markdown]${u}`:`${a}${u}`;e.edit(async d=>{d.replace(o.range,c),t.cell_type=n,t.range.start.line<t.range.end.line&&(e.selection=new ke.Selection(t.range.start.line+1,0,t.range.end.line,t.range.end.character),ke.commands.executeCommand("editor.action.removeCommentLine").then(E,E),n==="markdown"&&ke.commands.executeCommand("editor.action.addCommentLine").then(E,E))}).then(E,E)}async moveCellsDirection(e){let t=ke.window.activeTextEditor;if(!t||!t.selection)return!1;let n=this.getStartEndCellIndex(t.selection);if(!n)return!1;let i=n[0],o=n[1],s=this.cells,a=s[i],l=s[o];if(!a||!l)return!1;let u=new ke.Range(a.range.start,l.range.end),c=new ke.Range(t.selection.start.line-u.start.line,t.selection.start.character,t.selection.end.line-u.start.line,t.selection.end.character),d=t.selection.active.isBefore(t.selection.anchor),f;if(e){if(i===0)return!1;{let m=s[i-1];f=this.exchangeTextLines(t,m.range,u).then(b=>(b&&(t.selection=new ke.Selection(m.range.start.line+c.start.line,c.start.character,m.range.start.line+c.end.line,c.end.character)),b))}}else{if(o===s.length-1)return!1;{let m=s[o+1],g=this.exchangeTextLines(t,u,m.range),b=m.range.end.line-m.range.start.line,y=u.end.line-u.start.line,P=b-y;f=g.then(A=>(A&&(t.selection=new ke.Selection(m.range.start.line+P+c.start.line,c.start.character,m.range.start.line+P+c.end.line,c.end.character)),A))}}return f.then(m=>(m&&d&&(t.selection=new ke.Selection(t.selection.active,t.selection.anchor)),!0))}exchangeTextLines(e,t,n){let i=t.start.line,o=t.end.line,s=n.start.line,a=n.end.line;if(o>=s)throw RangeError(`Above lines must be fully above not ${o} <= ${s}`);let l=new ke.Range(i,0,o,e.document.lineAt(o).range.end.character),u=e.document.getText(l),c=new ke.Range(s,0,a,e.document.lineAt(a).range.end.character),d=e.document.getText(c),f="";if(o+1<s){let b=o+1,y=s-1,P=new ke.Range(b,0,y,e.document.lineAt(y).range.end.character);f=`${e.document.getText(P)}
`}let m=`${d}
${f}${u}`,g=new ke.Range(l.start,c.end);return e.edit(b=>{b.replace(g,m),this.codeLensUpdatedEvent.fire()})}getStartEndCells(e){let t=this.getStartEndCellIndex(e);if(t){let n=this.getCellFromIndex(t[0]),i=this.getCellFromIndex(t[1]);return[n,i]}}getStartEndCellIndex(e){if(!e)return;let t=this.getCellIndex(e.start),n=t;if(e.start.line!==e.end.line&&(n=this.getCellIndex(e.end)),t===-1){if(n===-1)return;{t=0;let i=this.getCellFromIndex(0);if(e.start.line>i.range.start.line)throw RangeError(`Should not be able to pick a range with an end in a cell and start after a cell. ${e.start.line} > ${i.range.end.line}`)}}if(t>=0&&n>=0)return[t,n]}insertCell(e,t){let n=this.getDefaultCellMarker(e.document.uri),i=t>=e.document.lineCount?`
${n}
`:`${n}

`,o=new ke.Position(t,0),s=new ke.Position(t+1,0);e.edit(a=>{a.insert(o,i),this.codeLensUpdatedEvent.fire()}).then(E,E),e.selection=new ke.Selection(s,s)}getDefaultCellMarker(e){return this.configService.getSettings(e).defaultCellMarker||nt.DefaultCodeCellMarker}onCodeLensFactoryUpdated(){this.document&&(this.codeLenses=this.codeLensFactory.createCodeLenses(this.document),this.cells=this.codeLensFactory.getCellRanges(this.document)),this.codeLensUpdatedEvent.fire()}onDocumentClosed(e){this.document&&Xs(e.uri,this.document.uri)&&Ce(this.disposables)}ondidCloseNotebook(e){var t;this.replTracker.isForReplEditor(e)&&this.configService.getSettings((t=this.document)==null?void 0:t.uri).addGotoCodeLenses&&this.onCodeLensFactoryUpdated()}getActiveInteractiveWindow(){var e;return this.interactiveWindowProvider.getOrCreate((e=this.document)==null?void 0:e.uri)}async addCode(e,t,n,i,o){let s=!1;try{o?s=await e.debugCode(t,n,i):s=await e.addCode(t,n,i)}catch(a){a instanceof bv||await this.dataScienceErrorHandler.handleError(a)}return s}async runMatchingCell(e,t,n){let i=this.getCurrentCellLens(e.start),o=this.getNextCellLens(e.start);if(i&&this.document){let s=Yv(this.document.getText(i.range));if(t){let l=ke.window.activeTextEditor,{newCellOnRunLast:u}=this.configService.getSettings(this.document.uri),c=new ms(this.configService.getSettings(this.document.uri));o?this.advanceToRange(o.range):u&&l&&!c.isEmptyCell(s)&&this.insertCell(l,i.range.end.line+1)}let a=await this.getActiveInteractiveWindow();await this.addCode(a,s,this.document.uri,i.range.start.line,n)}}getCellIndex(e){return this.cells.findIndex(t=>e&&t.range.contains(e))}getCellFromIndex(e){let t=this.cells,n=C_e(e,t.length);return t[n]}getCellFromPosition(e){if(!e){let t=ke.window.activeTextEditor;t&&t.selection&&(e=t.selection.active)}if(e){let t=this.getCellIndex(e);if(t>=0)return this.cells[t]}}getCurrentCellLens(e){return this.codeLenses.find(t=>t.range.contains(e)&&t.command!==void 0&&t.command.command===le.RunCell)}getNextCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===le.RunCell);if(t>=0)return this.codeLenses.find((n,i)=>n.command!==void 0&&n.command.command===le.RunCell&&i>t)}getPreviousCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===le.RunCell);if(t>=1)return this.codeLenses.find((n,i)=>n.command!==void 0&&i<t&&i+1===t)}async runFileAsOneCell(e){if(this.document){let t=await this.getActiveInteractiveWindow(),n=this.document.getText();await this.addCode(t,n,this.document.uri,0,e)}}advanceToRange(e){let t=ke.window.activeTextEditor,n=new ke.Selection(e.start,e.start);t&&(t.selection=n,t.revealRange(e,ke.TextEditorRevealType.Default))}};U([Tn("DATASCIENCE.DEBUG_CURRENT_CELL")],tr.prototype,"debugCurrentCell",1),U([Tn("DATASCIENCE.RUN_ALL_CELLS")],tr.prototype,"runAllCells",1),U([Tn("DATASCIENCE.RUN_FILE_INTERACTIVE")],tr.prototype,"runFileInteractive",1),U([Tn("DATASCIENCE.DEBUG_FILE_INTERACTIVE")],tr.prototype,"debugFileInteractive",1),U([Tn("DATASCIENCE.RUN_ALL_CELLS_ABOVE")],tr.prototype,"runAllCellsAbove",1),U([Tn("DATASCIENCE.RUN_CELL_AND_ALL_BELOW")],tr.prototype,"runCellAndAllBelow",1),U([Tn("DATASCIENCE.RUN_SELECTION_OR_LINE")],tr.prototype,"runSelectionOrLine",1),U([Tn("DATASCIENCE.RUN_TO_LINE")],tr.prototype,"runToLine",1),U([Tn("DATASCIENCE.RUN_FROM_LINE")],tr.prototype,"runFromLine",1),U([F7("CodeWatcher::runCell",4)],tr.prototype,"runCell",1),U([Tn("DATASCIENCE.DEBUG_CURRENT_CELL")],tr.prototype,"debugCell",1),U([Tn("DATASCIENCE.RUN_CURRENT_CELL")],tr.prototype,"runCurrentCell",1),U([Tn("DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE")],tr.prototype,"runCurrentCellAndAdvance",1),U([Dr("DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW")],tr.prototype,"runCurrentCellAndAddBelow",1),U([Dr("DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION")],tr.prototype,"insertCellBelowPosition",1),U([Dr("DATASCIENCE.RUN_INSERT_CELL_BELOW")],tr.prototype,"insertCellBelow",1),U([Dr("DATASCIENCE.RUN_INSERT_CELL_ABOVE")],tr.prototype,"insertCellAbove",1),U([Dr("DATASCIENCE.RUN_DELETE_CELLS")],tr.prototype,"deleteCells",1),U([Dr("DATASCIENCE.RUN_SELECT_CELL")],tr.prototype,"selectCell",1),U([Dr("DATASCIENCE.RUN_SELECT_CELL_CONTENTS")],tr.prototype,"selectCellContents",1),U([Dr("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE")],tr.prototype,"extendSelectionByCellAbove",1),U([Dr("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW")],tr.prototype,"extendSelectionByCellBelow",1),U([Dr("DATASCIENCE.RUN_MOVE_CELLS_UP")],tr.prototype,"moveCellsUp",1),U([Dr("DATASCIENCE.RUN_MOVE_CELLS_DOWN")],tr.prototype,"moveCellsDown",1),U([Dr("DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN")],tr.prototype,"changeCellToMarkdown",1),U([Dr("DATASCIENCE.RUN_CHANGE_CELL_TO_CODE")],tr.prototype,"changeCellToCode",1),U([Dr("DATASCIENCE.GOTO_NEXT_CELL_IN_FILE")],tr.prototype,"gotoNextCell",1),U([Dr("DATASCIENCE.GOTO_PREV_CELL_IN_FILE")],tr.prototype,"gotoPreviousCell",1),tr=U([(0,op.injectable)(),x(0,(0,op.inject)(lo)),x(1,(0,op.inject)(Ke)),x(2,(0,op.inject)(XM)),x(3,(0,op.inject)(dn)),x(4,(0,op.inject)(HM)),x(5,(0,op.inject)(Iu))],tr);p();var Sv=se(ge()),wi=se(require("vscode"));var Pm=require("vscode");var N_=class{constructor(e,t,n,i){this.configuration=t;this.extensionChecker=n;this.cellRangeCache=i;this.computeDecorations(),e.push(this),e.push(this.configuration.getSettings(void 0).onDidChange(this.settingsChanged,this)),e.push(wi.window.onDidChangeActiveTextEditor(this.changedEditor,this)),e.push(wi.window.onDidChangeTextEditorSelection(this.changedSelection,this)),e.push(wi.workspace.onDidChangeTextDocument(this.changedDocument,this)),this.settingsChanged()}activate(){}dispose(){this.timer&&clearTimeout(this.timer)}settingsChanged(){wi.window.activeTextEditor&&this.triggerUpdate(wi.window.activeTextEditor)}changedEditor(){this.triggerUpdate(void 0)}changedDocument(e){wi.window.activeTextEditor&&e.document===wi.window.activeTextEditor.document&&this.triggerUpdate(Pm.window.activeTextEditor)}changedSelection(e){e.textEditor&&e.textEditor.selection.anchor&&this.triggerUpdate(e.textEditor)}triggerUpdate(e){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>this.update(e),100)}computeDecorations(){this.currentCellTopUnfocused=Pm.window.createTextEditorDecorationType({borderColor:new wi.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottomUnfocused=Pm.window.createTextEditorDecorationType({borderColor:new wi.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellTop=Pm.window.createTextEditorDecorationType({borderColor:new wi.ThemeColor("interactive.activeCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottom=Pm.window.createTextEditorDecorationType({borderColor:new wi.ThemeColor("interactive.activeCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0})}cellDecorationEnabled(e){return e.decorateCells===!1?!1:e.decorateCells==="currentCell"||e.decorateCells==="allCells"}update(e){let t=e===void 0?Pm.window.visibleTextEditors:[e];for(let n of t)if(n&&n.document&&n.document.languageId===Ye&&!lS(n.document)&&this.currentCellTop&&this.currentCellBottom&&this.currentCellTopUnfocused&&this.currentCellBottomUnfocused&&this.extensionChecker.isPythonExtensionInstalled){let i=this.configuration.getSettings(n.document.uri);if(this.cellDecorationEnabled(i)){let o=this.cellRangeCache.getCellRanges(n.document),s=o.map(c=>c.range).filter(c=>c.contains(n.selection.anchor)),a=s.length>0?[new wi.Range(s[0].start,s[0].start)]:[],l=i.decorateCells!=="allCells"&&s.length>0?[new wi.Range(s[0].end,s[0].end)]:[],u=[];i.decorateCells==="allCells"&&o.forEach(c=>{let d=c.range.start;d!==s[0].start&&u.push(new wi.Range(d,d))}),Pm.window.activeTextEditor===n?(n.setDecorations(this.currentCellTop,a),n.setDecorations(this.currentCellBottom,l),n.setDecorations(this.currentCellTopUnfocused,u),n.setDecorations(this.currentCellBottomUnfocused,[])):(n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[...u,...a]),n.setDecorations(this.currentCellBottomUnfocused,l))}else n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[]),n.setDecorations(this.currentCellBottomUnfocused,[])}}};N_=U([(0,Sv.injectable)(),x(0,(0,Sv.inject)(ve)),x(1,(0,Sv.inject)(Ke)),x(2,(0,Sv.inject)(vo)),x(3,(0,Sv.inject)(wm))],N_);p();var co=se(ge()),Xt=require("vscode");p();var ht=require("vscode");var Mee=se($g());var sp=class{constructor(e,t,n,i,o){this.serviceContainer=e;this._owner=t;this.controllerFactory=n;this.inputUri=o;this._onDidChangeViewState=new ht.EventEmitter;this.closedEvent=new ht.EventEmitter;this._submitters=[];this.internalDisposables=[];var s;this.fs=this.serviceContainer.get(Pt),this.configuration=this.serviceContainer.get(Ke),this.jupyterExporter=this.serviceContainer.get(AS),this.interactiveWindowDebugger=this.serviceContainer.tryGet(xee),this.errorHandler=this.serviceContainer.get(dn),this.codeGeneratorFactory=this.serviceContainer.get(D_),this.storageFactory=this.serviceContainer.get(Na),this.kernelProvider=this.serviceContainer.get(qe),this.debuggingManager=this.serviceContainer.get(JM),this.notebookUri=i instanceof ht.TabInputInteractiveWindow||i instanceof ht.TabInputNotebook?i.uri:i.notebook.uri,this._owner&&this._submitters.push(this._owner),ht.window.onDidChangeActiveNotebookEditor(a=>{(a==null?void 0:a.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire()},this.internalDisposables),ht.workspace.onDidCloseNotebookDocument(a=>{a.uri.toString()===this.notebookUri.toString()&&this.closedEvent.fire()},this.internalDisposables),((s=ht.window.activeNotebookEditor)==null?void 0:s.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire(),this.cellMatcher=new ms(this.configuration.getSettings(this.owningResource)),this.notebookDocument&&this.codeGeneratorFactory.getOrCreate(this.notebookDocument)}get onDidChangeViewState(){return this._onDidChangeViewState.event}get closed(){return this.closedEvent.event}get owner(){return this._owner}get submitters(){return this._submitters}get notebookDocument(){return this._notebookDocument||(this._notebookDocument=ht.workspace.notebookDocuments.find(e=>e.uri.toString()===this.notebookUri.toString())),this._notebookDocument}get kernelConnectionMetadata(){var e;return(e=this.controller)==null?void 0:e.metadata}async notifyConnectionReset(){if(this.notebookDocument)this.controller||(this.controller=this.initController()),this.controller.setInfoMessageCell(W.noKernelConnected);else{let e=ht.workspace.onDidOpenNotebookDocument(async t=>{t.uri.toString()===this.notebookUri.toString()&&(this._notebookDocument=t,this.controller=this.initController(),this.internalDisposables.push(this.controller.listenForControllerSelection()),this.controller.setInfoMessageCell(W.noKernelConnected),e.dispose())})}}initController(){let e=this.controllerFactory.create(this,this.errorHandler,this.kernelProvider,this._owner);return this.internalDisposables.push(e.listenForControllerSelection()),e}async ensureInitialized(){if(!this.notebookDocument&&(w.debug("Showing Interactive editor to initialize codeGenerator from notebook document"),await this.showInteractiveEditor(),!this.notebookDocument))throw new Error("Could not open notebook document for Interactive Window");this.codeGeneratorFactory.get(this.notebookDocument)||this.codeGeneratorFactory.getOrCreate(this.notebookDocument),this.controller||(this.controller=this.initController()),this.controller.controller?(this.controller.startKernel().catch(E),await this.controller.resolveSysInfoCell()):(w.info("No controller selected for Interactive Window initialization"),this.controller.setInfoMessageCell(W.selectKernelForEditor))}async showInteractiveEditor(){let e;ht.window.tabGroups.all.find(i=>{i.tabs.find(o=>{(o.input instanceof ht.TabInputNotebook||o.input instanceof ht.TabInputInteractiveWindow)&&o.input.uri.toString()==this.notebookUri.toString()&&(e=o.group.viewColumn)})});let t=this.notebookDocument||await this.openNotebookDocument();return await ht.window.showNotebookDocument(t,{preserveFocus:!0,viewColumn:e,asRepl:!0})}async openNotebookDocument(){return w.debug(`Opening notebook document ${this.notebookUri}`),await ht.workspace.openNotebookDocument(this.notebookUri)}dispose(){var e;this.internalDisposables.forEach(t=>t.dispose()),(e=this.controller)==null||e.disconnect()}async showErrorForCell(e,t){var o,s,a;let n=(o=this.controller)==null?void 0:o.controller,i=by(e);if(n&&i&&t){let l=io.getOrCreate(t,new uv(n));try{await l.appendOutput(i)}catch(u){w.warn(`Could not append error message "${i}" to cell: ${u}`)}finally{l.end(!1,(a=(s=t.executionSummary)==null?void 0:s.timing)==null?void 0:a.endTime)}}else w.info(`Could not append error message to cell "${i}"`)}changeMode(e){var t;(t=this.controller)==null||t.updateMode(e)}async addCode(e,t,n){return this.submitCode(e,t,n,!1)}useNewDebugMode(){var t;return!!(this.configuration.getSettings(this.owner).forceIPyKernelDebugger||(t=this.controller)!=null&&t.metadata&&!zt(this.controller.metadata))}async debugCode(e,t,n){let i=!0,o=ht.workspace.textDocuments.find(a=>this.fs.arePathsSame(a.uri,t));if(!this.useNewDebugMode()&&o&&o.isUntitled){let a=[...ht.workspace.textDocuments];if(i=await o.save(),i){let l=ht.workspace.textDocuments.filter(u=>a.indexOf(u)===-1);l&&l.length>0&&(t=(l.find(c=>c.languageId==="python")||l.find(c=>!c.fileName.endsWith(".interactive"))||l[0]).uri,await ht.workspace.openTextDocument(t))}}let s=!0;return i?this.submitCode(e,t,n,!0):s}async submitCode(e,t,n,i){var c;if(this.cellMatcher.isEmptyCell(e)||!((c=this.controller)!=null&&c.controller))return!0;this.updateOwners(t);let o=at(e,{trim:!1}),s=new ms(this.configuration.getSettings(t)),a=-1;s.isMarkdown(o[0])&&Rg(o,(d,f)=>void 0,(d,f)=>{d&&d.length>0&&a===-1&&(a=f)});let u=(a>0?[o.slice(0,a).join(`
`),o.slice(a).join(`
`)]:[e]).map(d=>{let f=Re();this.controller.setPendingCellAdd(f.promise);let m=this.addNotebookCell(d,t,n),g=this.createExecutionPromise(m,i);return g.catch(b=>{b instanceof bv?m.then(y=>{b.cell!==y&&this.showErrorForCell(W.cellStopOnErrorMessage,y).then(E,E)}).catch(E):m.then(y=>this.errorHandler.getErrorMessageForDisplayInCell(b,"execution",this.owningResource).then(P=>this.showErrorForCell(P,y))).catch(E)}).finally(()=>{f==null||f.resolve()}),g});return u[u.length-1]}async createExecutionPromise(e,t){var a,l;if(!this.controller||!this.notebookDocument)return!1;w.ci("InteractiveWindow.ts.createExecutionPromise.start");let n=this.controller.startKernel(),i=await e,o=!0,s=async()=>void 0;try{let u=await n;await this.generateCodeAndAddMetadata(i,t,u),t&&this.useNewDebugMode()?await this.debuggingManager.start(this.notebookDocument,i):t&&zt(u.kernelConnectionMetadata)&&this.interactiveWindowDebugger&&(s=async()=>{var f;return(f=this.interactiveWindowDebugger)==null?void 0:f.detach(u)},await this.interactiveWindowDebugger.attach(u),await this.interactiveWindowDebugger.updateSourceMaps(((a=this.storageFactory.get({notebook:i.notebook}))==null?void 0:a.all)||[]),this.interactiveWindowDebugger.enable(u)),w.ci("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell");let c=ql(i);o=await this.kernelProvider.getKernelExecution(u).executeCell(i,(l=c==null?void 0:c.generatedCode)==null?void 0:l.code).then(()=>!0,()=>!1),w.ci("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell.finished")}finally{await s(),w.ci("InteractiveWindow.ts.createExecutionPromise.end")}if(!o)throw new bv(i);return o}async expandAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{await ht.commands.executeCommand("notebook.cell.expandCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async collapseAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{e.kind===ht.NotebookCellKind.Code&&await ht.commands.executeCommand("notebook.cell.collapseCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async scrollToCell(e){let t=await this.showInteractiveEditor(),n=t.notebook.getCells().find(i=>{var o;return((o=ql(i))==null?void 0:o.id)===e});if(n){let i=new ht.NotebookRange(n.index,n.index+1);t.revealRange(i,ht.NotebookEditorRevealType.Default),t.selection=i}}async hasCell(e){let t=this.notebookDocument;return!!t&&t.getCells().some(n=>{var i;return((i=ql(n))==null?void 0:i.id)===e})}get owningResource(){if(this.owner)return this.owner;let e=aS();if(e)return e}updateOwners(e){var t;this._owner||(this._owner=e,(t=this.controller)==null||t.updateOwners(e)),this._submitters.find(n=>n.toString()==e.toString())||this._submitters.push(e)}async addNotebookCell(e,t,n){var g,b;let i=this.notebookDocument;if(!i)throw new Error("No notebook document");let o=this.configuration.getSettings(this.owningResource),s=this.cellMatcher.getCellType(e)===UE,a=s?qN(at(e)).join(""):Ree(e,o,this.cellMatcher),l=this.cellMatcher.getFirstMarker(e),u=(b=(g=ht.workspace.textDocuments.find(y=>{var P;return y.uri.toString()===((P=this.owner)==null?void 0:P.toString())}))==null?void 0:g.languageId)!=null?b:Ye,c=new ht.NotebookCellData(s?ht.NotebookCellKind.Markup:ht.NotebookCellKind.Code,a,s?UE:u),d={uristring:t.toString(),lineIndex:n,originalSource:e},f={interactiveWindowCellMarker:l,interactive:d,id:(0,Mee.default)()};c.metadata=f;let m;return await Su(i,async y=>{m=await this.getAppendIndex();let P=ht.NotebookEdit.insertCells(m,[c]);y.set(i.uri,[P])}),i.cellAt(m)}async getAppendIndex(){if(!this.notebookDocument)throw new Error("No notebook document");return this.notebookDocument.cellCount}async generateCodeAndAddMetadata(e,t,n){let i=ql(e);if(!i)return;let o=!zt(n.kernelConnectionMetadata)||this.configuration.getSettings(void 0).forceIPyKernelDebugger,s=await this.codeGeneratorFactory.getOrCreate(this.notebookDocument).generateCode(i,e.index,t,o),a={...i,generatedCode:s},l=new ht.WorkspaceEdit,u=ht.NotebookEdit.updateCellMetadata(e.index,a);l.set(e.notebook.uri,[u]),await ht.workspace.applyEdit(l)}async export(){var n;if(!this.notebookDocument)throw new Error("no notebook to export.");let e=Nee(this.notebookDocument),t=await new rp().showDialog("ipynb",this.owningResource);t&&await((n=this.jupyterExporter)==null?void 0:n.exportToFile(e,lt(t)))}async exportAs(){var n;if(await this.ensureInitialized(),!this.controller)throw new Error("An active kernel is required to export the notebook.");let e=(n=this.controller.kernel)==null?void 0:n.value,t;if(this.submitters&&this.submitters.length){let i=this.submitters[this.submitters.length-1];t=Zt(i.path,_p(i.path))}_n()?ht.commands.executeCommand(le.ExportAsPythonScript,this.notebookDocument,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(E,E):ht.commands.executeCommand(le.Export,this.notebookDocument,t,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(E,E)}};U([aL()],sp.prototype,"showErrorForCell",1),U([aL()],sp.prototype,"createExecutionPromise",1);p();function Oee(r){return W.interactiveWindowTitleFormat(Zt(r.path))}p();var x9=class{constructor(e,t,n,i,o,s,a){this.controllerService=e;this.mode=t;this.interactiveWindow=n;this.errorHandler=i;this.kernelProvider=o;this.owner=s;this.disposables=[];this.controller=a==null?void 0:a.controller,this.metadata=a==null?void 0:a.connection}updateMode(e){this.mode=e}updateOwners(e){this.owner=e}async startKernel(){var e;if((e=this.connectingListener)==null||e.dispose(),this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Interactive Window kernel not selected");this.setInfoMessage(this.metadata,0);try{let t=await this.createKernel(),n=async()=>{this.interactiveWindow.notebookDocument&&this.metadata&&(this.systemInfoCell=void 0,this.setInfoMessage(this.metadata,1))};return this.disposables.push(t.addHook("willRestart",n)),t.onRestarted(async()=>{w.debug("Restart event handled in IW"),this.fileInKernel=void 0;try{await this.setFileInKernel(t)}catch(i){w.error("Failed to run initialization after restarting")}finally{this.finishSysInfoMessage(t,1)}},this,this.disposables),this.fileInKernel=void 0,await this.setFileInKernel(t),this.finishSysInfoMessage(t,0),t}catch(t){throw this.owner?this.deleteSysInfoCell():await this.finishSysInfoWithFailureMessage(t),t}}async createKernel(){if(this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Controller not selected");let e=Re();e.promise.catch(E),this.kernel=e;try{let{kernel:t,actualController:n}=await this.controllerService.createKernel(this.metadata,this.controller,this.owner,this.interactiveWindow.notebookDocument,this.disposables);return this.metadata=t.kernelConnectionMetadata,this.controller=n,this.disposables.push(t),e.resolve(t),t}catch(t){throw e.reject(t),this.disconnect(),t}}async setFileInKernel(e){let t=this.owner;if(!t){w.ci("Unable to run initialization for IW");return}let n=lt(t),i=this.kernelProvider.getKernelExecution(e);this.mode==="perFile"&&!this.fileInKernel?(w.debug(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):(!this.fileInKernel||this.fileInKernel.toString()!==t.toString())&&this.mode!=="perFile"?(w.debug(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):w.debug(`Not Initializing __file__ in setFileInKernel with ${n} for mode ${this.mode} currently ${this.fileInKernel}`)}setPendingCellAdd(e){if(this.metadata&&this.interactiveWindow.notebookDocument){let t=this.controllerService.getRegisteredController(this.metadata);t==null||t.setPendingCellAddition(this.interactiveWindow.notebookDocument,e)}}listenForControllerSelection(){return this.controllerService.onControllerSelected(e=>{var t,n,i,o;if(!(!this.interactiveWindow.notebookDocument||e.notebook.uri.toString()!==((n=(t=this.interactiveWindow.notebookDocument)==null?void 0:t.uri)==null?void 0:n.toString()))&&e.controller.id!==((i=this.controller)==null?void 0:i.id)){let s=!!this.kernel;this.disconnect(),this.controller=e.controller.controller,this.metadata=e.controller.connection,s?this.startKernel().catch(E):((o=this.connectingListener)==null||o.dispose(),this.connectingListener=e.controller.onConnecting(()=>{this.startKernel().catch(E)}),this.disposables.push(this.connectingListener))}},this)}setInfoMessageCell(e){if(!this.interactiveWindow.notebookDocument){w.warn("Could not set info cell: no notebook document");return}this.systemInfoCell?this.systemInfoCell.updateMessage(e).catch(t=>w.warn(`could not update info cell with message: "${e}", error: ${t}`)):this.systemInfoCell=new $M(this.interactiveWindow,this.interactiveWindow.notebookDocument,e)}async resolveSysInfoCell(){var e;await((e=this.systemInfoCell)==null?void 0:e.resolveCell())}setInfoMessage(e,t){let n=Pee(e,t);this.setInfoMessageCell(n)}finishSysInfoMessage(e,t){var i;let n=Dee(e.kernelConnectionMetadata,t);(i=this.systemInfoCell)==null||i.updateMessage(n).catch(o=>w.warn(`System info message was not updated: "${n}" because of error: ${o}`)),this.systemInfoCell=void 0}async finishSysInfoWithFailureMessage(e){var n;let t=await this.errorHandler.getErrorMessageForDisplayInCell(e,"start",this.owner);t=t.split(`
`).join(`  
`),(n=this.systemInfoCell)==null||n.updateMessage(t).catch(i=>w.warn(`System info message was not updated: "${t}" because of error: ${i}`)),this.systemInfoCell=void 0}deleteSysInfoCell(){var e;(e=this.systemInfoCell)==null||e.deleteCell().then(E,E),this.systemInfoCell=void 0}disconnect(){this.disposables.forEach(e=>e.dispose()),this.disposables=[],this.kernel=void 0}},Iv=class{constructor(e,t,n){this.controllerService=e;this.mode=t;this.initialController=n}create(e,t,n,i){if(!e.notebookDocument)throw Error("could not create controller: no notebook document");let o=this.initialController,s=this.controllerService.getSelectedController(e.notebookDocument);return s&&(o=s),new x9(this.controllerService,this.mode,e,t,n,i,o)}};p();var jP=class extends sp{async getAppendIndex(){var t,n;if((t=this.editor)!=null&&t.replOptions||(this.editor=await this.showInteractiveEditor()),!((n=this.editor)!=null&&n.replOptions))throw new Error("Interactive editor not found");return this.editor.replOptions.appendIndex}};var Lee="ds_asked_per_file_interactive",Kee="ds_interactive_window_cache",R_=class{constructor(e){this.serviceContainer=e}isForReplEditor(e){return this.interactiveWindowProvider||(this.interactiveWindowProvider=this.serviceContainer.get(lo)),this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e.uri)!==void 0}};R_=U([(0,co.injectable)(),x(0,(0,co.inject)(Nr))],R_);var A_=class{constructor(e,t,n,i,o,s,a,l){this.serviceContainer=e;this.disposables=t;this.fs=n;this.configService=i;this.globalMemento=o;this.workspaceMemento=s;this.notebookEditorProvider=a;this.controllerHelper=l;this._onDidChangeActiveInteractiveWindow=new Xt.EventEmitter;this._windows=[];this.notebookEditorProvider.registerEmbedNotebookProvider(this),this.restoreWindows()}get onDidChangeActiveInteractiveWindow(){return this._onDidChangeActiveInteractiveWindow.event}get activeWindow(){var t;let e=(t=Xt.window.activeNotebookEditor)==null?void 0:t.notebook.uri.toString();return e?this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e}):void 0}restoreWindows(){let e=new Map;Xt.window.tabGroups.all.forEach(t=>{t.tabs.forEach(n=>{let i=n.input;(i instanceof Xt.TabInputInteractiveWindow||i instanceof Xt.TabInputNotebook)&&e.set(i.uri.toString(),i)})}),this.workspaceMemento.get(Kee,[]).forEach(t=>{if(!t.uriString||!e.get(t.uriString))return;let n=e.get(t.uriString);if(!n)return;let i=this.configService.getSettings(n.uri).interactiveWindowMode,o=n instanceof Xt.TabInputInteractiveWindow?new sp(this.serviceContainer,Xt.Uri.parse(t.owner),new Iv(this.controllerHelper,i),n,Xt.Uri.parse(t.inputBoxUriString)):new jP(this.serviceContainer,Xt.Uri.parse(t.owner),new Iv(this.controllerHelper,i),n,Xt.Uri.parse(t.inputBoxUriString));o.notifyConnectionReset().catch(E),this._windows.push(o),ne("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!1,hasOwner:!!t.owner,mode:i,restored:!0});let s=o.closed(this.onInteractiveWindowClosed.bind(this,o));this.disposables.push(o),this.disposables.push(s),this.disposables.push(o.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this)))}),this._updateWindowCache()}async getOrCreate(e,t){if(!Xt.workspace.isTrusted)throw new Error("Workspace not trusted");let n=await this.getInteractiveMode(e);this.pendingCreations&&await this.pendingCreations.catch(E);let i=this.getExisting(e,n,t);return i||(i=await this.create(e,n,t)),await i.ensureInitialized(),i}get(e){let t=this.configService.getSettings(e).interactiveWindowMode;return this.getExisting(e,t)}async create(e,t,n){let i=Re();this.pendingCreations=i.promise;try{let o=this.configService.getSettings(e).interactiveReplNotebook,s=o?bt:vr,a=await this.controllerHelper.getInitialController(e,s,n);w.info(`Starting interactive window for resource '${Ee(e)}' with controller '${a==null?void 0:a.id}'`);let[l,u]=await this.createEditor(a,e,t,o);a&&a.controller.updateNotebookAffinity(u.notebook,Xt.NotebookControllerAffinity.Preferred),w.debug(`Interactive Window Editor Created: ${u.notebook.uri.toString()} with input box: ${l.toString()}`);let c=o?new jP(this.serviceContainer,e,new Iv(this.controllerHelper,t,a),u,l):new sp(this.serviceContainer,e,new Iv(this.controllerHelper,t,a),u,l);this._windows.push(c),ne("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!!a,hasOwner:!!e,mode:t,restored:!1}),this._updateWindowCache(),this.lastActiveInteractiveWindow=c;let d=c.closed(this.onInteractiveWindowClosed.bind(this,c));return this.disposables.push(c),this.disposables.push(d),this.disposables.push(c.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this))),c}finally{i.resolve()}}async createEditor(e,t,n,i){let o=t&&n==="perFile"?Oee(t):void 0,s=t!==void 0,a=this.getInteractiveViewColumn(t);if(i)return this.createNotebookBackedEditor(a,s,e==null?void 0:e.controller,o);let{inputUri:l,notebookEditor:u}=await Xt.commands.executeCommand("interactive.open",{viewColumn:a,preserveFocus:s},void 0,e?`${Je}/${e.id}`:void 0,o);if(!u)throw new Error("Failed to request creation of interactive window from VS Code.");return[l,u]}async createNotebookBackedEditor(e,t,n,i){i=i||"Interactive-1";let o=await Xt.workspace.openNotebookDocument(bt),s=await Xt.window.showNotebookDocument(o,{preserveFocus:n?!1:t,viewColumn:e,asRepl:i});if(!s.replOptions)throw new Error("Wrong type of editor created");return n&&await Xt.commands.executeCommand("notebook.selectKernel",{editor:s,id:n.id,extension:Je}),[o.cellAt(s.replOptions.appendIndex).document.uri,s]}getInteractiveViewColumn(e){if(e)return Xt.ViewColumn.Beside;let t=this.configService.getSettings(e).interactiveWindowViewColumn;return t==="secondGroup"?Xt.ViewColumn.One:t==="active"?Xt.ViewColumn.Active:Xt.ViewColumn.Beside}async getInteractiveMode(e){let t=this.configService.getSettings(e).interactiveWindowMode;if(t==="multiple"&&e&&!this.globalMemento.get(Lee)&&this._windows.length===1&&(!this._windows[0].owner||!this.fs.arePathsSame(this._windows[0].owner,e))){this.globalMemento.update(Lee,!0).then(E,E);let n=[W.interactiveWindowModeBannerSwitchYes,W.interactiveWindowModeBannerSwitchNo];await Xt.window.showInformationMessage(W.interactiveWindowModeBannerTitle,...n)===n[0]&&(t="perFile",this._windows[0].changeMode(t),await this.configService.updateSetting("interactiveWindow.creationMode",t,e,Xt.ConfigurationTarget.Global))}return t}_updateWindowCache(){let e=this._windows.map(t=>{var n;return{owner:(n=t.owner)==null?void 0:n.toString(),uriString:t.notebookUri.toString(),inputBoxUriString:t.inputUri.toString()}});this.workspaceMemento.update(Kee,e).then(E,E)}getExisting(e,t,n){return t==="single"?this._windows.length>0?this._windows[0]:void 0:t==="multiple"?e?this.activeWindow||this.lastActiveInteractiveWindow||this._windows[0]:void 0:this._windows.find(i=>{var o;return!e&&!i.owner&&!n?!0:e&&i.owner&&this.fs.arePathsSame(e,i.owner)?!n||((o=i.kernelConnectionMetadata)==null?void 0:o.id)===n.id:!1})}raiseOnDidChangeActiveInteractiveWindow(){this.lastActiveInteractiveWindow=this.activeWindow?this.activeWindow:this.lastActiveInteractiveWindow,this._onDidChangeActiveInteractiveWindow.fire(this.activeWindow)}onInteractiveWindowClosed(e){var t;w.debug(`Closing interactive window: ${(t=e.notebookUri)==null?void 0:t.toString()}`),e.dispose(),this._windows=this._windows.filter(n=>n!==e),this._updateWindowCache(),this.lastActiveInteractiveWindow===e&&(this.lastActiveInteractiveWindow=this._windows[0]),this.raiseOnDidChangeActiveInteractiveWindow()}getActiveOrAssociatedInteractiveWindow(){if(this.activeWindow)return this.activeWindow;if(Xt.window.activeTextEditor===void 0)return;let e=Xt.window.activeTextEditor.document.uri;if(e.scheme!==Xl)return this.get(e)}findNotebookEditor(e){var n,i;let t;if(e&&e.path.endsWith(".interactive"))t=(n=this.get(e))==null?void 0:n.notebookDocument;else{let o=this.configService.getSettings(e).interactiveWindowMode;t=(i=this.getExisting(e,o))==null?void 0:i.notebookDocument}return t?Xt.window.visibleNotebookEditors.find(o=>o.notebook===t):void 0}findAssociatedNotebookDocument(e){let t=this._windows.find(i=>{var o;return((o=i.inputUri)==null?void 0:o.toString())===e.toString()});return t==null?void 0:t.notebookDocument}getInteractiveWindowWithNotebook(e){let t;return e!==void 0?t=this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e.toString()}):t=this.getActiveOrAssociatedInteractiveWindow(),t}getInteractiveWindowsWithSubmitter(e){return this._windows.filter(t=>t.submitters.find(n=>this.fs.arePathsSame(e,n)))}};A_=U([(0,co.injectable)(),x(0,(0,co.inject)(Nr)),x(1,(0,co.inject)(ve)),x(2,(0,co.inject)(Pt)),x(3,(0,co.inject)(Ke)),x(4,(0,co.inject)(_t)),x(4,(0,co.named)(rr)),x(5,(0,co.inject)(_t)),x(5,(0,co.named)(Is)),x(6,(0,co.inject)(Oo)),x(7,(0,co.inject)(qM))],A_);p();var O_=se(ge());p();var Eu=require("vscode");var ZM=class{constructor(e,t,n,i){this.configService=e;this.storage=t;this.notebook=n;this.executionCount=0;this.cellIndexesCounted={};this.disposables=[];i.push(this),Eu.workspace.onDidChangeTextDocument(this.onChangedDocument,this,this.disposables),Rr.onDidChangeNotebookCellExecutionState(this.onDidCellStateChange,this,this.disposables)}dispose(){this.disposed||(this.disposed=!0,this.storage.clear(),this.disposables.forEach(e=>e.dispose()))}reset(){this.storage.clear(),this.executionCount=0}async generateCode(e,t,n,i){let{executableLines:o}=this.extractExecutableLines(e);if(this.executionCount+=1,this.cellIndexesCounted[t]=!0,o.length>0&&o.find(s=>s.trim().length>0))return this.generateCodeImpl(e,this.executionCount,n,i)}extractExecutableLines(e){let t=e.interactive.originalSource,n=this.configService.getSettings(this.notebook.uri),i=new ms(n),o=cS(t);if(n.magicCommandsAsComments&&o.forEach((s,a)=>o[a]=zM(s)),e.interactiveWindowCellMarker&&o.length&&o[0].trim()===e.interactiveWindowCellMarker.trim()){let s=o.slice(1).filter(a=>a.trim().length>0);if(s.length>0&&s[0].trim().startsWith("%%")){let a=o.slice(o.indexOf(s[0]));return{lines:a,executableLines:a}}}return o.length>0&&(i.isCode(o[0])||i.isMarkdown(o[0]))?{lines:o,executableLines:o.slice(1)}:{lines:o,executableLines:o}}onDidCellStateChange(e){var t;e.state===1&&(e.state!==1||e.cell.notebook!==this.notebook||!((t=e.cell.executionSummary)!=null&&t.executionOrder)||this.cellIndexesCounted[e.cell.index]||(this.executionCount+=1,this.cellIndexesCounted[e.cell.index]=!0))}async generateCodeImpl(e,t,n,i){let{lineIndex:o,uristring:s}=e.interactive,a=Eu.workspace.textDocuments.find(O=>O.uri.toString()===s);if(!a)return;let{stripped:l,trueStartLine:u}=this.extractStrippedLines(e),c=a.lineAt(u),d=a.lineAt(Math.min(u+l.length-1,a.lineCount-1)),f=0;for(;f<l.length&&l[f].trim().length===0;)f+=1;let m=f+u,g=a.offsetAt(new Eu.Position(o,0)),b=a.offsetAt(d.rangeIncludingLineBreak.end),y=(e.interactiveWindowCellMarker||"").length>0,{runtimeLine:P,debuggerStartLine:A}=this.addHiddenLines(n,l,u,m,y,i),D=l.join(""),T=a.getText(new Eu.Range(new Eu.Position(o,0),d.rangeIncludingLineBreak.end)),K=(await ja(D,"SHA-1")).substring(0,12),L=this.getRuntimeFile(K,t),B=n?-1:0,N={line:c?c.lineNumber+1:1,endLine:d?d.lineNumber+1:1,firstNonBlankLineIndex:m,debuggerStartLine:A,executionCount:t,startOffset:g,endOffset:b,deleted:!1,code:D,trimmedRightCode:l.map(O=>O.replace(/[ \t\r]+\n$/g,`
`)).join(""),realCode:T,runtimeLine:P,runtimeFile:L,id:e.id,timestamp:Date.now(),lineOffsetRelativeToIndexOfFirstLineInCell:B,hasCellMarker:y};return w.info(`Generated code for ${t} = ${L} with ${l.length} lines`),this.storage.store(Eu.Uri.parse(e.interactive.uristring),N),N}getRuntimeFile(e,t){return`<ipython-input-${t}-${e}>`}onChangedDocument(e){let t=this.storage.getFileGeneratedCode(e.document.uri);if(t){let n=e.document.getText();e.contentChanges.forEach(i=>{this.handleContentChange(n,i,t)})}}extractStrippedLines(e){let t=cS(e.interactive.originalSource),{lines:n}=this.extractExecutableLines(e),i=e.interactive.lineIndex+1;if(!e.interactiveWindowCellMarker){i=e.interactive.lineIndex;for(let l=0;l<n.length;l+=1)if(n[l]!==t[l]){i+=l+1;break}}let o=0;for(;o<n.length&&n[o].trim().length===0;)o+=1;let s=n.length-1,a=n.length-2;for(;a>0;){let l=n[s],u=n[a];if((l.length===0||l===`
`)&&(u.length===0||u===`
`))n.splice(s,1),s-=1,a-=1;else break}!n[s].endsWith(`
`)&&n[s].length>0&&(n[s]=`${n[s]}
`);for(let l=0;l<n.length;l++)n[l]=n[l].replace(/\r\n/g,`
`);return{stripped:n,trueStartLine:i}}handleContentChange(e,t,n){let i=t.range.start.line-t.range.end.line+t.text.split(`
`).length-1,o=t.text.length-t.rangeLength,s=t.rangeLength<=0?t.rangeOffset:t.rangeOffset+t.rangeLength-1;n.forEach(a=>{a.endOffset<t.rangeOffset||(a.startOffset>s?(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.startOffset===s?a.deleted||t.rangeLength>0||i===0?a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode:(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode)})}addHiddenLines(e,t,n,i,o,s){let a=s||this.configService.getSettings(void 0).forceIPyKernelDebugger===!0;return e&&this.configService.getSettings(this.notebook.uri).stopOnFirstLineWhileDebugging?a?(t.splice(0,0,`breakpoint()
`),{runtimeLine:1,debuggerStartLine:n+1}):(t.splice(0,0,`breakpoint()
`),{runtimeLine:2,debuggerStartLine:n}):{runtimeLine:1,debuggerStartLine:o?i:i+1}}};var Fee=require("vscode");var M_=class{constructor(e,t,n){this.configService=e;this.storageFactory=t;this.disposables=n;this.codeGenerators=new WeakMap}activate(){Fee.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebook,this,this.disposables)}getOrCreate(e){let t=this.get(e);if(t)return t;let n=new ZM(this.configService,this.storageFactory.getOrCreate(e),e,this.disposables);return this.codeGenerators.set(e,n),n}get(e){return this.codeGenerators.get(e)}onDidCloseNotebook(e){var t;(t=this.codeGenerators.get(e))==null||t.dispose(),this.codeGenerators.delete(e)}};M_=U([(0,O_.injectable)(),x(0,(0,O_.inject)(Ke)),x(1,(0,O_.inject)(Na)),x(2,(0,O_.inject)(ve))],M_);p();var Uee=se(ge()),Wee=require("vscode");p();var eO=class{constructor(){this.codeGeneratorsByFile=new gu}clear(){this.codeGeneratorsByFile.clear()}get all(){return[...this.codeGeneratorsByFile.entries()].map(e=>({uri:e[0],generatedCodes:e[1].filter(t=>!t.deleted)})).filter(e=>e.generatedCodes.length>0)}getFileGeneratedCode(e){return this.codeGeneratorsByFile.get(e)||[]}store(e,t){let n=this.codeGeneratorsByFile.get(e)||[],i=!1;for(let o=0;o<n.length&&!i;o+=1){let s=n[o];t.line>=s.line&&t.line<=s.endLine?(n.splice(o,1,t),i=!0):s.line>t.line&&(n.splice(o,0,t),i=!0)}i||n.push(t),this.codeGeneratorsByFile.set(e,n)}};var L_=class{constructor(){this.storages=new WeakMap}getOrCreate(e){return this.storages.has(e)||this.storages.set(e,new eO),this.storages.get(e)}get(e){if("notebook"in e)return this.storages.get(e.notebook);{let t=Wee.workspace.notebookDocuments.find(n=>{let i=this.storages.get(n);return i==null?void 0:i.all.find(o=>o.uri.toString()===e.fileUri.toString())});return t?this.storages.get(t):void 0}}};L_=U([(0,Uee.injectable)()],L_);p();var ap=se(ge());var K_=class{constructor(e,t,n,i,o,s){this.kernelProvider=e;this.codeGeneratorFactory=n;this.storageFactory=i;this.controllers=o;this.replTracker=s;this.disposables=[];t.push(this)}dispose(){Ce(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.controllers.onControllerSelected(this.onNotebookControllerSelected,this,this.disposables)}onNotebookControllerSelected({notebook:e}){var t,n;(t=this.storageFactory.get({notebook:e}))==null||t.clear(),(n=this.codeGeneratorFactory.get(e))==null||n.reset()}onDidCreateKernel(e){var n;let t=e.notebook;e.creator!=="jupyterExtension"||this.replTracker.isForReplEditor(t)||((n=this.storageFactory.get({notebook:t}))==null||n.clear(),e.onRestarted(()=>{var i;(i=this.storageFactory.get({notebook:t}))==null||i.clear(),this.codeGeneratorFactory.getOrCreate(t).reset()},this,this.disposables))}};K_=U([(0,ap.injectable)(),x(0,(0,ap.inject)(qe)),x(1,(0,ap.inject)(ve)),x(2,(0,ap.inject)(D_)),x(3,(0,ap.inject)(Na)),x(4,(0,ap.inject)(Nt)),x(5,(0,ap.inject)(Iu))],K_);p();var _v=se(ge()),_te=require("vscode");var Ite=Ste(),rO=/(;32m[ ->]*?)(\d+)(.*)/g,F_=class{constructor(e,t,n,i){this.storageFactory=e;this.platformService=t;this.configurationService=n;this.replTracker=i}format(e,t){var a;if(!this.replTracker.isForReplEditor(e.notebook))return t;let n=this.storageFactory.get({notebook:e.notebook}),i=t.some(l=>/^[Input|Cell|File].*?\n.*/.test(l));if(!i&&!n)return t;let o=this.configurationService.getSettings(e.document.uri),s=(a=o==null?void 0:o.formatStackTraces)!=null?a:!1;return t.map(l=>i?this.modifyTracebackFrameIPython8(l,n==null?void 0:n.all,s):s?this.modifyTracebackFrameIPython7(l,n.all):l)}modifyTracebackFrameIPython8(e,t,n){var c,d,f,m,g;e=e.replace(/\u001b\[4\dm/g,""),e=e.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),e=e.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(b,y,P,A)=>(A=A.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${y}${P}${A}
`)),w.ci(`Trace frame to match: ${e}`);let i,o,s=/Cell\s+(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,l=/Input\s+?(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\].*line: (?<lineNumber>\d).*/.exec(e),u=s.exec(e);if(l&&((c=l.groups)!=null&&c.executionCount)&&((d=l.groups)!=null&&d.lineNumber)?(i=parseInt(l.groups.executionCount),o=(f=l.groups)==null?void 0:f.lineNumber):u&&((m=u.groups)!=null&&m.executionCount)&&((g=u.groups)!=null&&g.lineNumber)&&(i=parseInt(u.groups.executionCount),o=u.groups.lineNumber),t&&i){let b,y;for(let P of t)if(y=P.generatedCodes.find(A=>A.executionCount===i),y){b=P.uri;break}if(y&&b){let P=e;return n&&(P=P.replace(rO,(A,D,T,K)=>{let L=parseInt(T,10),O=(y.hasCellMarker?y.line-1:y.line)-1+y.lineOffsetRelativeToIndexOfFirstLineInCell+L;return`${D}<a href='${b==null?void 0:b.toString()}?line=${O-1}'>${O}</a>${K}`})),P.replace(/.*?\n/,`File \x1B[1;32m${lt(b)}:${o}\x1B[0m
`)}}if(n){let b=/^File.*?\[\d;32m(.*):\d+.*\u001b.*\n/.exec(e);if(b&&b.length>1){let y=wD(b[1],lt(this.platformService.homeDir)),P=_te.Uri.file(y);return e.replace(rO,(A,D,T,K)=>{let L=parseInt(T,10);return`${D}<a href='${P==null?void 0:P.toString()}?line=${L-1}'>${L}</a>${K}`})}}return e}modifyTracebackFrameIPython7(e,t){return t.map(i=>i.uri).forEach(i=>{let o=lt(i),s=Ee(i),a=this.storageFactory.get({fileUri:i});if(a){if(e.includes(o)&&new RegExp(`\\[.*?;32m${Ite(o)}`).test(e)||e.includes(s)&&new RegExp(`\\[.*?;32m${Ite(s)}`).test(e)){let l="",u=/(;32m[ ->]*?)(\d+)(.*)/g;for(let d=u.exec(e);d&&d.length>3;d=u.exec(e)){let f=hu(d[3]).substr(1);l=`${l}${f}
`}let c=this.findCellOffset(a.getFileGeneratedCode(i),l);c!==void 0&&(e=e.replace(rO,(d,f,m,g)=>{let b=parseInt(m,10),y=c+b-1;return`${f}<a href='${i.toString()}?line=${y}'>${y+1}</a>${g}`}))}if(e.includes(o)){let l=this.findCellOffset(a.getFileGeneratedCode(i),e);if(l)return e.replace(rO,(u,c,d,f)=>{let m=parseInt(d,10),g=l+m-1;return`${c}<a href='${i.toString()}?line=${g}'>${g+1}</a>${f}`})}}}),e}findCellOffset(e,t){if(e){for(let n of e)if(n.trimmedRightCode.indexOf(t)>=0)return n.firstNonBlankLineIndex}}};F_=U([(0,_v.injectable)(),x(0,(0,_v.inject)(Na)),x(1,(0,_v.inject)(us)),x(2,(0,_v.inject)(Ke)),x(3,(0,_v.inject)(Iu))],F_);p();var Cu=se(ge()),Dm=require("vscode");p();function Ete(r){let e={source:{path:lt(r.uri)},pydevdSourceMaps:[]};return e.pydevdSourceMaps=r.generatedCodes.map(t=>({line:t.debuggerStartLine,endLine:t.endLine,runtimeSource:{path:t.runtimeFile},runtimeLine:t.runtimeLine})),e}p();var nO=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;this._ready=Re();this.ready=this._ready.promise;ne("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){w.debug(`[Debug-IW] ${e}: ${t}`)}async willSendEvent(e){return b9(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&AP(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){let t=ql(this.debugCell);e.command==="setBreakpoints"&&t&&t.generatedCode&&!this.cellDumpInvoked&&(this.debugCellDumped||(this.debugCellDumped=mv(this.execution,this.debugAdapter)),await this.debugCellDumped),e.command==="configurationDone"&&t&&t.generatedCode&&(this.debugCellDumped||(this.debugCellDumped=mv(this.execution,this.debugAdapter)),await this.debugCellDumped,this._ready.resolve())}};p();var iO=class extends u_{constructor(){super(...arguments);this._ready=Re();this.ready=this._ready.promise}resolve(){this._ready.resolve()}};p();var P9=require("vscode");var oO=class extends p_{constructor(t,n,i,o,s,a,l){super(t,n,i,o,s,a);this.cellToDebugFileSortedInReverseOrderByLineNumber=[];l&&(this.debugLocationTracker=l.createDebugAdapterTracker(t),this.debugLocationTracker.onWillStartSession&&this.debugLocationTracker.onWillStartSession(),this.onDidSendMessage(u=>{var c;(c=this.debugLocationTracker)!=null&&c.onDidSendMessage&&this.debugLocationTracker.onDidSendMessage(u)},this,this.disposables),this.onDidEndSession(()=>{var u;(u=this.debugLocationTracker)!=null&&u.onWillStopSession&&this.debugLocationTracker.onWillStopSession()},this,this.disposables))}handleClientMessageAsync(t){var n,i;return w.ci(`KernelDebugAdapter::handleMessage ${JSON.stringify(t,void 0," ")}`),t.type==="request"&&((n=this.debugLocationTracker)!=null&&n.onWillReceiveMessage)&&this.debugLocationTracker.onWillReceiveMessage(t),t.type==="response"&&((i=this.debugLocationTracker)!=null&&i.onDidSendMessage)&&this.debugLocationTracker.onDidSendMessage(t),super.handleClientMessageAsync(t)}async dumpCell(t){var o,s;let n=this.notebookDocument.cellAt(t),i=ql(n);if(!i)throw new Error("Not an interactive window cell");try{let a=(((o=i.generatedCode)==null?void 0:o.code)||n.document.getText()).replace(/\r\n/g,`
`),l=await this.session.customRequest("dumpCell",{code:a}),u=bs(l.sourcePath);this.fileToCell.set(u,P9.Uri.parse(i.interactive.uristring));let c=0;i.generatedCode&&!i.generatedCode.hasCellMarker&&(c=i.generatedCode.firstNonBlankLineIndex),this.cellToDebugFileSortedInReverseOrderByLineNumber.push({debugFilePath:u,interactiveWindow:P9.Uri.parse(i.interactive.uristring),metadata:i,lineOffset:c+i.interactive.lineIndex+(((s=i.generatedCode)==null?void 0:s.lineOffsetRelativeToIndexOfFirstLineInCell)||0)}),this.cellToDebugFileSortedInReverseOrderByLineNumber.sort((d,f)=>f.metadata.interactive.lineIndex-d.metadata.interactive.lineIndex)}catch(a){w.error(`Failed to dump cell for ${n.index} with code ${i.interactive.originalSource}`,a)}}translateDebuggerLocationToRealLocation(t,n){var o;if(n=(o=t==null?void 0:t.source)!=null?o:n,!n||!n.path)return;let i=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(s=>s.debugFilePath===n.path);i&&(n.name=Zt(i.interactiveWindow.path),n.path=i.interactiveWindow.toString(),typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine+(i.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line+(i.lineOffset||0)))}translateRealLocationToDebuggerLocation(t,n){var s;let i=t.line;if(n=(s=t==null?void 0:t.source)!=null?s:n,!n||!n.path||typeof i!="number")return;let o=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(a=>i>=a.metadata.interactive.lineIndex+1);!o||o.interactiveWindow.path!==n.path||(n.path=o.debugFilePath,typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine-(o.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line-(o.lineOffset||0)))}async sendRequestToJupyterSession(t){var n,i;if(t.command==="setBreakpoints"){let o=t.arguments;if(delete o.lines,o.source.path!==((n=this.cellToDebugFileSortedInReverseOrderByLineNumber[0])==null?void 0:n.interactiveWindow.path))return super.sendRequestToJupyterSession(t);let s,a=[],l=[],u=()=>{if(a.length){let f=JSON.parse(JSON.stringify(t));f.arguments.breakpoints=a,l.push(super.sendRequestToJupyterSession(f))}};for(let f of(i=t.arguments.breakpoints)!=null?i:[]){let m=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(g=>f.line>=g.metadata.generatedCode.line&&f.line<=g.metadata.generatedCode.endLine);if(m&&m.metadata.interactive.lineIndex!==s)u(),s=m.metadata.interactive.lineIndex,a=[f];else if(m)a.push(f);else{let g={...f,verified:!0};l.push(Promise.resolve({body:{breakpoints:[g]}}))}}u();let c=await Promise.all(l),d=JSON.parse(JSON.stringify(c[0]));return c.slice(1).forEach(f=>{var m;d.body.breakpoints=d.body.breakpoints.concat((m=f.body.breakpoints)!=null?m:[])}),d.command="setBreakpoints",d.type="response",d.success=!0,d.request_seq=t.seq,d}return super.sendRequestToJupyterSession(t)}getDumpFilesForDeletion(){return this.cellToDebugFileSortedInReverseOrderByLineNumber.map(t=>t.debugFilePath)}};p();var Cte=require("vscode");var sO=class{constructor(e){this.debugCell=e}trace(e,t){w.debug(`[Debug-IWRestart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Showing warning for unsupported restart request"),Cte.window.showWarningMessage(W.restartNotSupported,{modal:!0}).then(E,E),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};var U_=class extends d_{constructor(t,n,i,o,s,a,l){super(t,n,l);this.platform=i;this.debugLocationTrackerFactory=o;this.configService=s;this.debugService=a}activate(){super.activate(),this.disposables.push(Dm.debug.registerDebugAdapterDescriptorFactory(lK,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){return 2}async start(t,n){w.ci("Starting debugging IW"),await this.checkIpykernelAndPrompt(n)===1&&await this.startDebuggingCell(t,n)}async startDebuggingCell(t,n){let i=this.configService.getSettings(t.uri),o={type:lK,name:Zt(t.uri.toString()),request:"attach",justMyCode:i.debugJustMyCode,__notebookUri:t.uri.toString(),__mode:2,__cellIndex:n.index},s={suppressSaveBeforeStart:!0};await this.startDebuggingConfig(o,s);let a=this.notebookToDebugger.get(t);if(!a){w.error("Debugger not found, could not start debugging.");return}await a.ready}async createDebugAdapterDescriptor(t){let n=t.configuration;vee(n);let i=Dm.workspace.notebookDocuments.find(s=>s.uri.toString()===n.__notebookUri);if(!i||typeof n.__cellIndex!="number"){w.error("Invalid debug session for debugging of IW using Jupyter Protocol");return}if(this.notebookInProgress.has(i)){w.info("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(i)){w.info("Cannot start debugging. Already debugging this notebook document. Toolbar should update");return}let o=new iO(i,n,t);this.notebookToDebugger.set(i,o);try{return this.notebookInProgress.add(i),await this.doCreateDebugAdapterDescriptor(n,t,i,o)}finally{this.notebookInProgress.delete(i)}}async doCreateDebugAdapterDescriptor(t,n,i,o){let s=await this.ensureKernelIsRunning(i);if(!(s!=null&&s.session)){Dm.window.showInformationMessage(W.kernelWasNotStarted).then(E,E);return}let a=new oO(n,i,s.session,s,this.platform,this.debugService,this.debugLocationTrackerFactory);this.disposables.push(a.onDidEndSession(this.endSession.bind(this)));let l=i.cellAt(t.__cellIndex),u=new nO(a,l,this.kernelProvider.getKernelExecution(s));return a.addDebuggingDelegates([u,new sO(l)]),u.ready.then(()=>o.resolve()).catch(c=>console.error("Failed waiting for controller to be ready",c)),this.trackDebugAdapter(i,a),new Dm.DebugAdapterInlineImplementation(a)}async updateSourceMaps(t,n){let i=this.getDebugSession(t.notebook);i&&(w.ci("Sending debug request for source map"),await Promise.all(n.map(async o=>{if(i)return i.customRequest("setPydevdSourceMap",Ete(o))})))}};U_=U([(0,Cu.injectable)(),x(0,(0,Cu.inject)(qe)),x(1,(0,Cu.inject)(Nt)),x(2,(0,Cu.inject)(us)),x(3,(0,Cu.inject)(_M)),x(4,(0,Cu.inject)(Ke)),x(5,(0,Cu.inject)(so)),x(6,(0,Cu.inject)(Nr))],U_);p();var Ev=se(ge()),wte=require("vscode");var W_=class{constructor(e,t,n,i){this.configService=e;this.fs=t;this.context=n;this.registry=i;this.priority=5}activate(){this.registry.register(this,vr)}async getCode(e){if(!jt(e.kernelConnectionMetadata))return[];if(!_n()){if(this.configService.getSettings(void 0).forceIPyKernelDebugger===!0)return[];if(!zt(e.kernelConnectionMetadata))return[]}if(!zt(e.kernelConnectionMetadata))return[];this.addRunCellHookContents||(this.addRunCellHookContents=this.fs.readFile(wte.Uri.joinPath(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","kernel","addRunCellHook.py")));let t=await this.addRunCellHookContents;return at(t,{trim:!1})}};W_=U([(0,Ev.injectable)(),x(0,(0,Ev.inject)(Ke)),x(1,(0,Ev.inject)(Pt)),x(2,(0,Ev.inject)(st)),x(3,(0,Ev.inject)(Md))],W_);p();var j_=se(ge()),B_=require("vscode");var V_=class{constructor(e,t,n){this.dataScienceCodeLensProvider=e;this.extensionContext=t;this.configurationService=n}activate(){this.configurationService.getSettings().pythonCellFolding&&this.extensionContext.subscriptions.push(B_.languages.registerFoldingRangeProvider([lD],this))}provideFoldingRanges(e,t,n){if([Xl,Uv].includes(e.uri.scheme))return;let i=this.dataScienceCodeLensProvider.getCodeWatcher(e);if(i){let o=i.getCodeLenses();return n.isCancellationRequested||o.length==0?void 0:o.map(s=>new B_.FoldingRange(s.range.start.line,s.range.end.line,B_.FoldingRangeKind.Region))}}};V_=U([(0,j_.injectable)(),x(0,(0,j_.inject)(Cm)),x(1,(0,j_.inject)(st)),x(2,(0,j_.inject)(Ke))],V_);p();var q_=se(ge());var xte=require("vscode");var H_=class{constructor(e,t,n){this.dataScienceCodeLensProvider=e;this.extensionContext=t}activate(){this.extensionContext.subscriptions.push(xte.languages.registerCodeLensProvider([lD],this.dataScienceCodeLensProvider))}};H_=U([(0,q_.injectable)(),x(0,(0,q_.inject)(Cm)),x(1,(0,q_.inject)(st)),x(2,(0,q_.inject)(wm))],H_);p();var Aa=se(ge());var D9="LastInteractiveKernelSelected",J_=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.interpreterService=t;this.disposables=n;this.workspaceMemento=i;this.serviceContainer=o;this.onControllerSelected=this.controllerRegistration.onControllerSelected}async getInitialController(e,t,n){if(n){let i=this.controllerRegistration.get(n,t);if(i)return i}if(this.workspaceMemento.get(D9)){let i=this.workspaceMemento.get(D9),o=i?this.controllerRegistration.get(i,t):void 0;if(o)return o}if(this.interpreterService)return await iEe(t,e,this.interpreterService,this.controllerRegistration)}getSelectedController(e){return this.controllerRegistration.getSelected(e)}getRegisteredController(e){return this.controllerRegistration.get(e,"interactive")}async createKernel(e,t,n,i,o){await Ol(n,e);let s=(c,d)=>{c!=="start"&&c!=="restart"||w.ci(`(onStart) Looking for controller ${d.controller.id} in ${this.controllerRegistration.all.map(f=>`${f.kind}:${f.id}`).join(", ")}`)},a=await Ta.connectToNotebookKernel(e,this.serviceContainer,{resource:n||i.uri,notebook:i,controller:t},new hr(!1),o,"jupyterExtension",s),l=this.controllerRegistration.registered.find(c=>c.id===a.controller.id);if(!l)throw Error(`Controller ${a.controller.id} not found or not yet created`);let u=l.controller;return this.interpreterService&&oEe(a.kernelConnectionMetadata,n,this.interpreterService).then(async c=>{await this.workspaceMemento.update(D9,c?void 0:a.kernelConnectionMetadata)}).catch(c=>{w.warn("Failed to store kernel connection metadata",c)}),{kernel:a,actualController:u}}};J_=U([(0,Aa.injectable)(),x(0,(0,Aa.inject)(Nt)),x(1,(0,Aa.inject)(cm)),x(1,(0,Aa.optional)()),x(2,(0,Aa.inject)(ve)),x(3,(0,Aa.inject)(_t)),x(3,(0,Aa.named)(Is)),x(4,(0,Aa.inject)(Nr))],J_);async function iEe(r,e,t,n){let i=await t.getActiveInterpreter(e);if(i){let o=await zx(i),s=Jx.create({kernelSpec:o,interpreter:i,id:mR(o,i)}),a=n.addOrUpdate(s,[r]),l=a[0];return n.trackActiveInterpreterControllers(a),w.ci(`Active Interpreter Controller ${l.connection.kind}:${l.id} created for View ${r} with resource ${Ee(e)}`),l}}async function oEe(r,e,t){var i;let n=await t.getActiveInterpreter(e);return(n==null?void 0:n.id)===((i=r.interpreter)==null?void 0:i.id)}p();var Cv=se(require("vscode")),aO=se(ge());var G_=class{constructor(e){this.configService=e;this.cache=new Map;this.disposables=[];this.cachedOwnsSetting=this.configService.getSettings(void 0).sendSelectionToInteractiveWindow,Cv.workspace.onDidChangeConfiguration(this.onSettingChanged,this,this.disposables),Cv.window.onDidChangeActiveTextEditor(this.onChangedActiveTextEditor,this,this.disposables),this.onChangedActiveTextEditor(),Cv.workspace.onDidCloseTextDocument(this.onClosedDocument,this,this.disposables)}getCellRanges(e){let t=this.cache.get(e.uri);if(t&&t.version===e.version)return t.ranges;let n=this.configService.getSettings(e.uri),i=E9(e,n);return this.cache.set(e.uri,{version:e.version,ranges:i}),this.updateContextKeys(e),i}clear(){this.cache.clear()}onChangedActiveTextEditor(){let e=Cv.window.activeTextEditor;!e||e.document.languageId!=Ye||[Xl,Uv].includes(e.document.uri.scheme)?(new pr(gr.HasCodeCells).set(!1).catch(n=>w.warn("Failed to set jupyter.HasCodeCells context",n)),this.updateContextKeys(!1)):this.updateContextKeys(e.document)}onSettingChanged(e){if(this.cache.clear(),e.affectsConfiguration("jupyter.interactiveWindow.textEditor.executeSelection")){let t=this.configService.getSettings(void 0);this.cachedOwnsSetting=t.sendSelectionToInteractiveWindow,this.updateContextKeys()}}updateContextKeys(e){var n;let t=!1;if(typeof e=="boolean")t=e;else{let i=e!=null?e:(n=Cv.window.activeTextEditor)==null?void 0:n.document;t=i?this.getCellRanges(i).length>0:!1}new pr(gr.OwnsSelection).set(this.cachedOwnsSetting||t).catch(E),new pr(gr.HasCodeCells).set(t).catch(E)}onClosedDocument(e){this.cache.delete(e.uri)}dispose(){this.disposables.forEach(e=>e.dispose())}};G_=U([(0,aO.injectable)(),x(0,(0,aO.inject)(Ke))],G_);function Pte(r){r.addSingleton(lo,A_),r.addSingleton(Iu,R_),r.addSingleton(qM,J_),r.addSingleton(Ve,hs),r.addSingleton(wm,G_),r.add(BM,tr),r.addSingleton(HM,T_),r.addSingleton(Cm,k_),r.addSingleton(Ve,H_),r.addSingleton(Ve,V_),r.addSingleton(Ve,N_),r.addSingleton(Ve,K_),r.addSingleton(D_,M_,void 0,[Ve]),r.addSingleton(Na,L_),r.addSingleton(wS,F_),r.addSingleton(JM,U_,void 0,[Ve]),r.addSingleton(Ve,W_)}p();p();var Dte=se(ge());p();var uo=require("vscode");var lO=class{async normalizeLines(e,t){return e}async getFileToExecute(){let e=uo.window.activeTextEditor;if(!e){uo.window.showErrorMessage("No open file to run in terminal").then(E,E);return}if(e.document.isUntitled){uo.window.showErrorMessage("The active file needs to be saved before it can be run").then(E,E);return}if(e.document.languageId!==Ye){uo.window.showErrorMessage("The active file is not a Python source file").then(E,E);return}return e.document.isDirty&&await e.document.save(),e.document.uri}getSelectedTextToExecute(e){if(!e)return;let t=e.selection,n;return t.isEmpty?n=e.document.lineAt(t.start.line).text:t.isSingleLine?n=this.getSingleLineSelectionText(e):n=this.getMultiLineSelectionText(e),Yv(n.trimEnd())}async saveFileIfDirty(e){let t=uo.workspace.textDocuments.filter(n=>n.uri.path===e.path);t.length===1&&t[0].isDirty&&await t[0].save()}getSingleLineSelectionText(e){let t=e.selection,n=new uo.Range(t.start,t.end),i=e.document.getText(n),o=e.document.lineAt(t.start.line).text;return i.trim()===o.trim()?o:i}getMultiLineSelectionText(e){let t=e.selection,n=new uo.Range(t.start,t.end),i=e.document.getText(n),o=new uo.Range(new uo.Position(t.start.line,0),new uo.Position(t.end.line,e.document.lineAt(t.end.line).text.length)),s=e.document.getText(o);if(i.trim()===s.trim())return s;let a=e.document.lineAt(t.start.line).text,l=new uo.Range(t.start,new uo.Position(t.start.line,a.length)),u=e.document.getText(l);return u.trimStart()===a.trimStart()?a+i.substring(u.length):i}};var Y_=class extends lO{};Y_=U([(0,Dte.injectable)()],Y_);function Tte(r){r.addSingleton(XM,Y_)}p();p();var Ma=se(ge());p();var qs=require("vscode");var cO=class{constructor(e,t,n,i,o,s){this.fileConverter=e;this.fs=t;this.interactiveProvider=n;this.controllerRegistration=i;this.preferredKernel=o;this.kernelFinder=s;this.disposables=[]}register(){this.registerCommand(le.ExportAsPythonScript,(e,t)=>this.export(e,"python",void 0,t)),this.registerCommand(le.ExportToHTML,(e,t,n)=>this.export(e,"html",t,n)),this.registerCommand(le.ExportToPDF,(e,t,n)=>this.export(e,"pdf",t,n)),this.registerCommand(le.Export,(e,t,n)=>this.export(e,void 0,t,n)),this.registerCommand(le.NativeNotebookExport,e=>this.nativeNotebookExport(e))}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommand(e,t){let n=qs.commands.registerCommand(e,t,this);this.disposables.push(n)}async nativeNotebookExport(e){var i,o,s;let t=pi(e)?e:(i=e==null?void 0:e.notebookEditor)==null?void 0:i.notebookUri,n=t?qs.workspace.notebookDocuments.find(a=>this.fs.arePathsSame(a.uri,t)):(o=qs.window.activeNotebookEditor)==null?void 0:o.notebook;if(n){let a,l=this.kernelFinder.registered.find(d=>d.kind==="localPythonEnvironment"),u=new qs.CancellationTokenSource;try{a=l?await this.preferredKernel.findPreferredLocalKernelSpecConnection(n,l,u.token).then(d=>d==null?void 0:d.interpreter):void 0}finally{u.dispose()}let c=((s=this.controllerRegistration.getSelected(n))==null?void 0:s.connection.interpreter)||a;return this.export(n,void 0,void 0,c)}else return this.export(void 0,void 0,void 0,void 0)}async export(e,t,n,i){var o,s,a,l;if(!e){if(e=((o=qs.window.activeNotebookEditor)==null?void 0:o.notebook)||((a=(s=this.interactiveProvider)==null?void 0:s.getActiveOrAssociatedInteractiveWindow())==null?void 0:a.notebookDocument),!e){w.info("Export called without a valid exportable document active");return}i=i||((l=this.controllerRegistration.getSelected(e))==null?void 0:l.connection.interpreter),t&&ne("DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",void 0,{format:t})}if(t)await this.fileConverter.export(t,e,n,i);else{let u=await this.showExportQuickPickMenu(e,n,i).then(c=>c);u!==void 0?u.handler():ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK")}}getExportQuickPickItems(e,t,n){let i=[];return(n||e.metadata&&pR(_a(e)))&&i.push({label:W.exportPythonQuickPickLabel,picked:!0,handler:()=>{ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"python"}),qs.commands.executeCommand(le.ExportAsPythonScript,e,n).then(E,E)}}),i.push({label:W.exportHTMLQuickPickLabel,picked:!1,handler:()=>{ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"html"}),qs.commands.executeCommand(le.ExportToHTML,e,t,n).then(E,E)}},{label:W.exportPDFQuickPickLabel,picked:!1,handler:()=>{ne("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"pdf"}),qs.commands.executeCommand(le.ExportToPDF,e,t,n).then(E,E)}}),i}async showExportQuickPickMenu(e,t,n){let i=this.getExportQuickPickItems(e,t,n),o={ignoreFocusOut:!1,matchOnDescription:!0,matchOnDetail:!0,placeHolder:W.exportAsQuickPickPlaceholder};return qs.window.showQuickPick(i,o)}};var uO=require("vscode");var $_=class{constructor(e,t,n,i,o,s,a){this.disposables=e;this.fileConverter=t;this.fs=n;this.interactiveProvider=i;this.controllerSelection=o;this.kernelFinder=s;this.jupyterConnection=a;this.exportCommand=new cO(this.fileConverter,this.fs,this.interactiveProvider,o,new i_(a),s),uO.workspace.isTrusted||uO.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){var e;uO.workspace.isTrusted&&((e=this.exportCommand)==null||e.register())}};$_=U([(0,Ma.injectable)(),x(0,(0,Ma.inject)(ve)),x(1,(0,Ma.inject)(g_)),x(2,(0,Ma.inject)(Pt)),x(3,(0,Ma.inject)(lo)),x(3,(0,Ma.optional)()),x(4,(0,Ma.inject)(Nt)),x(5,(0,Ma.inject)(oi)),x(6,(0,Ma.inject)(pn))],$_);p();var wu=se(ge()),Js=require("vscode");var z_=class{constructor(e,t,n,i,o){this.interactiveProvider=e;this.kernelProvider=n;this.controllers=i;this.jupyterUriProviderRegistration=o;this.disposables=[];this.isPythonFileActive=!1;this.ownedOpenNotebooks=new Set;t.push(this),this.nativeContext=new pr(gr.IsNativeActive),this.canRestartNotebookKernelContext=new pr(gr.CanRestartNotebookKernel),this.canInterruptNotebookKernelContext=new pr(gr.CanInterruptNotebookKernel),this.canRestartInteractiveWindowKernelContext=new pr(gr.CanRestartInteractiveWindowKernel),this.canInterruptInteractiveWindowKernelContext=new pr(gr.CanInterruptInteractiveWindowKernel),this.interactiveContext=new pr(gr.IsInteractiveActive),this.interactiveOrNativeContext=new pr(gr.IsInteractiveOrNativeActive),this.pythonOrNativeContext=new pr(gr.IsPythonOrNativeActive),this.pythonOrInteractiveContext=new pr(gr.IsPythonOrInteractiveActive),this.pythonOrInteractiveOrNativeContext=new pr(gr.IsPythonOrInteractiveOrNativeActive),this.hasNativeNotebookCells=new pr(gr.HaveNativeCells),this.isPythonNotebook=new pr(gr.IsPythonNotebook),this.isJupyterKernelSelected=new pr(gr.IsJupyterKernelSelected),this.hasNativeNotebookOrInteractiveWindowOpen=new pr(gr.HasNativeNotebookOrInteractiveWindowOpen),this.kernelSourceContext=new pr(gr.KernelSource)}dispose(){this.disposables.forEach(e=>e.dispose())}activate(){var e;Js.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,this.disposables),this.kernelProvider.onKernelStatusChanged(this.onDidKernelStatusChange,this,this.disposables),this.interactiveProvider&&(this.interactiveProvider.onDidChangeActiveInteractiveWindow(this.onDidChangeActiveInteractiveWindow,this,this.disposables),this.interactiveProvider.activeWindow&&this.onDidChangeActiveInteractiveWindow()),Js.window.activeNotebookEditor&&this.onDidChangeActiveNotebookEditor(Js.window.activeNotebookEditor),Js.window.onDidChangeActiveNotebookEditor(this.onDidChangeActiveNotebookEditor,this,this.disposables),((e=Js.window.activeTextEditor)==null?void 0:e.document.languageId)===Ye&&this.onDidChangeActiveTextEditor(Js.window.activeTextEditor),Js.workspace.onDidCloseNotebookDocument(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),this.controllers.onControllerSelectionChanged(()=>this.updateSelectedKernelContext(),this,this.disposables),this.updateSelectedKernelContext()}updateNativeNotebookCellContext(){var t;let e=(((t=Js.window.activeNotebookEditor)==null?void 0:t.notebook.cellCount)||0)>0;this.hasNativeNotebookCells.set(e).catch(E)}onDidChangeActiveInteractiveWindow(e){this.interactiveContext.set(!!e).catch(E),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}onDidChangeActiveNotebookEditor(e){let t=e?e.notebook.notebookType===bt:!1;this.nativeContext.set(t).catch(E),this.isPythonNotebook.set(e&&t?pR(_a(e.notebook)):!1).catch(E),this.updateContextOfActiveNotebookKernel(e),this.updateContextOfActiveInteractiveWindowKernel(),this.updateNativeNotebookCellContext(),this.updateMergedContexts()}updateNativeNotebookInteractiveWindowOpenContext(e,t){t?this.ownedOpenNotebooks.add(e):this.ownedOpenNotebooks.delete(e),this.hasNativeNotebookOrInteractiveWindowOpen.set(this.ownedOpenNotebooks.size>0).catch(E)}updateContextOfActiveNotebookKernel(e){let t=e&&e.notebook.notebookType===bt?this.kernelProvider.get(e.notebook):void 0;if(t){let n=this.kernelProvider.getKernelExecution(t),i=t.status!=="unknown"||n.executionCount>0||t.startedAtLeastOnce;this.canRestartNotebookKernelContext.set(!!i).catch(E);let o=t.status==="busy";this.canInterruptNotebookKernelContext.set(!!o).catch(E)}else this.canRestartNotebookKernelContext.set(!1).catch(E),this.canInterruptNotebookKernelContext.set(!1).catch(E);this.updateKernelSourceContext(t).catch(E),this.updateSelectedKernelContext()}async updateKernelSourceContext(e){if(!e||!Wt(e.kernelConnectionMetadata)){this.kernelSourceContext.set("").catch(E);return}let t=e.kernelConnectionMetadata,n=await this.jupyterUriProviderRegistration.jupyterCollections.find(i=>i.extensionId===t.serverProviderHandle.extensionId&&i.id===t.serverProviderHandle.id);if(!n){this.kernelSourceContext.set("").catch(E);return}this.kernelSourceContext.set(n.id).catch(E)}updateSelectedKernelContext(){var t,n,i;let e=((t=Js.window.activeNotebookEditor)==null?void 0:t.notebook)||((i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument);e&&mr(e)&&this.controllers.getSelected(e)?(this.isJupyterKernelSelected.set(!0).catch(E),this.updateNativeNotebookInteractiveWindowOpenContext(e,!0)):this.isJupyterKernelSelected.set(!1).catch(E)}updateContextOfActiveInteractiveWindowKernel(){var n,i;let e=(i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument,t=e?this.kernelProvider.get(e):void 0;if(t){let o=t.status!=="unknown";this.canRestartInteractiveWindowKernelContext.set(!!o).catch(E);let s=t.status==="busy";this.canInterruptInteractiveWindowKernelContext.set(!!s).catch(E)}else this.canRestartInteractiveWindowKernelContext.set(!1).catch(E),this.canInterruptInteractiveWindowKernelContext.set(!1).catch(E);this.updateSelectedKernelContext()}onDidKernelStatusChange({kernel:e}){var n;let t=e.notebook;t.notebookType===vr?this.updateContextOfActiveInteractiveWindowKernel():t.notebookType===bt&&t===((n=Js.window.activeNotebookEditor)==null?void 0:n.notebook)&&this.updateContextOfActiveNotebookKernel(Js.window.activeNotebookEditor)}onDidChangeActiveTextEditor(e){this.isPythonFileActive=(e==null?void 0:e.document.languageId)===Ye&&!hB(e.document.uri),this.updateNativeNotebookCellContext(),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}updateMergedContexts(){this.interactiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0).catch(E),this.pythonOrNativeContext.set(this.nativeContext.value===!0||this.isPythonFileActive===!0).catch(E),this.pythonOrInteractiveContext.set(this.interactiveContext.value===!0||this.isPythonFileActive===!0).catch(E),this.pythonOrInteractiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0&&this.isPythonFileActive===!0).catch(E)}};z_=U([(0,wu.injectable)(),x(0,(0,wu.inject)(lo)),x(0,(0,wu.optional)()),x(1,(0,wu.inject)(ve)),x(2,(0,wu.inject)(qe)),x(3,(0,wu.inject)(Nt)),x(4,(0,wu.inject)(sr))],z_);p();var lp=se(ge());var Q_=class{constructor(e,t,n){this.disposableRegistry=e;this.rawSupported=t;this.commandListeners=n;this.isDisposed=!1;this.startTime=Date.now()}get activationStartTime(){return this.startTime}activate(){this.disposableRegistry.push(this),this.computeZmqAvailable(),this.commandListeners&&this.commandListeners.forEach(e=>e.register())}async dispose(){this.changeHandler&&(this.changeHandler.dispose(),this.changeHandler=void 0)}computeZmqAvailable(){new pr(gr.ZmqAvailable).set(this.rawSupported?this.rawSupported.isSupported:!1).then(E,E)}};Q_=U([(0,lp.injectable)(),x(0,(0,lp.inject)(ve)),x(1,(0,lp.inject)(Hd)),x(1,(0,lp.optional)()),x(2,(0,lp.multiInject)(py))],Q_);p();var Tm=se(ge()),xu=require("vscode");var X_=class{constructor(e,t,n){this.jupyterServerHelper=e;this.fileSystem=t;this.errorHandler=n;this.extractPythonMainVersion=async()=>{if(!this.jupyterServerHelper)return 3;let e=await this.jupyterServerHelper.getUsableJupyterPython(),t=await Tp(e);return e&&t&&t.major||3}}async exportToFile(e,t,n=!0){let i=await this.serialize(e);try{if(await this.fileSystem.writeFile(xu.Uri.file(t),i||""),!n)return;let o=W.exportOpenQuestion1;xu.window.showInformationMessage(W.exportDialogComplete(t),o).then(async s=>{try{s===o&&await YM(xu.Uri.file(t))}catch(a){await this.errorHandler.handleError(a)}},E)}catch(o){w.error("Error in exporting notebook file"),xu.window.showInformationMessage(W.exportDialogFailed(o)).then(E,E)}}async serialize(e,t){var a;let n=await this.extractPythonMainVersion(),i={language_info:{codemirror_mode:{name:"ipython",version:n},file_extension:".py",mimetype:"text/x-python",name:"python",nbconvert_exporter:"python",pygments_lexer:`ipython${n}`,version:n},kernelspec:t},o=(a=xu.extensions.getExtension("vscode.ipynb"))==null?void 0:a.exports;if(!o)throw new Error("vscode.ipynb extension not found");let s=new xu.NotebookData(e);return s.metadata={metadata:i,nbformat:oL.major,nbformat_minor:oL.minor},o.exportNotebook(s)}};X_=U([(0,Tm.injectable)(),x(0,(0,Tm.inject)(CR)),x(0,(0,Tm.optional)()),x(1,(0,Tm.inject)(Pt)),x(2,(0,Tm.inject)(dn))],X_);p();var Li=se(ge()),dO=require("vscode");p();var xv=se(ge()),wv=require("vscode");var Nte=require("vscode");var T9="JUPYTER_API_ACCESS_INFORMATION",kte=new Set([Je.split(".")[0],"rchiodo","donjayamanne","SynapseVSCode"]),k9=new Set(["rchiodo","nuant"]),cp=class{constructor(e,t){this.globalState=e;this.context=t;this.extensionAccess=new Map;this.promiseChain=new Bv}async getAccessInformation(e){var s,a;let t=!e.extensionId||e.extensionId===uD?"":e.extensionId.split(".")[0]||"";if(this.context.extensionMode===wv.ExtensionMode.Test||!t||Ud()==="insiders"){if(!kte.has(t)&&!k9.has(t)){w.warn(`Publisher ${t} is allowed to access the Kernel API with a message.`);let l=((a=(s=Nte.extensions.getExtension(e.extensionId))==null?void 0:s.packageJSON)==null?void 0:a.displayName)||"",u=l&&e.extensionId?`${l} (${e.extensionId})`:e.extensionId||t;wv.window.showErrorMessage(W.thanksForUsingJupyterKernelApiPleaseRegisterWithUs(u)).then(E,E)}if(!k9.has(t)||!t||this.context.extensionMode===wv.ExtensionMode.Test)return{extensionId:e.extensionId,accessAllowed:!0}}if(kte.has(t))return{extensionId:e.extensionId,accessAllowed:!0};if(!k9.has(t))return wv.window.showErrorMessage(`Please contact the Jupyter Extension to get access to the Kernel API. Publisher ${t}`).then(E,E),w.error(`Publisher ${t} is not allowed to access the Kernel API.`),{extensionId:e.extensionId,accessAllowed:!1};let n=this.globalState.get(T9),i=n==null?void 0:n.find(l=>l.extensionId===e.extensionId);if(i)return ne("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:i.allowed}),{extensionId:e.extensionId,accessAllowed:i.allowed==="yes"};if(this.extensionAccess.get(e.extensionId))return this.extensionAccess.get(e.extensionId);let o=(async()=>{let l=W.allowExtensionToUseJupyterKernelApi(`${e.displayName} (${e.extensionId})`,Ue.bannerLabelYes),c=await wv.window.showInformationMessage(l,{modal:!0},Ue.bannerLabelYes,Ue.bannerLabelNo)===Ue.bannerLabelYes;return this.promiseChain.chainFinally(async()=>{let d=[...this.globalState.get(T9,[])];return d=d.filter(f=>f.extensionId!==e.extensionId),d.push({allowed:c?"yes":"no",extensionId:e.extensionId}),this.globalState.update(T9,d)}).then(E,E),ne("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:c?"yes":"no"}),{extensionId:e.extensionId,accessAllowed:c}})();return this.extensionAccess.set(e.extensionId,o),o}};cp=U([(0,xv.injectable)(),x(0,(0,xv.inject)(_t)),x(0,(0,xv.named)(rr)),x(1,(0,xv.inject)(st))],cp);p();var Rte=new WeakMap;function N9(r){let e=Rte.get(r);return e||(e=sEe(r),Rte.set(r,e)),e}function sEe(r){return new Proxy(r,{get(e,t){return t==="kernel"?e.kernel?aEe(e.kernel):void 0:Reflect.get(e,t)}})}var Ate=new WeakMap;function aEe(r){let e=Ate.get(r);return e||(e=lEe(r),Ate.set(r,e)),e}function lEe(r){return new Proxy(r,{get(e,t){return t==="registerCommTarget"?(n,i)=>(CZ(r,n),Reflect.get(e,t).apply(e,[n,i])):t==="removeCommTarget"?(n,i)=>(wZ(r,n),Reflect.get(e,t).apply(e,[n,i])):Reflect.get(e,t)}})}var Z_=class{constructor(e,t,n,i,o,s,a,l){this.kernelProvider=e;this.kernelFinder=t;this.thirdPartyKernelProvider=n;this.disposables=i;this.controllerRegistration=o;this.apiAccess=s;this.extensions=a;this.serviceContainer=l;this.chainedApiAccess=new Bv;this.extensionApi=new Map}async getService(){let e=this.extensions.determineExtensionFromCallStack(),t=await this.chainedApiAccess.chainFinally(()=>this.apiAccess.getAccessInformation(e));if(!t.accessAllowed)return;if(this.extensionApi.get(t.extensionId))return this.extensionApi.get(t.extensionId);let n=new qP(t.extensionId,this.kernelProvider,this.kernelFinder,this.thirdPartyKernelProvider,this.disposables,this.controllerRegistration,this.serviceContainer);return this.extensionApi.set(t.extensionId,n),n}};Z_=U([(0,Li.injectable)(),x(0,(0,Li.inject)(qe)),x(1,(0,Li.inject)(oi)),x(2,(0,Li.inject)(Ug)),x(3,(0,Li.inject)(ve)),x(4,(0,Li.inject)(Nt)),x(5,(0,Li.inject)(cp)),x(6,(0,Li.inject)(Ba)),x(7,(0,Li.inject)(Nr))],Z_);var qP=class{constructor(e,t,n,i,o,s,a){this.callingExtensionId=e;this.kernelProvider=t;this.kernelFinder=n;this.thirdPartyKernelProvider=i;this.disposables=o;this.controllerRegistration=s;this.serviceContainer=a;this._onDidChangeKernelSpecifications=new dO.EventEmitter;this._onDidChangeKernels=new dO.EventEmitter;this.translatedConnections=new WeakMap;this._onDidChangeStatus=new dO.EventEmitter;this._status=this.kernelFinder.status,this.kernelFinder.onDidChangeStatus(()=>{this._status=this.kernelFinder.status,this._onDidChangeStatus.fire()},this,o),this.kernelProvider.onDidDisposeKernel(l=>{var u;w.ci(`Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.kernelProvider.onDidStartKernel(l=>{var u;w.ci(`Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidDisposeKernel(l=>{var u;w.ci(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidStartKernel(l=>{var u;w.ci(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(u=l.kernelConnectionMetadata.interpreter)==null?void 0:u.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.controllerRegistration.onDidChange(()=>this._onDidChangeKernelSpecifications.fire(),this,o)}get onDidChangeKernelSpecifications(){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernelSpecifications"}),w.debug(`API called from ${this.callingExtensionId}`),this._onDidChangeKernelSpecifications.event}get onDidChangeKernels(){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernels"}),this._onDidChangeKernels.event}get status(){return this._status}get onDidChangeStatus(){return this._onDidChangeStatus.event}async getKernelSpecifications(){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernelSpecifications"}),this.kernelFinder.kernels.map(e=>this.translateKernelConnectionMetadataToExportedType(e))}getActiveKernels(){ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getActiveKernels"});let e=[],t=new Set;return this.kernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.kernelProvider.get(n.notebook);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.thirdPartyKernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.thirdPartyKernelProvider.get(n.uri);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.controllerRegistration.registered.forEach(n=>{n.controller.notebookType===bt&&n.connection.kind==="connectToLiveRemoteKernel"&&(!n.connection.kernelModel.id||t.has(n.connection.kernelModel.id)||e.push({metadata:n.connection,uri:void 0,id:n.id}))}),e}getKernel(e){var n;ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernel"});let t=(n=this.thirdPartyKernelProvider.get(e))!=null?n:this.kernelProvider.get(e);if(t!=null&&t.session)return{metadata:this.translateKernelConnectionMetadataToExportedType(t.kernelConnectionMetadata),connection:N9(t.session)}}async startKernel(e,t){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"startKernel"}),this.startOrConnect(e,t)}async connect(e,t){return ne("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"connect"}),this.startOrConnect(e,t)}async startOrConnect(e,t){let n=this.kernelFinder.kernels.find(o=>o.id===e.id);if(!n)throw new Error("Not found");let i=await Ta.connectToKernel(n,this.serviceContainer,{resource:t},new hr(!1),this.disposables,"3rdPartyExtension");if(!(i!=null&&i.session))throw new Error("Not found");return N9(i.session)}translateKernelConnectionMetadataToExportedType(e){if(!this.translatedConnections.has(e)){let t=Object.freeze(Qc.fromJSON(e.toJSON()));this.translatedConnections.set(e,t)}return this.translatedConnections.get(e)}};qP=U([x(1,(0,Li.inject)(qe)),x(2,(0,Li.inject)(oi)),x(3,(0,Li.inject)(Ug)),x(4,(0,Li.inject)(ve)),x(5,(0,Li.inject)(Nt)),x(6,(0,Li.inject)(Nr))],qP);p();var tE=se(ge());var eE=class{constructor(e){this.syncActivationServices=e}activate(){this.syncActivationServices.map(e=>{try{e.activate()}catch(t){w.error(`Error in activating extension, failed in ${e.constructor.name}`,t)}})}};eE=U([(0,tE.injectable)(),x(0,(0,tE.optional)()),x(0,(0,tE.multiInject)(Ve))],eE);p();p();var Yl=require("vscode");p();var Gl=require("vscode");var Ote="version";function Mte(r){return`${Ote}-${r.extension.packageJSON.version||"version"}`}async function Lte(r,e){if(rc())return Gl.Uri.joinPath(r.globalStorageUri,Mte(r));{let t=Gl.Uri.joinPath(Gl.Uri.file(r.globalStorageUri.fsPath),Mte(r));if(e)try{await e.createDirectory(t)}catch(n){w.warn(`Failed to create temp directory (${t.fsPath}), falling back to extension dir`,n),t=Gl.Uri.joinPath(r.extensionUri,"temp"),await e.createDirectory(t)}return t}}async function Kte(r){try{let e=await Gl.workspace.fs.readDirectory(r.globalStorageUri);await Promise.all(e.filter(([t,n])=>t.startsWith(Ote)&&n===Gl.FileType.Directory).map(([t])=>Gl.workspace.fs.delete(Gl.Uri.joinPath(r.globalStorageUri,t),{recursive:!0}))).catch(E)}catch(e){}}function Fte(r,e){e&&Yl.commands.registerCommand("dataScience.ClearCache",async()=>{let t=[];for(let n of r.globalState.keys())t.push(r.globalState.update(n,void 0).then(E,E));for(let n of r.workspaceState.keys())t.push(r.workspaceState.update(n,void 0).then(E,E));t.push(Yl.commands.executeCommand(le.ClearSavedJupyterUris).then(E,E)),await Promise.all(t).catch(E),await Promise.all([Yl.workspace.fs.delete(Yl.Uri.joinPath(r.globalStorageUri,"lastExecutedRemoteCell.json")).then(E,E),Yl.workspace.fs.delete(Yl.Uri.joinPath(r.globalStorageUri,"remoteServersMRUList.json")).then(E,E),Yl.workspace.fs.delete(Yl.Uri.joinPath(r.globalStorageUri,xI)).then(E,E),Kte(r).then(E,E)]),w.info("Cache cleared")})}function Ute(r,e){Fte(r,e)}p();p();var mO=se(ge()),Jt=require("vscode");var pO=W.percentPipCondaInstallInsteadOfBang("pip"),R9=W.percentPipCondaInstallInsteadOfBang("conda"),Wte=W.matplotlibWidgetInsteadOfOther,fO="Jupyter",rE=class{constructor(e){this.disposables=[];this.notebooksProcessed=new WeakMap;this.cellsToProcess=new Set;this.problems=Jt.languages.createDiagnosticCollection(fO),this.disposables.push(this.problems),e.push(this)}dispose(){Ce(this.disposables),this.problems.dispose()}activate(){this.disposables.push(Jt.languages.registerCodeActionsProvider(Ye,this)),this.disposables.push(Jt.languages.registerHoverProvider(Ye,this)),Jt.workspace.onDidChangeTextDocument(t=>{let n=lS(t.document);if(!n)return;let i=n.getCells().find(o=>o.document===t.document);i&&this.analyzeNotebookCell(i)},this,this.disposables),Jt.workspace.onDidCloseNotebookDocument(t=>{this.problems.delete(t.uri);let n=this.notebooksProcessed.get(t);this.notebooksProcessed.delete(t),n&&n.forEach((i,o)=>this.problems.delete(Jt.Uri.parse(o)))},this,this.disposables),Jt.workspace.onDidOpenNotebookDocument(t=>this.analyzeNotebook(t),this,this.disposables);let e=new ec(300);this.disposables.push(e),Jt.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>{let n=this.notebooksProcessed.get(t.notebook);t.contentChanges.forEach(i=>{i.removedCells.forEach(o=>{n==null||n.delete(o.document.uri.toString())}),i.addedCells.forEach(o=>this.queueCellForProcessing(o))}),t.cellChanges.forEach(i=>this.queueCellForProcessing(i.cell))})},this,this.disposables),Jt.workspace.notebookDocuments.map(t=>this.analyzeNotebook(t))}provideHover(e,t,n){let i=lS(e);if((i==null?void 0:i.notebookType)!==bt)return;let o=this.problems.get(e.uri);if(!o)return;let s=o.find(l=>l.message===pO||l.message===R9);if(!s||!s.range.contains(t))return;let a=s.message===pO?"pip":"conda";return new Jt.Hover(W.pipCondaInstallHoverWarning(a,"https://aka.ms/jupyterCellMagicBangInstall"),s.range)}provideCodeActions(e,t,n,i){if(!lS(e))return[];let o=[];return n.diagnostics.forEach(s=>{switch(s.message){case pO:o.push(this.createReplaceCodeAction(e,"pip",s));break;case R9:o.push(this.createReplaceCodeAction(e,"conda",s));break;case Wte:o.push(this.createGotoWikiAction(e,Jt.Uri.parse("https://aka.ms/vscodejupytermatplotlibwidget"),s));break;default:break}}),o}createReplaceCodeAction(e,t,n){let i=new Jt.CodeAction(W.replacePipCondaInstallCodeAction(t),Jt.CodeActionKind.QuickFix);i.isPreferred=!0,i.diagnostics=[n];let o=new Jt.WorkspaceEdit;return o.replace(e.uri,new Jt.Range(n.range.start,new Jt.Position(n.range.start.line,n.range.start.character+1)),"%"),i.edit=o,i}createGotoWikiAction(e,t,n){let i=new Jt.CodeAction(W.matplotlibWidgetCodeActionTitle,Jt.CodeActionKind.QuickFix);return i.isPreferred=!0,i.diagnostics=[n],i.command={title:W.matplotlibWidgetCodeActionTitle,command:"vscode.open",arguments:[t]},i}analyzeNotebook(e){e.notebookType===bt&&e.getCells().forEach((t,n)=>n<100?this.queueCellForProcessing(t):void 0)}queueCellForProcessing(e){this.cellsToProcess.add(e),this.analyzeNotebookCells()}analyzeNotebookCells(){if(this.cellsToProcess.size===0)return;let e=this.cellsToProcess.values().next().value;e&&(this.cellsToProcess.delete(e),this.analyzeNotebookCell(e)),setTimeout(()=>this.analyzeNotebookCells(),0)}analyzeNotebookCell(e){var n;if(e.kind!==Jt.NotebookCellKind.Code||e.document.languageId!==Ye||e.notebook.isClosed||e.document.isClosed||((n=this.notebooksProcessed.get(e.notebook))==null?void 0:n.get(e.document.uri.toString()))===e.document.version)return;this.problems.delete(e.document.uri);let t=this.notebooksProcessed.get(e.notebook)||new Map;t.set(e.document.uri.toString(),e.document.version),this.notebooksProcessed.set(e.notebook,t);for(let i=0;i<Math.min(e.document.lineCount,50);i++){let o=e.document.lineAt(i),s=o.text;if(s.trim().startsWith("!pip install")){let a=s.indexOf("!"),l=s.indexOf("l"),u=new Jt.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:pO,range:u,severity:Jt.DiagnosticSeverity.Error,source:fO}])}else if(s.trim().startsWith("!conda install")){let a=s.indexOf("!"),l=s.indexOf("l"),u=new Jt.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:R9,range:u,severity:Jt.DiagnosticSeverity.Error,source:fO}])}else if(s.trim().startsWith("%matplotlib")&&!s.trim().endsWith("widget")&&!s.trim().endsWith("inline")){let a=s.indexOf("%"),l=s.length,u=new Jt.Range(o.lineNumber,a,o.lineNumber,l);this.problems.set(e.document.uri,[{message:Wte,range:u,severity:Jt.DiagnosticSeverity.Warning,source:fO}])}}}};rE=U([(0,mO.injectable)(),x(0,(0,mO.inject)(ve))],rE);p();var bO=se(ge()),br=require("vscode");p();var Vte=new Map([["method",0],["function",1],["constructor",2],["field",3],["variable",4],["class",5],["struct",6],["interface",7],["module",8],["property",9],["event",10],["operator",11],["unit",12],["value",13],["constant",14],["enum",15],["enumMember",16],["keyword",17],["text",18],["color",19],["file",20],["reference",21],["customcolor",22],["folder",23],["typeParameter",24],["snippet",25],["<unknown>",3]]);p();function hO(r){if(r>=300)return"ZZZZZZZ";if(r<=25)return`A${String.fromCharCode(65+r)}`;let e=String.fromCharCode(65+Math.ceil(r/25)),t=String.fromCharCode(65+r%25);return`${e}${t}`}p();var Yte=require("vscode");p();var Pv=require("vscode");var cEe=new Map([["julia",fEe],["python",dEe],["r",mEe]]);function jte(r,e){let t=cEe.get(e.toLowerCase());return t?t(r):r}var uEe=["Docstring:","Options:","Parameters","Returns","See Also","Notes","Examples","Usage:","Subclasses:"];function dEe(r){let e=at(r,{trim:!1,removeEmptyEntries:!1}),t=-1,n=!1,i=!1,o=[],s=new Set,a=!1,l="",u=!1,c=!1;if(e.map((f,m)=>{if(m===0){let b=["Signature:","Init signature:"].find(y=>f.toLowerCase().startsWith(y.toLowerCase()));if(b){n=!0,f=f.substring(b.length).trim(),o.push("```python"),f.trim().length&&(o.push(f),u=!0);return}}if(f.startsWith("File:")&&m===e.length-1||f.startsWith("Type:")&&m===0)return;if(!a&&f.toLowerCase().startsWith("String form:".toLowerCase())){i=!0;return}let g=uEe.find(b=>f.trim().toLowerCase().startsWith(b.toLowerCase()));if(g&&!s.has(g)){l=g.toLowerCase(),s.add(g),a=!0,t=m,i=!1,n&&o.push("```","----------"),n=!1,c=!1,l!=="docstring:"&&o.push(`## ${g}`);let b=f.includes(":")?f.split(":")[1].replace("<no docstring>","").trim():"";b.length&&(o.push(b),u=!0);return}if(!i){if(t+1===m&&f.replace(/-/g,"").replace(/:/g,"").replace("<no docstring>","").trim().length===0){t=m,i=!1,n=!1,c=!1;return}if(l==="parameters"||l==="see also"){f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),u=u||f.trim().length>0;return}if(l==="options:"){f.startsWith("-")&&f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),u=u||f.trim().length>0;return}if(l==="returns"){f.trim().length&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),u=u||f.trim().length>0;return}if(l==="examples"&&!n&&(t+1===m||t+2===m))return i=!1,n=!0,u=u||f.trim().length>0,o.push("```python",f);if(!n&&f.startsWith("class ")&&f.trim().endsWith("):")){n=!0,c=!0,o.push("```python",f),u=u||f.trim().length>0;return}if(n&&c&&f.trim().length>0&&f.substring(0,1)!==" "&&f.substring(0,1)!=="	")return n=!1,c=!1,o.push(f,"```");u=u||f.trim().length>0,o.push(f)}}),!u)return"";let d=o.join(`  
`);return n?new Pv.MarkdownString(d+"  \n```"):new Pv.MarkdownString(d)}var pEe=[{section:"Examples:",header:"Examples",nextLine://g},{section:"Usage note",header:"Usage note",nextLine://g},{section:"Note:",header:"\u2502 Note",nextLine:"\u2502"},{section:"Note:",header:"\u2502 Note",nextLine:String.fromCharCode(9474)}];function fEe(r){let e=at(r,{trim:!1,removeEmptyEntries:!1}),t=!1,n=[],i=new Set,o="",s=!1,a=!1;e.every(u=>u.trim().length===0||u.startsWith("  "))&&e.forEach((u,c)=>e[c]=u.trim().length?u.substring(2):u),e.map((u,c)=>{if(u.trim()==="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500")return a=!1,n.push(u);if(!a)return o="signature",t=!0,a=!0,u.trim().length?(s=!0,n.push("```julia",u)):n.push("```julia");o==="signature"&&u.trim()===""&&(o="",t=!1,s=!1,n.push("```"));let d=pEe.find(f=>u.trim().toLowerCase().startsWith(f.header.toLowerCase()));if(d&&(typeof d.nextLine=="string"?e[c+1].trim()===d.nextLine.trim():e[c+1].trim().replace(d.nextLine,"").length===0)){e[c+1]="",o=d.section.toLowerCase(),i.add(d.header),t&&n.push("```"),t=!1,n.push(`## ${d.section}`),o==="note:"&&!e.slice(c+1).every(f=>f.trim().length===0||f.trim().startsWith("|")||f.trim().startsWith(String.fromCharCode(9474)))&&(o="");return}if(o==="examples:"&&!t)return t=!0,u.trim().length?(s=!0,n.push("```julia",u)):n.push("```julia");if(o==="note:"){n.push(u.trim()?u.trim().substring(1):"");return}t&&!s&&u.trim().length===0||n.push(u)});let l=n.join(`  
`);return t?new Pv.MarkdownString(l+"  \n```"):new Pv.MarkdownString(l)}function mEe(r){let e=at(r,{trim:!1,removeEmptyEntries:!1}),t=[];e.forEach((a,l)=>e[l]=a.indexOf("     ")===0?a.substring(5):a);let n="",i=!1,o=!1;e.map(a=>{let l=a.replace(/_/g,"").trim();if(a.startsWith("_")&&a.includes(String.fromCharCode(8))&&a.split("_").length===a.split(String.fromCharCode(8)).length&&l){i&&t.push("```"),i=!1,n=l.trim().toLowerCase(),t.push(`## ${l}`);return}if((n==="examples"||n==="examples:"||n==="usage"||n==="usage:")&&!i)return i=!0,a.trim().length?(o=!0,t.push("```r",a)):t.push("```r");if(n==="note:"){t.push(a.trim()?a.trim().substring(1):"");return}i&&!o&&a.trim().length===0||t.push(a)});let s=t.join(`  
`);return i?new Pv.MarkdownString(s+"  \n```"):new Pv.MarkdownString(s)}p();var Bte=new WeakMap;async function Dv(r,e,t){var f;let n=Bte.get(r)||0;Bte.set(r,n+1);let i=_R(Je,r),o=`application/vnd.vscode.bg.execution.${n}`,s=`application/vnd.vscode.bg.execution.${n}.result`,a=`application/vnd.vscode.bg.execution.${n}.error`,l="",u=`
def __jupyter_exec_background__():
    from IPython.display import display
    from threading import Thread
    from traceback import format_exc

    # First send a dummy response to get the display id.
    # Later we'll send the real response with the actual data.
    # And that can happen much later even after the execution completes,
    # as that response will be sent from a bg thread.
    output = display({"${o}": ""}, raw=True, display_id=True)

    def do_implementation():
        ${e.map((m,g)=>g===0?m:`        ${m}`).join(`
`)}

    def bg_main():
        try:
            output.update({"${s}": do_implementation()}, raw=True)
        except Exception as e:
            output.update({"${a}": format_exc()}, raw=True)


    Thread(target=bg_main, daemon=True).start()


__jupyter_exec_background__()
del __jupyter_exec_background__
`.trim(),c=new En;c.add(t.onCancellationRequested(()=>c.dispose()));let d=Os(t,new Promise((m,g)=>{c.add(i.onDidReceiveDisplayUpdate(async b=>{var A;if(t.isCancellationRequested)return m(void 0);let y=Wg(b);if(!l||((A=y==null?void 0:y.transient)==null?void 0:A.display_id)!==l)return;let P=b.items.find(D=>D.mime===s);if(P)try{return m(JSON.parse(new TextDecoder().decode(P.data)))}catch(D){return g(new Error("Failed to parse the result",D))}}))})).finally(()=>{r.session&&nQ(r.session,l),c.dispose()});for await(let m of i.executeCode(u,t)){if(t.isCancellationRequested)return;let g=Wg(m);if(!((f=g==null?void 0:g.transient)!=null&&f.display_id))continue;if(m.items.find(y=>y.mime===o)){l=g.transient.display_id;continue}if(l===g.transient.display_id){let y=m.items.find(P=>P.mime===s||P.mime===a);if((y==null?void 0:y.mime)===s)return JSON.parse(new TextDecoder().decode(y.data));if((y==null?void 0:y.mime)===a){w.warn(`Error in background execution:
`,new TextDecoder().decode(y.data));return}}}if(!t.isCancellationRequested){if(!l){w.warn("Failed to get display id for completions");return}return d}}var hEe=1,km=ui.IntellisenseResolveTimeout,Hte=5,A9=new WeakSet,gO=class extends Error{constructor(){super("Request timed out")}};async function $te(r,e,t,n,i,o,s,a){var d;if(!r.range||!((d=n.session)!=null&&d.kernel)||A9.has(n)||!jt(n.kernelConnectionMetadata)&&n.status!=="idle")return r;let l=wEe(e||r,s,a),u=CEe(l,n,t),c=IQ(t);try{let f=await Hv(km,new gO,Os(c.token,u));if(!t.isCancellationRequested&&(f==null?void 0:f.status)==="ok"&&(f!=null&&f.found)){let m=gEe(f);r.documentation=jte(m,o)}}catch(f){if(f instanceof Yte.CancellationError)return r;f instanceof gO&&(c.cancel(),vEe(n,o,i))}finally{c.dispose()}return r}function gEe(r){return!r||r.status!=="ok"||!r.found?";":!r.data||typeof r.data!="object"?"":"text/plain"in r.data?hu(r.data["text/plain"]):""}var qte=new WeakSet;function vEe(r,e,t){jt(r.kernelConnectionMetadata)||A9.has(r)||(A9.add(r),w.warn(`Failed to inspect code in kernel ${ut(r.kernelConnectionMetadata)}`),qte.has(r)||(qte.add(r),ne("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",void 0,{kernelId:t,kernelConnectionType:r.kernelConnectionMetadata.kind,kernelLanguage:e})))}var M9=new WeakMap,O9=new WeakMap;async function yEe(r,e,t){let n=`return get_ipython().kernel.do_inspect("${Qx(e.code)}", ${e.cursor_pos}, ${e.detail_level})`;return{content:await Dv(r,[n],t)}}var Jte={data:{},found:!1,status:"ok",metadata:{}};function bEe(r,e){var i;if(!((i=r.session)!=null&&i.kernel))return;let t=JSON.stringify(e),n=M9.get(r.session.kernel);return n==null?void 0:n.get(t)}function SEe(r,e,t){var o;if(!((o=r.session)!=null&&o.kernel)||t.status!=="ok"||!t.found)return;let n=JSON.stringify(e),i=M9.get(r.session.kernel)||new Map;M9.set(r.session.kernel,i),i.size>100&&i.clear(),i.set(n,t)}function IEe(r){var t;if(!((t=r.session)!=null&&t.kernel))return!1;let e=O9.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};return!jt(r.kernelConnectionMetadata)&&e.maxTime>km?(w.warn(`Not sending inspect request as previous requests took over ${km}s.`),!1):e.numberOfTimesMaxedOut>Hte?(w.warn(`Not sending inspect request as there have been at least ${Hte} requests that took over ${km}s.`),!1):e.maxTime>km&&Date.now()-e.lastRequestTime<3e4?(w.warn(`Not sending inspect request as previous requests took over ${km}s.`),!1):!0}async function _Ee(r,e){var i;if(!((i=r.session)!=null&&i.kernel)||!Gte(r))return;w.info(`Too many pending requests ${zte(r)} for kernel ${r.id}, waiting for it to be ready.`);let t=r.session.kernel,n=new En;await Os(e,new Promise(o=>{let s=()=>{if(e.isCancellationRequested)return;if(!Gte(r)){o(),Ce(n);return}let a=setTimeout(s,100);n.add({dispose:()=>clearTimeout(a)})};n.add(kg(e.onCancellationRequested)(()=>{o(),t.statusChanged.disconnect(s)})),t.statusChanged.connect(s),n.add({dispose:()=>{t.statusChanged.disconnect(s)}})})).finally(()=>Ce(n))}function EEe(r,e){var n;if(!((n=r.session)!=null&&n.kernel))return;let t=O9.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};t.maxTime=Math.max(t.maxTime,e),t.lastRequestTime=Date.now(),e>km&&(t.numberOfTimesMaxedOut+=1),O9.set(r.session.kernel,t)}async function CEe(r,e,t){var l;if(!((l=e.session)!=null&&l.kernel))return;let n=bEe(e,r);if(n)return n;if(!IEe(e)||(await _Ee(e,t),t.isCancellationRequested))return Jte;let i=xEe(e),o=new It,s=at(r.code).reverse()[0].slice(-50);w.trace(`Inspecting code ${s}`);let a=jt(e.kernelConnectionMetadata)?yEe(e,r,t):e.session.kernel.requestInspect(r);return a.finally(()=>i.dispose()),a.then(({content:u})=>{var d;if(!((d=e.session)!=null&&d.kernel))return;SEe(e,r,u),EEe(e,o.elapsedTime);let c=o.elapsedTime>km?w.warn:w.debug;return t.isCancellationRequested?c(`Inspected code ${s} in ${o.elapsedTime}ms (but cancelled)`):c(`Inspected code ${s} in ${o.elapsedTime}ms`),u})}function wEe(r,e,t){var l;let n=e.getText(),i=(typeof r.insertText=="string"?r.insertText:(l=r.insertText)==null?void 0:l.value)||(typeof r.label=="string"?r.label:r.label.label)||"",o=n.substring(0,t.character)+i,s=t.character+i.length;return{code:o,cursor_pos:s,detail_level:0}}var JP=new WeakMap;function Gte(r){var e;return(e=r.session)!=null&&e.kernel?zte(r)>=hEe:!1}function zte(r){var e,t,n,i,o;return(e=r.session)!=null&&e.kernel?(JP.has((t=r.session)==null?void 0:t.kernel)||JP.set((n=r.session)==null?void 0:n.kernel,{count:0}),((o=JP.get((i=r.session)==null?void 0:i.kernel))==null?void 0:o.count)||0):0}function xEe(r){var t,n,i;if(!((t=r.session)!=null&&t.kernel))return{dispose:E};let e=JP.get((n=r.session)==null?void 0:n.kernel)||{count:0};return JP.set((i=r.session)==null?void 0:i.kernel,e),e.count+=1,{dispose:()=>{e.count-=1}}}var yO=class extends Error{constructor(){super("Request timed out")}},L9=class{constructor(e,t,n){this.kernelId=e;this.kernel=t;this.monacoLanguage=n;this.pendingCompletionRequest=new WeakMap;this.previousCompletionItems=new WeakMap}async provideCompletionItems(e,t,n,i){var a;if(!((a=this.kernel.session)!=null&&a.kernel))return[];let o=e.version;if(this.pendingCompletionRequest.has(e))return[];this.pendingCompletionRequest.set(e,{position:t,version:o});let s=new br.Disposable(()=>{var l,u;(l=this.pendingCompletionRequest.get(e))!=null&&l.position.isEqual(t)&&((u=this.pendingCompletionRequest.get(e))==null?void 0:u.version)===o&&this.pendingCompletionRequest.delete(e)});try{let l=Au(Os(n,Promise.resolve(br.commands.executeCommand("vscode.executeCompletionItemProvider",e.uri,t)).then(m=>(m==null?void 0:m.items)||[]))),u=new It;if(await tc(50),n.isCancellationRequested)return[];let c=await Hv(ui.IntellisenseTimeout,new yO,this.provideCompletionItemsFromKernel(e,t,n,i));if(n.isCancellationRequested||!c||!c.length)return[];let d=await fo(0,l.promise);jt(this.kernel.kernelConnectionMetadata)&&!l.completed&&u.elapsedTime<ui.IntellisenseTimeout+50&&(d=await fo(ui.IntellisenseTimeout-u.elapsedTime,l.promise));let f=new Set((d||[]).map(m=>typeof m.label=="string"?m.label:m.label.label).map(m=>[m,`.${m}`]).flat());return c.filter(m=>!f.has(typeof m.label=="string"?m.label:m.label.label))}catch(l){if(l instanceof yO)return[];throw l instanceof br.CancellationError||w.debug("Completions failed",l),l}finally{s.dispose()}}async provideCompletionItemsFromKernel(e,t,n,i){var y,P,A,D,T;if(n.isCancellationRequested||!((y=this.kernel.session)!=null&&y.kernel))return[];let o=new It,s={duration:0,timesExceededTimeout:0,requestDuration:0,completionItems:0},a={kernelId:this.kernelId,kernelConnectionType:this.kernel.kernelConnectionMetadata.kind,kernelLanguage:IO(this.kernel),monacoLanguage:this.monacoLanguage,cancelled:!1,kernelStatusBeforeRequest:this.kernel.status,completed:!1,requestSent:!1};if(!jt(this.kernel.kernelConnectionMetadata)&&this.kernel.status!=="idle")return[];let l=e.getText(),u=e.offsetAt(t);a.requestSent=!0;let c=await Os(n,this.getKernelCompletion(l,u,n));if(w.debug(`Jupyter completion time: ${o.elapsedTime}`),a.cancelled=n.isCancellationRequested,a.completed=!n.isCancellationRequested,a.kernelStatusAfterRequest=this.kernel.status,s.requestDuration=n.isCancellationRequested?0:o.elapsedTime,n.isCancellationRequested)return[];if(((P=c==null?void 0:c.content)==null?void 0:P.status)!=="ok"||((T=(D=(A=c==null?void 0:c.content)==null?void 0:A.matches)==null?void 0:D.length)!=null?T:0)===0)return Xte(this.kernel,s,a),[];let d={matches:c.content.matches,cursor:{start:c.content.cursor_start,end:c.content.cursor_end},metadata:c.content.metadata},f=d.metadata?d.metadata._jupyter_types_experimental:[];s.completionItems=d.matches.length,Xte(this.kernel,s,a);let m={code:l,cursor:d.cursor,documentRef:new WeakRef(e),position:e.positionAt(d.cursor.start)},g=new br.Range(e.positionAt(d.cursor.start),e.positionAt(d.cursor.end)),b=[];return Array.isArray(f)&&f.length>=d.matches.length&&f.every(K=>K&&typeof K.text=="string")?b=c.content.matches.map((K,L)=>{let B=f[L],N=B.type?Vte.get(B.type):br.CompletionItemKind.Field,O=new br.CompletionItem(K,N);return typeof B.start=="number"&&typeof B.end=="number"?O.range=new br.Range(e.positionAt(B.start),e.positionAt(B.end)):O.range=g,O.insertText=B.text,O.sortText=hO(L),jt(this.kernel.kernelConnectionMetadata)&&(K.startsWith("%")||K.startsWith("!"))&&(O.sortText=`ZZZ${O.sortText}`),this.previousCompletionItems.set(O,{...m,originalCompletionItem:JSON.parse(JSON.stringify(O))}),O}):b=d.matches.map((K,L)=>{let B=new br.CompletionItem(K);return B.range=g,B.sortText=hO(L),jt(this.kernel.kernelConnectionMetadata)&&(K.startsWith("%")||K.startsWith("!"))&&(B.sortText=`ZZZ${B.sortText}`),this.previousCompletionItems.set(B,{...m,originalCompletionItem:B}),B}),jt(this.kernel.kernelConnectionMetadata)?kEe(i.triggerCharacter,this.allowStringFilterForPython,b,e,t):b}async resolveCompletionItem(e,t){var l;if(!e.range||!((l=this.kernel.session)!=null&&l.kernel))return e;let n=this.previousCompletionItems.get(e);if(!n)return e;let{documentRef:i,position:o,originalCompletionItem:s}=n,a=i.deref();return a?$te(e,s,t,this.kernel,this.kernelId,this.monacoLanguage,a,o):e}async getKernelCompletion(e,t,n){var i;if((i=this.kernel.session)!=null&&i.kernel)return jt(this.kernel.kernelConnectionMetadata)?this.getPythonKernelCompletion(e,t,n):Os(n,this.kernel.session.kernel.requestComplete({code:e,cursor_pos:t}))}async getPythonKernelCompletion(e,t,n){let i=`return get_ipython().kernel.do_complete("${Qx(e)}", ${t})`;return{content:await Dv(this.kernel,[i],n)}}},Qte=new WeakMap,vO=new WeakMap;function Xte(r,e,t){var o;let n=Qte.get(r),i=((o=vO.get(r))==null?void 0:o.count)||0;e.duration>=ui.IntellisenseTimeout&&vO.set(r,{count:i+1,measures:e,properties:t}),e.timesExceededTimeout=i,n?n.elapsedTime>6e4&&(ne("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n.reset(),vO.delete(r)):(ne("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n=new It,Qte.set(r,new It),vO.delete(r))}var K9=class extends Lr{constructor(t,n){super();this.kernel=t;this.notebookEditorProvider=n;this.cellCompletionProviders=new WeakMap;this.completionItemsSent=new WeakMap;this.monacoLanguage=SO(this.kernel);this.registerCompletionProvider(),this._register(br.workspace.onDidChangeConfiguration(i=>{var o;if(i.affectsConfiguration("jupyter.enableKernelCompletions"))if(Zte(this.kernel.notebook.uri))this.completionProvider||this.registerCompletionProvider();else{(o=this.completionProvider)==null||o.dispose(),this.completionProvider=void 0;return}!i.affectsConfiguration("jupyter.completionTriggerCharacters")&&!i.affectsConfiguration("jupyter.pythonCompletionTriggerCharacters")||this.registerCompletionProvider()}))}registerCompletionProvider(){var n;if(!Zte(this.kernel.notebook.uri))return;let t=PEe(this.kernel);if(t.length===0){DEe(this.kernel);return}w.trace(`Registering Kernel Completion Provider from kernel ${ut(this.kernel.kernelConnectionMetadata)} for language ${this.monacoLanguage}`),this.allowStringFilterForPython=t.includes("'")||t.includes('"'),(n=this.completionProvider)==null||n.dispose(),this.completionProvider=void 0,this.completionProvider=br.languages.registerCompletionItemProvider(this.monacoLanguage,this,...t)}dispose(){var t;super.dispose(),(t=this.completionProvider)==null||t.dispose()}async provideCompletionItems(t,n,i,o){if(this.notebookEditorProvider.findAssociatedNotebookDocument(t.uri)!==this.kernel.notebook)return[];let s=this.cellCompletionProviders.get(t);if(!s){let a=await Rt(this.kernel.kernelConnectionMetadata.id);s=new L9(a,this.kernel,this.monacoLanguage),this.cellCompletionProviders.set(t,s)}return s.allowStringFilterForPython=this.allowStringFilterForPython,s.provideCompletionItems(t,n,i,o).then(a=>(a.forEach(l=>this.completionItemsSent.set(l,s)),a))}async resolveCompletionItem(t,n){let i=this.completionItemsSent.get(t);return i?i.resolveCompletionItem(t,n):t}},Nm=class extends Lr{constructor(t){super();this.kernelCompletionProviders=new WeakMap;t.push(this)}activate(){let t=tt.instance.get(qe);this._register(t.onDidStartKernel(async n=>{var a;if((a=n.session)!=null&&a.kernel&&jt(n.kernelConnectionMetadata)&&n.session.kernel.requestComplete({code:"__file__.",cursor_pos:9}),!SO(n)||this.kernelCompletionProviders.has(n))return;let o=tt.instance.get(Oo),s=this._register(new K9(n,o));this.kernelCompletionProviders.set(n,s)})),this._register(t.onDidDisposeKernel(n=>{var i;(i=this.kernelCompletionProviders.get(n))==null||i.dispose()}))}};Nm=U([(0,bO.injectable)(),x(0,(0,bO.inject)(ve))],Nm);function SO(r){return Kc(IO(r))}function IO(r){let e="";switch(r.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":e=r.kernelConnectionMetadata.kernelModel.language;break;case"startUsingRemoteKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;case"startUsingLocalKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;default:e=r.kernelConnectionMetadata.kernelSpec.language;break}return(e||"").toLowerCase()}function Zte(r){return br.workspace.getConfiguration("jupyter",r).get("enableKernelCompletions",!1)}function PEe(r){let e=br.workspace.getConfiguration("jupyter",r.notebook.uri).get("completionTriggerCharacters");if(!e||typeof e!="object")return[];let t=IO(r),n=SO(r);return t in e?Array.isArray(e[t])?e[t]:[]:n in e?Array.isArray(e[n])?e[n]:[]:[]}function DEe(r){let e=IO(r),t=SO(r);e.toLowerCase()===t.toLowerCase()?w.warn(br.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,ut(r.kernelConnectionMetadata),`{${e}`)):w.warn(br.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
 or the following: 
jupyter.completionTriggerCharacters = {2}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,ut(r.kernelConnectionMetadata),`{${e}`,`{${t}`))}function TEe(r,e){let t=r.indexOf('"'),n=r.indexOf("'"),i=r.lastIndexOf('"'),o=r.lastIndexOf("'"),s=t>=0?t:n,a=i>=0?i:o;return s>=0&&e.character>s&&e.character<=a}function kEe(r,e,t,n,i){let o=i.character===0?void 0:new br.Range(i.line,i.character-1,i.line,i.character),a=(o?n.getText(o):void 0)===".",l=n.getWordRangeAtPosition(a||r==="."?new br.Position(i.line,i.character-1):i),u=l&&o?l.union(o):void 0,c=n.lineAt(i.line).text,d=u?n.getText(u):c,f=d.endsWith(".")||a,m=e&&(r=="'"||r=='"'||TEe(c,i));w.ci(`Jupyter completions filtering applied: ${m} on ${c}`);let g=t.map((b,y)=>{let P=typeof b.label=="string"?b.label:b.label.label,A=typeof b.label=="string"?b.label:b.label.label;if(A.startsWith("%")||A.startsWith("!"))return{...b,sortText:`ZZZ${b.sortText}`};if(m)return b;let D=d?A.indexOf(d):-1,T,K,L;if(d&&f&&A.includes(d)){T=A.substring(A.indexOf(d)+(f?d.length:0)),K=A.substring(A.indexOf(d)+d.length);let B=(typeof b.label=="string"?b.label.length:b.label.label.length)-K.length;L=b.range&&"start"in b.range?new br.Range(new br.Position(b.range.start.line,b.range.start.character+B),b.range.end):b.range}if(!K&&D>0){T=A.substring(A.indexOf(d)+(f?d.length:0)),K=A.substring(A.indexOf(d)+d.length);let B=(typeof b.label=="string"?b.label.length:b.label.label.length)-K.length;L=b.range&&"start"in b.range?new br.Range(new br.Position(b.range.start.line,b.range.start.character+B),b.range.end):b.range}return T&&K&&L&&(b.label=T,P=K,b.insertText=K,b.filterText=f?`.${K}`:K,b.range=L,b.sortText=hO(y)),P.endsWith("/")?{...b,command:{command:"editor.action.triggerSuggest",title:""}}:(P.includes(" ")&&(P=P.replace(/\\ /g," "),typeof b.label=="string"?b.label=b.label.replace(/\\ /g," "):b.label.label=b.label.label.replace(/\\ /g," ")),m||!P.includes(".")&&!P.endsWith("/")||P.startsWith(".")&&!P.endsWith("/")?b:void 0)}).filter(b=>b!==void 0);return w.ci(`Jupyter completions for ${d} at pos ${i.line}:${i.character} with trigger: ${r}
   ${t.map(b=>b.label).join(",")}`),w.ci(`Jupyter results for ${d} at pos ${i.line}:${i.character} with trigger: ${r}
   ${g.map(b=>b.label).join(",")}`),g}function ere(r,e){r.addSingleton(Ve,rE),r.addSingleton(Nm,Nm),r.addBinding(Nm,Ve)}p();var iE=se(ge());var tre=require("vscode");var nE=class{constructor(e,t,n){this.extensionChecker=e;this.disposables=t;this.kernelProvider=n}activate(){this.extensionChecker.onPythonExtensionInstallationStatusChanged(this.onPythonExtensionInstallationStatusChanged,this,this.disposables)}async onPythonExtensionInstallationStatusChanged(e){e==="installed"&&this.anyKernelsAreActive()&&tre.window.showInformationMessage(W.pythonExtensionInstalled,Ue.ok).then(E,E)}anyKernelsAreActive(){return this.kernelProvider.kernels.length>0}};nE=U([(0,iE.injectable)(),x(0,(0,iE.inject)(vo)),x(1,(0,iE.inject)(ve)),x(2,(0,iE.inject)(qe))],nE);p();var _O=se(ge()),Pu=require("vscode");var NEe=/^\s*(from (?<fromImport>\w+)(?:\.\w+)* import \w+(?:, \w+)*(?: as \w+)?|import (?<importImport>\w+(?:, \w+)*)(?: as \w+)?)$/,REe=1e3,AEe=mn(),oE=class{constructor(e,t=1e3){this.pendingChecks=new gu;this.disposables=new En;this.sentMatches=new Set;this.processedNotebookCells=new WeakMap;e.push(this.disposables),this.disposables.add(new Pu.Disposable(()=>Ce(this.pendingChecks.values()))),this.isTelemetryDisabled=TN(),this.disposables.add(Pu.workspace.onDidOpenNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(Pu.workspace.onDidCloseNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(Pu.workspace.onDidSaveNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave")));let n=this.disposables.add(new ec(t));this.disposables.add(Rr.onDidChangeNotebookCellExecutionState(i=>{n.trigger(()=>{i.state==2&&!this.isTelemetryDisabled&&this.checkNotebookCell(i.cell,"onExecution").catch(E)})},this)),this.disposables.add(kN(i=>this.isTelemetryDisabled=i))}activate(){Pu.workspace.notebookDocuments.forEach(e=>this.checkNotebookDocument(e,"onOpenCloseOrSave"))}getDocumentLines(e){let t=[];for(let n=0;n<Math.min(REe,e.lineCount);n++){let i=e.lineAt(n);i.isEmptyOrWhitespace||t.push(i.text.trim())}return t}onOpenedOrClosedNotebookDocument(e,t){!mr(e)||this.isTelemetryDisabled||this.scheduleCheck(e.uri,this.checkNotebookDocument.bind(this,e,t))}scheduleCheck(e,t){let n=this.pendingChecks.get(e);if(n&&(n.dispose(),this.pendingChecks.delete(e)),AEe)t();else{let i=setTimeout(t,5e3);this.pendingChecks.set(e,new Pu.Disposable(()=>clearTimeout(i)))}}async checkNotebookDocument(e,t){!mr(e)||this.isTelemetryDisabled||await Promise.all(e.getCells().map(async n=>this.checkNotebookCell(n,t)))}async checkNotebookCell(e,t){if(!(!mr(e.notebook)||e.kind!==Pu.NotebookCellKind.Code||e.document.languageId!==Ye||this.processedNotebookCells.get(e)===e.document.version))try{this.processedNotebookCells.set(e,e.document.version);let n=e.notebook.notebookType===bt?"notebook":"interactive";await this.sendTelemetryForImports(this.getDocumentLines(e.document),n,t)}catch(n){if(!di)throw n}}lookForImports(e){let t=[];try{for(let n of e){if(!n.includes("import")&&!n.includes("from"))continue;let i=n?NEe.exec(n):null;i!==null&&i.groups!==void 0&&(i.groups.fromImport!==void 0?t.push(i.groups.fromImport):i.groups.importImport!==void 0&&t.push(...i.groups.importImport.split(",").map(o=>o.trim())))}}catch(n){}return t}async sendTelemetryForImports(e,t,n){await Promise.all(this.lookForImports(e).map(async i=>{let o=`${i}_${t||""}_${n}`;if(this.sentMatches.has(o))return;this.sentMatches.add(o);let s=await Rt(i);ne("HASHED_PACKAGE_NAME",void 0,{hashedNamev2:s,resourceType:t,when:n})}))}};oE=U([(0,_O.injectable)(),x(0,(0,_O.inject)(ve))],oE);p();var nn=se(ge()),nre=se($g()),gt=require("vscode");p();var Du=require("vscode");var EO=class{constructor(e,t,n,i,o){this.configService=e;this.agentCreator=t;this.requestCreator=n;this.serverUriStorage=i;this.disposables=o;this.savedConnectInfo=new Map;this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}getPasswordConnectionInfo(e){if(!e.url||e.url.length<1)throw new Error("Invalid URL");let t=sE(e.url),n=e.disposables||[],i=!Array.isArray(e.disposables),o=this.savedConnectInfo.get(e.handle);return o||(o=this.getJupyterConnectionInfo({url:t,isTokenEmpty:e.isTokenEmpty,disposables:n,validationErrorMessage:e.validationErrorMessage}).then(s=>((!s||s.requiresPassword&&Object.keys(s).length===1)&&(w.warn(`Password for ${t} was invalid.`),this.savedConnectInfo.delete(e.handle)),s)),o.catch(()=>this.savedConnectInfo.delete(e.handle)),o.finally(()=>{i&&Ce(n)}).catch(E),this.savedConnectInfo.set(e.handle,o)),o}async getJupyterConnectionInfo(e){let t,n,i,o,s=await this.needPassword(e.url);if(s||e.isTokenEmpty){if(s&&e.isTokenEmpty){let a=Du.window.createInputBox();e.disposables.push(a),a.title=W.jupyterSelectPasswordTitle,a.placeholder=W.jupyterSelectPasswordPrompt,a.ignoreFocusOut=!0,a.password=!0,a.validationMessage=e.validationErrorMessage||"",a.show(),a.buttons=[Du.QuickInputButtons.Back],o=await new Promise((l,u)=>{a.onDidTriggerButton(c=>{c===Du.QuickInputButtons.Back&&u(ze.back)},this,e.disposables),a.onDidChangeValue(()=>a.validationMessage="",this,e.disposables),a.onDidAccept(()=>l(a.value),this,e.disposables),a.onDidHide(()=>u(ze.cancel),this,e.disposables)})}if(typeof o===void 0&&!o&&e.isTokenEmpty)throw new Du.CancellationError;if(o||e.isTokenEmpty)if(t=await this.getXSRFToken(e.url,""),t){let a=await this.getSessionCookie(e.url,t,o||"");n=a.sessionCookieName,i=a.sessionCookieValue}else n="authservice_session",i=o,t=await this.getXSRFToken(e.url,`${n}=${i}`);else return{requiresPassword:s}}else return{requiresPassword:s};return t&&n&&(i||e.isTokenEmpty)?(ne("DS_INTERNAL.GET_PASSWORD_SUCCESS"),{requestHeaders:{Cookie:`_xsrf=${t}; ${n}=${i||""}`,"X-XSRFToken":t},requiresPassword:s}):(ne("DS_INTERNAL.GET_PASSWORD_FAILURE"),{requiresPassword:s})}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async getXSRFToken(e,t){var a;let n,i,o=new URL("login?",sE(e)).toString();t!=""?(o=new URL("tree",sE(e)).toString(),i={Connection:"keep-alive",Cookie:t}):i={Connection:"keep-alive"};let s=await this.makeRequest(o,{method:"get",redirect:"manual",headers:i});if(s!==void 0&&s.ok){let l=this.getCookies(s);l.has("_xsrf")&&(n=(a=l.get("_xsrf"))==null?void 0:a.split(";")[0])}return n}async needPassword(e){let t=await this.makeRequest(sE(e),{method:"get",redirect:"follow",headers:{Connection:"keep-alive"}});if(t.status===200&&t.redirected){if(t.url.toLowerCase().includes("/login?"))return!0;if(t.url.toLowerCase().includes("/lab?"))return!1}let n=new URL("tree?",sE(e)).toString();return t=await this.makeRequest(n,{method:"get",redirect:"manual",headers:{Connection:"keep-alive"}}),t.status===404?(w.error(`Jupyter Server not found at ${e}, got 404 for ${n}`),!1):t.status!==200}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(i.message.indexOf("reason: self signed certificate")>=0){let o=W.jupyterSelfCertEnable,s=W.jupyterSelfCertClose,a=await Du.window.showErrorMessage(W.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,Du.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}async getSessionCookie(e,t,n){let i,o,s=new URLSearchParams;s.append("_xsrf",t),s.append("password",n);let a=await this.makeRequest(new URL("login?",sE(e)).toString(),{method:"post",headers:{Cookie:`_xsrf=${t}`,Connection:"keep-alive","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},body:s.toString(),redirect:"manual"});if(a.status===302){let l=this.getCookies(a);if(l.size>0){let u=l.entries().next().value;u&&(i=u[0],o=u[1])}}return{sessionCookieName:i,sessionCookieValue:o}}getCookies(e){let t=new Map,i=(e.headers.raw?e.headers.raw():e.headers)["set-cookie"];return i&&i.forEach(o=>{let s=o.substring(0,o.indexOf("=")),a=o.substring(o.indexOf("=")+1);t.set(s,a)}),t}onDidRemoveServers(e){e.forEach(t=>{t.id.startsWith("_builtin")&&this.savedConnectInfo.delete(t.handle)})}};function sE(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}p();var wO=require("vscode");var CO=class{constructor(e,t,n){this.configService=e;this.agentCreator=t;this.requestCreator=n}async isJupyterHub(e){try{if(e.toLowerCase().includes("/user/")&&e.includes("token="))return!1;if(e.toLowerCase().includes("/user/")&&!e.includes("token="))return!0;let t=await this.makeRequest(new URL("hub/api",MEe(e)).toString(),{method:"get"});if(t.status!==200)return!1;try{let n=await t.json();return w.trace(`JupyterHub version is ${n&&n.version} for url ${e}`),n&&n.version}catch(n){}return!1}catch(t){return w.debug(`Error in detecting whether url is isJupyterHub: ${t}`),!1}}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(i.message.indexOf("reason: self signed certificate")>=0){let o=W.jupyterSelfCertEnable,s=W.jupyterSelfCertClose,a=await wO.window.showErrorMessage(W.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return ne("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,wO.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&ne("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}};function MEe(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}var xO="user-jupyter-server-uri-list-version2";var OEe="DataScienceAllowInsecureConnections",aE=class extends Lr{constructor(t,n,i,o,s,a,l,u,c,d,f,m=LE){super();this.jupyterConnection=n;this.context=c;this.fs=d;this.jupyterServerProviderRegistry=f;this.id=m;this.extensionId=Je;this.documentation=gt.Uri.parse("https://aka.ms/vscodeJuptyerExtKernelPickerExistingServer");this.displayName=W.UserJupyterServerUrlProviderDisplayName;this.detail=W.UserJupyterServerUrlProviderDetail;this._onDidChangeHandles=this._register(new gt.EventEmitter);this.onDidChangeHandles=this._onDidChangeHandles.event;this._onDidChangeServers=this._register(new gt.EventEmitter);this.onDidChangeServers=this._onDidChangeServers.event;a.push(this),this.newStorage=new $P(i),this.secureConnectionValidator=new YP(s),this.jupyterServerUriInput=new GP(u),this.jupyterServerUriDisplayName=new F9,this.jupyterPasswordConnect=new EO(t,l,u,o,a),this.jupyterHubPasswordConnect=new CO(t,l,u)}activate(){let t=this._register(this.jupyterServerProviderRegistry.createJupyterServerCollection(Je,this.id,this.displayName,this));t.commandProvider=this,t.documentation=this.documentation,this._register(this.onDidChangeHandles(()=>this._onDidChangeServers.fire(),this)),this._register(gt.commands.registerCommand("dataScience.ClearUserProviderJupyterServerCache",async()=>{await Promise.all([this.newStorage.clear().catch(E),this.fs.delete(gt.Uri.joinPath(this.context.globalStorageUri,xI)).catch(E)]),this._onDidChangeHandles.fire()})),this.initializeServers().catch(E)}async resolveJupyterServer(t,n){let i=await this.getServerUri(t.id);return{...t,connectionInformation:{id:t.id,label:t.label,baseUrl:gt.Uri.parse(i.baseUrl),token:i.token,headers:i.authorizationHeader,mappedRemoteNotebookDir:i.mappedRemoteNotebookDir?gt.Uri.file(i.mappedRemoteNotebookDir):void 0}}}async handleCommand(t,n){let i=new gt.CancellationTokenSource;this._register(new gt.Disposable(()=>{i.cancel(),i.dispose()}));try{let o="url"in t?t.url:void 0,s=await this.captureRemoteJupyterUrl(i.token,o);if(!s||s===ze.cancel)throw new gt.CancellationError;if(s&&s instanceof ze)return;let l=(await this.provideJupyterServers(i.token)).find(u=>u.id===s);if(!l)throw new Error(`Server ${s} not found`);return l}catch(o){if(o instanceof gt.CancellationError)throw o;w.error("Failed to select a Jupyter Server",o);return}finally{i.cancel(),i.dispose()}}async provideCommands(t,n){let i="";try{t=(t||"").trim(),["http:","https:"].includes(new URL(t.trim()).protocol.toLowerCase())&&(i=t)}catch(o){}return i?[{label:W.connectToToTheJupyterServer(i),url:i}]:[{label:W.jupyterSelectUriCommandLabel,canBeAutoSelected:!0}]}async provideJupyterServers(t){return await this.initializeServers(),(await this.newStorage.getServers(!1)).map(i=>({id:i.handle,label:i.serverInfo.displayName}))}async removeJupyterServer(t){await this.initializeServers(),await this.newStorage.remove(t.id),this._onDidChangeHandles.fire()}initializeServers(){if(this._cachedServerInfoInitialized)return this._cachedServerInfoInitialized;let t=Re();return this._cachedServerInfoInitialized=t.promise,(async()=>{this.newStorage.getServers(!1).catch(E),t.resolve()})().then(()=>t.resolve(),n=>t.reject(n)).catch(E),this._cachedServerInfoInitialized}recommendInstallingJupyterHubExtension(){throw gt.extensions.getExtension(Wv)?gt.window.showInformationMessage(W.useJupyterHubExtension,{modal:!0,detail:W.useJupyterHubExtensionDetail}).then(()=>{gt.commands.executeCommand("notebook.selectKernel",{notebookEditor:gt.window.activeNotebookEditor}).then(E,E)},E):gt.window.showInformationMessage(W.installJupyterHub,{modal:!0,detail:W.installJupyterHubDetail},Ue.install,Ue.moreInfo).then(t=>{t===Ue.install?gt.commands.executeCommand("workbench.extensions.installExtension",Wv,{context:{skipWalkthrough:!0}}).then(E,E):t===Ue.moreInfo&&gt.env.openExternal(gt.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter-hub")).then(E,E)},E),new gt.CancellationError}async captureRemoteJupyterUrl(t,n=""){await this.initializeServers();let i=[],o={baseUrl:"",displayName:"",token:""},s="",a=!1,l=!1,u,c="Get Url",d="Get Url",f=n,m=!1;if(n){let g=await this.jupyterServerUriInput.parseUserUriAndGetValidationError(n);typeof g.validationError=="string"?(s=g.validationError,c="Get Url"):(m=!0,o=g.jupyterServerUri,c="Check Passwords")}try{let g=!1;for(;;)try{if(u=(0,nre.default)(),c==="Get Url"){m=!1,c="Check Passwords",d=void 0;let y=s;s="";let P=await this.jupyterServerUriInput.getUrlFromUser(f||n,y,i);o=P.jupyterServerUri,f=P.url}if(t.isCancellationRequested)return ze.cancel;let b=[];if(c==="Check Passwords"){c="Check Insecure Connections",d=m&&n?void 0:"Get Url";try{let y=s;if(s="",!o.token&&await this.jupyterHubPasswordConnect.isJupyterHub(o.baseUrl))return this.recommendInstallingJupyterHubExtension(),ze.cancel;let P=await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:u,validationErrorMessage:y,disposables:b});a=P.requiresPassword,o.authorizationHeader=P.requestHeaders,g=!1}catch(y){if(g=!1,y instanceof gt.CancellationError||y==ze.back||y==ze.cancel)throw y;if(!Ms.isSelfCertsError(y)){if(!Zc.isSelfCertsExpiredError(y)){Tv(u,o.baseUrl,!1,"ConnectionFailure");let P=/(https?:\/\/[^\s]+)/g,A=(y.message||y.toString()).replace(P,D=>`[${D}](${D})`);if(s=(_n()?W.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:W.remoteJupyterConnectionFailedWithoutServerWithError)(A),o.token.length>0&&(y.message||"").toLowerCase()==="Failed to fetch".toLowerCase())g=!0;else{c="Get Url";continue}}}}finally{b.forEach(y=>this._register(y))}}if(t.isCancellationRequested)return ze.cancel;if(c==="Check Insecure Connections"&&(c="Verify Connection",d=a&&o.token.length===0?"Check Passwords":"Get Url",d==="Get Url"&&(d=m&&n?void 0:"Get Url"),!a&&o.token.length===0&&new URL(o.baseUrl).protocol.toLowerCase()==="http:"&&(l=!0,Ce(b),!await this.secureConnectionValidator.promptToUseInsecureConnections())))return Tv(u,o.baseUrl,!1,"InsecureHTTP"),ze.cancel;if(t.isCancellationRequested)return ze.cancel;if(c==="Verify Connection")try{c="Get Display Name",await this.jupyterConnection.validateRemoteUri({id:this.id,handle:u,extensionId:Je},o,!0)}catch(y){if(w.warn("Uri verification error",y),g&&s){c="Get Url";continue}if(y instanceof gt.CancellationError||y==ze.back||y==ze.cancel)throw y;if(Ms.isSelfCertsError(y)){s=W.jupyterSelfCertFailErrorMessageOnly,c="Get Url",Tv(u,o.baseUrl,!1,"SelfCert");continue}else if(Zc.isSelfCertsExpiredError(y)){s=W.jupyterSelfCertExpiredErrorMessageOnly,c="Get Url",Tv(u,o.baseUrl,!1,"ExpiredCert");continue}else if(a&&o.token.length===0){s=W.passwordFailure,c="Check Passwords",Tv(u,o.baseUrl,!1,"AuthFailure");continue}else{Tv(u,o.baseUrl,!1,"ConnectionFailure");let P=/(https?:\/\/[^\s]+)/g,A=(y.message||y.toString()).replace(P,D=>`[${D}](${D})`);s=(_n()?W.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:W.remoteJupyterConnectionFailedWithoutServerWithError)(A),c="Get Url";continue}}finally{Ce(b)}if(t.isCancellationRequested)return ze.cancel;if(c==="Get Display Name"){Ce(b),d=l?"Check Insecure Connections":a&&o.token.length===0?"Check Passwords":"Get Url",d==="Get Url"&&(d=m&&n?void 0:"Get Url"),o.displayName=await this.jupyterServerUriDisplayName.getDisplayName(u,o.displayName||new URL(o.baseUrl).hostname);break}}catch(b){if(b instanceof gt.CancellationError||b===ze.cancel)return ze.cancel;if(b===ze.back){if(!d)return ze.back;c=d;continue}throw b}return t.isCancellationRequested?ze.cancel:(await this.addNewServer({handle:u,uri:f,serverInfo:o}),gA({extensionId:this.extensionId,id:this.id,handle:u},o.displayName),Tv(u,o.baseUrl,!1),u)}catch(g){if(g instanceof gt.CancellationError)return ze.cancel;throw g}finally{Ce(i)}}async addNewServer(t){await this.newStorage.add(t),this._onDidChangeHandles.fire()}async getServerUri(t){let i=(await this.newStorage.getServers(!1)).find(l=>l.handle===t);if(!i)throw new Error("Server not found");let o=i.serverInfo,s=this.jupyterServerUriDisplayName.displayNamesOfHandles.get(t);s&&(o.displayName=s);let a=Object.assign({},o);try{let l=await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:t});a=Object.assign({},o,{authorizationHeader:l.requestHeaders||o.authorizationHeader})}catch(l){w.error("Failed to validate Password info",l)}return a}};aE=U([(0,nn.injectable)(),x(0,(0,nn.inject)(Ke)),x(1,(0,nn.inject)(pn)),x(2,(0,nn.inject)(rP)),x(3,(0,nn.inject)(dr)),x(4,(0,nn.inject)(_t)),x(4,(0,nn.named)(rr)),x(5,(0,nn.inject)(ve)),x(6,(0,nn.inject)(PR)),x(6,(0,nn.optional)()),x(7,(0,nn.inject)(jg)),x(8,(0,nn.inject)(st)),x(9,(0,nn.inject)(Pt)),x(10,(0,nn.inject)(sr)),x(11,(0,nn.optional)()),x(11,(0,nn.inject)(Date.now().toString()))],aE);var GP=class{constructor(e){this.requestCreator=e}async getUrlFromUser(e,t="",n){if(!e&&!bD)try{let s=await gt.env.clipboard.readText(),a=s.trim().startsWith("https://github.com/")?void 0:gt.Uri.parse(s.trim(),!0);e=s&&a&&a.scheme.toLowerCase().startsWith("http")?s:""}catch(s){e=""}let i=gt.window.createInputBox();n.push(i),i.title=W.jupyterSelectUriInputTitle,i.placeholder=W.jupyterSelectUriInputPlaceholder,i.value=e,i.validationMessage=t,i.buttons=[gt.QuickInputButtons.Back],i.ignoreFocusOut=!0,i.show();let o=Re();return i.onDidChangeValue(()=>i.validationMessage="",this,n),i.onDidHide(()=>o.reject(ze.cancel),this,n),i.onDidTriggerButton(s=>{s===gt.QuickInputButtons.Back&&o.reject(ze.back)},this,n),i.onDidAccept(async()=>{let s=await this.parseUserUriAndGetValidationError(i.value);if(typeof s.validationError=="string"){i.validationMessage=s.validationError;return}o.resolve(s)}),o.promise}async parseUserUriAndGetValidationError(e){let t=e.trim().replace(/\/(lab|tree)(\??)$/,""),n=U9(t,"");return n?(n.baseUrl=await LEe(t,this.requestCreator)||n.baseUrl,!t.toLowerCase().startsWith("http:")&&!t.toLowerCase().startsWith("https:")?{validationError:W.jupyterSelectURIMustBeHttpOrHttps}:{jupyterServerUri:n,url:t,validationError:void 0}):{validationError:W.jupyterSelectURIInvalidURI}}};GP=U([x(0,(0,nn.inject)(jg))],GP);async function LEe(r,e){var t;try{if(r=((t=U9(r,""))==null?void 0:t.baseUrl)||r,new URL(r).pathname==="/")return r;let n=r.indexOf("token=")>0?r.substring(0,r.indexOf("token=")):r,s=(await e.getFetchMethod()(n,{method:"GET",redirect:"manual"})).headers.get("location");if(s&&s.includes("login?"))return s.substring(0,s.indexOf("login?"))}catch(n){w.debug("Unable to identify the baseUrl of the Jupyter Server",n)}}function Tv(r,e,t,n){e=e.trim().toLowerCase();let i=Vt({handle:r,extensionId:Je,id:LE});Promise.all([Rt(e.toLowerCase()),Rt(i.toLowerCase())]).then(([o,s])=>{ne("DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",void 0,{serverIdHash:s,failed:!!n,baseUrlHash:o,isJupyterHub:t,isLocalHost:["localhost","127.0.0.1","::1"].includes(new URL(e).hostname),reason:n})}).catch(o=>w.error(`Failed to hash remote url ${e}`,o))}var F9=class{constructor(){this.displayNamesOfHandles=new Map}async getDisplayName(e,t){let n=[];try{let i=gt.window.createInputBox();n.push(i),i.ignoreFocusOut=!0,i.title=W.jupyterRenameServer,i.value=t,i.placeholder=W.jupyterServerUriDisplayNameInputPlaceholder,i.buttons=[gt.QuickInputButtons.Back],i.show();let o=Re();return n.push(i.onDidHide(()=>o.reject(ze.cancel))),i.onDidTriggerButton(s=>{s===gt.QuickInputButtons.Back&&o.reject(ze.back)},this,n),i.onDidAccept(()=>{let s=i.value.trim()||t;this.displayNamesOfHandles.set(e,s),o.resolve(s)},this,n),await o.promise}finally{Ce(n)}}},YP=class{constructor(e){this.globalMemento=e}async promptToUseInsecureConnections(){if(this.globalMemento.get(OEe,!1))return!0;let e=[],t=Re();try{let n=gt.window.createQuickPick();return e.push(n),n.canSelectMany=!1,n.ignoreFocusOut=!0,n.title=W.insecureSessionMessage,n.buttons=[gt.QuickInputButtons.Back],n.items=[{label:Ue.bannerLabelYes},{label:Ue.bannerLabelNo}],n.show(),e.push(n.onDidHide(()=>t.reject(ze.cancel))),n.onDidTriggerButton(i=>{i===gt.QuickInputButtons.Back&&t.reject(ze.back)},this,e),n.onDidAccept(()=>t.resolve(n.selectedItems.some(i=>i.label===Ue.bannerLabelYes)),this,e),await t.promise}finally{Ce(e)}}};YP=U([x(0,(0,nn.inject)(_t)),x(0,(0,nn.named)(rr))],YP);function U9(r,e){if(!r.startsWith(nt.REMOTE_URI))try{let t=new URL(r);return{baseUrl:`${t.protocol}//${t.host}${t.pathname==="/lab"||t.pathname==="/tree"?"":t.pathname}`,token:t.searchParams.get("token")||"",displayName:e||t.hostname}}catch(t){w.error(`Failed to parse URI ${r}`,t);return}}function rre(r){return r.map(e=>({handle:e.handle,uri:e.uri,displayName:e.serverInfo.displayName}))}function KEe(r){let e=[];return r.forEach(t=>{let n=U9(t.uri,t.displayName);n&&e.push({handle:t.handle,uri:t.uri,serverInfo:n})}),e}var $P=class{constructor(e){this.encryptedStorage=e;this.updatePromise=Promise.resolve()}async getServers(e){if(this.servers&&!e)return this.servers;let t=await this.encryptedStorage.retrieve(ui.JupyterServerRemoteLaunchService,xO);if(!t||t==="[]")return[];try{return this.servers=KEe(JSON.parse(t))}catch(n){return[]}}async add(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e.handle).concat(e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).concat(e);this.servers=t,await this.encryptedStorage.store(ui.JupyterServerRemoteLaunchService,xO,JSON.stringify(rre(t)))}).catch(E))}async remove(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).filter(n=>n.handle!==e);return this.servers=t,this.encryptedStorage.store(ui.JupyterServerRemoteLaunchService,xO,JSON.stringify(rre(t)))}).catch(E))}async clear(){this.servers=[],await(this.updatePromise=this.updatePromise.then(async()=>{this.servers=[],await this.encryptedStorage.store(ui.JupyterServerRemoteLaunchService,xO,void 0)}).catch(E))}};$P=U([x(0,(0,nn.inject)(rP))],$P);p();var zP=se(ge()),cE=require("vscode");var lE=class extends Lr{constructor(t,n){super();this.uriProviderRegistration=t;this.serverUriStorage=n;this.handleMappings=new Map;this._onDidChangeHandles=this._register(new cE.EventEmitter);this.extensionId=Je;this.id=sD;this.displayName="Jupyter Server for Testing";this.onDidChangeServers=this._onDidChangeHandles.event}async provideJupyterServers(t){return Array.from(this.handleMappings.values()).map(n=>n.server)}async resolveJupyterServer(t,n){return t}activate(){this._register(this.uriProviderRegistration.createJupyterServerCollection(Je,this.id,this.displayName,this)),this._register(cE.commands.registerCommand("jupyter.selectjupyteruri",this.selectJupyterUri,this))}async selectJupyterUri(t){var u;w.info(`Setting Jupyter Server URI to remote: ${t}`);let n=t.toString(!0),i=new URL(n),o=cE.Uri.parse(`${i.protocol}//${i.host}${i.pathname==="/lab"?"":i.pathname}`),s=(u=i.searchParams.get("token"))!=null?u:"",a=await ja(t.toString(!0),"SHA-1"),l={label:this.displayName,id:a,connectionInformation:{baseUrl:o,token:s}};this.handleMappings.set(a,{uri:t,server:l}),await this.serverUriStorage.add({id:this.id,handle:a,extensionId:Je}),this._onDidChangeHandles.fire()}};lE=U([(0,zP.injectable)(),x(0,(0,zP.inject)(sr)),x(1,(0,zP.inject)(dr))],lE);p();var PO=se(ge());var QP=require("vscode");var uE=class{constructor(e){this.disposables=e}activate(){this.registerCommandsIfTrusted()}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){QP.workspace.isTrusted&&this.registerCommand(le.ContinueEditSessionInCodespace,this.continueEditSessionInCodespace)}registerCommand(e,t){let n=QP.commands.registerCommand(e,t,this);this.disposables.push(n)}async continueEditSessionInCodespace(){await QP.commands.executeCommand("_workbench.editSessions.actions.continueEditSession.github.codespaces.continueEditSessionInCodespaceWithJupyterServer")}};uE=U([(0,PO.injectable)(),x(0,(0,PO.inject)(ve))],uE);p();var ire=se(ge());var ore=require("vscode");var dE=class{activate(){this.eagerlyActivateOtherExtensions().catch(E)}async eagerlyActivateOtherExtensions(){await Promise.all(ore.extensions.all.filter(e=>{var t,n;return(n=(t=e.packageJSON)==null?void 0:t.contributes)==null?void 0:n.pythonRemoteServerProvider}).map(e=>e.isActive?Promise.resolve():e.activate().then(E,E)))}};dE=U([(0,ire.injectable)()],dE);p();var DO=se(ge()),sre=require("vscode");var pE=class{constructor(e){this.uriStorage=e}activate(){sre.commands.registerCommand("jupyter.getUsedAzMLServerHandles",()=>{let e=[];return this.uriStorage.all.forEach(n=>{n.provider.extensionId.toLowerCase()==="ms-toolsai.vscode-ai".toLowerCase()&&e.push(n.provider)}),e})}};pE=U([(0,DO.injectable)(),x(0,(0,DO.inject)(dr))],pE);p();var up=require("vscode");var are=se(ge());var fE=class{activate(){let e=tt.instance.get(ve),t=new En;e.push(t),e.push(up.commands.registerCommand("jupyter.manageAccessToKernels",()=>FEe(t)))}};fE=U([(0,are.injectable)()],fE);async function FEe(r){let e=await aQ(),t=[];Array.from(e.entries()).forEach(([s])=>{var l,u;let a=(u=(l=up.extensions.getExtension(s))==null?void 0:l.packageJSON)==null?void 0:u.displayName;a&&t.push({label:a,description:s,extensionId:s})});let n=[];r.add({dispose:()=>{n=Ce(n)}});let i=up.window.createQuickPick();i.title=up.l10n.t("Manage Access To Jupyter Kernels"),i.placeholder=up.l10n.t("Choose which extensions can access Jupyter Kernels"),i.items=t,i.selectedItems=t.filter(s=>e.get(s.extensionId)===!0),i.canSelectMany=!0,i.ignoreFocusOut=!1;let o=!1;n.push(i),i.show(),await Promise.race([bx(i.onDidAccept,void 0,n).then(()=>o=!0),bx(i.onDidHide,void 0,n)]),o&&(await lQ(i.selectedItems.map(s=>s.extensionId)),n=Ce(n))}p();var ure=require("vscode");p();var TO=class{constructor(){this.cache=new Map;this.executionCount=0}getResults(e,t){return this.executionCount!==e&&(this.cache.clear(),this.executionCount=e),this.cache.get(t)}setResults(e,t,n){if(this.executionCount<e)this.cache.clear(),this.executionCount=e;else if(this.executionCount>e)return;this.cache.set(t,n)}},lre=TO,cre=TO;var kv=se(ge());var mE=class{constructor(e,t){this.variables=e;this.kernelProvider=t;this.variableResultCache=new lre;this.variableSummaryCache=new cre;this.runningKernels=new Set;this._onDidChangeVariables=new ure.EventEmitter;this.onDidChangeVariables=this._onDidChangeVariables.event;this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this)}onKernelStatusChanged({kernel:e}){if("variableProvider"in e.controller&&e.controller.variableProvider!==this)return;let t=e.notebook.uri.toString(),n=this.runningKernels.has(t);e.status==="idle"&&!n?this.runningKernels.add(t):e.status!=="busy"&&e.status!=="idle"&&n&&(this.runningKernels.delete(t),this._onDidChangeVariables.fire(e.notebook))}_getVariableResultCacheKey(e,t,n){let i="",o=t;return o&&(i=`${o.name}.${o.propertyChain.join(".")}[[${n}`),`${e}:${i}`}async*provideVariables(e,t,n,i,o){if(o.isCancellationRequested)return;let s=this.kernelProvider.get(e);if(!s||s.status==="dead"||s.status==="terminating")return;let a=this.kernelProvider.getKernelExecution(s).executionCount,l=this._getVariableResultCacheKey(e.uri.toString(),t,i),u=this.variableResultCache.getResults(a,l);if(t){let c=t;if(!u&&c.getChildren)u=(await c.getChildren(i,o)).map(f=>this.createVariableResult(f,s)),this.variableResultCache.setResults(a,l,u);else if(!u)return;for(let d of u)yield d;if(n===2&&c.count&&u.length>0&&c.count>i+u.length)for await(let d of this.provideVariables(e,t,n,i+u.length,o))yield d}else{u||(u=(await this.variables.getAllVariableDiscriptions(s,void 0,i,o)).map(d=>this.createVariableResult(d,s)),this.variableResultCache.setResults(a,l,u));for(let c of u)yield c}}_getVariableSummaryCacheKey(e,t){return`${e}:${t.name}`}async*provideVariablesWithSummarization(e,t,n,i,o){var l;let s=this.kernelProvider.get(e),a=this.provideVariables(e,t,n,i,o);for await(let u of a)if(s&&s.status!=="dead"&&s.status!=="terminating"){let c=this._getVariableSummaryCacheKey(e.uri.toString(),u.variable),d=this.kernelProvider.getKernelExecution(s).executionCount,f=this.variableSummaryCache.getResults(d,c);f==null&&u.variable.type==="pandas.core.frame.DataFrame"&&(f=await this.variables.getVariableValueSummary({name:u.variable.name,value:u.variable.value,supportsDataExplorer:!1,type:(l=u.variable.type)!=null?l:"",size:0,count:0,shape:"",truncated:!0},s,o),this.variableSummaryCache.setResults(d,c,f!=null?f:null)),yield{hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount,variable:{name:u.variable.name,value:u.variable.value,expression:u.variable.expression,type:u.variable.type,language:u.variable.language,summary:f!=null?f:""}}}}createVariableResult(e,t){var s;let n=(s=e.count)!=null?s:0,i=!!e.hasNamedChildren,o={getChildren:(a,l)=>this.getChildren(o,a,t,l),expression:UEe(e.root,e.propertyChain),...e};return{variable:o,hasNamedChildren:i,indexedChildrenCount:n}}async getChildren(e,t,n,i){let o=e;return await this.variables.getAllVariableDiscriptions(n,o,t,i)}};mE=U([(0,kv.injectable)(),x(0,(0,kv.inject)(Oi)),x(0,(0,kv.named)(nt.KERNEL_VARIABLES)),x(1,(0,kv.inject)(qe))],mE);function UEe(r,e){let t=r;for(let n of e)typeof n=="string"?t+=`.${n}`:t+=`[${n}]`;return t}p();var dp=se(ge()),kO=require("vscode");var WEe=/Type:\s*(\w+)/,VEe=/Value:\s*(.*)/,jEe=/String form:\s*([\s\S]+?)\n/,BEe=/Docstring:\s*(.*)/,HEe=/Length:\s+(.*)/,qEe=/^\s+\[(\d+) rows x (\d+) columns\]/m,JEe=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]),hE=class{constructor(e,t,n,i){this.configService=e;this.disposables=n;this.kernelProvider=i;this.variableRequesters=new Map;this.cachedVariables=new Map;this.refreshEventEmitter=new kO.EventEmitter;this.variableRequesters.set(Ye,t)}get refreshRequired(){return this.refreshEventEmitter.event}async getAllVariableDiscriptions(e,t,n,i){let o=Xc(e.kernelConnectionMetadata)||Ye,s=this.variableRequesters.get(o);return s?s.getAllVariableDiscriptions(e,t,n,i):[]}async getVariables(e,t){return this.getVariablesBasedOnKernel(t,e)}async getMatchingVariable(e,t,n){let i=this.cachedVariables.get(t.uri.toString());if(i){let o=i.variables.find(s=>s.name===e);return o&&!o.value&&(o=await this.getVariableValueFromKernel(o,t,n)),o}else{let o=await this.getVariableNamesAndTypesFromKernel(t,n);if(o){let s=o.find(a=>a.name===e);if(s)return this.getVariableValueFromKernel({name:e,value:void 0,supportsDataExplorer:!1,type:s.type,fullType:s.fullType,size:0,count:0,shape:"",truncated:!0},t,n)}}}async getVariableValueSummary(e,t,n){if(!t)return;let i=Xc(t==null?void 0:t.kernelConnectionMetadata)||Ye,o=this.variableRequesters.get(i);if(o)return o.getVariableValueSummary(e,t,n)}async getDataFrameInfo(e,t,n,i){if(!t)return e;let o=Xc(t==null?void 0:t.kernelConnectionMetadata)||Ye,s=this.variableRequesters.get(o);if(s){i&&(e=await this.getFullVariable(e,t));let a=e.name;return n&&(a=`${e.name}${n}`),s.getDataFrameInfo(e,t,a)}return e}async getDataFrameRows(e,t,n,i,o){let s=Xc(i==null?void 0:i.kernelConnectionMetadata)||Ye,a=this.variableRequesters.get(s);if(a){let l=e.name;return o&&(l=`${e.name}${o}`),a.getDataFrameRows(t,n,i,l)}return{data:[]}}async getFullVariable(e,t,n){let i=Xc(t==null?void 0:t.kernelConnectionMetadata)||Ye,o=this.variableRequesters.get(i);return o?o.getFullVariable(e,t,n):e}async getVariablesBasedOnKernel(e,t){var l;let n=this.cachedVariables.get(e.uri.toString()),i=this.kernelProvider.getKernelExecution(e).pendingCells.length>0,o=this.kernelProvider.getKernelExecution(e);(!n||!i&&(n.currentExecutionCount!==t.executionCount||n.currentExecutionCount!==o.executionCount))&&(n={currentExecutionCount:o.executionCount,variables:(await this.getVariableNamesAndTypesFromKernel(e)).map(u=>({name:u.name,value:void 0,supportsDataExplorer:!1,type:u.type,fullType:u.fullType,size:0,shape:"",count:0,truncated:!0,fileName:e.notebook.uri}))});let s=this.configService.getSettings(e.resourceUri).variableExplorerExclude?(l=this.configService.getSettings().variableExplorerExclude)==null?void 0:l.split(";"):[],a={executionCount:o.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(n){let u=t.sortColumn,c=(m,g)=>{let b=m[u]?m[u]:"",y=g[u]?g[u]:"";return t.sortAscending?b.localeCompare(y,void 0,{sensitivity:"base"}):y.localeCompare(b,void 0,{sensitivity:"base"})};n.variables.sort(c);let d=t.startIndex?t.startIndex:0,f=t.pageSize?t.pageSize:100;a.pageStartIndex=d;for(let m=d;m<d+f&&m<n.variables.length;){if(s&&s.indexOf(n.variables[m].type)>=0){n.variables.splice(m,1);continue}let g=typeof n.variables[m].value=="string"?n.variables[m]:await this.getVariableValueFromKernel(n.variables[m],e);n.variables[m]=g,a.pageResponse.push(g),m+=1}this.cachedVariables.set(e.uri.toString(),n),a.totalCount=n.variables.length}return a}async getVariableProperties(e,t,n){let i=await this.getMatchingVariable(e,t,n),o=Xc(t.kernelConnectionMetadata)||Ye,s=this.variableRequesters.get(o);return s?s.getVariableProperties(e,n,i):{}}async getVariableNamesAndTypesFromKernel(e,t){let n=Xc(e.kernelConnectionMetadata)||Ye,i=this.variableRequesters.get(n);return i?i.getVariableNamesAndTypesFromKernel(e,t):[]}inspect(e,t,n=0,i){let o=Re();try{e.requestInspect({code:t,cursor_pos:n,detail_level:0}).then(s=>{s&&s.content.status==="ok"?o.resolve(s.content.data):o.resolve(void 0)}).catch(s=>{o.reject(s)})}catch(s){o.reject(s)}return i&&this.disposables.push(i.onCancellationRequested(()=>o.reject(new kO.CancellationError))),o.promise}async getVariableValueFromKernel(e,t,n){var o;let i={...e};if(!t.disposed&&((o=t.session)!=null&&o.kernel)){let s=await this.inspect(t.session.kernel,e.name,0,n);if(s&&s.hasOwnProperty("text/plain")){let a=hu(s["text/plain"].toString()),l=WEe.exec(a),u=HEe.exec(a),c=qEe.exec(a);l&&(i.type=l[1]),i.value=[VEe,jEe,BEe].reduce((d,f)=>{var m;return d||((m=f.exec(a))==null?void 0:m[1])||""},""),u&&(i.count=parseInt(u[1],10)),c&&(i.shape=`(${c[1]}, ${c[2]})`)}s&&s.type&&(i.type=s.type.toString()),s&&s.value&&(i.value=s.value.toString()),JEe.has(i.type)&&(i.supportsDataExplorer=!0)}return i.type&&i.count&&!i.shape&&jt(t.kernelConnectionMetadata)&&i.supportsDataExplorer&&i.type!=="list"&&(i=await this.getFullVariable(i,t)),i}};hE=U([(0,dp.injectable)(),x(0,(0,dp.inject)(Ke)),x(1,(0,dp.inject)(GA)),x(1,(0,dp.named)(nt.PYTHON_VARIABLES_REQUESTER)),x(2,(0,dp.inject)(ve)),x(3,(0,dp.inject)(qe))],hE);p();var XP=se(ge());p();var gE=class extends ot{constructor(){super("unknown",W.jupyterDataRateExceeded)}};async function NO(r,{code:e,initializeCode:t,cleanupCode:n},i){var o;if(r.disposed||r.disposing||!((o=r.session)!=null&&o.kernel)||!r.session.kernel||r.session.isDisposed)return[];try{return t&&await Mi(r.session.kernel,t,i),await Mi(r.session.kernel,e,i)}catch(s){if(s instanceof zr)return[];throw s}finally{n&&await Mi(r.session.kernel,n,i)}}var vE=class{constructor(e,t){this.varScriptGenerator=e;this.dfScriptGenerator=t}async getDataFrameInfo(e,t,n){var u;let{code:i,cleanupCode:o,initializeCode:s}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!1,variableName:n}),a=await NO(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameInfo",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"}),l=((u=t.notebook)==null?void 0:u.uri)||t.resourceUri||t.uri;return{...e,...this.deserializeJupyterResult(a),fileName:l}}async getDataFrameRows(e,t,n,i){let{code:o,cleanupCode:s,initializeCode:a}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!1,variableName:i,startIndex:e,endIndex:t}),l=await NO(n,{code:o,cleanupCode:s,initializeCode:a},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameRows",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return l.length===0?{data:[]}:xM(this.deserializeJupyterResult(l))}async getVariableProperties(e,t,n){let i={};return n&&n.value&&(i[`${e}`]=n.value),i}async getVariableValueSummary(e,t,n){let i=await this.varScriptGenerator.generateCodeToGetVariableValueSummary(e.name);try{let o=await Dv(t,i.split(/\r?\n/),n);return o==null?void 0:o.summary}catch(o){w.warn(`Exception when getting variable summary for variable "${e.name}": ${o.message}`);return}}async getAllVariableDiscriptions(e,t,n,i){if(!e.session)return[];let o=t?{root:t.root,propertyChain:t.propertyChain,startIndex:n}:void 0,s=await this.varScriptGenerator.generateCodeToGetAllVariableDescriptions(o),a=await Dv(e,s.split(/\r?\n/),i);if(e.disposed||e.disposing||i!=null&&i.isCancellationRequested||!a)return[];try{return a}catch(l){return w.error(l),[]}}async getVariableNamesAndTypesFromKernel(e,t){if(e.session){let{code:n,cleanupCode:i,initializeCode:o}=await this.varScriptGenerator.generateCodeToGetVariableTypes({isDebugging:!1}),s=await NO(e,{code:n,cleanupCode:i,initializeCode:o},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getVariableNamesAndTypesFromKernel",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});if(e.disposed||e.disposing)return[];let a=this.deserializeJupyterResult(s),l=[];for(let u of a){let c={...u,value:void 0,supportsDataExplorer:!1,size:0,shape:"",count:0,truncated:!0};l.push(c)}return l}return[]}async getFullVariable(e,t,n){let{code:i,cleanupCode:o,initializeCode:s}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!1,variableName:e.name}),a=await NO(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getFullVariable",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return{...e,...this.deserializeJupyterResult(a)}}extractJupyterResultText(e){if(e.length>0){let t=e[0];if(t&&t.output_type==="stream"&&t.name==="stderr"&&t.hasOwnProperty("text")){let n=t.text;if(n.includes("iopub_data_rate_limit"))throw new gE;{let i=W.jupyterGetVariablesExecutionError(n);throw w.error(i),new Error(i)}}if(t&&t.output_type==="execute_result"){let n=t.data;if(n&&n.hasOwnProperty("text/plain"))return n["text/plain"]}if(t&&t.output_type==="stream"&&t.hasOwnProperty("text"))return t.text;if(t&&t.output_type==="error"&&t.hasOwnProperty("traceback")){let i=t.traceback.map(hu).join(`\r
`),o=W.jupyterGetVariablesExecutionError(i);throw w.error(o),new Error(o)}}throw new Error(W.jupyterGetVariablesBadResults)}deserializeJupyterResult(e){let t=this.extractJupyterResultText(e);return JSON.parse(t)}};vE=U([(0,XP.injectable)(),x(0,(0,XP.inject)(fy)),x(1,(0,XP.inject)(my))],vE);function dre(r,e,t){e.addSingleton(Ve,Q_),e.addSingleton(Ve,z_),e.addSingleton(Ve,$_),e.addSingleton(Ve,oE),e.addSingleton(Ve,dE),e.addSingleton(Ve,lE),e.add(nA,eE),e.add(AS,X_),e.addSingleton(kR,Z_),e.addSingleton(cp,cp),e.addSingleton(Ve,nE),ere(e,t),Ute(r,t),e.addSingleton(Ve,aE),e.addSingleton(Ve,uE),e.addSingleton(Ve,pE),e.addSingleton(Ve,fE),e.addSingleton(YA,mE),e.addSingleton(Oi,hE,nt.KERNEL_VARIABLES),e.addSingleton(GA,vE,nt.PYTHON_VARIABLES_REQUESTER)}p();p();var ZP=se(ge()),fre=require("vscode");p();var pre=class{};"force_variable_refresh","settings_updated","activate","show_data_explorer","get_variables_request","get_variables_response","variable_explorer_toggle","set_variable_explorer_height","variable_explorer_height_response","open_link","variables_complete","update_settings","loc_init","update_variable_view_execution_count","get_html_by_id_request","get_html_by_id_response","restart_kernel";var RO=Symbol("INotebookWatcher"),AO=Symbol("IVariableViewProvider");var yE=class{constructor(e,t){this.extensionContext=e;this.variableViewProvider=t}activate(){this.extensionContext.subscriptions.push(fre.window.registerWebviewViewProvider(this.variableViewProvider.viewType,this.variableViewProvider,{webviewOptions:{retainContextWhenHidden:!1}}))}};yE=U([(0,ZP.injectable)(),x(0,(0,ZP.inject)(st)),x(1,(0,ZP.inject)(AO))],yE);p();var Oa=se(ge());p();var LO=require("vscode");p();var MO=class{constructor(e,t){this.disposedCallback=t,this.callback=e}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}};p();p();var fp=require("vscode");var pp=class{constructor(e,t,n){this.configService=e;this.rootPath=t;this.scripts=n;this.disposed=!1;this.themeIsDarkPromise=Re();this.webviewInit=Re();this._disposables=[];this.onMessageListeners=[];this._onDidDisposeWebviewPanel=new fp.EventEmitter;this.onDataScienceSettingsChanged=async()=>{let e=JSON.stringify(await this.generateDataScienceExtraSettings());this.postMessageInternal("update_settings",e).catch(E)};this.onWebViewLoadFailed=async()=>{this.dispose()};this.onPossibleSettingsChange=async e=>{if(e.affectsConfiguration("workbench.colorTheme")||e.affectsConfiguration("editor.fontSize")||e.affectsConfiguration("editor.fontFamily")||e.affectsConfiguration("editor.cursorStyle")||e.affectsConfiguration("editor.cursorBlinking")||e.affectsConfiguration("editor.autoClosingBrackets")||e.affectsConfiguration("editor.autoClosingQuotes")||e.affectsConfiguration("editor.autoSurround")||e.affectsConfiguration("editor.autoIndent")||e.affectsConfiguration("editor.scrollBeyondLastLine")||e.affectsConfiguration("editor.fontLigatures")||e.affectsConfiguration("editor.scrollbar.verticalScrollbarSize")||e.affectsConfiguration("editor.scrollbar.horizontalScrollbarSize")||e.affectsConfiguration("files.autoSave")||e.affectsConfiguration("files.autoSaveDelay")||e.affectsConfiguration("jupyter.widgetScriptSources")){let t=await this.generateDataScienceExtraSettings();if(t){let n=JSON.stringify(t);this.postMessageInternal("update_settings",n).catch(E)}}};this._disposables.push(fp.workspace.onDidChangeConfiguration(this.onPossibleSettingsChange,this)),this._disposables.push(this.configService.getSettings(void 0).onDidChange(this.onDataScienceSettingsChanged.bind(this)))}get onDidDispose(){return this._onDidDisposeWebviewPanel.event}dispose(){this.disposed||(this.disposed=!0,this._disposables.forEach(e=>e.dispose())),this.webviewInit=void 0,this._onDidDisposeWebviewPanel.fire()}getHTMLById(e){if(!this.activeHTMLRequest)this.activeHTMLRequest=Re(),this.postMessageInternal("get_html_by_id_request",e).catch(E);else throw new Error("getHTMLById request already in progress");return this.activeHTMLRequest.promise}addMessageListener(e){this.onMessageListeners.push(e)}removeMessageListener(e){let t=this.onMessageListeners.indexOf(e);t>=0&&this.onMessageListeners.splice(t,1)}asWebviewUri(e){var t;if(!this.webview)throw new Error("asWebViewUri called too early");return(t=this.webview)==null?void 0:t.asWebviewUri(e)}postMessage(e,t){return this.postMessageInternal(e.toString(),t)}onMessage(e,t){switch(e){case"started":this.webViewRendered();break;case"get_html_by_id_response":this.activeHTMLRequest&&(this.activeHTMLRequest.resolve(t),this.activeHTMLRequest=void 0);break;default:break}this.onMessageListeners.forEach(n=>{n(e,t)})}async loadWebview(e,t){var n;if(this.disposed=!1,this.webviewInit=this.webviewInit||Re(),this.webview===void 0){let i=await this.generateDataScienceExtraSettings(),o=(n=fp.workspace.getWorkspaceFolder(e))==null?void 0:n.uri;this.webview=await this.provideWebview(e,i,o,t),this._disposables.push(this.webview.loadFailed(this.onWebViewLoadFailed,this))}this.onDataScienceSettingsChanged().catch(E),this.sendLocStrings().catch(E)}async generateDataScienceExtraSettings(){let e=this.owningResource,t=fp.workspace.getConfiguration("editor"),n=fp.workspace.getConfiguration("workbench"),i=n?n.get("colorTheme",iL):iL,o=fp.extensions.getExtension($s);return{...JSON.parse(JSON.stringify(this.configService.getSettings(e))),extraSettings:{editor:{cursor:this.getValue(t,"cursorStyle","line"),cursorBlink:this.getValue(t,"cursorBlinking","blink"),autoClosingBrackets:this.getValue(t,"autoClosingBrackets","languageDefined"),autoClosingQuotes:this.getValue(t,"autoClosingQuotes","languageDefined"),autoSurround:this.getValue(t,"autoSurround","languageDefined"),autoIndent:this.getValue(t,"autoIndent",!1),fontLigatures:this.getValue(t,"fontLigatures",!1),scrollBeyondLastLine:this.getValue(t,"scrollBeyondLastLine",!0),verticalScrollbarSize:this.getValue(t,"scrollbar.verticalScrollbarSize",14),horizontalScrollbarSize:this.getValue(t,"scrollbar.horizontalScrollbarSize",10),fontSize:this.getValue(t,"fontSize",14),fontFamily:this.getValue(t,"fontFamily","Consolas, 'Courier New', monospace")},theme:i,hasPythonExtension:o!==void 0,isWeb:Pi()==="Unknown"}}}async sendLocStrings(){let e={collapseSingle:Ft.collapseSingle,expandSingle:Ft.expandSingle,openExportFileYes:W.openExportFileYes,openExportFileNo:W.openExportFileNo,noRowsInDataViewer:Ft.noRowsInDataViewer,sliceIndexError:Ft.sliceIndexError,sliceMismatchedAxesError:Ft.sliceMismatchedAxesError,filterRowsTooltip:Ft.sliceMismatchedAxesError,fetchingDataViewer:Ft.fetchingDataViewer,dataViewerHideFilters:Ft.dataViewerHideFilters,dataViewerShowFilters:Ft.dataViewerShowFilters,refreshDataViewer:Ft.refreshDataViewer,clearFilters:Ft.refreshDataViewer,sliceSummaryTitle:Ft.sliceSummaryTitle,sliceData:Ft.sliceData,sliceSubmitButton:Ft.sliceSubmitButton,sliceDropdownAxisLabel:Ft.sliceDropdownAxisLabel,sliceDropdownIndexLabel:Ft.sliceDropdownIndexLabel,variableExplorerNameColumn:Ft.variableExplorerNameColumn,variableExplorerTypeColumn:Ft.variableExplorerTypeColumn,variableExplorerCountColumn:Ft.variableExplorerCountColumn,variableExplorerValueColumn:Ft.variableExplorerValueColumn,collapseVariableExplorerLabel:Ft.collapseVariableExplorerLabel,variableLoadingValue:Ft.variableLoadingValue,showDataExplorerTooltip:Ft.showDataExplorerTooltip,noRowsInVariableExplorer:Ft.noRowsInVariableExplorer,loadingRowsInVariableExplorer:Ft.loadingRowsInVariableExplorer,previousPlot:Ft.previousPlot,nextPlot:Ft.nextPlot,panPlot:Ft.panPlot,zoomInPlot:Ft.zoomInPlot,zoomOutPlot:Ft.zoomOutPlot,exportPlot:Ft.exportPlot,deletePlot:Ft.deletePlot,selectedImageListLabel:Ft.selectedImageListLabel,selectedImageLabel:Ft.selectedImageLabel,dvDeprecationWarning:Ft.dvDeprecationWarning};this.postMessageInternal("loc_init",JSON.stringify(e)).catch(E)}async postMessageInternal(e,t){var n;this.webviewInit&&(await this.webviewInit.promise,(n=this.webview)==null||n.postMessage({type:e.toString(),payload:t}))}webViewRendered(){this.webviewInit&&!this.webviewInit.resolved&&this.webviewInit.resolve(),this.sendLocStrings().catch(E),this.onDataScienceSettingsChanged().catch(E)}getValue(e,t,n){return e?e.get(t,n):n}};U([Jv()],pp.prototype,"getHTMLById",1),U([Jv()],pp.prototype,"addMessageListener",1),U([Jv()],pp.prototype,"removeMessageListener",1);var OO=class extends pp{constructor(t,n,i,o,s){super(t,o,s);this.configService=t;this.provider=i;this.messageListener=n(this.onMessage.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webviewView(){return this.webview&&this.webview}async provideWebview(t,n,i,o){if(!o)throw new Error("WebviewViews must be passed an initial VS Code Webview");return this.provider.create({additionalPaths:i?[i]:[],rootPath:this.rootPath,cwd:t,listener:this.messageListener,scripts:this.scripts,settings:n,webviewHost:o})}};var Nv=class extends OO{constructor(t,n,i,o,s,a,l){let u=Fi(i.extensionUri,"dist","webviews","webview-side","viewers");super(t,(c,d)=>new MO(c,d),n,u,[Fi(u,"variableView.js")]);this.variables=o;this.disposables=s;this.notebookWatcher=a;this.dataViewerDelegator=l;this.notebookWatcher.onDidFinishExecutingActiveNotebook(this.activeNotebookExecuted,this,this.disposables),this.notebookWatcher.onDidChangeActiveNotebook(this.activeNotebookChanged,this,this.disposables),this.notebookWatcher.onDidRestartActiveNotebook(this.activeNotebookRestarted,this,this.disposables),this.variables.refreshRequired(this.sendRefreshMessage,this,this.disposables),LO.window.onDidChangeActiveTextEditor(this.activeTextEditorChanged,this,this.disposables)}get owningResource(){}async load(t){await super.loadWebview(LO.Uri.file(process.cwd()),t).catch(w.error),this.webviewView&&this.disposables.push(this.webviewView.onDidChangeVisibility(()=>{this.handleVisibilityChanged()})),this.handleVisibilityChanged()}get title(){return"variableView"}onMessage(t,n){switch(t){case"get_variables_request":this.handleMessage(t,n,this.requestVariables);break;case"show_data_explorer":this.handleMessage(t,n,this.showDataViewer);break;default:break}super.onMessage(t,n)}handleMessage(t,n,i){let o=n;i.bind(this)(o)}handleVisibilityChanged(){let t=new pr("jupyter.variableViewVisible"),n=!1;this.webviewView&&(n=this.webviewView.visible),t.set(n).catch(E),n&&(ne("DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE"),this.notebookWatcher.activeNotebookExecutionCount!==void 0?this.postMessage("update_variable_view_execution_count",{executionCount:this.notebookWatcher.activeNotebookExecutionCount}).catch(E):this.postMessage("force_variable_refresh").catch(E))}async showDataViewer(t){var n,i;return t.variable.fileName=(i=t.variable.fileName)!=null?i:(n=this.notebookWatcher.activeKernel)==null?void 0:n.notebook.uri,this.dataViewerDelegator.showContributedDataViewer(t.variable,!0)}postProcessSupportsDataExplorer(t){let n=this.dataViewerDelegator.getVariableViewers();return t.pageResponse.forEach(i=>{i.supportsDataExplorer=n.some(o=>o.jupyterVariableViewers.dataTypes.includes(i.type))}),t}async requestVariables(t){let n=this.notebookWatcher.activeKernel;if(n){let i=await this.variables.getVariables(t,n);this.postMessage("get_variables_response",this.postProcessSupportsDataExplorer(i)).catch(E),ne("DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",{variableCount:i.totalCount})}else{let i={executionCount:t.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};this.postMessage("get_variables_response",i).catch(E)}}async activeNotebookExecuted(t){this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(E)}async activeNotebookChanged(t){t.executionCount?this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(E):this.postMessage("update_variable_view_execution_count",{executionCount:0}).catch(E),this.postMessage("force_variable_refresh").catch(E)}activeTextEditorChanged(){this.postMessage("force_variable_refresh").catch(E)}async activeNotebookRestarted(){this.postMessage("restart_kernel").catch(E)}async sendRefreshMessage(){this.postMessage("force_variable_refresh").catch(E)}};U([Dr("DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED")],Nv.prototype,"load",1),U([hn()],Nv.prototype,"showDataViewer",1),U([hn()],Nv.prototype,"requestVariables",1);p();var $l=require("vscode");var mre=se(ge());var zl=class{async showContributedDataViewer(e,t){try{let n=this.getMatchingExternalVariableViewers(e);if(n.length===0)return $l.window.showInformationMessage(W.dataViewerExtensionRequired,{modal:!0},Ue.bannerLabelYes).then(i=>{i===Ue.bannerLabelYes&&$l.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(E,E)});if(n.length===1){let i=n[0].jupyterVariableViewers.command;return w.info(`Showing data viewer with command ${i} for variable ${JSON.stringify({...e,value:"..."})}`),$l.commands.executeCommand(i,e)}else{let i=n.filter(s=>s.extension.id!==Je);if(i.length===1){let s=i[0].jupyterVariableViewers.command;return w.info(`Showing data viewer viewer with command ${s} for variable ${JSON.stringify({...e,value:"..."})}`),$l.commands.executeCommand(s,e)}let o=$l.window.createQuickPick();o.title=W.selectExternalDataViewer,o.items=n.map(s=>{var a,l;return{label:s.jupyterVariableViewers.title,detail:(l=(a=s.extension.packageJSON)==null?void 0:a.displayName)!=null?l:s.extension.id,command:s.jupyterVariableViewers.command}}),o.onDidAccept(async()=>{let s=o.selectedItems[0];if(s)return o.hide(),w.info(`Showing data viewer viewer with command ${s.command} for variable ${JSON.stringify({...e,value:"..."})}`),$l.commands.executeCommand(s.command,e)}),o.show()}}catch(n){w.error(n),ne("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",void 0,{reason:"exception",fromVariableView:t}),$l.window.showErrorMessage(W.showDataViewerFail).then(E,E)}}getMatchingExternalVariableViewers(e){return this.getVariableViewers().filter(n=>!e.type||n.jupyterVariableViewers.dataTypes.includes(e.type)).filter(n=>n.extension.id!==Je)}getVariableViewers(){return $l.extensions.all.filter(t=>{var n,i,o,s;return((i=(n=t.packageJSON)==null?void 0:n.contributes)==null?void 0:i.jupyterVariableViewers)&&((s=(o=t.packageJSON)==null?void 0:o.contributes)==null?void 0:s.jupyterVariableViewers.length)}).map(t=>{var i;let n=(i=t.packageJSON)==null?void 0:i.contributes;return n!=null&&n.jupyterVariableViewers?n.jupyterVariableViewers.map(o=>({extension:t,jupyterVariableViewers:o})):[]}).flat()}};zl=U([(0,mre.injectable)()],zl);var bE=class{constructor(e,t,n,i,o,s,a){this.configuration=e;this.webviewViewProvider=t;this.context=n;this.variables=i;this.disposables=o;this.notebookWatcher=s;this.dataViewerDelegator=a;this.viewType="jupyterViewVariables"}get activeVariableView(){if(!mn())throw new Error("activeVariableView only for test code");return this.variableView?Promise.resolve(this.variableView):(this.activeVariableViewPromise=Re(),this.activeVariableViewPromise.promise)}async resolveWebviewView(e,t,n){e.webview.options={enableScripts:!0},this.variableView=new Nv(this.configuration,this.webviewViewProvider,this.context,this.variables,this.disposables,this.notebookWatcher,this.dataViewerDelegator),this.activeVariableViewPromise&&this.activeVariableViewPromise.resolve(this.variableView),await this.variableView.load(e)}};bE=U([(0,Oa.injectable)(),x(0,(0,Oa.inject)(Ke)),x(1,(0,Oa.inject)(RR)),x(2,(0,Oa.inject)(st)),x(3,(0,Oa.inject)(Oi)),x(3,(0,Oa.named)(nt.ALL_VARIABLES)),x(4,(0,Oa.inject)(ve)),x(5,(0,Oa.inject)(RO)),x(6,(0,Oa.inject)(zl))],bE);p();var hp=se(ge());p();var gre=1e3,hre;(t=>(t.Fetching="fetching",t.Skipped="skipped"))(hre||(hre={}));var gs;(f=>(f.Started="started",f.UpdateSettings="update_settings",f.InitializeData="init",f.GetAllRowsRequest="get_all_rows_request",f.GetAllRowsResponse="get_all_rows_response",f.GetRowsRequest="get_rows_request",f.GetRowsResponse="get_rows_response",f.CompletedData="complete",f.GetSliceRequest="get_slice_request",f.RefreshDataViewer="refresh_data_viewer",f.SliceEnablementStateChanged="slice_enablement_state_changed",f.DeprecationWarningClicked="deprecation_warning_clicked"))(gs||(gs={}));var SE=Symbol("IDataViewerFactory"),KO=Symbol("IDataViewer"),FO=Symbol("IJupyterVariableDataProvider"),UO=Symbol("IJupyterVariableDataProviderFactory"),IE=Symbol("IDataViewerDependencyService");var mp=class{constructor(e,t){this.variableManager=e;this.dependencyService=t;this.initialized=!1}get kernel(){return this._kernel}static getNormalizedColumns(e){return e.map(t=>{let n;switch(t.type){case"bool":n="bool";break;case"integer":case"int32":case"int64":case"float":case"float32":case"float64":case"number":n="number";break;default:n="string"}return{key:t.key,type:n}})}static parseShape(e){try{if(e.startsWith("(")&&e.endsWith(")"))return e.substring(1,e.length-1).split(",").map(t=>parseInt(t))}catch(t){w.error(`Could not parse IJupyterVariable with malformed shape: ${e}`)}}dispose(){}setDependencies(e,t){this._kernel=t,this.variable=e}async getDataFrameInfo(e,t){let n={};await this.ensureInitialized();let i=this.variable;return i&&((e||t)&&(i=await this.variableManager.getDataFrameInfo(i,this._kernel,e,t)),n={columns:i.columns?mp.getNormalizedColumns(i.columns):i.columns,indexColumn:i.indexColumn,rowCount:i.rowCount,dataDimensionality:i.dataDimensionality,shape:mp.parseShape(i.shape),sliceExpression:e,type:i.type,maximumRowChunkSize:i.maximumRowChunkSize,name:i.name,fileName:lt(i.fileName)}),t&&(this.variable=i),n}async getAllRows(e){let t=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(t=(await this.variableManager.getDataFrameRows(this.variable,0,this.variable.rowCount,this._kernel,e)).data),t}async getRows(e,t,n){let i=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(i=(await this.variableManager.getDataFrameRows(this.variable,e,t,this._kernel,n)).data),i}async ensureInitialized(){var e,t;!this.initialized&&this.variable&&(this.initialized=!0,(e=this._kernel)!=null&&e.kernelConnectionMetadata&&this.dependencyService&&await this.dependencyService.checkAndInstallMissingDependencies(rc()?this._kernel:((t=this._kernel)==null?void 0:t.kernelConnectionMetadata.interpreter)||this._kernel),this.variable=await this.variableManager.getDataFrameInfo(this.variable,this._kernel))}};mp=U([(0,hp.injectable)(),x(0,(0,hp.inject)(Oi)),x(0,(0,hp.named)(nt.ALL_VARIABLES)),x(1,(0,hp.inject)(IE)),x(1,(0,hp.optional)())],mp);p();var WO=se(ge());var _E=class{constructor(e){this.serviceContainer=e}async create(e,t){let n=this.serviceContainer.get(FO);return n.setDependencies(e,t),n}};_E=U([(0,WO.injectable)(),x(0,(0,WO.inject)(Nr))],_E);p();var Mr=se(ge()),vs=require("vscode");p();var jO=require("vscode");var VO=class{constructor(e){this.configuration=e}async isRequestedColumnSizeAllowed(e,t){if(e>gre&&await this.shouldAskForLargeData(t)){let n=W.tooManyColumnsMessage,i=W.tooManyColumnsYes,o=W.tooManyColumnsNo,s=W.tooManyColumnsDontAskAgain,a=await jO.window.showWarningMessage(n,i,o,s);return a===s&&await this.disableAskForLargeData(),a===i}return!0}async shouldAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();return t&&t.askForLargeDataFrames===!0}async disableAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();t&&(t.askForLargeDataFrames=!1,this.configuration.updateSetting("askForLargeDataFrames",!1,void 0,jO.ConfigurationTarget.Global).catch(E))}};var vre="ds_prompt_about_deprecation",EE=class{constructor(e,t,n,i,o,s,a,l,u,c,d,f,m,g,b){this.disposables=e;this.debugService=t;this.jupyterVariableDataProviderFactory=i;this.dataViewerFactory=o;this.variableProvider=s;this.errorHandler=a;this.dataViewerDependencyService=l;this.interpreterService=u;this.platformService=c;this.kernelProvider=d;this.interactiveWindowProvider=f;this.experimentService=m;this.globalMemento=g;this.dataViewerDelegator=b;this.dataViewerChecker=new VO(n),vs.workspace.isTrusted||vs.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){vs.workspace.isTrusted&&(this.registerCommand(le.ShowDataViewer,this.delegateDataViewer),this.registerCommand(le.ShowJupyterDataViewer,this.delegateDataViewer))}registerCommand(e,t){let n=vs.commands.registerCommand(e,t,this);this.disposables.push(n)}async delegateDataViewer(e){let t="variable"in e?await this.getVariableFromRequest(e):e;if(!t){w.error("Variable info could not be retreived"),ne("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",void 0,{reason:"no variable info",fromVariableView:!1});return}return this.dataViewerDelegator.showContributedDataViewer(t,!1)}async getVariableFromRequest(e){if(this.variableProvider){let t=wM(e.variable);try{return await this.variableProvider.getFullVariable(t)}catch(n){return w.warn("Full variable info could not be retreived, will attempt with partial info.",n),t}}}async showJupyterVariableView(e){var n,i;ne("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX");let t=this.experimentService.inExperiment("DataViewerDeprecation");if(!this.globalMemento.get(vre)&&t&&(this.globalMemento.update(vre,!0).then(E,E),vs.window.showInformationMessage(W.dataViewerDeprecationMessage,W.dataViewerDeprecationRecommendationActionMessage).then(o=>{o===W.dataViewerDeprecationRecommendationActionMessage&&vs.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(E,E)},E)),(n=this.debugService)!=null&&n.activeDebugSession&&this.variableProvider&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory)try{if(this.debugService.activeDebugSession.configuration&&this.dataViewerDependencyService&&this.interpreterService){let l=await this.getDebugAdapterPython(this.debugService.activeDebugSession.configuration);l&&await this.dataViewerDependencyService.checkAndInstallMissingDependencies(l)}let o=await this.jupyterVariableDataProviderFactory.create(e),s=await o.getDataFrameInfo(),a=(i=s==null?void 0:s.columns)==null?void 0:i.length;if(a&&await this.dataViewerChecker.isRequestedColumnSizeAllowed(a)){let l=`${W.dataExplorerTitle} - ${e.name}`,u=await this.dataViewerFactory.create(o,l);return ne("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX"),u}}catch(o){ne("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",void 0,void 0,o),w.error(o),this.errorHandler.handleError(o).then(E,E)}else try{let o=this.getActiveKernel();if(o&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory){let s=await this.jupyterVariableDataProviderFactory.create(e,o),a=`${W.dataExplorerTitle} - ${e.name}`;return await this.dataViewerFactory.create(s,a)}}catch(o){w.error(o),ne("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER"),vs.window.showErrorMessage(W.showDataViewerFail).then(E,E)}}getActiveKernel(){var s,a;let e=(s=vs.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==bt?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=(a=this.dataViewerFactory)==null?void 0:a.activeViewer;return o?this.kernelProvider.kernels.find(l=>l===o.kernel):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return vs.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}async getDebugAdapterPython(e){if(!this.interpreterService){w.info("Interpreter Service missing when trying getDebugAdapterPython");return}let t="";if(e.debugAdapterPython!==void 0?(w.info("Found debugAdapterPython on Debug Configuration to use"),t=e.debugAdapterPython):e.pythonPath&&(w.info("Found pythonPath on Debug Configuration to use"),t=e.pythonPath),t){let n=t;return n.startsWith("~")&&this.platformService.homeDir&&(n=wD(n,this.platformService.homeDir.path)),this.interpreterService.getInterpreterDetails(vs.Uri.file(n))}else return this.interpreterService.getActiveInterpreter()}};EE=U([(0,Mr.injectable)(),x(0,(0,Mr.inject)(ve)),x(1,(0,Mr.inject)(so)),x(1,(0,Mr.optional)()),x(2,(0,Mr.inject)(Ke)),x(3,(0,Mr.inject)(UO)),x(3,(0,Mr.optional)()),x(4,(0,Mr.inject)(SE)),x(4,(0,Mr.optional)()),x(5,(0,Mr.inject)(Oi)),x(5,(0,Mr.named)(nt.DEBUGGER_VARIABLES)),x(6,(0,Mr.inject)(dn)),x(7,(0,Mr.inject)(IE)),x(7,(0,Mr.optional)()),x(8,(0,Mr.inject)(cm)),x(8,(0,Mr.optional)()),x(9,(0,Mr.inject)(us)),x(10,(0,Mr.inject)(qe)),x(11,(0,Mr.inject)(lo)),x(12,(0,Mr.inject)(dy)),x(13,(0,Mr.inject)(_t)),x(13,(0,Mr.named)(rr)),x(14,(0,Mr.inject)(zl))],EE);p();var Rv=se(ge()),Tu=require("vscode");var CE=class{constructor(e,t,n,i){this.interactiveWindowProvider=e;this.kernelProvider=t;this.dataViewerFactory=n;this.disposables=i;this._onDidFinisheExecutingActiveNotebook=new Tu.EventEmitter;this._onDidChangeActiveNotebook=new Tu.EventEmitter;this._onDidRestartActiveNotebook=new Tu.EventEmitter;this._executionCountTracker=new WeakMap;Tu.window.onDidChangeActiveNotebookEditor(this.activeEditorChanged,this,this.disposables),Tu.workspace.onDidCloseNotebookDocument(this.notebookEditorClosed,this,this.disposables),this.kernelProvider.onDidRestartKernel(o=>{this.handleRestart({state:1,notebook:o.notebook})},this,this.disposables),Rr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables)}get onDidChangeActiveNotebook(){return this._onDidChangeActiveNotebook.event}get onDidFinishExecutingActiveNotebook(){return this._onDidFinisheExecutingActiveNotebook.event}get onDidRestartActiveNotebook(){return this._onDidRestartActiveNotebook.event}get activeKernel(){var s;let e=(s=Tu.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==bt?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=this.dataViewerFactory.activeViewer;return o?this.kernelProvider.kernels.find(a=>a===o.kernel):void 0}get activeNotebookExecutionCount(){var t;let e=(t=this.activeKernel)==null?void 0:t.notebook;return e?this._executionCountTracker.get(e):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return Tu.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}onDidChangeNotebookCellExecutionState(e){mr(e.cell.notebook)&&e.state===1&&this.handleExecute({notebook:e.cell.notebook,state:0,cell:e.cell})}handleExecute(e){var t,n,i,o,s,a;this.isNonSilentExecution(e)&&(((n=(t=e.cell)==null?void 0:t.executionSummary)==null?void 0:n.executionOrder)!==void 0&&this._executionCountTracker.set(e.notebook,(i=e.cell.executionSummary)==null?void 0:i.executionOrder),this.isActiveNotebookEvent(e)&&((s=(o=e.cell)==null?void 0:o.executionSummary)==null?void 0:s.executionOrder)!==void 0&&this.activeKernel&&this.kernelProvider.getKernelExecution(this.activeKernel).pendingCells.length===0&&this._onDidFinisheExecutingActiveNotebook.fire({executionCount:(a=e.cell.executionSummary)==null?void 0:a.executionOrder}))}handleRestart(e){this._executionCountTracker.delete(e.notebook),this.isActiveNotebookEvent(e)&&this._onDidRestartActiveNotebook.fire()}notebookEditorClosed(e){this._executionCountTracker.delete(e)}activeEditorChanged(e){let t={};if(e&&mr(e.notebook)){let n=this._executionCountTracker.get(e.notebook);n&&(t.executionCount=n)}this._onDidChangeActiveNotebook.fire(t)}isNonSilentExecution(e){var t;return!!(e.state===0&&e.cell&&((t=e.cell.executionSummary)!=null&&t.executionOrder))}isActiveNotebookEvent(e){var t;return((t=this.activeKernel)==null?void 0:t.notebook)===e.notebook}};CE=U([(0,Rv.injectable)(),x(0,(0,Rv.inject)(lo)),x(1,(0,Rv.inject)(qe)),x(2,(0,Rv.inject)(SE)),x(3,(0,Rv.inject)(ve))],CE);p();var eD=se(ge());var yre=require("vscode");var Rm=class{constructor(e,t){this.serviceContainer=e;this.disposables=t;this.knownViewers=new Set;t.push(this),this.viewContext=new pr(gr.IsDataViewerActive),this.disposables.push(yre.commands.registerCommand(le.RefreshDataViewer,this.refreshDataViewer,this))}dispose(){for(let e of this.knownViewers)e.dispose()}async create(e,t){let n,i=this.serviceContainer.get(KO);try{this.knownViewers.add(i),i.onDidDisposeDataViewer(this.updateOpenDataViewers,this,this.disposables),i.onDidChangeDataViewerViewState(this.updateViewStateContext,this,this.disposables),await i.showData(e,t),n=i}finally{n||i.dispose()}return n}get activeViewer(){return[...this.knownViewers.values()].find(e=>e.active)}updateOpenDataViewers(e){this.knownViewers.delete(e)}async updateViewStateContext(){let e=!1;this.knownViewers.forEach(t=>{t.active&&(e=!0)}),await this.viewContext.set(e)}refreshDataViewer(){for(let e of this.knownViewers)e.active&&e.refreshData().then(E,E)}};U([Dr("DATASCIENCE.START_SHOW_DATA_EXPLORER")],Rm.prototype,"create",1),U([AR(1e3)],Rm.prototype,"refreshDataViewer",1),Rm=U([(0,eD.injectable)(),x(0,(0,eD.inject)(Nr)),x(1,(0,eD.inject)(ve))],Rm);p();var ku=se(ge()),ys=require("vscode");p();var BO=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged(e)}};p();p();var V9;function j9(r,e){return V9&&V9.hasOwnProperty(r)?V9[r]:e}function B9(r,...e){return r.replace(/{(\d+)}/g,(t,n)=>e[n]===void 0?t:e[n])}var GEe=/^\s*((?<StartRange>-?\d+:)|(?<StopRange>-?:\d+)|(?:(?<Start>-?\d+)(?::(?<Stop>-?\d+))?(?::(?<Step>-?\d+))?))\s*$/;function H9(r){let e=r.length-2;return"["+r.map(()=>e>0?(e-=1,"0"):":").join(", ")+"]"}function YEe(r,e){if(r.startsWith("[")&&r.endsWith("]")){let t,n=r.substring(1,r.length-1).split(",").map((i,o)=>{var a;let s=GEe.exec(i);if((a=s==null?void 0:s.groups)!=null&&a.Start&&!s.groups.Stop){let l=parseInt(s.groups.Start),u=e[o];return(l>=0&&l>=u||l<0&&l<-u)&&(t={shapeIndex:o,value:l}),l}});if(t){let{shapeIndex:i,value:o}=t,s=j9("sliceIndexError","Index {0} out of range for axis {1} with {2} elements");return B9(s,o.toString(),i.toString(),e[i].toString())}else if(n&&n.length!==e.length){let i=j9("sliceMismatchedAxesError","Expected {0} axes, got {1} in slice expression");return B9(i,e.length.toString(),n.length.toString())}}return""}function bre(r,e){return YEe(r,e)===""}p();var wE=class extends pp{constructor(t,n,i,o,s,a,l){super(t,o,s);this.configService=t;this.provider=n;this._title=a;this.viewColumn=l;this.viewState={visible:!1,active:!1};this.webPanelViewStateChanged=t=>{let n=t.isVisible(),i=t.isActive(),o={visible:n,active:i},s={visible:this.viewState.visible,active:this.viewState.active};this.viewState.visible=n,this.viewState.active=i,this.onViewStateChanged({current:o,previous:s})};this.messageListener=i(this.onMessage.bind(this),this.webPanelViewStateChanged.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webPanel(){if(this.webview)return this.webview}async show(t){this.isDisposed||this.webPanel&&await this.webPanel.show(t)}dispose(){this.isDisposed||this.webPanel&&this.webPanel.close(),super.dispose()}get title(){return this._title}setTitle(t){this._title=t,!this.isDisposed&&this.webPanel&&this.webPanel.setTitle(t)}onViewStateChanged(t){}async provideWebview(t,n,i,o){return this.provider.create({viewColumn:this.viewColumn,listener:this.messageListener,title:this.title,rootPath:this.rootPath,scripts:this.scripts,settings:n,cwd:t,webviewHost:o,additionalPaths:i?[i]:[]})}};var Sre="JupyterDataViewerPreferredViewColumn",Av=class extends wE{constructor(t,n,i,o,s){var l;let a=Fi(s.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(u,c,d)=>new BO(u,c,d),a,[Fi(a,"dataExplorer.js")],W.dataExplorerTitle,(l=i.get(Sre))!=null?l:ys.ViewColumn.One);this.globalMemento=i;this.errorHandler=o;this.context=s;this.pendingRowsCount=0;this.sentDataViewerSliceDimensionalityTelemetry=!1;this._onDidDisposeDataViewer=new ys.EventEmitter;this._onDidChangeDataViewerViewState=new ys.EventEmitter;this.onDidDispose(this.dataViewerDisposed,this)}get active(){var t;return!!((t=this.webPanel)!=null&&t.isActive())}get refreshPending(){return this.pendingRowsCount>0}get onDidDisposeDataViewer(){return this._onDidDisposeDataViewer.event}get onDidChangeDataViewerViewState(){return this._onDidChangeDataViewerViewState.event}async showData(t,n){if(!this.isDisposed){this.dataProvider=t,await super.loadWebview(ys.Uri.file(process.cwd())).catch(w.error),super.setTitle(n),await super.show(!0);let i=await this.prepDataFrameInfo();if(i.shape&&i.shape.length>2){this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length);let o=H9(i.shape);i=await this.getDataFrameInfo(o)}this.postMessage(gs.InitializeData,i).catch(E)}}get kernel(){if(this.dataProvider&&"kernel"in this.dataProvider)return this.dataProvider.kernel}dataViewerDisposed(){this._onDidDisposeDataViewer.fire(this)}async refreshData(){let t=this.currentSliceExpression;this.dataFrameInfoPromise=void 0;let n=await this.getDataFrameInfo(void 0,!0);if(t!==void 0&&n.shape!==void 0)if(bre(t,n.shape))n=await this.getDataFrameInfo(t);else{let i=H9(n.shape);n=await this.getDataFrameInfo(i)}w.info(`Refreshing data viewer for variable ${n.name}`),this.postMessage(gs.InitializeData,n).catch(E)}dispose(){super.dispose(),this.dataProvider&&(this.dataProvider.dispose(),this.dataProvider=void 0)}async onViewStateChanged(t){var n;t.current.active&&t.current.visible&&t.previous.active&&t.current.visible&&await this.globalMemento.update(Sre,(n=this.webPanel)==null?void 0:n.viewColumn),this._onDidChangeDataViewerViewState.fire()}get owningResource(){}onMessage(t,n){switch(t){case gs.GetAllRowsRequest:this.getAllRows(n).catch(E);break;case gs.GetRowsRequest:this.getRowChunk(n).catch(E);break;case gs.GetSliceRequest:this.getSlice(n).catch(E);break;case gs.RefreshDataViewer:this.refreshData().catch(E),ne("DATASCIENCE.REFRESH_DATA_VIEWER");break;case gs.SliceEnablementStateChanged:ne("DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",void 0,{newState:n.newState?"checked":"unchecked"});break;case gs.DeprecationWarningClicked:ys.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(E,E);break;default:break}super.onMessage(t,n)}getDataFrameInfo(t,n){return(!this.dataFrameInfoPromise||t!==this.currentSliceExpression)&&(this.dataFrameInfoPromise=this.dataProvider?this.dataProvider.getDataFrameInfo(t,n):Promise.resolve({}),this.currentSliceExpression=t),this.dataFrameInfoPromise}async prepDataFrameInfo(){this.rowsTimer=new It;let t=await this.getDataFrameInfo();try{ne("DATASCIENCE.SHOW_DATA_EXPLORER",void 0,{rows:t.rowCount?t.rowCount:0,columns:t.columns?t.columns.length:0}),this.pendingRowsCount=t.rowCount?t.rowCount:0}catch(n){}return t}async getAllRows(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.dataProvider.getAllRows(t);return this.pendingRowsCount=0,this.postMessage(gs.GetAllRowsResponse,n)}})}getSlice(t){return this.wrapRequest(async()=>{var n;if(this.dataProvider){let i=await this.getDataFrameInfo(t.slice);return(n=i.shape)!=null&&n.length&&this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length),ne("DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",void 0,{source:t.source}),this.postMessage(gs.InitializeData,i)}})}getRowChunk(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.getDataFrameInfo(t.sliceExpression),i=await this.dataProvider.getRows(t.start,Math.min(t.end,n.rowCount?n.rowCount:0),t.sliceExpression);return this.pendingRowsCount=Math.max(0,this.pendingRowsCount-i.length),this.postMessage(gs.GetRowsResponse,{rows:i,start:t.start,end:t.end})}})}async wrapRequest(t){try{return await t()}catch(n){if(n instanceof gE){w.error(n.message);let i=W.pythonInteractiveHelpLink;ys.window.showErrorMessage(W.jupyterDataRateExceeded,i).then(o=>{o===i&&ys.env.openExternal(ys.Uri.parse(aD.JupyterDataRateHelpLink))},E),this.dispose()}w.error(n),this.errorHandler.handleError(n).then(E,E)}finally{this.sendElapsedTimeTelemetry()}}sendElapsedTimeTelemetry(){this.rowsTimer&&this.pendingRowsCount===0&&ne("DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",void 0,{rowsTimer:this.rowsTimer.elapsedTime})}maybeSendSliceDataDimensionalityTelemetry(t){this.sentDataViewerSliceDimensionalityTelemetry||(ne("DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",{numberOfDimensions:t}),this.sentDataViewerSliceDimensionalityTelemetry=!0)}};U([Dr("DATAVIEWER.WEBVIEW_LOADED")],Av.prototype,"showData",1),Av=U([(0,ku.injectable)(),x(0,(0,ku.inject)(KS)),x(1,(0,ku.inject)(Ke)),x(2,(0,ku.inject)(_t)),x(2,(0,ku.named)(rr)),x(3,(0,ku.inject)(dn)),x(4,(0,ku.inject)(st))],Av);p();var Ire=se(ge());p();p();p();var HO="0.20.0";var qO=require("vscode");var tD=class{async getVersion(e,t){try{let n=await this._getVersion(e,t);return typeof n=="string"?iY(n):n}catch(n){w.warn(W.failedToGetVersionOfPandas,n.message);return}}async promptInstall(e,t,n){let i=n?W.pandasTooOldForViewingFormat(n,HO):W.pandasRequiredForViewing(HO);if((rB()?Ue.install:await qO.window.showErrorMessage(i,{modal:!0},Ue.install))===Ue.install)await this._doInstall(e,t);else throw ne("DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS"),new Error(i)}async checkOrInstall(e){let t=new qO.CancellationTokenSource;try{let n=await this.getVersion(e,t.token);if(t.token.isCancellationRequested){ne("DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED");return}if(n){if(n.compare(HO)>0){ne("DS_INTERNAL.SHOW_DATA_PANDAS_OK");return}ne("DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD");let i=`${n.major}.${n.minor}.${n.build}`;await this.promptInstall(e,t,i)}ne("DS_INTERNAL.SHOW_DATA_NO_PANDAS"),await this.promptInstall(e,t)}finally{t.dispose()}}};U([Dr("DS_INTERNAL.PYTHON_MODULE_INSTALL",{action:"displayed",moduleName:Ci.get(23)})],tD.prototype,"promptInstall",1);var q9="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",$Ee=`import pandas as _VSCODE_pandas;print(_VSCODE_pandas.__version__);print("${q9}"); del _VSCODE_pandas`;function zEe(r){return(r.kernelConnectionMetadata.interpreter&&Jr(r.kernelConnectionMetadata.interpreter))==="Conda"?"%conda":"%pip"}var JO=class extends tD{async execute(e,t){var o;if(!((o=t.session)!=null&&o.kernel))throw new zr;let n=await Mi(t.session.kernel,e),i=n.find(s=>s.output_type==="error");return i&&w.warn(W.failedToGetVersionOfPandas,i.message),n.map(s=>{var a;return(a=s.text)==null?void 0:a.toString()})}async _getVersion(e){let n=(await this.execute($Ee,e)).map(s=>s?s.toString():void 0).find(s=>s);if(!(n!=null&&n.includes(q9)))return w.warn(W.failedToGetVersionOfPandas,`Output is ${n}`),"";let i=at(n.trim()),o=i.indexOf(q9);return o>=0?i[o-1]:""}async _doInstall(e){let t=`${zEe(e)} install pandas`;try{await this.execute(t,e),ne("DATASCIENCE.USER_INSTALLED_PANDAS")}catch(n){throw ne("DATASCIENCE.USER_INSTALLED_PANDAS",void 0,void 0,n),new Error(W.failedToInstallPandas)}}async checkAndInstallMissingDependencies(e){var t;if(ne("DATAVIEWER.USING_KERNEL"),!((t=e.session)!=null&&t.kernel))throw ne("DATASCIENCE.NO_ACTIVE_KERNEL_SESSION"),new Error("No no active kernel session.");await this.checkOrInstall(e)}};var xE=class{constructor(){this.withKernel=new JO}async checkAndInstallMissingDependencies(e){return this.withKernel.checkAndInstallMissingDependencies(e)}};xE=U([(0,Ire.injectable)()],xE);p();var Gs;(s=>(s.Started="started",s.UpdateSettings="update_settings",s.SendPlot="send_plot",s.CopyPlot="copy_plot",s.ExportPlot="export_plot",s.RemovePlot="remove_plot"))(Gs||(Gs={}));var _re=class{};Gs.Started,Gs.UpdateSettings,Gs.SendPlot,Gs.CopyPlot,Gs.ExportPlot,Gs.RemovePlot;var GO=Symbol("IPlotViewerProvider"),YO=Symbol("IPlotViewer");p();var Mv=se(ge());var Nu=require("vscode");p();var $O=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged&&this.viewChanged(e)}};var PE=class extends wE{constructor(t,n,i,o){let s=new It,a=Fi(o.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(l,u,c)=>new $O(l,u,c),a,[Fi(a,"plotViewer.js")],W.plotViewerTitle,Nu.ViewColumn.One);this.fs=i;this.context=o;this.closedEvent=new Nu.EventEmitter;this.removedEvent=new Nu.EventEmitter;this.addPlot=async t=>{this.isDisposed||(await super.show(!1),this.postMessage(Gs.SendPlot,t).catch(E))};super.loadWebview(Nu.Uri.file(process.cwd())).catch(w.error).finally(()=>{ne("PLOTVIEWER.WEBVIEW_LOADED",{duration:s.elapsedTime})})}get closed(){return this.closedEvent.event}get removed(){return this.removedEvent.event}async show(){if(!this.isDisposed)return super.show(!0)}dispose(){super.dispose(),this.removedEvent.dispose(),this.closedEvent&&this.closedEvent.fire(this)}get owningResource(){}onMessage(t,n){switch(t){case Gs.CopyPlot:this.copyPlot(n.toString()).catch(E);break;case Gs.ExportPlot:this.exportPlot(n).catch(E);break;case Gs.RemovePlot:this.removePlot(n);break;default:break}super.onMessage(t,n)}removePlot(t){this.removedEvent.fire(t)}copyPlot(t){return Promise.resolve()}async exportPlot(t){w.info("exporting plot...");let n={};n[W.pngFilter]=["png"],n[W.svgFilter]=["svg"];let i=await Nu.window.showSaveDialog({saveLabel:W.exportPlotTitle,filters:n});try{if(i)switch(_p(i.path).toLowerCase()){case".png":let s=lR(t.png.replace("data:image/png;base64",""));await this.fs.writeFile(i,s);break;default:case".svg":await this.fs.writeFile(i,t.svg);break}}catch(o){w.error(o),Nu.window.showErrorMessage(W.exportImageFailed(o.toString())).then(E,E)}}};PE=U([(0,Mv.injectable)(),x(0,(0,Mv.inject)(KS)),x(1,(0,Mv.inject)(Ke)),x(2,(0,Mv.inject)(Pt)),x(3,(0,Mv.inject)(st))],PE);p();var rD=se(ge());var DE=class{constructor(e,t){this.serviceContainer=e;this.imageList=[];this.closedViewer=()=>{this.currentViewer&&(this.currentViewer=void 0),this.currentViewerClosed&&(this.currentViewerClosed.dispose(),this.currentViewerClosed=void 0)};this.removedPlot=e=>{this.imageList.splice(e,1)};t.push(this)}dispose(){this.currentViewer&&this.currentViewer.dispose()}async showPlot(e){this.imageList.push(e);let t=this.currentViewer?[e]:this.imageList,n=await this.getOrCreate();await Promise.all(t.map(n.addPlot))}async getOrCreate(){return this.currentViewer||(this.currentViewer=this.serviceContainer.get(YO),this.currentViewerClosed=this.currentViewer.closed(this.closedViewer),this.currentViewer.removed(this.removedPlot),ne("DATASCIENCE.OPEN_PLOT_VIEWER"),await this.currentViewer.show()),this.currentViewer}};DE=U([(0,rD.injectable)(),x(0,(0,rD.inject)(Nr)),x(1,(0,rD.inject)(ve))],DE);p();var QO=se(ge()),Am=require("vscode");var Ere="image/svg+xml",zO={"image/png":"png","image/jpeg":"jpeg","image/gif":"gif",[Ere]:"svg"},TE=class{constructor(e){this.fs=e}async savePlot(e,t,n){if(e.isClosed)return;let i=QEe(e,t,n);if(!i)return w.error(`No plot to save ${Ee(e.uri)}, id: ${t} for ${n}`);if(!(n.toLowerCase()in zO))return w.error(`Unsupported MimeType ${Ee(e.uri)}, id: ${t} for ${n}`);let o=await this.getSaveTarget(i,n);o&&(o.path.toLowerCase().endsWith("pdf")?await this.saveAsPdf(i,o):await this.saveAsImage(i,o))}getSaveTarget(e,t){var l;let n=zO[t.toLowerCase()],i={};e.items.find(u=>u.mime.toLowerCase()===Ere)&&(i[W.pdfFilter]=["pdf"],i[W.svgFilter]=["svg"]),n==="png"&&(i[W.pngFilter]=["png"]),Object.keys(i).length===0&&(i.Images=[n]);let o=(((l=Am.workspace.workspaceFolders)==null?void 0:l.length)||0)>0?Am.workspace.workspaceFolders[0].uri:void 0,s="output",a=o?Am.Uri.joinPath(o,s):Am.Uri.file(s);return Am.window.showSaveDialog({defaultUri:a,saveLabel:W.exportPlotTitle,filters:i})}async saveAsImage(e,t){let n=_p(t.path).substring(1),i=Object.keys(zO).find(s=>zO[s]===n),o=e.items.find(s=>s.mime===i);if(!o)throw new Error(`Unsupported MimeType ${t.toString()}, available mime Types: ${e.items.map(s=>s.mime).join(", ")}`);await this.fs.writeFile(t,o.data)}async saveAsPdf(e,t){return w.error("Save as PDF is not yet supported on the web.")}};TE=U([(0,QO.injectable)(),x(0,(0,QO.inject)(Pt))],TE);function QEe(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e&&i.items.find(o=>o.mime===t))return i}p();var XO=se(ge());var XEe="image/svg+xml",ZEe="image/png",gp=class{constructor(e){this.plotViewProvider=e}async openPlot(e,t){if(e.isClosed)return;let n=Cre(e,t,XEe),i;if(n)i=new TextDecoder().decode(n.data);else{let o=Cre(e,t,ZEe);if(!o)return w.error(`No SVG or PNG Plot to open ${Ee(e.uri)}, id: ${t}`);i=eCe(o)}i&&await this.plotViewProvider.showPlot(i)}};gp=U([(0,XO.injectable)(),x(0,(0,XO.inject)(GO))],gp);function Cre(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e)return i.items.find(o=>o.mime===t)}function eCe(r){let e=r.data,t=cR(e),n=tCe(e);return`<?xml version="1.0" encoding="utf-8" standalone="no"?>
<svg height="${n.height}" width="${n.width}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g>
        <image xmlns="http://www.w3.org/2000/svg" x="0" y="0" height="100%" width="100%" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="data:image/png;base64,${t}"/>
    </g>
</svg>`}function tCe(r){if(!rCe(r))throw new Error("The buffer is not a valid png");let e=new DataView(new Uint8Array(r).buffer);return{width:e.getUint32(16,!1),height:e.getUint32(20,!1)}}function rCe(r){return r[0]===137&&r[1]===80&&r[2]===78&&r[3]===71&&r[4]===13&&r[5]===10&&r[6]===26&&r[7]===10&&r.length>8+21}p();var nD=se(ge()),eL=require("vscode");p();var ZO=Symbol("IPlotSaveHandler");var kE=class{constructor(e,t){this.plotSaveHandler=e;this.plotViewHandler=t;this.disposables=[]}dispose(){Ce(this.disposables)}activate(){this.activateImpl().catch(E)}async activateImpl(){let e=eL.extensions.getExtension(jv);if(!e)return;e.isActive||await e.activate(),e.exports.onDidReceiveMessage(({editor:n,message:i})=>{var s;let o=n.notebook||((s=eL.window.activeNotebookEditor)==null?void 0:s.notebook);o&&(i.type==="saveImageAs"?this.plotSaveHandler.savePlot(o,i.outputId,i.mimeType).catch(E):i.type==="openImageInPlotViewer"&&this.plotViewHandler.openPlot(o,i.outputId).catch(E))},this,this.disposables)}};kE=U([(0,nD.injectable)(),x(0,(0,nD.inject)(ZO)),x(1,(0,nD.inject)(gp))],kE);p();var iD=se(ge()),tL=require("vscode");var NE=class{constructor(e,t){this.kernelProvider=e;this.controllers=t;this.disposables=[];this.widgetOutputsPerNotebook=new WeakMap}dispose(){Ce(this.disposables)}activate(){let e=tL.notebooks.createRendererMessaging("jupyter-ipywidget-renderer");e.onDidReceiveMessage(this.onDidReceiveMessage.bind(this,e),this,this.disposables),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables)}onDidStartKernel(e){this.hookupKernel(e),e.onStarted(()=>this.hookupKernel(e),this,this.disposables),e.onRestarted(()=>this.hookupKernel(e),this,this.disposables)}hookupKernel(e){var s,a,l;this.widgetOutputsPerNotebook.delete(e.notebook);let t=(s=e.session)==null?void 0:s.kernel,n=(l=(a=e.session)==null?void 0:a.kernel)==null?void 0:l.iopubMessage;if(!n)return;let i=ri(),o=(u,c)=>{u===t&&(i.KernelMessage.isDisplayDataMsg(c)||i.KernelMessage.isUpdateDisplayDataMsg(c)||i.KernelMessage.isExecuteReplyMsg(c)||i.KernelMessage.isExecuteResultMsg(c))&&this.trackModelId(e.notebook,c)};n.connect(o),this.disposables.push(new tL.Disposable(()=>n.disconnect(o)))}trackModelId(e,t){let n=t.content;if(n.data&&typeof n.data=="object"&&po in n.data){let i=n.data[po];if(i&&"model_id"in i){let o=this.widgetOutputsPerNotebook.get(e)||new Set;o.add(i.model_id),this.widgetOutputsPerNotebook.set(e,o)}}}onDidReceiveMessage(e,{editor:t,message:n}){n&&typeof n=="object"&&n.command==="query-widget-state"&&this.queryWidgetState(e,t,n),n&&typeof n=="object"&&n.command==="ipywidget-renderer-loaded"&&this.sendWidgetVersionAndState(e,t)}queryWidgetState(e,t,n){let i=this.widgetOutputsPerNotebook.get(t.notebook),o=!!this.controllers.getSelected(t.notebook),s=!!(i!=null&&i.has(n.model_id));e.postMessage({command:"query-widget-state",model_id:n.model_id,hasWidgetState:s,kernelSelected:o},t).then(E,E)}sendWidgetVersionAndState(e,t){let n=this.kernelProvider.get(t.notebook),i=n==null?void 0:n.ipywidgetsVersion;n!=null&&n.ipywidgetsVersion&&w.trace(`IPyWidget version in Kernel is ${n==null?void 0:n.ipywidgetsVersion}.`);let o=!!this.controllers.getSelected(t.notebook);e.postMessage({command:"ipywidget-renderer-init",version:i,widgetState:void 0,kernelSelected:o},t).then(E,E)}};NE=U([(0,iD.injectable)(),x(0,(0,iD.inject)(qe)),x(1,(0,iD.inject)(Nt))],NE);function wre(r){r.addSingleton(Ve,kE),r.addSingleton(Ve,EE),r.add(KO,Av),r.addSingleton(SE,Rm),r.addSingleton(IE,xE),r.addSingleton(zl,zl),r.add(YO,PE),r.addSingleton(GO,DE),r.addSingleton(ZO,TE),r.addSingleton(gp,gp),r.addSingleton(RO,CE),r.addSingleton(Ve,yE),r.addSingleton(Ve,NE),r.addSingleton(AO,bE),r.add(FO,mp),r.addSingleton(UO,_E)}p();var Rre=se(YL());p();var xre=se(ge());var Ov=class{constructor(e){this.container=e}getContainer(){return this.container}add(e,t,n,i){n?this.container.bind(e).to(t).whenTargetNamed(n):this.container.bind(e).to(t),i&&i.forEach(o=>{this.addBinding(e,o)})}addFactory(e,t){this.container.bind(e).toFactory(t)}addBinding(e,t){this.container.bind(t).toService(e)}addSingleton(e,t,n,i){n?this.container.bind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.bind(e).to(t).inSingletonScope(),i&&i.forEach(o=>{this.addBinding(e,o)})}addSingletonInstance(e,t,n){n?this.container.bind(e).toConstantValue(t).whenTargetNamed(n):this.container.bind(e).toConstantValue(t)}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}rebind(e,t,n){n?this.container.rebind(e).to(t).whenTargetNamed(n):this.container.rebind(e).to(t)}rebindSingleton(e,t,n){n?this.container.rebind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.rebind(e).to(t).inSingletonScope()}rebindInstance(e,t,n){n?this.container.rebind(e).toConstantValue(t).whenTargetNamed(n):this.container.rebind(e).toConstantValue(t)}dispose(){this.container.unbindAll(),this.container.unload()}};U([Jv()],Ov.prototype,"getContainer",1),Ov=U([(0,xre.injectable)()],Ov);var In=require("vscode");p();var Dre=require("vscode");function Tre(r){let e=Dre.window.createOutputChannel(W.jupyterServerConsoleOutputChannel,"log");r.push(e);let t={get(n,i){let o=n[i];if(typeof o=="function"){if(i==="append")return(...s)=>{e.append(...s),Pre(...s)};if(i==="appendLine")return(...s)=>{e.appendLine(...s),Pre(...s)}}return o}};return new Proxy(e,t)}function Pre(...r){r.length===1?w.debug(at(r[0]).map((e,t)=>t===0?e:`    ${e}`).join(`
`)):w.debug(...r)}p();var kre=require("vscode");function Nre(){let r=kre.workspace.getConfiguration("python"),e=r==null?void 0:r.get("languageServer");return!(e!=="Pylance"&&e!=="Default")}async function Are(r,e){let t=O7(e);t.appendLine(`${In.env.appName} (${In.version}, ${In.env.remoteName}, ${In.env.appHost})`),t.appendLine(`Jupyter Extension Version: ${r.extension.packageJSON.version}.`);let n=In.extensions.getExtension($s);n?t.appendLine(`Python Extension Version: ${n.packageJSON.version}.`):t.appendLine("Python Extension not installed.");let i=In.extensions.getExtension(lB);return i?t.appendLine(`Pylance Extension Version${Nre()?"":" (Not Used) "}: ${i.packageJSON.version}.`):t.appendLine("Pylance Extension not installed."),e!=null&&e.platform&&t.appendLine(`Platform: ${e.platform} (${e.arch}).`),t.appendLine(`Temp Storage folder ${Ee(await Lte(r))}`),!In.workspace.workspaceFolders||In.workspace.workspaceFolders.length===0?t.appendLine("No workspace folder opened."):In.workspace.workspaceFolders.length===1?t.appendLine(`Workspace folder ${Ee(In.workspace.workspaceFolders[0].uri)}, Home = ${e==null?void 0:e.homePath}`):t.appendLine(`Multiple Workspace folders opened ${In.workspace.workspaceFolders.map(o=>Ee(o.uri)).join(", ")}`),t}function Mre(r,e){let t=new Rre.Container({skipBaseClassChecks:!0}),n=new Ov(t),i=new tt(t);return n.addSingletonInstance(Nr,i),n.addSingletonInstance(SZ,n),n.addSingletonInstance(ve,r.subscriptions),n.addSingletonInstance(_t,r.globalState,rr),n.addSingletonInstance(_t,r.workspaceState,Is),n.addSingletonInstance(st,r),n.addSingletonInstance(Wm,e,Vv),n.addSingletonInstance(Wm,Tre(r.subscriptions),aB),[n,i]}function Ore(){let r=Re(),e={location:In.ProgressLocation.Window,title:Ue.loadingExtension};return In.window.withProgress(e,()=>r.promise).then(E,E),{dispose:()=>r.resolve()}}function Lre(r,e,t){nCe(Ue.handleExtensionActivationError),console.error("extension activation failed",r),w.error("extension activation failed",r),AQ(r,e,t)}function nCe(r){try{In.window.showErrorMessage(r).then(E,E)}catch(e){w.error("failed to notify user",e)}}async function Kre(r,e){let t=e.get(dy),n=new It;await t.activate();let i=n.elapsedTime;ne("DS_INTERNAL.EXPERIMENT_LOAD",{duration:i}),In.commands.executeCommand("setContext","jupyter.vscode.channel",Ud()).then(E,E),e.get(nA).activate();let o=e.get(gT);o.initialize(),r.subscriptions.push(o)}var J9=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}},RE=new J9,oD={totalActivateTime:0,codeLoadingTime:0,startActivateTime:0,endActivateTime:0,workspaceFolderCount:0};typeof requestAnimationFrame=="undefined"&&typeof setImmediate=="undefined"&&(self.setImmediate=r=>setTimeout(r),self.clearImmediate=r=>clearTimeout(r));oD.codeLoadingTime=RE.elapsedTime;var G9;async function iCe(r){oD.startActivateTime=RE.elapsedTime;let e=await Are(r,{addConsoleLogger:mn()});cY(RE),jB(r.subscriptions),tB(Ql.env.uiKind==Ql.UIKind.Web),iB(!0),r.subscriptions.push({dispose:()=>OE.isExiting=!0});try{let[t,n]=sCe(r,e);return await n,RQ(oD,RE),t}catch(t){return oD.endActivateTime=RE.elapsedTime,Lre(t,oD,RE),w.error("Failed to active the Jupyter Extension",t),{ready:Promise.resolve(),registerPythonApi:E,registerRemoteServerProvider:()=>({dispose:E}),getKernelService:()=>Promise.resolve(void 0),addRemoteJupyterServer:()=>Promise.resolve(void 0),openNotebook:()=>Promise.reject(),createJupyterServerCollection:()=>{throw new Error("Not Implemented")},kernels:{getKernel:()=>Promise.resolve(void 0),onDidStart:()=>({dispose:E})}}}}function oCe(){if(OE.isExiting=!0,G9){let r=G9.get(Wu);if(r)return r.dispose()}return Promise.resolve()}function sCe(r,e){let t=Ore();try{let[n,i]=Mre(r,e);G9=i,oY(()=>Promise.resolve(new Map));let o=aCe(r,n,i);return[TQ(o,n,i,r),o,i]}finally{t.dispose()}}async function aCe(r,e,t){let n=r.extensionMode===Ql.ExtensionMode.Development||Ql.workspace.getConfiguration("jupyter").get("development",!1);e.addSingletonInstance(W7,n),n&&Ql.commands.executeCommand("setContext","jupyter.development",!0).then(E,E),Ql.commands.executeCommand("setContext","jupyter.webExtension",!0).then(E,E),NX(e),wee(e,n),bZ(e,n),Pte(e),Tte(e),dre(r,e,n),wre(e),await Kre(r,t)}
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

@microsoft/dynamicproto-js/lib/dist/esm/dynamicproto-js.js:
  (*!
   * Microsoft Dynamic Proto Utility, 1.1.8
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)

strip-comments/index.js:
  (*!
   * strip-comments <https://github.com/jonschlinkert/strip-comments>
   * Copyright (c) 2014-present, Jon Schlinkert.
   * Released under the MIT License.
   *)
*/
